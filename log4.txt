I reach this funciton 32
cuda:0
Yes I use this function ----------------------------------
Decode step 0
32
Memory before Offload Manager initialization 15337.9873046875 MB
Memory after Offload Manager initialization 15338.3955078125 MB
32
Memory before Offload Manager initialization 15338.2705078125 MB
Memory after Offload Manager initialization 15338.6787109375 MB
32
Memory before Offload Manager initialization 15338.5537109375 MB
Memory after Offload Manager initialization 15338.9619140625 MB
32
Memory before Offload Manager initialization 15338.8369140625 MB
Memory after Offload Manager initialization 15339.2451171875 MB
32
Memory before Offload Manager initialization 15339.1201171875 MB
Memory after Offload Manager initialization 15339.5283203125 MB
32
Memory before Offload Manager initialization 15339.4033203125 MB
Memory after Offload Manager initialization 15339.8115234375 MB
32
Memory before Offload Manager initialization 15339.6865234375 MB
Memory after Offload Manager initialization 15340.0947265625 MB
32
Memory before Offload Manager initialization 15339.9697265625 MB
Memory after Offload Manager initialization 15340.3779296875 MB
32
Memory before Offload Manager initialization 15340.2529296875 MB
Memory after Offload Manager initialization 15340.6611328125 MB
32
Memory before Offload Manager initialization 15340.5361328125 MB
Memory after Offload Manager initialization 15340.9443359375 MB
32
Memory before Offload Manager initialization 15340.8193359375 MB
Memory after Offload Manager initialization 15341.2275390625 MB
32
Memory before Offload Manager initialization 15341.1025390625 MB
Memory after Offload Manager initialization 15341.5107421875 MB
32
Memory before Offload Manager initialization 15341.3857421875 MB
Memory after Offload Manager initialization 15341.7939453125 MB
32
Memory before Offload Manager initialization 15341.6689453125 MB
Memory after Offload Manager initialization 15342.0771484375 MB
32
Memory before Offload Manager initialization 15341.9521484375 MB
Memory after Offload Manager initialization 15342.3603515625 MB
32
Memory before Offload Manager initialization 15342.2353515625 MB
Memory after Offload Manager initialization 15342.6435546875 MB
32
Memory before Offload Manager initialization 15342.5185546875 MB
Memory after Offload Manager initialization 15342.9267578125 MB
32
Memory before Offload Manager initialization 15342.8017578125 MB
Memory after Offload Manager initialization 15343.2099609375 MB
32
Memory before Offload Manager initialization 15343.0849609375 MB
Memory after Offload Manager initialization 15343.4931640625 MB
32
Memory before Offload Manager initialization 15343.3681640625 MB
Memory after Offload Manager initialization 15343.7763671875 MB
32
Memory before Offload Manager initialization 15343.6513671875 MB
Memory after Offload Manager initialization 15344.0595703125 MB
32
Memory before Offload Manager initialization 15343.9345703125 MB
Memory after Offload Manager initialization 15344.3427734375 MB
32
Memory before Offload Manager initialization 15344.2177734375 MB
Memory after Offload Manager initialization 15344.6259765625 MB
32
Memory before Offload Manager initialization 15344.5009765625 MB
Memory after Offload Manager initialization 15344.9091796875 MB
32
Memory before Offload Manager initialization 15344.7841796875 MB
Memory after Offload Manager initialization 15345.1923828125 MB
32
Memory before Offload Manager initialization 15345.0673828125 MB
Memory after Offload Manager initialization 15345.4755859375 MB
32
Memory before Offload Manager initialization 15345.3505859375 MB
Memory after Offload Manager initialization 15345.7587890625 MB
32
Memory before Offload Manager initialization 15345.6337890625 MB
Memory after Offload Manager initialization 15346.0419921875 MB
32
Memory before Offload Manager initialization 15345.9169921875 MB
Memory after Offload Manager initialization 15346.3251953125 MB
32
Memory before Offload Manager initialization 15346.2001953125 MB
Memory after Offload Manager initialization 15346.6083984375 MB
32
Memory before Offload Manager initialization 15346.4833984375 MB
Memory after Offload Manager initialization 15346.8916015625 MB
32
Memory before Offload Manager initialization 15346.7666015625 MB
Memory after Offload Manager initialization 15347.1748046875 MB
Decode step 1
1
Memory before offload  15345.767578125 MB
Memory after offload  15345.767578125 MB
Memory before cuda sdpa 15345.78125 MB
On entering CUDA sdpa main function  allocated = 15345.78125 MB
Before first SDPA allocated = 15345.78125 MB
On chunked entry = 15345.78125 MB
On scale calculation = 15345.78906 MB
Before interleave = 15345.78906 MB
After interleave = 15346.28906 MB
After matmul = 15354.41602 MB
Before local copies matmul = 15354.41602 MB
After local copies = 15354.41895 MB
After first SDPA allocated = 15353.90625 MB
After first copy allocated = 15353.90625 MB
On chunked entry = 15353.90625 MB
On scale calculation = 15353.91406 MB
Before interleave = 15353.91406 MB
After interleave = 15353.92969 MB
After matmul = 15353.93018 MB
Before local copies matmul = 15353.93018 MB
After local copies = 15353.93164 MB
fter compute chunk allocated = 15353.90625 MB
Memory after cuda sdpa 15353.9140625 MB
1
Memory before offload  15353.892578125 MB
Memory after offload  15353.892578125 MB
Memory before cuda sdpa 15353.90625 MB
On entering CUDA sdpa main function  allocated = 15353.90625 MB
Before first SDPA allocated = 15353.90625 MB
On chunked entry = 15353.90625 MB
On scale calculation = 15353.91406 MB
Before interleave = 15353.91406 MB
After interleave = 15354.41406 MB
After matmul = 15362.54102 MB
Before local copies matmul = 15362.54102 MB
After local copies = 15362.54395 MB
After first SDPA allocated = 15362.03125 MB
After first copy allocated = 15362.03125 MB
On chunked entry = 15362.03125 MB
On scale calculation = 15362.03906 MB
Before interleave = 15362.03906 MB
After interleave = 15362.05469 MB
After matmul = 15362.05518 MB
Before local copies matmul = 15362.05518 MB
After local copies = 15362.05664 MB
fter compute chunk allocated = 15362.03125 MB
Memory after cuda sdpa 15362.0390625 MB
1
Memory before offload  15362.017578125 MB
Memory after offload  15362.017578125 MB
Memory before cuda sdpa 15362.03125 MB
On entering CUDA sdpa main function  allocated = 15362.03125 MB
Before first SDPA allocated = 15362.03125 MB
On chunked entry = 15362.03125 MB
On scale calculation = 15362.03906 MB
Before interleave = 15362.03906 MB
After interleave = 15362.53906 MB
After matmul = 15370.66602 MB
Before local copies matmul = 15370.66602 MB
After local copies = 15370.66895 MB
After first SDPA allocated = 15370.15625 MB
After first copy allocated = 15370.15625 MB
On chunked entry = 15370.15625 MB
On scale calculation = 15370.16406 MB
Before interleave = 15370.16406 MB
After interleave = 15370.17969 MB
After matmul = 15370.18018 MB
Before local copies matmul = 15370.18018 MB
After local copies = 15370.18164 MB
fter compute chunk allocated = 15370.15625 MB
Memory after cuda sdpa 15370.1640625 MB
1
Memory before offload  15370.142578125 MB
Memory after offload  15370.142578125 MB
Memory before cuda sdpa 15370.15625 MB
On entering CUDA sdpa main function  allocated = 15370.15625 MB
Before first SDPA allocated = 15370.15625 MB
On chunked entry = 15370.15625 MB
On scale calculation = 15370.16406 MB
Before interleave = 15370.16406 MB
After interleave = 15370.66406 MB
After matmul = 15378.79102 MB
Before local copies matmul = 15378.79102 MB
After local copies = 15378.79395 MB
After first SDPA allocated = 15378.28125 MB
After first copy allocated = 15378.28125 MB
On chunked entry = 15378.28125 MB
On scale calculation = 15378.28906 MB
Before interleave = 15378.28906 MB
After interleave = 15378.30469 MB
After matmul = 15378.30518 MB
Before local copies matmul = 15378.30518 MB
After local copies = 15378.30664 MB
fter compute chunk allocated = 15378.28125 MB
Memory after cuda sdpa 15378.2890625 MB
1
Memory before offload  15378.267578125 MB
Memory after offload  15378.267578125 MB
Memory before cuda sdpa 15378.28125 MB
On entering CUDA sdpa main function  allocated = 15378.28125 MB
Before first SDPA allocated = 15378.28125 MB
On chunked entry = 15378.28125 MB
On scale calculation = 15378.28906 MB
Before interleave = 15378.28906 MB
After interleave = 15378.78906 MB
After matmul = 15386.91602 MB
Before local copies matmul = 15386.91602 MB
After local copies = 15386.91895 MB
After first SDPA allocated = 15386.40625 MB
After first copy allocated = 15386.40625 MB
On chunked entry = 15386.40625 MB
On scale calculation = 15386.41406 MB
Before interleave = 15386.41406 MB
After interleave = 15386.42969 MB
After matmul = 15386.43018 MB
Before local copies matmul = 15386.43018 MB
After local copies = 15386.43164 MB
fter compute chunk allocated = 15386.40625 MB
Memory after cuda sdpa 15386.4140625 MB
1
Memory before offload  15386.392578125 MB
Memory after offload  15386.392578125 MB
Memory before cuda sdpa 15386.40625 MB
On entering CUDA sdpa main function  allocated = 15386.40625 MB
Before first SDPA allocated = 15386.40625 MB
On chunked entry = 15386.40625 MB
On scale calculation = 15386.41406 MB
Before interleave = 15386.41406 MB
After interleave = 15386.91406 MB
After matmul = 15395.04102 MB
Before local copies matmul = 15395.04102 MB
After local copies = 15395.04395 MB
After first SDPA allocated = 15394.53125 MB
After first copy allocated = 15394.53125 MB
On chunked entry = 15394.53125 MB
On scale calculation = 15394.53906 MB
Before interleave = 15394.53906 MB
After interleave = 15394.55469 MB
After matmul = 15394.55518 MB
Before local copies matmul = 15394.55518 MB
After local copies = 15394.55664 MB
fter compute chunk allocated = 15394.53125 MB
Memory after cuda sdpa 15394.5390625 MB
1
Memory before offload  15394.517578125 MB
Memory after offload  15394.517578125 MB
Memory before cuda sdpa 15394.53125 MB
On entering CUDA sdpa main function  allocated = 15394.53125 MB
Before first SDPA allocated = 15394.53125 MB
On chunked entry = 15394.53125 MB
On scale calculation = 15394.53906 MB
Before interleave = 15394.53906 MB
After interleave = 15395.03906 MB
After matmul = 15403.16602 MB
Before local copies matmul = 15403.16602 MB
After local copies = 15403.16895 MB
After first SDPA allocated = 15402.65625 MB
After first copy allocated = 15402.65625 MB
On chunked entry = 15402.65625 MB
On scale calculation = 15402.66406 MB
Before interleave = 15402.66406 MB
After interleave = 15402.67969 MB
After matmul = 15402.68018 MB
Before local copies matmul = 15402.68018 MB
After local copies = 15402.68164 MB
fter compute chunk allocated = 15402.65625 MB
Memory after cuda sdpa 15402.6640625 MB
1
Memory before offload  15402.642578125 MB
Memory after offload  15402.642578125 MB
Memory before cuda sdpa 15402.65625 MB
On entering CUDA sdpa main function  allocated = 15402.65625 MB
Before first SDPA allocated = 15402.65625 MB
On chunked entry = 15402.65625 MB
On scale calculation = 15402.66406 MB
Before interleave = 15402.66406 MB
After interleave = 15403.16406 MB
After matmul = 15411.29102 MB
Before local copies matmul = 15411.29102 MB
After local copies = 15411.29395 MB
After first SDPA allocated = 15410.78125 MB
After first copy allocated = 15410.78125 MB
On chunked entry = 15410.78125 MB
On scale calculation = 15410.78906 MB
Before interleave = 15410.78906 MB
After interleave = 15410.80469 MB
After matmul = 15410.80518 MB
Before local copies matmul = 15410.80518 MB
After local copies = 15410.80664 MB
fter compute chunk allocated = 15410.78125 MB
Memory after cuda sdpa 15410.7890625 MB
1
Memory before offload  15410.767578125 MB
Memory after offload  15410.767578125 MB
Memory before cuda sdpa 15410.78125 MB
On entering CUDA sdpa main function  allocated = 15410.78125 MB
Before first SDPA allocated = 15410.78125 MB
On chunked entry = 15410.78125 MB
On scale calculation = 15410.78906 MB
Before interleave = 15410.78906 MB
After interleave = 15411.28906 MB
After matmul = 15419.41602 MB
Before local copies matmul = 15419.41602 MB
After local copies = 15419.41895 MB
After first SDPA allocated = 15418.90625 MB
After first copy allocated = 15418.90625 MB
On chunked entry = 15418.90625 MB
On scale calculation = 15418.91406 MB
Before interleave = 15418.91406 MB
After interleave = 15418.92969 MB
After matmul = 15418.93018 MB
Before local copies matmul = 15418.93018 MB
After local copies = 15418.93164 MB
fter compute chunk allocated = 15418.90625 MB
Memory after cuda sdpa 15418.9140625 MB
1
Memory before offload  15418.892578125 MB
Memory after offload  15418.892578125 MB
Memory before cuda sdpa 15418.90625 MB
On entering CUDA sdpa main function  allocated = 15418.90625 MB
Before first SDPA allocated = 15418.90625 MB
On chunked entry = 15418.90625 MB
On scale calculation = 15418.91406 MB
Before interleave = 15418.91406 MB
After interleave = 15419.41406 MB
After matmul = 15427.54102 MB
Before local copies matmul = 15427.54102 MB
After local copies = 15427.54395 MB
After first SDPA allocated = 15427.03125 MB
After first copy allocated = 15427.03125 MB
On chunked entry = 15427.03125 MB
On scale calculation = 15427.03906 MB
Before interleave = 15427.03906 MB
After interleave = 15427.05469 MB
After matmul = 15427.05518 MB
Before local copies matmul = 15427.05518 MB
After local copies = 15427.05664 MB
fter compute chunk allocated = 15427.03125 MB
Memory after cuda sdpa 15427.0390625 MB
1
Memory before offload  15427.017578125 MB
Memory after offload  15427.017578125 MB
Memory before cuda sdpa 15427.03125 MB
On entering CUDA sdpa main function  allocated = 15427.03125 MB
Before first SDPA allocated = 15427.03125 MB
On chunked entry = 15427.03125 MB
On scale calculation = 15427.03906 MB
Before interleave = 15427.03906 MB
After interleave = 15427.53906 MB
After matmul = 15435.66602 MB
Before local copies matmul = 15435.66602 MB
After local copies = 15435.66895 MB
After first SDPA allocated = 15435.15625 MB
After first copy allocated = 15435.15625 MB
On chunked entry = 15435.15625 MB
On scale calculation = 15435.16406 MB
Before interleave = 15435.16406 MB
After interleave = 15435.17969 MB
After matmul = 15435.18018 MB
Before local copies matmul = 15435.18018 MB
After local copies = 15435.18164 MB
fter compute chunk allocated = 15435.15625 MB
Memory after cuda sdpa 15435.1640625 MB
1
Memory before offload  15435.142578125 MB
Memory after offload  15435.142578125 MB
Memory before cuda sdpa 15435.15625 MB
On entering CUDA sdpa main function  allocated = 15435.15625 MB
Before first SDPA allocated = 15435.15625 MB
On chunked entry = 15435.15625 MB
On scale calculation = 15435.16406 MB
Before interleave = 15435.16406 MB
After interleave = 15435.66406 MB
After matmul = 15443.79102 MB
Before local copies matmul = 15443.79102 MB
After local copies = 15443.79395 MB
After first SDPA allocated = 15443.28125 MB
After first copy allocated = 15443.28125 MB
On chunked entry = 15443.28125 MB
On scale calculation = 15443.28906 MB
Before interleave = 15443.28906 MB
After interleave = 15443.30469 MB
After matmul = 15443.30518 MB
Before local copies matmul = 15443.30518 MB
After local copies = 15443.30664 MB
fter compute chunk allocated = 15443.28125 MB
Memory after cuda sdpa 15443.2890625 MB
1
Memory before offload  15443.267578125 MB
Memory after offload  15443.267578125 MB
Memory before cuda sdpa 15443.28125 MB
On entering CUDA sdpa main function  allocated = 15443.28125 MB
Before first SDPA allocated = 15443.28125 MB
On chunked entry = 15443.28125 MB
On scale calculation = 15443.28906 MB
Before interleave = 15443.28906 MB
After interleave = 15443.78906 MB
After matmul = 15451.91602 MB
Before local copies matmul = 15451.91602 MB
After local copies = 15451.91895 MB
After first SDPA allocated = 15451.40625 MB
After first copy allocated = 15451.40625 MB
On chunked entry = 15451.40625 MB
On scale calculation = 15451.41406 MB
Before interleave = 15451.41406 MB
After interleave = 15451.42969 MB
After matmul = 15451.43018 MB
Before local copies matmul = 15451.43018 MB
After local copies = 15451.43164 MB
fter compute chunk allocated = 15451.40625 MB
Memory after cuda sdpa 15451.4140625 MB
1
Memory before offload  15451.392578125 MB
Memory after offload  15451.392578125 MB
Memory before cuda sdpa 15451.40625 MB
On entering CUDA sdpa main function  allocated = 15451.40625 MB
Before first SDPA allocated = 15451.40625 MB
On chunked entry = 15451.40625 MB
On scale calculation = 15451.41406 MB
Before interleave = 15451.41406 MB
After interleave = 15451.91406 MB
After matmul = 15460.04102 MB
Before local copies matmul = 15460.04102 MB
After local copies = 15460.04395 MB
After first SDPA allocated = 15459.53125 MB
After first copy allocated = 15459.53125 MB
On chunked entry = 15459.53125 MB
On scale calculation = 15459.53906 MB
Before interleave = 15459.53906 MB
After interleave = 15459.55469 MB
After matmul = 15459.55518 MB
Before local copies matmul = 15459.55518 MB
After local copies = 15459.55664 MB
fter compute chunk allocated = 15459.53125 MB
Memory after cuda sdpa 15459.5390625 MB
1
Memory before offload  15459.517578125 MB
Memory after offload  15459.517578125 MB
Memory before cuda sdpa 15459.53125 MB
On entering CUDA sdpa main function  allocated = 15459.53125 MB
Before first SDPA allocated = 15459.53125 MB
On chunked entry = 15459.53125 MB
On scale calculation = 15459.53906 MB
Before interleave = 15459.53906 MB
After interleave = 15460.03906 MB
After matmul = 15468.16602 MB
Before local copies matmul = 15468.16602 MB
After local copies = 15468.16895 MB
After first SDPA allocated = 15467.65625 MB
After first copy allocated = 15467.65625 MB
On chunked entry = 15467.65625 MB
On scale calculation = 15467.66406 MB
Before interleave = 15467.66406 MB
After interleave = 15467.67969 MB
After matmul = 15467.68018 MB
Before local copies matmul = 15467.68018 MB
After local copies = 15467.68164 MB
fter compute chunk allocated = 15467.65625 MB
Memory after cuda sdpa 15467.6640625 MB
1
Memory before offload  15467.642578125 MB
Memory after offload  15467.642578125 MB
Memory before cuda sdpa 15467.65625 MB
On entering CUDA sdpa main function  allocated = 15467.65625 MB
Before first SDPA allocated = 15467.65625 MB
On chunked entry = 15467.65625 MB
On scale calculation = 15467.66406 MB
Before interleave = 15467.66406 MB
After interleave = 15468.16406 MB
After matmul = 15476.29102 MB
Before local copies matmul = 15476.29102 MB
After local copies = 15476.29395 MB
After first SDPA allocated = 15475.78125 MB
After first copy allocated = 15475.78125 MB
On chunked entry = 15475.78125 MB
On scale calculation = 15475.78906 MB
Before interleave = 15475.78906 MB
After interleave = 15475.80469 MB
After matmul = 15475.80518 MB
Before local copies matmul = 15475.80518 MB
After local copies = 15475.80664 MB
fter compute chunk allocated = 15475.78125 MB
Memory after cuda sdpa 15475.7890625 MB
1
Memory before offload  15475.767578125 MB
Memory after offload  15475.767578125 MB
Memory before cuda sdpa 15475.78125 MB
On entering CUDA sdpa main function  allocated = 15475.78125 MB
Before first SDPA allocated = 15475.78125 MB
On chunked entry = 15475.78125 MB
On scale calculation = 15475.78906 MB
Before interleave = 15475.78906 MB
After interleave = 15476.28906 MB
After matmul = 15484.41602 MB
Before local copies matmul = 15484.41602 MB
After local copies = 15484.41895 MB
After first SDPA allocated = 15483.90625 MB
After first copy allocated = 15483.90625 MB
On chunked entry = 15483.90625 MB
On scale calculation = 15483.91406 MB
Before interleave = 15483.91406 MB
After interleave = 15483.92969 MB
After matmul = 15483.93018 MB
Before local copies matmul = 15483.93018 MB
After local copies = 15483.93164 MB
fter compute chunk allocated = 15483.90625 MB
Memory after cuda sdpa 15483.9140625 MB
1
Memory before offload  15483.892578125 MB
Memory after offload  15483.892578125 MB
Memory before cuda sdpa 15483.90625 MB
On entering CUDA sdpa main function  allocated = 15483.90625 MB
Before first SDPA allocated = 15483.90625 MB
On chunked entry = 15483.90625 MB
On scale calculation = 15483.91406 MB
Before interleave = 15483.91406 MB
After interleave = 15484.41406 MB
After matmul = 15492.54102 MB
Before local copies matmul = 15492.54102 MB
After local copies = 15492.54395 MB
After first SDPA allocated = 15492.03125 MB
After first copy allocated = 15492.03125 MB
On chunked entry = 15492.03125 MB
On scale calculation = 15492.03906 MB
Before interleave = 15492.03906 MB
After interleave = 15492.05469 MB
After matmul = 15492.05518 MB
Before local copies matmul = 15492.05518 MB
After local copies = 15492.05664 MB
fter compute chunk allocated = 15492.03125 MB
Memory after cuda sdpa 15492.0390625 MB
1
Memory before offload  15492.017578125 MB
Memory after offload  15492.017578125 MB
Memory before cuda sdpa 15492.03125 MB
On entering CUDA sdpa main function  allocated = 15492.03125 MB
Before first SDPA allocated = 15492.03125 MB
On chunked entry = 15492.03125 MB
On scale calculation = 15492.03906 MB
Before interleave = 15492.03906 MB
After interleave = 15492.53906 MB
After matmul = 15500.66602 MB
Before local copies matmul = 15500.66602 MB
After local copies = 15500.66895 MB
After first SDPA allocated = 15500.15625 MB
After first copy allocated = 15500.15625 MB
On chunked entry = 15500.15625 MB
On scale calculation = 15500.16406 MB
Before interleave = 15500.16406 MB
After interleave = 15500.17969 MB
After matmul = 15500.18018 MB
Before local copies matmul = 15500.18018 MB
After local copies = 15500.18164 MB
fter compute chunk allocated = 15500.15625 MB
Memory after cuda sdpa 15500.1640625 MB
1
Memory before offload  15500.142578125 MB
Memory after offload  15500.142578125 MB
Memory before cuda sdpa 15500.15625 MB
On entering CUDA sdpa main function  allocated = 15500.15625 MB
Before first SDPA allocated = 15500.15625 MB
On chunked entry = 15500.15625 MB
On scale calculation = 15500.16406 MB
Before interleave = 15500.16406 MB
After interleave = 15500.66406 MB
After matmul = 15508.79102 MB
Before local copies matmul = 15508.79102 MB
After local copies = 15508.79395 MB
After first SDPA allocated = 15508.28125 MB
After first copy allocated = 15508.28125 MB
On chunked entry = 15508.28125 MB
On scale calculation = 15508.28906 MB
Before interleave = 15508.28906 MB
After interleave = 15508.30469 MB
After matmul = 15508.30518 MB
Before local copies matmul = 15508.30518 MB
After local copies = 15508.30664 MB
fter compute chunk allocated = 15508.28125 MB
Memory after cuda sdpa 15508.2890625 MB
1
Memory before offload  15508.267578125 MB
Memory after offload  15508.267578125 MB
Memory before cuda sdpa 15508.28125 MB
On entering CUDA sdpa main function  allocated = 15508.28125 MB
Before first SDPA allocated = 15508.28125 MB
On chunked entry = 15508.28125 MB
On scale calculation = 15508.28906 MB
Before interleave = 15508.28906 MB
After interleave = 15508.78906 MB
After matmul = 15516.91602 MB
Before local copies matmul = 15516.91602 MB
After local copies = 15516.91895 MB
After first SDPA allocated = 15516.40625 MB
After first copy allocated = 15516.40625 MB
On chunked entry = 15516.40625 MB
On scale calculation = 15516.41406 MB
Before interleave = 15516.41406 MB
After interleave = 15516.42969 MB
After matmul = 15516.43018 MB
Before local copies matmul = 15516.43018 MB
After local copies = 15516.43164 MB
fter compute chunk allocated = 15516.40625 MB
Memory after cuda sdpa 15516.4140625 MB
1
Memory before offload  15516.392578125 MB
Memory after offload  15516.392578125 MB
Memory before cuda sdpa 15516.40625 MB
On entering CUDA sdpa main function  allocated = 15516.40625 MB
Before first SDPA allocated = 15516.40625 MB
On chunked entry = 15516.40625 MB
On scale calculation = 15516.41406 MB
Before interleave = 15516.41406 MB
After interleave = 15516.91406 MB
After matmul = 15525.04102 MB
Before local copies matmul = 15525.04102 MB
After local copies = 15525.04395 MB
After first SDPA allocated = 15524.53125 MB
After first copy allocated = 15524.53125 MB
On chunked entry = 15524.53125 MB
On scale calculation = 15524.53906 MB
Before interleave = 15524.53906 MB
After interleave = 15524.55469 MB
After matmul = 15524.55518 MB
Before local copies matmul = 15524.55518 MB
After local copies = 15524.55664 MB
fter compute chunk allocated = 15524.53125 MB
Memory after cuda sdpa 15524.5390625 MB
1
Memory before offload  15524.517578125 MB
Memory after offload  15524.517578125 MB
Memory before cuda sdpa 15524.53125 MB
On entering CUDA sdpa main function  allocated = 15524.53125 MB
Before first SDPA allocated = 15524.53125 MB
On chunked entry = 15524.53125 MB
On scale calculation = 15524.53906 MB
Before interleave = 15524.53906 MB
After interleave = 15525.03906 MB
After matmul = 15533.16602 MB
Before local copies matmul = 15533.16602 MB
After local copies = 15533.16895 MB
After first SDPA allocated = 15532.65625 MB
After first copy allocated = 15532.65625 MB
On chunked entry = 15532.65625 MB
On scale calculation = 15532.66406 MB
Before interleave = 15532.66406 MB
After interleave = 15532.67969 MB
After matmul = 15532.68018 MB
Before local copies matmul = 15532.68018 MB
After local copies = 15532.68164 MB
fter compute chunk allocated = 15532.65625 MB
Memory after cuda sdpa 15532.6640625 MB
1
Memory before offload  15532.642578125 MB
Memory after offload  15532.642578125 MB
Memory before cuda sdpa 15532.65625 MB
On entering CUDA sdpa main function  allocated = 15532.65625 MB
Before first SDPA allocated = 15532.65625 MB
On chunked entry = 15532.65625 MB
On scale calculation = 15532.66406 MB
Before interleave = 15532.66406 MB
After interleave = 15533.16406 MB
After matmul = 15541.29102 MB
Before local copies matmul = 15541.29102 MB
After local copies = 15541.29395 MB
After first SDPA allocated = 15540.78125 MB
After first copy allocated = 15540.78125 MB
On chunked entry = 15540.78125 MB
On scale calculation = 15540.78906 MB
Before interleave = 15540.78906 MB
After interleave = 15540.80469 MB
After matmul = 15540.80518 MB
Before local copies matmul = 15540.80518 MB
After local copies = 15540.80664 MB
fter compute chunk allocated = 15540.78125 MB
Memory after cuda sdpa 15540.7890625 MB
1
Memory before offload  15540.767578125 MB
Memory after offload  15540.767578125 MB
Memory before cuda sdpa 15540.78125 MB
On entering CUDA sdpa main function  allocated = 15540.78125 MB
Before first SDPA allocated = 15540.78125 MB
On chunked entry = 15540.78125 MB
On scale calculation = 15540.78906 MB
Before interleave = 15540.78906 MB
After interleave = 15541.28906 MB
After matmul = 15549.41602 MB
Before local copies matmul = 15549.41602 MB
After local copies = 15549.41895 MB
After first SDPA allocated = 15548.90625 MB
After first copy allocated = 15548.90625 MB
On chunked entry = 15548.90625 MB
On scale calculation = 15548.91406 MB
Before interleave = 15548.91406 MB
After interleave = 15548.92969 MB
After matmul = 15548.93018 MB
Before local copies matmul = 15548.93018 MB
After local copies = 15548.93164 MB
fter compute chunk allocated = 15548.90625 MB
Memory after cuda sdpa 15548.9140625 MB
1
Memory before offload  15548.892578125 MB
Memory after offload  15548.892578125 MB
Memory before cuda sdpa 15548.90625 MB
On entering CUDA sdpa main function  allocated = 15548.90625 MB
Before first SDPA allocated = 15548.90625 MB
On chunked entry = 15548.90625 MB
On scale calculation = 15548.91406 MB
Before interleave = 15548.91406 MB
After interleave = 15549.41406 MB
After matmul = 15557.54102 MB
Before local copies matmul = 15557.54102 MB
After local copies = 15557.54395 MB
After first SDPA allocated = 15557.03125 MB
After first copy allocated = 15557.03125 MB
On chunked entry = 15557.03125 MB
On scale calculation = 15557.03906 MB
Before interleave = 15557.03906 MB
After interleave = 15557.05469 MB
After matmul = 15557.05518 MB
Before local copies matmul = 15557.05518 MB
After local copies = 15557.05664 MB
fter compute chunk allocated = 15557.03125 MB
Memory after cuda sdpa 15557.0390625 MB
1
Memory before offload  15557.017578125 MB
Memory after offload  15557.017578125 MB
Memory before cuda sdpa 15557.03125 MB
On entering CUDA sdpa main function  allocated = 15557.03125 MB
Before first SDPA allocated = 15557.03125 MB
On chunked entry = 15557.03125 MB
On scale calculation = 15557.03906 MB
Before interleave = 15557.03906 MB
After interleave = 15557.53906 MB
After matmul = 15565.66602 MB
Before local copies matmul = 15565.66602 MB
After local copies = 15565.66895 MB
After first SDPA allocated = 15565.15625 MB
After first copy allocated = 15565.15625 MB
On chunked entry = 15565.15625 MB
On scale calculation = 15565.16406 MB
Before interleave = 15565.16406 MB
After interleave = 15565.17969 MB
After matmul = 15565.18018 MB
Before local copies matmul = 15565.18018 MB
After local copies = 15565.18164 MB
fter compute chunk allocated = 15565.15625 MB
Memory after cuda sdpa 15565.1640625 MB
1
Memory before offload  15565.142578125 MB
Memory after offload  15565.142578125 MB
Memory before cuda sdpa 15565.15625 MB
On entering CUDA sdpa main function  allocated = 15565.15625 MB
Before first SDPA allocated = 15565.15625 MB
On chunked entry = 15565.15625 MB
On scale calculation = 15565.16406 MB
Before interleave = 15565.16406 MB
After interleave = 15565.66406 MB
After matmul = 15573.79102 MB
Before local copies matmul = 15573.79102 MB
After local copies = 15573.79395 MB
After first SDPA allocated = 15573.28125 MB
After first copy allocated = 15573.28125 MB
On chunked entry = 15573.28125 MB
On scale calculation = 15573.28906 MB
Before interleave = 15573.28906 MB
After interleave = 15573.30469 MB
After matmul = 15573.30518 MB
Before local copies matmul = 15573.30518 MB
After local copies = 15573.30664 MB
fter compute chunk allocated = 15573.28125 MB
Memory after cuda sdpa 15573.2890625 MB
1
Memory before offload  15573.267578125 MB
Memory after offload  15573.267578125 MB
Memory before cuda sdpa 15573.28125 MB
On entering CUDA sdpa main function  allocated = 15573.28125 MB
Before first SDPA allocated = 15573.28125 MB
On chunked entry = 15573.28125 MB
On scale calculation = 15573.28906 MB
Before interleave = 15573.28906 MB
After interleave = 15573.78906 MB
After matmul = 15581.91602 MB
Before local copies matmul = 15581.91602 MB
After local copies = 15581.91895 MB
After first SDPA allocated = 15581.40625 MB
After first copy allocated = 15581.40625 MB
On chunked entry = 15581.40625 MB
On scale calculation = 15581.41406 MB
Before interleave = 15581.41406 MB
After interleave = 15581.42969 MB
After matmul = 15581.43018 MB
Before local copies matmul = 15581.43018 MB
After local copies = 15581.43164 MB
fter compute chunk allocated = 15581.40625 MB
Memory after cuda sdpa 15581.4140625 MB
1
Memory before offload  15581.392578125 MB
Memory after offload  15581.392578125 MB
Memory before cuda sdpa 15581.40625 MB
On entering CUDA sdpa main function  allocated = 15581.40625 MB
Before first SDPA allocated = 15581.40625 MB
On chunked entry = 15581.40625 MB
On scale calculation = 15581.41406 MB
Before interleave = 15581.41406 MB
After interleave = 15581.91406 MB
After matmul = 15590.04102 MB
Before local copies matmul = 15590.04102 MB
After local copies = 15590.04395 MB
After first SDPA allocated = 15589.53125 MB
After first copy allocated = 15589.53125 MB
On chunked entry = 15589.53125 MB
On scale calculation = 15589.53906 MB
Before interleave = 15589.53906 MB
After interleave = 15589.55469 MB
After matmul = 15589.55518 MB
Before local copies matmul = 15589.55518 MB
After local copies = 15589.55664 MB
fter compute chunk allocated = 15589.53125 MB
Memory after cuda sdpa 15589.5390625 MB
1
Memory before offload  15589.517578125 MB
Memory after offload  15589.517578125 MB
Memory before cuda sdpa 15589.53125 MB
On entering CUDA sdpa main function  allocated = 15589.53125 MB
Before first SDPA allocated = 15589.53125 MB
On chunked entry = 15589.53125 MB
On scale calculation = 15589.53906 MB
Before interleave = 15589.53906 MB
After interleave = 15590.03906 MB
After matmul = 15598.16602 MB
Before local copies matmul = 15598.16602 MB
After local copies = 15598.16895 MB
After first SDPA allocated = 15597.65625 MB
After first copy allocated = 15597.65625 MB
On chunked entry = 15597.65625 MB
On scale calculation = 15597.66406 MB
Before interleave = 15597.66406 MB
After interleave = 15597.67969 MB
After matmul = 15597.68018 MB
Before local copies matmul = 15597.68018 MB
After local copies = 15597.68164 MB
fter compute chunk allocated = 15597.65625 MB
Memory after cuda sdpa 15597.6640625 MB
1
Memory before offload  15597.642578125 MB
Memory after offload  15597.642578125 MB
Memory before cuda sdpa 15597.65625 MB
On entering CUDA sdpa main function  allocated = 15597.65625 MB
Before first SDPA allocated = 15597.65625 MB
On chunked entry = 15597.65625 MB
On scale calculation = 15597.66406 MB
Before interleave = 15597.66406 MB
After interleave = 15598.16406 MB
After matmul = 15606.29102 MB
Before local copies matmul = 15606.29102 MB
After local copies = 15606.29395 MB
After first SDPA allocated = 15605.78125 MB
After first copy allocated = 15605.78125 MB
On chunked entry = 15605.78125 MB
On scale calculation = 15605.78906 MB
Before interleave = 15605.78906 MB
After interleave = 15605.80469 MB
After matmul = 15605.80518 MB
Before local copies matmul = 15605.80518 MB
After local copies = 15605.80664 MB
fter compute chunk allocated = 15605.78125 MB
Memory after cuda sdpa 15605.7890625 MB
Decode step 2
1
Memory before offload  15605.76806640625 MB
Memory after offload  15605.76806640625 MB
Memory before cuda sdpa 15605.78173828125 MB
On entering CUDA sdpa main function  allocated = 15605.78174 MB
Before first SDPA allocated = 15605.78174 MB
On chunked entry = 15605.78174 MB
On scale calculation = 15605.78955 MB
Before interleave = 15605.78955 MB
After interleave = 15606.28955 MB
After matmul = 15614.41650 MB
Before local copies matmul = 15614.41650 MB
After local copies = 15614.41943 MB
After first SDPA allocated = 15613.90674 MB
After first copy allocated = 15613.90674 MB
On chunked entry = 15613.90674 MB
On scale calculation = 15613.91455 MB
Before interleave = 15613.91455 MB
After interleave = 15613.94580 MB
After matmul = 15613.94629 MB
Before local copies matmul = 15613.94629 MB
After local copies = 15613.94775 MB
fter compute chunk allocated = 15613.90674 MB
Memory after cuda sdpa 15613.91455078125 MB
1
Memory before offload  15613.89306640625 MB
Memory after offload  15613.89306640625 MB
Memory before cuda sdpa 15613.90673828125 MB
On entering CUDA sdpa main function  allocated = 15613.90674 MB
Before first SDPA allocated = 15613.90674 MB
On chunked entry = 15613.90674 MB
On scale calculation = 15613.91455 MB
Before interleave = 15613.91455 MB
After interleave = 15614.41455 MB
After matmul = 15622.54150 MB
Before local copies matmul = 15622.54150 MB
After local copies = 15622.54443 MB
After first SDPA allocated = 15622.03174 MB
After first copy allocated = 15622.03174 MB
On chunked entry = 15622.03174 MB
On scale calculation = 15622.03955 MB
Before interleave = 15622.03955 MB
After interleave = 15622.07080 MB
After matmul = 15622.07129 MB
Before local copies matmul = 15622.07129 MB
After local copies = 15622.07275 MB
fter compute chunk allocated = 15622.03174 MB
Memory after cuda sdpa 15622.03955078125 MB
1
Memory before offload  15622.01806640625 MB
Memory after offload  15622.01806640625 MB
Memory before cuda sdpa 15622.03173828125 MB
On entering CUDA sdpa main function  allocated = 15622.03174 MB
Before first SDPA allocated = 15622.03174 MB
On chunked entry = 15622.03174 MB
On scale calculation = 15622.03955 MB
Before interleave = 15622.03955 MB
After interleave = 15622.53955 MB
After matmul = 15630.66650 MB
Before local copies matmul = 15630.66650 MB
After local copies = 15630.66943 MB
After first SDPA allocated = 15630.15674 MB
After first copy allocated = 15630.15674 MB
On chunked entry = 15630.15674 MB
On scale calculation = 15630.16455 MB
Before interleave = 15630.16455 MB
After interleave = 15630.19580 MB
After matmul = 15630.19629 MB
Before local copies matmul = 15630.19629 MB
After local copies = 15630.19775 MB
fter compute chunk allocated = 15630.15674 MB
Memory after cuda sdpa 15630.16455078125 MB
1
Memory before offload  15630.14306640625 MB
Memory after offload  15630.14306640625 MB
Memory before cuda sdpa 15630.15673828125 MB
On entering CUDA sdpa main function  allocated = 15630.15674 MB
Before first SDPA allocated = 15630.15674 MB
On chunked entry = 15630.15674 MB
On scale calculation = 15630.16455 MB
Before interleave = 15630.16455 MB
After interleave = 15630.66455 MB
After matmul = 15638.79150 MB
Before local copies matmul = 15638.79150 MB
After local copies = 15638.79443 MB
After first SDPA allocated = 15638.28174 MB
After first copy allocated = 15638.28174 MB
On chunked entry = 15638.28174 MB
On scale calculation = 15638.28955 MB
Before interleave = 15638.28955 MB
After interleave = 15638.32080 MB
After matmul = 15638.32129 MB
Before local copies matmul = 15638.32129 MB
After local copies = 15638.32275 MB
fter compute chunk allocated = 15638.28174 MB
Memory after cuda sdpa 15638.28955078125 MB
1
Memory before offload  15638.26806640625 MB
Memory after offload  15638.26806640625 MB
Memory before cuda sdpa 15638.28173828125 MB
On entering CUDA sdpa main function  allocated = 15638.28174 MB
Before first SDPA allocated = 15638.28174 MB
On chunked entry = 15638.28174 MB
On scale calculation = 15638.28955 MB
Before interleave = 15638.28955 MB
After interleave = 15638.78955 MB
After matmul = 15646.91650 MB
Before local copies matmul = 15646.91650 MB
After local copies = 15646.91943 MB
After first SDPA allocated = 15646.40674 MB
After first copy allocated = 15646.40674 MB
On chunked entry = 15646.40674 MB
On scale calculation = 15646.41455 MB
Before interleave = 15646.41455 MB
After interleave = 15646.44580 MB
After matmul = 15646.44629 MB
Before local copies matmul = 15646.44629 MB
After local copies = 15646.44775 MB
fter compute chunk allocated = 15646.40674 MB
Memory after cuda sdpa 15646.41455078125 MB
1
Memory before offload  15646.39306640625 MB
Memory after offload  15646.39306640625 MB
Memory before cuda sdpa 15646.40673828125 MB
On entering CUDA sdpa main function  allocated = 15646.40674 MB
Before first SDPA allocated = 15646.40674 MB
On chunked entry = 15646.40674 MB
On scale calculation = 15646.41455 MB
Before interleave = 15646.41455 MB
After interleave = 15646.91455 MB
After matmul = 15655.04150 MB
Before local copies matmul = 15655.04150 MB
After local copies = 15655.04443 MB
After first SDPA allocated = 15654.53174 MB
After first copy allocated = 15654.53174 MB
On chunked entry = 15654.53174 MB
On scale calculation = 15654.53955 MB
Before interleave = 15654.53955 MB
After interleave = 15654.57080 MB
After matmul = 15654.57129 MB
Before local copies matmul = 15654.57129 MB
After local copies = 15654.57275 MB
fter compute chunk allocated = 15654.53174 MB
Memory after cuda sdpa 15654.53955078125 MB
1
Memory before offload  15654.51806640625 MB
Memory after offload  15654.51806640625 MB
Memory before cuda sdpa 15654.53173828125 MB
On entering CUDA sdpa main function  allocated = 15654.53174 MB
Before first SDPA allocated = 15654.53174 MB
On chunked entry = 15654.53174 MB
On scale calculation = 15654.53955 MB
Before interleave = 15654.53955 MB
After interleave = 15655.03955 MB
After matmul = 15663.16650 MB
Before local copies matmul = 15663.16650 MB
After local copies = 15663.16943 MB
After first SDPA allocated = 15662.65674 MB
After first copy allocated = 15662.65674 MB
On chunked entry = 15662.65674 MB
On scale calculation = 15662.66455 MB
Before interleave = 15662.66455 MB
After interleave = 15662.69580 MB
After matmul = 15662.69629 MB
Before local copies matmul = 15662.69629 MB
After local copies = 15662.69775 MB
fter compute chunk allocated = 15662.65674 MB
Memory after cuda sdpa 15662.66455078125 MB
1
Memory before offload  15662.64306640625 MB
Memory after offload  15662.64306640625 MB
Memory before cuda sdpa 15662.65673828125 MB
On entering CUDA sdpa main function  allocated = 15662.65674 MB
Before first SDPA allocated = 15662.65674 MB
On chunked entry = 15662.65674 MB
On scale calculation = 15662.66455 MB
Before interleave = 15662.66455 MB
After interleave = 15663.16455 MB
After matmul = 15671.29150 MB
Before local copies matmul = 15671.29150 MB
After local copies = 15671.29443 MB
After first SDPA allocated = 15670.78174 MB
After first copy allocated = 15670.78174 MB
On chunked entry = 15670.78174 MB
On scale calculation = 15670.78955 MB
Before interleave = 15670.78955 MB
After interleave = 15670.82080 MB
After matmul = 15670.82129 MB
Before local copies matmul = 15670.82129 MB
After local copies = 15670.82275 MB
fter compute chunk allocated = 15670.78174 MB
Memory after cuda sdpa 15670.78955078125 MB
1
Memory before offload  15670.76806640625 MB
Memory after offload  15670.76806640625 MB
Memory before cuda sdpa 15670.78173828125 MB
On entering CUDA sdpa main function  allocated = 15670.78174 MB
Before first SDPA allocated = 15670.78174 MB
On chunked entry = 15670.78174 MB
On scale calculation = 15670.78955 MB
Before interleave = 15670.78955 MB
After interleave = 15671.28955 MB
After matmul = 15679.41650 MB
Before local copies matmul = 15679.41650 MB
After local copies = 15679.41943 MB
After first SDPA allocated = 15678.90674 MB
After first copy allocated = 15678.90674 MB
On chunked entry = 15678.90674 MB
On scale calculation = 15678.91455 MB
Before interleave = 15678.91455 MB
After interleave = 15678.94580 MB
After matmul = 15678.94629 MB
Before local copies matmul = 15678.94629 MB
After local copies = 15678.94775 MB
fter compute chunk allocated = 15678.90674 MB
Memory after cuda sdpa 15678.91455078125 MB
1
Memory before offload  15678.89306640625 MB
Memory after offload  15678.89306640625 MB
Memory before cuda sdpa 15678.90673828125 MB
On entering CUDA sdpa main function  allocated = 15678.90674 MB
Before first SDPA allocated = 15678.90674 MB
On chunked entry = 15678.90674 MB
On scale calculation = 15678.91455 MB
Before interleave = 15678.91455 MB
After interleave = 15679.41455 MB
After matmul = 15687.54150 MB
Before local copies matmul = 15687.54150 MB
After local copies = 15687.54443 MB
After first SDPA allocated = 15687.03174 MB
After first copy allocated = 15687.03174 MB
On chunked entry = 15687.03174 MB
On scale calculation = 15687.03955 MB
Before interleave = 15687.03955 MB
After interleave = 15687.07080 MB
After matmul = 15687.07129 MB
Before local copies matmul = 15687.07129 MB
After local copies = 15687.07275 MB
fter compute chunk allocated = 15687.03174 MB
Memory after cuda sdpa 15687.03955078125 MB
1
Memory before offload  15687.01806640625 MB
Memory after offload  15687.01806640625 MB
Memory before cuda sdpa 15687.03173828125 MB
On entering CUDA sdpa main function  allocated = 15687.03174 MB
Before first SDPA allocated = 15687.03174 MB
On chunked entry = 15687.03174 MB
On scale calculation = 15687.03955 MB
Before interleave = 15687.03955 MB
After interleave = 15687.53955 MB
After matmul = 15695.66650 MB
Before local copies matmul = 15695.66650 MB
After local copies = 15695.66943 MB
After first SDPA allocated = 15695.15674 MB
After first copy allocated = 15695.15674 MB
On chunked entry = 15695.15674 MB
On scale calculation = 15695.16455 MB
Before interleave = 15695.16455 MB
After interleave = 15695.19580 MB
After matmul = 15695.19629 MB
Before local copies matmul = 15695.19629 MB
After local copies = 15695.19775 MB
fter compute chunk allocated = 15695.15674 MB
Memory after cuda sdpa 15695.16455078125 MB
1
Memory before offload  15695.14306640625 MB
Memory after offload  15695.14306640625 MB
Memory before cuda sdpa 15695.15673828125 MB
On entering CUDA sdpa main function  allocated = 15695.15674 MB
Before first SDPA allocated = 15695.15674 MB
On chunked entry = 15695.15674 MB
On scale calculation = 15695.16455 MB
Before interleave = 15695.16455 MB
After interleave = 15695.66455 MB
After matmul = 15703.79150 MB
Before local copies matmul = 15703.79150 MB
After local copies = 15703.79443 MB
After first SDPA allocated = 15703.28174 MB
After first copy allocated = 15703.28174 MB
On chunked entry = 15703.28174 MB
On scale calculation = 15703.28955 MB
Before interleave = 15703.28955 MB
After interleave = 15703.32080 MB
After matmul = 15703.32129 MB
Before local copies matmul = 15703.32129 MB
After local copies = 15703.32275 MB
fter compute chunk allocated = 15703.28174 MB
Memory after cuda sdpa 15703.28955078125 MB
1
Memory before offload  15703.26806640625 MB
Memory after offload  15703.26806640625 MB
Memory before cuda sdpa 15703.28173828125 MB
On entering CUDA sdpa main function  allocated = 15703.28174 MB
Before first SDPA allocated = 15703.28174 MB
On chunked entry = 15703.28174 MB
On scale calculation = 15703.28955 MB
Before interleave = 15703.28955 MB
After interleave = 15703.78955 MB
After matmul = 15711.91650 MB
Before local copies matmul = 15711.91650 MB
After local copies = 15711.91943 MB
After first SDPA allocated = 15711.40674 MB
After first copy allocated = 15711.40674 MB
On chunked entry = 15711.40674 MB
On scale calculation = 15711.41455 MB
Before interleave = 15711.41455 MB
After interleave = 15711.44580 MB
After matmul = 15711.44629 MB
Before local copies matmul = 15711.44629 MB
After local copies = 15711.44775 MB
fter compute chunk allocated = 15711.40674 MB
Memory after cuda sdpa 15711.41455078125 MB
1
Memory before offload  15711.39306640625 MB
Memory after offload  15711.39306640625 MB
Memory before cuda sdpa 15711.40673828125 MB
On entering CUDA sdpa main function  allocated = 15711.40674 MB
Before first SDPA allocated = 15711.40674 MB
On chunked entry = 15711.40674 MB
On scale calculation = 15711.41455 MB
Before interleave = 15711.41455 MB
After interleave = 15711.91455 MB
After matmul = 15720.04150 MB
Before local copies matmul = 15720.04150 MB
After local copies = 15720.04443 MB
After first SDPA allocated = 15719.53174 MB
After first copy allocated = 15719.53174 MB
On chunked entry = 15719.53174 MB
On scale calculation = 15719.53955 MB
Before interleave = 15719.53955 MB
After interleave = 15719.57080 MB
After matmul = 15719.57129 MB
Before local copies matmul = 15719.57129 MB
After local copies = 15719.57275 MB
fter compute chunk allocated = 15719.53174 MB
Memory after cuda sdpa 15719.53955078125 MB
1
Memory before offload  15719.51806640625 MB
Memory after offload  15719.51806640625 MB
Memory before cuda sdpa 15719.53173828125 MB
On entering CUDA sdpa main function  allocated = 15719.53174 MB
Before first SDPA allocated = 15719.53174 MB
On chunked entry = 15719.53174 MB
On scale calculation = 15719.53955 MB
Before interleave = 15719.53955 MB
After interleave = 15720.03955 MB
After matmul = 15728.16650 MB
Before local copies matmul = 15728.16650 MB
After local copies = 15728.16943 MB
After first SDPA allocated = 15727.65674 MB
After first copy allocated = 15727.65674 MB
On chunked entry = 15727.65674 MB
On scale calculation = 15727.66455 MB
Before interleave = 15727.66455 MB
After interleave = 15727.69580 MB
After matmul = 15727.69629 MB
Before local copies matmul = 15727.69629 MB
After local copies = 15727.69775 MB
fter compute chunk allocated = 15727.65674 MB
Memory after cuda sdpa 15727.66455078125 MB
1
Memory before offload  15727.64306640625 MB
Memory after offload  15727.64306640625 MB
Memory before cuda sdpa 15727.65673828125 MB
On entering CUDA sdpa main function  allocated = 15727.65674 MB
Before first SDPA allocated = 15727.65674 MB
On chunked entry = 15727.65674 MB
On scale calculation = 15727.66455 MB
Before interleave = 15727.66455 MB
After interleave = 15728.16455 MB
After matmul = 15736.29150 MB
Before local copies matmul = 15736.29150 MB
After local copies = 15736.29443 MB
After first SDPA allocated = 15735.78174 MB
After first copy allocated = 15735.78174 MB
On chunked entry = 15735.78174 MB
On scale calculation = 15735.78955 MB
Before interleave = 15735.78955 MB
After interleave = 15735.82080 MB
After matmul = 15735.82129 MB
Before local copies matmul = 15735.82129 MB
After local copies = 15735.82275 MB
fter compute chunk allocated = 15735.78174 MB
Memory after cuda sdpa 15735.78955078125 MB
1
Memory before offload  15735.76806640625 MB
Memory after offload  15735.76806640625 MB
Memory before cuda sdpa 15735.78173828125 MB
On entering CUDA sdpa main function  allocated = 15735.78174 MB
Before first SDPA allocated = 15735.78174 MB
On chunked entry = 15735.78174 MB
On scale calculation = 15735.78955 MB
Before interleave = 15735.78955 MB
After interleave = 15736.28955 MB
After matmul = 15744.41650 MB
Before local copies matmul = 15744.41650 MB
After local copies = 15744.41943 MB
After first SDPA allocated = 15743.90674 MB
After first copy allocated = 15743.90674 MB
On chunked entry = 15743.90674 MB
On scale calculation = 15743.91455 MB
Before interleave = 15743.91455 MB
After interleave = 15743.94580 MB
After matmul = 15743.94629 MB
Before local copies matmul = 15743.94629 MB
After local copies = 15743.94775 MB
fter compute chunk allocated = 15743.90674 MB
Memory after cuda sdpa 15743.91455078125 MB
1
Memory before offload  15743.89306640625 MB
Memory after offload  15743.89306640625 MB
Memory before cuda sdpa 15743.90673828125 MB
On entering CUDA sdpa main function  allocated = 15743.90674 MB
Before first SDPA allocated = 15743.90674 MB
On chunked entry = 15743.90674 MB
On scale calculation = 15743.91455 MB
Before interleave = 15743.91455 MB
After interleave = 15744.41455 MB
After matmul = 15752.54150 MB
Before local copies matmul = 15752.54150 MB
After local copies = 15752.54443 MB
After first SDPA allocated = 15752.03174 MB
After first copy allocated = 15752.03174 MB
On chunked entry = 15752.03174 MB
On scale calculation = 15752.03955 MB
Before interleave = 15752.03955 MB
After interleave = 15752.07080 MB
After matmul = 15752.07129 MB
Before local copies matmul = 15752.07129 MB
After local copies = 15752.07275 MB
fter compute chunk allocated = 15752.03174 MB
Memory after cuda sdpa 15752.03955078125 MB
1
Memory before offload  15752.01806640625 MB
Memory after offload  15752.01806640625 MB
Memory before cuda sdpa 15752.03173828125 MB
On entering CUDA sdpa main function  allocated = 15752.03174 MB
Before first SDPA allocated = 15752.03174 MB
On chunked entry = 15752.03174 MB
On scale calculation = 15752.03955 MB
Before interleave = 15752.03955 MB
After interleave = 15752.53955 MB
After matmul = 15760.66650 MB
Before local copies matmul = 15760.66650 MB
After local copies = 15760.66943 MB
After first SDPA allocated = 15760.15674 MB
After first copy allocated = 15760.15674 MB
On chunked entry = 15760.15674 MB
On scale calculation = 15760.16455 MB
Before interleave = 15760.16455 MB
After interleave = 15760.19580 MB
After matmul = 15760.19629 MB
Before local copies matmul = 15760.19629 MB
After local copies = 15760.19775 MB
fter compute chunk allocated = 15760.15674 MB
Memory after cuda sdpa 15760.16455078125 MB
1
Memory before offload  15760.14306640625 MB
Memory after offload  15760.14306640625 MB
Memory before cuda sdpa 15760.15673828125 MB
On entering CUDA sdpa main function  allocated = 15760.15674 MB
Before first SDPA allocated = 15760.15674 MB
On chunked entry = 15760.15674 MB
On scale calculation = 15760.16455 MB
Before interleave = 15760.16455 MB
After interleave = 15760.66455 MB
After matmul = 15768.79150 MB
Before local copies matmul = 15768.79150 MB
After local copies = 15768.79443 MB
After first SDPA allocated = 15768.28174 MB
After first copy allocated = 15768.28174 MB
On chunked entry = 15768.28174 MB
On scale calculation = 15768.28955 MB
Before interleave = 15768.28955 MB
After interleave = 15768.32080 MB
After matmul = 15768.32129 MB
Before local copies matmul = 15768.32129 MB
After local copies = 15768.32275 MB
fter compute chunk allocated = 15768.28174 MB
Memory after cuda sdpa 15768.28955078125 MB
1
Memory before offload  15768.26806640625 MB
Memory after offload  15768.26806640625 MB
Memory before cuda sdpa 15768.28173828125 MB
On entering CUDA sdpa main function  allocated = 15768.28174 MB
Before first SDPA allocated = 15768.28174 MB
On chunked entry = 15768.28174 MB
On scale calculation = 15768.28955 MB
Before interleave = 15768.28955 MB
After interleave = 15768.78955 MB
After matmul = 15776.91650 MB
Before local copies matmul = 15776.91650 MB
After local copies = 15776.91943 MB
After first SDPA allocated = 15776.40674 MB
After first copy allocated = 15776.40674 MB
On chunked entry = 15776.40674 MB
On scale calculation = 15776.41455 MB
Before interleave = 15776.41455 MB
After interleave = 15776.44580 MB
After matmul = 15776.44629 MB
Before local copies matmul = 15776.44629 MB
After local copies = 15776.44775 MB
fter compute chunk allocated = 15776.40674 MB
Memory after cuda sdpa 15776.41455078125 MB
1
Memory before offload  15776.39306640625 MB
Memory after offload  15776.39306640625 MB
Memory before cuda sdpa 15776.40673828125 MB
On entering CUDA sdpa main function  allocated = 15776.40674 MB
Before first SDPA allocated = 15776.40674 MB
On chunked entry = 15776.40674 MB
On scale calculation = 15776.41455 MB
Before interleave = 15776.41455 MB
After interleave = 15776.91455 MB
After matmul = 15785.04150 MB
Before local copies matmul = 15785.04150 MB
After local copies = 15785.04443 MB
After first SDPA allocated = 15784.53174 MB
After first copy allocated = 15784.53174 MB
On chunked entry = 15784.53174 MB
On scale calculation = 15784.53955 MB
Before interleave = 15784.53955 MB
After interleave = 15784.57080 MB
After matmul = 15784.57129 MB
Before local copies matmul = 15784.57129 MB
After local copies = 15784.57275 MB
fter compute chunk allocated = 15784.53174 MB
Memory after cuda sdpa 15784.53955078125 MB
1
Memory before offload  15784.51806640625 MB
Memory after offload  15784.51806640625 MB
Memory before cuda sdpa 15784.53173828125 MB
On entering CUDA sdpa main function  allocated = 15784.53174 MB
Before first SDPA allocated = 15784.53174 MB
On chunked entry = 15784.53174 MB
On scale calculation = 15784.53955 MB
Before interleave = 15784.53955 MB
After interleave = 15785.03955 MB
After matmul = 15793.16650 MB
Before local copies matmul = 15793.16650 MB
After local copies = 15793.16943 MB
After first SDPA allocated = 15792.65674 MB
After first copy allocated = 15792.65674 MB
On chunked entry = 15792.65674 MB
On scale calculation = 15792.66455 MB
Before interleave = 15792.66455 MB
After interleave = 15792.69580 MB
After matmul = 15792.69629 MB
Before local copies matmul = 15792.69629 MB
After local copies = 15792.69775 MB
fter compute chunk allocated = 15792.65674 MB
Memory after cuda sdpa 15792.66455078125 MB
1
Memory before offload  15792.64306640625 MB
Memory after offload  15792.64306640625 MB
Memory before cuda sdpa 15792.65673828125 MB
On entering CUDA sdpa main function  allocated = 15792.65674 MB
Before first SDPA allocated = 15792.65674 MB
On chunked entry = 15792.65674 MB
On scale calculation = 15792.66455 MB
Before interleave = 15792.66455 MB
After interleave = 15793.16455 MB
After matmul = 15801.29150 MB
Before local copies matmul = 15801.29150 MB
After local copies = 15801.29443 MB
After first SDPA allocated = 15800.78174 MB
After first copy allocated = 15800.78174 MB
On chunked entry = 15800.78174 MB
On scale calculation = 15800.78955 MB
Before interleave = 15800.78955 MB
After interleave = 15800.82080 MB
After matmul = 15800.82129 MB
Before local copies matmul = 15800.82129 MB
After local copies = 15800.82275 MB
fter compute chunk allocated = 15800.78174 MB
Memory after cuda sdpa 15800.78955078125 MB
1
Memory before offload  15800.76806640625 MB
Memory after offload  15800.76806640625 MB
Memory before cuda sdpa 15800.78173828125 MB
On entering CUDA sdpa main function  allocated = 15800.78174 MB
Before first SDPA allocated = 15800.78174 MB
On chunked entry = 15800.78174 MB
On scale calculation = 15800.78955 MB
Before interleave = 15800.78955 MB
After interleave = 15801.28955 MB
After matmul = 15809.41650 MB
Before local copies matmul = 15809.41650 MB
After local copies = 15809.41943 MB
After first SDPA allocated = 15808.90674 MB
After first copy allocated = 15808.90674 MB
On chunked entry = 15808.90674 MB
On scale calculation = 15808.91455 MB
Before interleave = 15808.91455 MB
After interleave = 15808.94580 MB
After matmul = 15808.94629 MB
Before local copies matmul = 15808.94629 MB
After local copies = 15808.94775 MB
fter compute chunk allocated = 15808.90674 MB
Memory after cuda sdpa 15808.91455078125 MB
1
Memory before offload  15808.89306640625 MB
Memory after offload  15808.89306640625 MB
Memory before cuda sdpa 15808.90673828125 MB
On entering CUDA sdpa main function  allocated = 15808.90674 MB
Before first SDPA allocated = 15808.90674 MB
On chunked entry = 15808.90674 MB
On scale calculation = 15808.91455 MB
Before interleave = 15808.91455 MB
After interleave = 15809.41455 MB
After matmul = 15817.54150 MB
Before local copies matmul = 15817.54150 MB
After local copies = 15817.54443 MB
After first SDPA allocated = 15817.03174 MB
After first copy allocated = 15817.03174 MB
On chunked entry = 15817.03174 MB
On scale calculation = 15817.03955 MB
Before interleave = 15817.03955 MB
After interleave = 15817.07080 MB
After matmul = 15817.07129 MB
Before local copies matmul = 15817.07129 MB
After local copies = 15817.07275 MB
fter compute chunk allocated = 15817.03174 MB
Memory after cuda sdpa 15817.03955078125 MB
1
Memory before offload  15817.01806640625 MB
Memory after offload  15817.01806640625 MB
Memory before cuda sdpa 15817.03173828125 MB
On entering CUDA sdpa main function  allocated = 15817.03174 MB
Before first SDPA allocated = 15817.03174 MB
On chunked entry = 15817.03174 MB
On scale calculation = 15817.03955 MB
Before interleave = 15817.03955 MB
After interleave = 15817.53955 MB
After matmul = 15825.66650 MB
Before local copies matmul = 15825.66650 MB
After local copies = 15825.66943 MB
After first SDPA allocated = 15825.15674 MB
After first copy allocated = 15825.15674 MB
On chunked entry = 15825.15674 MB
On scale calculation = 15825.16455 MB
Before interleave = 15825.16455 MB
After interleave = 15825.19580 MB
After matmul = 15825.19629 MB
Before local copies matmul = 15825.19629 MB
After local copies = 15825.19775 MB
fter compute chunk allocated = 15825.15674 MB
Memory after cuda sdpa 15825.16455078125 MB
1
Memory before offload  15825.14306640625 MB
Memory after offload  15825.14306640625 MB
Memory before cuda sdpa 15825.15673828125 MB
On entering CUDA sdpa main function  allocated = 15825.15674 MB
Before first SDPA allocated = 15825.15674 MB
On chunked entry = 15825.15674 MB
On scale calculation = 15825.16455 MB
Before interleave = 15825.16455 MB
After interleave = 15825.66455 MB
After matmul = 15833.79150 MB
Before local copies matmul = 15833.79150 MB
After local copies = 15833.79443 MB
After first SDPA allocated = 15833.28174 MB
After first copy allocated = 15833.28174 MB
On chunked entry = 15833.28174 MB
On scale calculation = 15833.28955 MB
Before interleave = 15833.28955 MB
After interleave = 15833.32080 MB
After matmul = 15833.32129 MB
Before local copies matmul = 15833.32129 MB
After local copies = 15833.32275 MB
fter compute chunk allocated = 15833.28174 MB
Memory after cuda sdpa 15833.28955078125 MB
1
Memory before offload  15833.26806640625 MB
Memory after offload  15833.26806640625 MB
Memory before cuda sdpa 15833.28173828125 MB
On entering CUDA sdpa main function  allocated = 15833.28174 MB
Before first SDPA allocated = 15833.28174 MB
On chunked entry = 15833.28174 MB
On scale calculation = 15833.28955 MB
Before interleave = 15833.28955 MB
After interleave = 15833.78955 MB
After matmul = 15841.91650 MB
Before local copies matmul = 15841.91650 MB
After local copies = 15841.91943 MB
After first SDPA allocated = 15841.40674 MB
After first copy allocated = 15841.40674 MB
On chunked entry = 15841.40674 MB
On scale calculation = 15841.41455 MB
Before interleave = 15841.41455 MB
After interleave = 15841.44580 MB
After matmul = 15841.44629 MB
Before local copies matmul = 15841.44629 MB
After local copies = 15841.44775 MB
fter compute chunk allocated = 15841.40674 MB
Memory after cuda sdpa 15841.41455078125 MB
1
Memory before offload  15841.39306640625 MB
Memory after offload  15841.39306640625 MB
Memory before cuda sdpa 15841.40673828125 MB
On entering CUDA sdpa main function  allocated = 15841.40674 MB
Before first SDPA allocated = 15841.40674 MB
On chunked entry = 15841.40674 MB
On scale calculation = 15841.41455 MB
Before interleave = 15841.41455 MB
After interleave = 15841.91455 MB
After matmul = 15850.04150 MB
Before local copies matmul = 15850.04150 MB
After local copies = 15850.04443 MB
After first SDPA allocated = 15849.53174 MB
After first copy allocated = 15849.53174 MB
On chunked entry = 15849.53174 MB
On scale calculation = 15849.53955 MB
Before interleave = 15849.53955 MB
After interleave = 15849.57080 MB
After matmul = 15849.57129 MB
Before local copies matmul = 15849.57129 MB
After local copies = 15849.57275 MB
fter compute chunk allocated = 15849.53174 MB
Memory after cuda sdpa 15849.53955078125 MB
1
Memory before offload  15849.51806640625 MB
Memory after offload  15849.51806640625 MB
Memory before cuda sdpa 15849.53173828125 MB
On entering CUDA sdpa main function  allocated = 15849.53174 MB
Before first SDPA allocated = 15849.53174 MB
On chunked entry = 15849.53174 MB
On scale calculation = 15849.53955 MB
Before interleave = 15849.53955 MB
After interleave = 15850.03955 MB
After matmul = 15858.16650 MB
Before local copies matmul = 15858.16650 MB
After local copies = 15858.16943 MB
After first SDPA allocated = 15857.65674 MB
After first copy allocated = 15857.65674 MB
On chunked entry = 15857.65674 MB
On scale calculation = 15857.66455 MB
Before interleave = 15857.66455 MB
After interleave = 15857.69580 MB
After matmul = 15857.69629 MB
Before local copies matmul = 15857.69629 MB
After local copies = 15857.69775 MB
fter compute chunk allocated = 15857.65674 MB
Memory after cuda sdpa 15857.66455078125 MB
1
Memory before offload  15857.64306640625 MB
Memory after offload  15857.64306640625 MB
Memory before cuda sdpa 15857.65673828125 MB
On entering CUDA sdpa main function  allocated = 15857.65674 MB
Before first SDPA allocated = 15857.65674 MB
On chunked entry = 15857.65674 MB
On scale calculation = 15857.66455 MB
Before interleave = 15857.66455 MB
After interleave = 15858.16455 MB
After matmul = 15866.29150 MB
Before local copies matmul = 15866.29150 MB
After local copies = 15866.29443 MB
After first SDPA allocated = 15865.78174 MB
After first copy allocated = 15865.78174 MB
On chunked entry = 15865.78174 MB
On scale calculation = 15865.78955 MB
Before interleave = 15865.78955 MB
After interleave = 15865.82080 MB
After matmul = 15865.82129 MB
Before local copies matmul = 15865.82129 MB
After local copies = 15865.82275 MB
fter compute chunk allocated = 15865.78174 MB
Memory after cuda sdpa 15865.78955078125 MB
Decode step 3
1
Memory before offload  15865.7685546875 MB
Memory after offload  15865.7685546875 MB
Memory before cuda sdpa 15865.7822265625 MB
On entering CUDA sdpa main function  allocated = 15865.78223 MB
Before first SDPA allocated = 15865.78223 MB
On chunked entry = 15865.78223 MB
On scale calculation = 15865.79004 MB
Before interleave = 15865.79004 MB
After interleave = 15866.29004 MB
After matmul = 15874.41699 MB
Before local copies matmul = 15874.41699 MB
After local copies = 15874.41992 MB
After first SDPA allocated = 15873.90723 MB
After first copy allocated = 15873.90723 MB
On chunked entry = 15873.90723 MB
On scale calculation = 15873.91504 MB
Before interleave = 15873.91504 MB
After interleave = 15873.96191 MB
After matmul = 15873.96240 MB
Before local copies matmul = 15873.96240 MB
After local copies = 15873.96387 MB
fter compute chunk allocated = 15873.90723 MB
Memory after cuda sdpa 15873.9150390625 MB
1
Memory before offload  15873.8935546875 MB
Memory after offload  15873.8935546875 MB
Memory before cuda sdpa 15873.9072265625 MB
On entering CUDA sdpa main function  allocated = 15873.90723 MB
Before first SDPA allocated = 15873.90723 MB
On chunked entry = 15873.90723 MB
On scale calculation = 15873.91504 MB
Before interleave = 15873.91504 MB
After interleave = 15874.41504 MB
After matmul = 15882.54199 MB
Before local copies matmul = 15882.54199 MB
After local copies = 15882.54492 MB
After first SDPA allocated = 15882.03223 MB
After first copy allocated = 15882.03223 MB
On chunked entry = 15882.03223 MB
On scale calculation = 15882.04004 MB
Before interleave = 15882.04004 MB
After interleave = 15882.08691 MB
After matmul = 15882.08740 MB
Before local copies matmul = 15882.08740 MB
After local copies = 15882.08887 MB
fter compute chunk allocated = 15882.03223 MB
Memory after cuda sdpa 15882.0400390625 MB
1
Memory before offload  15882.0185546875 MB
Memory after offload  15882.0185546875 MB
Memory before cuda sdpa 15882.0322265625 MB
On entering CUDA sdpa main function  allocated = 15882.03223 MB
Before first SDPA allocated = 15882.03223 MB
On chunked entry = 15882.03223 MB
On scale calculation = 15882.04004 MB
Before interleave = 15882.04004 MB
After interleave = 15882.54004 MB
After matmul = 15890.66699 MB
Before local copies matmul = 15890.66699 MB
After local copies = 15890.66992 MB
After first SDPA allocated = 15890.15723 MB
After first copy allocated = 15890.15723 MB
On chunked entry = 15890.15723 MB
On scale calculation = 15890.16504 MB
Before interleave = 15890.16504 MB
After interleave = 15890.21191 MB
After matmul = 15890.21240 MB
Before local copies matmul = 15890.21240 MB
After local copies = 15890.21387 MB
fter compute chunk allocated = 15890.15723 MB
Memory after cuda sdpa 15890.1650390625 MB
1
Memory before offload  15890.1435546875 MB
Memory after offload  15890.1435546875 MB
Memory before cuda sdpa 15890.1572265625 MB
On entering CUDA sdpa main function  allocated = 15890.15723 MB
Before first SDPA allocated = 15890.15723 MB
On chunked entry = 15890.15723 MB
On scale calculation = 15890.16504 MB
Before interleave = 15890.16504 MB
After interleave = 15890.66504 MB
After matmul = 15898.79199 MB
Before local copies matmul = 15898.79199 MB
After local copies = 15898.79492 MB
After first SDPA allocated = 15898.28223 MB
After first copy allocated = 15898.28223 MB
On chunked entry = 15898.28223 MB
On scale calculation = 15898.29004 MB
Before interleave = 15898.29004 MB
After interleave = 15898.33691 MB
After matmul = 15898.33740 MB
Before local copies matmul = 15898.33740 MB
After local copies = 15898.33887 MB
fter compute chunk allocated = 15898.28223 MB
Memory after cuda sdpa 15898.2900390625 MB
1
Memory before offload  15898.2685546875 MB
Memory after offload  15898.2685546875 MB
Memory before cuda sdpa 15898.2822265625 MB
On entering CUDA sdpa main function  allocated = 15898.28223 MB
Before first SDPA allocated = 15898.28223 MB
On chunked entry = 15898.28223 MB
On scale calculation = 15898.29004 MB
Before interleave = 15898.29004 MB
After interleave = 15898.79004 MB
After matmul = 15906.91699 MB
Before local copies matmul = 15906.91699 MB
After local copies = 15906.91992 MB
After first SDPA allocated = 15906.40723 MB
After first copy allocated = 15906.40723 MB
On chunked entry = 15906.40723 MB
On scale calculation = 15906.41504 MB
Before interleave = 15906.41504 MB
After interleave = 15906.46191 MB
After matmul = 15906.46240 MB
Before local copies matmul = 15906.46240 MB
After local copies = 15906.46387 MB
fter compute chunk allocated = 15906.40723 MB
Memory after cuda sdpa 15906.4150390625 MB
1
Memory before offload  15906.3935546875 MB
Memory after offload  15906.3935546875 MB
Memory before cuda sdpa 15906.4072265625 MB
On entering CUDA sdpa main function  allocated = 15906.40723 MB
Before first SDPA allocated = 15906.40723 MB
On chunked entry = 15906.40723 MB
On scale calculation = 15906.41504 MB
Before interleave = 15906.41504 MB
After interleave = 15906.91504 MB
After matmul = 15915.04199 MB
Before local copies matmul = 15915.04199 MB
After local copies = 15915.04492 MB
After first SDPA allocated = 15914.53223 MB
After first copy allocated = 15914.53223 MB
On chunked entry = 15914.53223 MB
On scale calculation = 15914.54004 MB
Before interleave = 15914.54004 MB
After interleave = 15914.58691 MB
After matmul = 15914.58740 MB
Before local copies matmul = 15914.58740 MB
After local copies = 15914.58887 MB
fter compute chunk allocated = 15914.53223 MB
Memory after cuda sdpa 15914.5400390625 MB
1
Memory before offload  15914.5185546875 MB
Memory after offload  15914.5185546875 MB
Memory before cuda sdpa 15914.5322265625 MB
On entering CUDA sdpa main function  allocated = 15914.53223 MB
Before first SDPA allocated = 15914.53223 MB
On chunked entry = 15914.53223 MB
On scale calculation = 15914.54004 MB
Before interleave = 15914.54004 MB
After interleave = 15915.04004 MB
After matmul = 15923.16699 MB
Before local copies matmul = 15923.16699 MB
After local copies = 15923.16992 MB
After first SDPA allocated = 15922.65723 MB
After first copy allocated = 15922.65723 MB
On chunked entry = 15922.65723 MB
On scale calculation = 15922.66504 MB
Before interleave = 15922.66504 MB
After interleave = 15922.71191 MB
After matmul = 15922.71240 MB
Before local copies matmul = 15922.71240 MB
After local copies = 15922.71387 MB
fter compute chunk allocated = 15922.65723 MB
Memory after cuda sdpa 15922.6650390625 MB
1
Memory before offload  15922.6435546875 MB
Memory after offload  15922.6435546875 MB
Memory before cuda sdpa 15922.6572265625 MB
On entering CUDA sdpa main function  allocated = 15922.65723 MB
Before first SDPA allocated = 15922.65723 MB
On chunked entry = 15922.65723 MB
On scale calculation = 15922.66504 MB
Before interleave = 15922.66504 MB
After interleave = 15923.16504 MB
After matmul = 15931.29199 MB
Before local copies matmul = 15931.29199 MB
After local copies = 15931.29492 MB
After first SDPA allocated = 15930.78223 MB
After first copy allocated = 15930.78223 MB
On chunked entry = 15930.78223 MB
On scale calculation = 15930.79004 MB
Before interleave = 15930.79004 MB
After interleave = 15930.83691 MB
After matmul = 15930.83740 MB
Before local copies matmul = 15930.83740 MB
After local copies = 15930.83887 MB
fter compute chunk allocated = 15930.78223 MB
Memory after cuda sdpa 15930.7900390625 MB
1
Memory before offload  15930.7685546875 MB
Memory after offload  15930.7685546875 MB
Memory before cuda sdpa 15930.7822265625 MB
On entering CUDA sdpa main function  allocated = 15930.78223 MB
Before first SDPA allocated = 15930.78223 MB
On chunked entry = 15930.78223 MB
On scale calculation = 15930.79004 MB
Before interleave = 15930.79004 MB
After interleave = 15931.29004 MB
After matmul = 15939.41699 MB
Before local copies matmul = 15939.41699 MB
After local copies = 15939.41992 MB
After first SDPA allocated = 15938.90723 MB
After first copy allocated = 15938.90723 MB
On chunked entry = 15938.90723 MB
On scale calculation = 15938.91504 MB
Before interleave = 15938.91504 MB
After interleave = 15938.96191 MB
After matmul = 15938.96240 MB
Before local copies matmul = 15938.96240 MB
After local copies = 15938.96387 MB
fter compute chunk allocated = 15938.90723 MB
Memory after cuda sdpa 15938.9150390625 MB
1
Memory before offload  15938.8935546875 MB
Memory after offload  15938.8935546875 MB
Memory before cuda sdpa 15938.9072265625 MB
On entering CUDA sdpa main function  allocated = 15938.90723 MB
Before first SDPA allocated = 15938.90723 MB
On chunked entry = 15938.90723 MB
On scale calculation = 15938.91504 MB
Before interleave = 15938.91504 MB
After interleave = 15939.41504 MB
After matmul = 15947.54199 MB
Before local copies matmul = 15947.54199 MB
After local copies = 15947.54492 MB
After first SDPA allocated = 15947.03223 MB
After first copy allocated = 15947.03223 MB
On chunked entry = 15947.03223 MB
On scale calculation = 15947.04004 MB
Before interleave = 15947.04004 MB
After interleave = 15947.08691 MB
After matmul = 15947.08740 MB
Before local copies matmul = 15947.08740 MB
After local copies = 15947.08887 MB
fter compute chunk allocated = 15947.03223 MB
Memory after cuda sdpa 15947.0400390625 MB
1
Memory before offload  15947.0185546875 MB
Memory after offload  15947.0185546875 MB
Memory before cuda sdpa 15947.0322265625 MB
On entering CUDA sdpa main function  allocated = 15947.03223 MB
Before first SDPA allocated = 15947.03223 MB
On chunked entry = 15947.03223 MB
On scale calculation = 15947.04004 MB
Before interleave = 15947.04004 MB
After interleave = 15947.54004 MB
After matmul = 15955.66699 MB
Before local copies matmul = 15955.66699 MB
After local copies = 15955.66992 MB
After first SDPA allocated = 15955.15723 MB
After first copy allocated = 15955.15723 MB
On chunked entry = 15955.15723 MB
On scale calculation = 15955.16504 MB
Before interleave = 15955.16504 MB
After interleave = 15955.21191 MB
After matmul = 15955.21240 MB
Before local copies matmul = 15955.21240 MB
After local copies = 15955.21387 MB
fter compute chunk allocated = 15955.15723 MB
Memory after cuda sdpa 15955.1650390625 MB
1
Memory before offload  15955.1435546875 MB
Memory after offload  15955.1435546875 MB
Memory before cuda sdpa 15955.1572265625 MB
On entering CUDA sdpa main function  allocated = 15955.15723 MB
Before first SDPA allocated = 15955.15723 MB
On chunked entry = 15955.15723 MB
On scale calculation = 15955.16504 MB
Before interleave = 15955.16504 MB
After interleave = 15955.66504 MB
After matmul = 15963.79199 MB
Before local copies matmul = 15963.79199 MB
After local copies = 15963.79492 MB
After first SDPA allocated = 15963.28223 MB
After first copy allocated = 15963.28223 MB
On chunked entry = 15963.28223 MB
On scale calculation = 15963.29004 MB
Before interleave = 15963.29004 MB
After interleave = 15963.33691 MB
After matmul = 15963.33740 MB
Before local copies matmul = 15963.33740 MB
After local copies = 15963.33887 MB
fter compute chunk allocated = 15963.28223 MB
Memory after cuda sdpa 15963.2900390625 MB
1
Memory before offload  15963.2685546875 MB
Memory after offload  15963.2685546875 MB
Memory before cuda sdpa 15963.2822265625 MB
On entering CUDA sdpa main function  allocated = 15963.28223 MB
Before first SDPA allocated = 15963.28223 MB
On chunked entry = 15963.28223 MB
On scale calculation = 15963.29004 MB
Before interleave = 15963.29004 MB
After interleave = 15963.79004 MB
After matmul = 15971.91699 MB
Before local copies matmul = 15971.91699 MB
After local copies = 15971.91992 MB
After first SDPA allocated = 15971.40723 MB
After first copy allocated = 15971.40723 MB
On chunked entry = 15971.40723 MB
On scale calculation = 15971.41504 MB
Before interleave = 15971.41504 MB
After interleave = 15971.46191 MB
After matmul = 15971.46240 MB
Before local copies matmul = 15971.46240 MB
After local copies = 15971.46387 MB
fter compute chunk allocated = 15971.40723 MB
Memory after cuda sdpa 15971.4150390625 MB
1
Memory before offload  15971.3935546875 MB
Memory after offload  15971.3935546875 MB
Memory before cuda sdpa 15971.4072265625 MB
On entering CUDA sdpa main function  allocated = 15971.40723 MB
Before first SDPA allocated = 15971.40723 MB
On chunked entry = 15971.40723 MB
On scale calculation = 15971.41504 MB
Before interleave = 15971.41504 MB
After interleave = 15971.91504 MB
After matmul = 15980.04199 MB
Before local copies matmul = 15980.04199 MB
After local copies = 15980.04492 MB
After first SDPA allocated = 15979.53223 MB
After first copy allocated = 15979.53223 MB
On chunked entry = 15979.53223 MB
On scale calculation = 15979.54004 MB
Before interleave = 15979.54004 MB
After interleave = 15979.58691 MB
After matmul = 15979.58740 MB
Before local copies matmul = 15979.58740 MB
After local copies = 15979.58887 MB
fter compute chunk allocated = 15979.53223 MB
Memory after cuda sdpa 15979.5400390625 MB
1
Memory before offload  15979.5185546875 MB
Memory after offload  15979.5185546875 MB
Memory before cuda sdpa 15979.5322265625 MB
On entering CUDA sdpa main function  allocated = 15979.53223 MB
Before first SDPA allocated = 15979.53223 MB
On chunked entry = 15979.53223 MB
On scale calculation = 15979.54004 MB
Before interleave = 15979.54004 MB
After interleave = 15980.04004 MB
After matmul = 15988.16699 MB
Before local copies matmul = 15988.16699 MB
After local copies = 15988.16992 MB
After first SDPA allocated = 15987.65723 MB
After first copy allocated = 15987.65723 MB
On chunked entry = 15987.65723 MB
On scale calculation = 15987.66504 MB
Before interleave = 15987.66504 MB
After interleave = 15987.71191 MB
After matmul = 15987.71240 MB
Before local copies matmul = 15987.71240 MB
After local copies = 15987.71387 MB
fter compute chunk allocated = 15987.65723 MB
Memory after cuda sdpa 15987.6650390625 MB
1
Memory before offload  15987.6435546875 MB
Memory after offload  15987.6435546875 MB
Memory before cuda sdpa 15987.6572265625 MB
On entering CUDA sdpa main function  allocated = 15987.65723 MB
Before first SDPA allocated = 15987.65723 MB
On chunked entry = 15987.65723 MB
On scale calculation = 15987.66504 MB
Before interleave = 15987.66504 MB
After interleave = 15988.16504 MB
After matmul = 15996.29199 MB
Before local copies matmul = 15996.29199 MB
After local copies = 15996.29492 MB
After first SDPA allocated = 15995.78223 MB
After first copy allocated = 15995.78223 MB
On chunked entry = 15995.78223 MB
On scale calculation = 15995.79004 MB
Before interleave = 15995.79004 MB
After interleave = 15995.83691 MB
After matmul = 15995.83740 MB
Before local copies matmul = 15995.83740 MB
After local copies = 15995.83887 MB
fter compute chunk allocated = 15995.78223 MB
Memory after cuda sdpa 15995.7900390625 MB
1
Memory before offload  15995.7685546875 MB
Memory after offload  15995.7685546875 MB
Memory before cuda sdpa 15995.7822265625 MB
On entering CUDA sdpa main function  allocated = 15995.78223 MB
Before first SDPA allocated = 15995.78223 MB
On chunked entry = 15995.78223 MB
On scale calculation = 15995.79004 MB
Before interleave = 15995.79004 MB
After interleave = 15996.29004 MB
After matmul = 16004.41699 MB
Before local copies matmul = 16004.41699 MB
After local copies = 16004.41992 MB
After first SDPA allocated = 16003.90723 MB
After first copy allocated = 16003.90723 MB
On chunked entry = 16003.90723 MB
On scale calculation = 16003.91504 MB
Before interleave = 16003.91504 MB
After interleave = 16003.96191 MB
After matmul = 16003.96240 MB
Before local copies matmul = 16003.96240 MB
After local copies = 16003.96387 MB
fter compute chunk allocated = 16003.90723 MB
Memory after cuda sdpa 16003.9150390625 MB
1
Memory before offload  16003.8935546875 MB
Memory after offload  16003.8935546875 MB
Memory before cuda sdpa 16003.9072265625 MB
On entering CUDA sdpa main function  allocated = 16003.90723 MB
Before first SDPA allocated = 16003.90723 MB
On chunked entry = 16003.90723 MB
On scale calculation = 16003.91504 MB
Before interleave = 16003.91504 MB
After interleave = 16004.41504 MB
After matmul = 16012.54199 MB
Before local copies matmul = 16012.54199 MB
After local copies = 16012.54492 MB
After first SDPA allocated = 16012.03223 MB
After first copy allocated = 16012.03223 MB
On chunked entry = 16012.03223 MB
On scale calculation = 16012.04004 MB
Before interleave = 16012.04004 MB
After interleave = 16012.08691 MB
After matmul = 16012.08740 MB
Before local copies matmul = 16012.08740 MB
After local copies = 16012.08887 MB
fter compute chunk allocated = 16012.03223 MB
Memory after cuda sdpa 16012.0400390625 MB
1
Memory before offload  16012.0185546875 MB
Memory after offload  16012.0185546875 MB
Memory before cuda sdpa 16012.0322265625 MB
On entering CUDA sdpa main function  allocated = 16012.03223 MB
Before first SDPA allocated = 16012.03223 MB
On chunked entry = 16012.03223 MB
On scale calculation = 16012.04004 MB
Before interleave = 16012.04004 MB
After interleave = 16012.54004 MB
After matmul = 16020.66699 MB
Before local copies matmul = 16020.66699 MB
After local copies = 16020.66992 MB
After first SDPA allocated = 16020.15723 MB
After first copy allocated = 16020.15723 MB
On chunked entry = 16020.15723 MB
On scale calculation = 16020.16504 MB
Before interleave = 16020.16504 MB
After interleave = 16020.21191 MB
After matmul = 16020.21240 MB
Before local copies matmul = 16020.21240 MB
After local copies = 16020.21387 MB
fter compute chunk allocated = 16020.15723 MB
Memory after cuda sdpa 16020.1650390625 MB
1
Memory before offload  16020.1435546875 MB
Memory after offload  16020.1435546875 MB
Memory before cuda sdpa 16020.1572265625 MB
On entering CUDA sdpa main function  allocated = 16020.15723 MB
Before first SDPA allocated = 16020.15723 MB
On chunked entry = 16020.15723 MB
On scale calculation = 16020.16504 MB
Before interleave = 16020.16504 MB
After interleave = 16020.66504 MB
After matmul = 16028.79199 MB
Before local copies matmul = 16028.79199 MB
After local copies = 16028.79492 MB
After first SDPA allocated = 16028.28223 MB
After first copy allocated = 16028.28223 MB
On chunked entry = 16028.28223 MB
On scale calculation = 16028.29004 MB
Before interleave = 16028.29004 MB
After interleave = 16028.33691 MB
After matmul = 16028.33740 MB
Before local copies matmul = 16028.33740 MB
After local copies = 16028.33887 MB
fter compute chunk allocated = 16028.28223 MB
Memory after cuda sdpa 16028.2900390625 MB
1
Memory before offload  16028.2685546875 MB
Memory after offload  16028.2685546875 MB
Memory before cuda sdpa 16028.2822265625 MB
On entering CUDA sdpa main function  allocated = 16028.28223 MB
Before first SDPA allocated = 16028.28223 MB
On chunked entry = 16028.28223 MB
On scale calculation = 16028.29004 MB
Before interleave = 16028.29004 MB
After interleave = 16028.79004 MB
After matmul = 16036.91699 MB
Before local copies matmul = 16036.91699 MB
After local copies = 16036.91992 MB
After first SDPA allocated = 16036.40723 MB
After first copy allocated = 16036.40723 MB
On chunked entry = 16036.40723 MB
On scale calculation = 16036.41504 MB
Before interleave = 16036.41504 MB
After interleave = 16036.46191 MB
After matmul = 16036.46240 MB
Before local copies matmul = 16036.46240 MB
After local copies = 16036.46387 MB
fter compute chunk allocated = 16036.40723 MB
Memory after cuda sdpa 16036.4150390625 MB
1
Memory before offload  16036.3935546875 MB
Memory after offload  16036.3935546875 MB
Memory before cuda sdpa 16036.4072265625 MB
On entering CUDA sdpa main function  allocated = 16036.40723 MB
Before first SDPA allocated = 16036.40723 MB
On chunked entry = 16036.40723 MB
On scale calculation = 16036.41504 MB
Before interleave = 16036.41504 MB
After interleave = 16036.91504 MB
After matmul = 16045.04199 MB
Before local copies matmul = 16045.04199 MB
After local copies = 16045.04492 MB
After first SDPA allocated = 16044.53223 MB
After first copy allocated = 16044.53223 MB
On chunked entry = 16044.53223 MB
On scale calculation = 16044.54004 MB
Before interleave = 16044.54004 MB
After interleave = 16044.58691 MB
After matmul = 16044.58740 MB
Before local copies matmul = 16044.58740 MB
After local copies = 16044.58887 MB
fter compute chunk allocated = 16044.53223 MB
Memory after cuda sdpa 16044.5400390625 MB
1
Memory before offload  16044.5185546875 MB
Memory after offload  16044.5185546875 MB
Memory before cuda sdpa 16044.5322265625 MB
On entering CUDA sdpa main function  allocated = 16044.53223 MB
Before first SDPA allocated = 16044.53223 MB
On chunked entry = 16044.53223 MB
On scale calculation = 16044.54004 MB
Before interleave = 16044.54004 MB
After interleave = 16045.04004 MB
After matmul = 16053.16699 MB
Before local copies matmul = 16053.16699 MB
After local copies = 16053.16992 MB
After first SDPA allocated = 16052.65723 MB
After first copy allocated = 16052.65723 MB
On chunked entry = 16052.65723 MB
On scale calculation = 16052.66504 MB
Before interleave = 16052.66504 MB
After interleave = 16052.71191 MB
After matmul = 16052.71240 MB
Before local copies matmul = 16052.71240 MB
After local copies = 16052.71387 MB
fter compute chunk allocated = 16052.65723 MB
Memory after cuda sdpa 16052.6650390625 MB
1
Memory before offload  16052.6435546875 MB
Memory after offload  16052.6435546875 MB
Memory before cuda sdpa 16052.6572265625 MB
On entering CUDA sdpa main function  allocated = 16052.65723 MB
Before first SDPA allocated = 16052.65723 MB
On chunked entry = 16052.65723 MB
On scale calculation = 16052.66504 MB
Before interleave = 16052.66504 MB
After interleave = 16053.16504 MB
After matmul = 16061.29199 MB
Before local copies matmul = 16061.29199 MB
After local copies = 16061.29492 MB
After first SDPA allocated = 16060.78223 MB
After first copy allocated = 16060.78223 MB
On chunked entry = 16060.78223 MB
On scale calculation = 16060.79004 MB
Before interleave = 16060.79004 MB
After interleave = 16060.83691 MB
After matmul = 16060.83740 MB
Before local copies matmul = 16060.83740 MB
After local copies = 16060.83887 MB
fter compute chunk allocated = 16060.78223 MB
Memory after cuda sdpa 16060.7900390625 MB
1
Memory before offload  16060.7685546875 MB
Memory after offload  16060.7685546875 MB
Memory before cuda sdpa 16060.7822265625 MB
On entering CUDA sdpa main function  allocated = 16060.78223 MB
Before first SDPA allocated = 16060.78223 MB
On chunked entry = 16060.78223 MB
On scale calculation = 16060.79004 MB
Before interleave = 16060.79004 MB
After interleave = 16061.29004 MB
After matmul = 16069.41699 MB
Before local copies matmul = 16069.41699 MB
After local copies = 16069.41992 MB
After first SDPA allocated = 16068.90723 MB
After first copy allocated = 16068.90723 MB
On chunked entry = 16068.90723 MB
On scale calculation = 16068.91504 MB
Before interleave = 16068.91504 MB
After interleave = 16068.96191 MB
After matmul = 16068.96240 MB
Before local copies matmul = 16068.96240 MB
After local copies = 16068.96387 MB
fter compute chunk allocated = 16068.90723 MB
Memory after cuda sdpa 16068.9150390625 MB
1
Memory before offload  16068.8935546875 MB
Memory after offload  16068.8935546875 MB
Memory before cuda sdpa 16068.9072265625 MB
On entering CUDA sdpa main function  allocated = 16068.90723 MB
Before first SDPA allocated = 16068.90723 MB
On chunked entry = 16068.90723 MB
On scale calculation = 16068.91504 MB
Before interleave = 16068.91504 MB
After interleave = 16069.41504 MB
After matmul = 16077.54199 MB
Before local copies matmul = 16077.54199 MB
After local copies = 16077.54492 MB
After first SDPA allocated = 16077.03223 MB
After first copy allocated = 16077.03223 MB
On chunked entry = 16077.03223 MB
On scale calculation = 16077.04004 MB
Before interleave = 16077.04004 MB
After interleave = 16077.08691 MB
After matmul = 16077.08740 MB
Before local copies matmul = 16077.08740 MB
After local copies = 16077.08887 MB
fter compute chunk allocated = 16077.03223 MB
Memory after cuda sdpa 16077.0400390625 MB
1
Memory before offload  16077.0185546875 MB
Memory after offload  16077.0185546875 MB
Memory before cuda sdpa 16077.0322265625 MB
On entering CUDA sdpa main function  allocated = 16077.03223 MB
Before first SDPA allocated = 16077.03223 MB
On chunked entry = 16077.03223 MB
On scale calculation = 16077.04004 MB
Before interleave = 16077.04004 MB
After interleave = 16077.54004 MB
After matmul = 16085.66699 MB
Before local copies matmul = 16085.66699 MB
After local copies = 16085.66992 MB
After first SDPA allocated = 16085.15723 MB
After first copy allocated = 16085.15723 MB
On chunked entry = 16085.15723 MB
On scale calculation = 16085.16504 MB
Before interleave = 16085.16504 MB
After interleave = 16085.21191 MB
After matmul = 16085.21240 MB
Before local copies matmul = 16085.21240 MB
After local copies = 16085.21387 MB
fter compute chunk allocated = 16085.15723 MB
Memory after cuda sdpa 16085.1650390625 MB
1
Memory before offload  16085.1435546875 MB
Memory after offload  16085.1435546875 MB
Memory before cuda sdpa 16085.1572265625 MB
On entering CUDA sdpa main function  allocated = 16085.15723 MB
Before first SDPA allocated = 16085.15723 MB
On chunked entry = 16085.15723 MB
On scale calculation = 16085.16504 MB
Before interleave = 16085.16504 MB
After interleave = 16085.66504 MB
After matmul = 16093.79199 MB
Before local copies matmul = 16093.79199 MB
After local copies = 16093.79492 MB
After first SDPA allocated = 16093.28223 MB
After first copy allocated = 16093.28223 MB
On chunked entry = 16093.28223 MB
On scale calculation = 16093.29004 MB
Before interleave = 16093.29004 MB
After interleave = 16093.33691 MB
After matmul = 16093.33740 MB
Before local copies matmul = 16093.33740 MB
After local copies = 16093.33887 MB
fter compute chunk allocated = 16093.28223 MB
Memory after cuda sdpa 16093.2900390625 MB
1
Memory before offload  16093.2685546875 MB
Memory after offload  16093.2685546875 MB
Memory before cuda sdpa 16093.2822265625 MB
On entering CUDA sdpa main function  allocated = 16093.28223 MB
Before first SDPA allocated = 16093.28223 MB
On chunked entry = 16093.28223 MB
On scale calculation = 16093.29004 MB
Before interleave = 16093.29004 MB
After interleave = 16093.79004 MB
After matmul = 16101.91699 MB
Before local copies matmul = 16101.91699 MB
After local copies = 16101.91992 MB
After first SDPA allocated = 16101.40723 MB
After first copy allocated = 16101.40723 MB
On chunked entry = 16101.40723 MB
On scale calculation = 16101.41504 MB
Before interleave = 16101.41504 MB
After interleave = 16101.46191 MB
After matmul = 16101.46240 MB
Before local copies matmul = 16101.46240 MB
After local copies = 16101.46387 MB
fter compute chunk allocated = 16101.40723 MB
Memory after cuda sdpa 16101.4150390625 MB
1
Memory before offload  16101.3935546875 MB
Memory after offload  16101.3935546875 MB
Memory before cuda sdpa 16101.4072265625 MB
On entering CUDA sdpa main function  allocated = 16101.40723 MB
Before first SDPA allocated = 16101.40723 MB
On chunked entry = 16101.40723 MB
On scale calculation = 16101.41504 MB
Before interleave = 16101.41504 MB
After interleave = 16101.91504 MB
After matmul = 16110.04199 MB
Before local copies matmul = 16110.04199 MB
After local copies = 16110.04492 MB
After first SDPA allocated = 16109.53223 MB
After first copy allocated = 16109.53223 MB
On chunked entry = 16109.53223 MB
On scale calculation = 16109.54004 MB
Before interleave = 16109.54004 MB
After interleave = 16109.58691 MB
After matmul = 16109.58740 MB
Before local copies matmul = 16109.58740 MB
After local copies = 16109.58887 MB
fter compute chunk allocated = 16109.53223 MB
Memory after cuda sdpa 16109.5400390625 MB
1
Memory before offload  16109.5185546875 MB
Memory after offload  16109.5185546875 MB
Memory before cuda sdpa 16109.5322265625 MB
On entering CUDA sdpa main function  allocated = 16109.53223 MB
Before first SDPA allocated = 16109.53223 MB
On chunked entry = 16109.53223 MB
On scale calculation = 16109.54004 MB
Before interleave = 16109.54004 MB
After interleave = 16110.04004 MB
After matmul = 16118.16699 MB
Before local copies matmul = 16118.16699 MB
After local copies = 16118.16992 MB
After first SDPA allocated = 16117.65723 MB
After first copy allocated = 16117.65723 MB
On chunked entry = 16117.65723 MB
On scale calculation = 16117.66504 MB
Before interleave = 16117.66504 MB
After interleave = 16117.71191 MB
After matmul = 16117.71240 MB
Before local copies matmul = 16117.71240 MB
After local copies = 16117.71387 MB
fter compute chunk allocated = 16117.65723 MB
Memory after cuda sdpa 16117.6650390625 MB
1
Memory before offload  16117.6435546875 MB
Memory after offload  16117.6435546875 MB
Memory before cuda sdpa 16117.6572265625 MB
On entering CUDA sdpa main function  allocated = 16117.65723 MB
Before first SDPA allocated = 16117.65723 MB
On chunked entry = 16117.65723 MB
On scale calculation = 16117.66504 MB
Before interleave = 16117.66504 MB
After interleave = 16118.16504 MB
After matmul = 16126.29199 MB
Before local copies matmul = 16126.29199 MB
After local copies = 16126.29492 MB
After first SDPA allocated = 16125.78223 MB
After first copy allocated = 16125.78223 MB
On chunked entry = 16125.78223 MB
On scale calculation = 16125.79004 MB
Before interleave = 16125.79004 MB
After interleave = 16125.83691 MB
After matmul = 16125.83740 MB
Before local copies matmul = 16125.83740 MB
After local copies = 16125.83887 MB
fter compute chunk allocated = 16125.78223 MB
Memory after cuda sdpa 16125.7900390625 MB
Decode step 4
1
Memory before offload  16125.76904296875 MB
Memory after offload  16125.76904296875 MB
Memory before cuda sdpa 16125.78271484375 MB
On entering CUDA sdpa main function  allocated = 16125.78271 MB
Before first SDPA allocated = 16125.78271 MB
On chunked entry = 16125.78271 MB
On scale calculation = 16125.79053 MB
Before interleave = 16125.79053 MB
After interleave = 16126.29053 MB
After matmul = 16134.41748 MB
Before local copies matmul = 16134.41748 MB
After local copies = 16134.42041 MB
After first SDPA allocated = 16133.90771 MB
After first copy allocated = 16133.90771 MB
On chunked entry = 16133.90771 MB
On scale calculation = 16133.91553 MB
Before interleave = 16133.91553 MB
After interleave = 16133.97803 MB
After matmul = 16133.97852 MB
Before local copies matmul = 16133.97852 MB
After local copies = 16133.97998 MB
fter compute chunk allocated = 16133.90771 MB
Memory after cuda sdpa 16133.91552734375 MB
1
Memory before offload  16133.89404296875 MB
Memory after offload  16133.89404296875 MB
Memory before cuda sdpa 16133.90771484375 MB
On entering CUDA sdpa main function  allocated = 16133.90771 MB
Before first SDPA allocated = 16133.90771 MB
On chunked entry = 16133.90771 MB
On scale calculation = 16133.91553 MB
Before interleave = 16133.91553 MB
After interleave = 16134.41553 MB
After matmul = 16142.54248 MB
Before local copies matmul = 16142.54248 MB
After local copies = 16142.54541 MB
After first SDPA allocated = 16142.03271 MB
After first copy allocated = 16142.03271 MB
On chunked entry = 16142.03271 MB
On scale calculation = 16142.04053 MB
Before interleave = 16142.04053 MB
After interleave = 16142.10303 MB
After matmul = 16142.10352 MB
Before local copies matmul = 16142.10352 MB
After local copies = 16142.10498 MB
fter compute chunk allocated = 16142.03271 MB
Memory after cuda sdpa 16142.04052734375 MB
1
Memory before offload  16142.01904296875 MB
Memory after offload  16142.01904296875 MB
Memory before cuda sdpa 16142.03271484375 MB
On entering CUDA sdpa main function  allocated = 16142.03271 MB
Before first SDPA allocated = 16142.03271 MB
On chunked entry = 16142.03271 MB
On scale calculation = 16142.04053 MB
Before interleave = 16142.04053 MB
After interleave = 16142.54053 MB
After matmul = 16150.66748 MB
Before local copies matmul = 16150.66748 MB
After local copies = 16150.67041 MB
After first SDPA allocated = 16150.15771 MB
After first copy allocated = 16150.15771 MB
On chunked entry = 16150.15771 MB
On scale calculation = 16150.16553 MB
Before interleave = 16150.16553 MB
After interleave = 16150.22803 MB
After matmul = 16150.22852 MB
Before local copies matmul = 16150.22852 MB
After local copies = 16150.22998 MB
fter compute chunk allocated = 16150.15771 MB
Memory after cuda sdpa 16150.16552734375 MB
1
Memory before offload  16150.14404296875 MB
Memory after offload  16150.14404296875 MB
Memory before cuda sdpa 16150.15771484375 MB
On entering CUDA sdpa main function  allocated = 16150.15771 MB
Before first SDPA allocated = 16150.15771 MB
On chunked entry = 16150.15771 MB
On scale calculation = 16150.16553 MB
Before interleave = 16150.16553 MB
After interleave = 16150.66553 MB
After matmul = 16158.79248 MB
Before local copies matmul = 16158.79248 MB
After local copies = 16158.79541 MB
After first SDPA allocated = 16158.28271 MB
After first copy allocated = 16158.28271 MB
On chunked entry = 16158.28271 MB
On scale calculation = 16158.29053 MB
Before interleave = 16158.29053 MB
After interleave = 16158.35303 MB
After matmul = 16158.35352 MB
Before local copies matmul = 16158.35352 MB
After local copies = 16158.35498 MB
fter compute chunk allocated = 16158.28271 MB
Memory after cuda sdpa 16158.29052734375 MB
1
Memory before offload  16158.26904296875 MB
Memory after offload  16158.26904296875 MB
Memory before cuda sdpa 16158.28271484375 MB
On entering CUDA sdpa main function  allocated = 16158.28271 MB
Before first SDPA allocated = 16158.28271 MB
On chunked entry = 16158.28271 MB
On scale calculation = 16158.29053 MB
Before interleave = 16158.29053 MB
After interleave = 16158.79053 MB
After matmul = 16166.91748 MB
Before local copies matmul = 16166.91748 MB
After local copies = 16166.92041 MB
After first SDPA allocated = 16166.40771 MB
After first copy allocated = 16166.40771 MB
On chunked entry = 16166.40771 MB
On scale calculation = 16166.41553 MB
Before interleave = 16166.41553 MB
After interleave = 16166.47803 MB
After matmul = 16166.47852 MB
Before local copies matmul = 16166.47852 MB
After local copies = 16166.47998 MB
fter compute chunk allocated = 16166.40771 MB
Memory after cuda sdpa 16166.41552734375 MB
1
Memory before offload  16166.39404296875 MB
Memory after offload  16166.39404296875 MB
Memory before cuda sdpa 16166.40771484375 MB
On entering CUDA sdpa main function  allocated = 16166.40771 MB
Before first SDPA allocated = 16166.40771 MB
On chunked entry = 16166.40771 MB
On scale calculation = 16166.41553 MB
Before interleave = 16166.41553 MB
After interleave = 16166.91553 MB
After matmul = 16175.04248 MB
Before local copies matmul = 16175.04248 MB
After local copies = 16175.04541 MB
After first SDPA allocated = 16174.53271 MB
After first copy allocated = 16174.53271 MB
On chunked entry = 16174.53271 MB
On scale calculation = 16174.54053 MB
Before interleave = 16174.54053 MB
After interleave = 16174.60303 MB
After matmul = 16174.60352 MB
Before local copies matmul = 16174.60352 MB
After local copies = 16174.60498 MB
fter compute chunk allocated = 16174.53271 MB
Memory after cuda sdpa 16174.54052734375 MB
1
Memory before offload  16174.51904296875 MB
Memory after offload  16174.51904296875 MB
Memory before cuda sdpa 16174.53271484375 MB
On entering CUDA sdpa main function  allocated = 16174.53271 MB
Before first SDPA allocated = 16174.53271 MB
On chunked entry = 16174.53271 MB
On scale calculation = 16174.54053 MB
Before interleave = 16174.54053 MB
After interleave = 16175.04053 MB
After matmul = 16183.16748 MB
Before local copies matmul = 16183.16748 MB
After local copies = 16183.17041 MB
After first SDPA allocated = 16182.65771 MB
After first copy allocated = 16182.65771 MB
On chunked entry = 16182.65771 MB
On scale calculation = 16182.66553 MB
Before interleave = 16182.66553 MB
After interleave = 16182.72803 MB
After matmul = 16182.72852 MB
Before local copies matmul = 16182.72852 MB
After local copies = 16182.72998 MB
fter compute chunk allocated = 16182.65771 MB
Memory after cuda sdpa 16182.66552734375 MB
1
Memory before offload  16182.64404296875 MB
Memory after offload  16182.64404296875 MB
Memory before cuda sdpa 16182.65771484375 MB
On entering CUDA sdpa main function  allocated = 16182.65771 MB
Before first SDPA allocated = 16182.65771 MB
On chunked entry = 16182.65771 MB
On scale calculation = 16182.66553 MB
Before interleave = 16182.66553 MB
After interleave = 16183.16553 MB
After matmul = 16191.29248 MB
Before local copies matmul = 16191.29248 MB
After local copies = 16191.29541 MB
After first SDPA allocated = 16190.78271 MB
After first copy allocated = 16190.78271 MB
On chunked entry = 16190.78271 MB
On scale calculation = 16190.79053 MB
Before interleave = 16190.79053 MB
After interleave = 16190.85303 MB
After matmul = 16190.85352 MB
Before local copies matmul = 16190.85352 MB
After local copies = 16190.85498 MB
fter compute chunk allocated = 16190.78271 MB
Memory after cuda sdpa 16190.79052734375 MB
1
Memory before offload  16190.76904296875 MB
Memory after offload  16190.76904296875 MB
Memory before cuda sdpa 16190.78271484375 MB
On entering CUDA sdpa main function  allocated = 16190.78271 MB
Before first SDPA allocated = 16190.78271 MB
On chunked entry = 16190.78271 MB
On scale calculation = 16190.79053 MB
Before interleave = 16190.79053 MB
After interleave = 16191.29053 MB
After matmul = 16199.41748 MB
Before local copies matmul = 16199.41748 MB
After local copies = 16199.42041 MB
After first SDPA allocated = 16198.90771 MB
After first copy allocated = 16198.90771 MB
On chunked entry = 16198.90771 MB
On scale calculation = 16198.91553 MB
Before interleave = 16198.91553 MB
After interleave = 16198.97803 MB
After matmul = 16198.97852 MB
Before local copies matmul = 16198.97852 MB
After local copies = 16198.97998 MB
fter compute chunk allocated = 16198.90771 MB
Memory after cuda sdpa 16198.91552734375 MB
1
Memory before offload  16198.89404296875 MB
Memory after offload  16198.89404296875 MB
Memory before cuda sdpa 16198.90771484375 MB
On entering CUDA sdpa main function  allocated = 16198.90771 MB
Before first SDPA allocated = 16198.90771 MB
On chunked entry = 16198.90771 MB
On scale calculation = 16198.91553 MB
Before interleave = 16198.91553 MB
After interleave = 16199.41553 MB
After matmul = 16207.54248 MB
Before local copies matmul = 16207.54248 MB
After local copies = 16207.54541 MB
After first SDPA allocated = 16207.03271 MB
After first copy allocated = 16207.03271 MB
On chunked entry = 16207.03271 MB
On scale calculation = 16207.04053 MB
Before interleave = 16207.04053 MB
After interleave = 16207.10303 MB
After matmul = 16207.10352 MB
Before local copies matmul = 16207.10352 MB
After local copies = 16207.10498 MB
fter compute chunk allocated = 16207.03271 MB
Memory after cuda sdpa 16207.04052734375 MB
1
Memory before offload  16207.01904296875 MB
Memory after offload  16207.01904296875 MB
Memory before cuda sdpa 16207.03271484375 MB
On entering CUDA sdpa main function  allocated = 16207.03271 MB
Before first SDPA allocated = 16207.03271 MB
On chunked entry = 16207.03271 MB
On scale calculation = 16207.04053 MB
Before interleave = 16207.04053 MB
After interleave = 16207.54053 MB
After matmul = 16215.66748 MB
Before local copies matmul = 16215.66748 MB
After local copies = 16215.67041 MB
After first SDPA allocated = 16215.15771 MB
After first copy allocated = 16215.15771 MB
On chunked entry = 16215.15771 MB
On scale calculation = 16215.16553 MB
Before interleave = 16215.16553 MB
After interleave = 16215.22803 MB
After matmul = 16215.22852 MB
Before local copies matmul = 16215.22852 MB
After local copies = 16215.22998 MB
fter compute chunk allocated = 16215.15771 MB
Memory after cuda sdpa 16215.16552734375 MB
1
Memory before offload  16215.14404296875 MB
Memory after offload  16215.14404296875 MB
Memory before cuda sdpa 16215.15771484375 MB
On entering CUDA sdpa main function  allocated = 16215.15771 MB
Before first SDPA allocated = 16215.15771 MB
On chunked entry = 16215.15771 MB
On scale calculation = 16215.16553 MB
Before interleave = 16215.16553 MB
After interleave = 16215.66553 MB
After matmul = 16223.79248 MB
Before local copies matmul = 16223.79248 MB
After local copies = 16223.79541 MB
After first SDPA allocated = 16223.28271 MB
After first copy allocated = 16223.28271 MB
On chunked entry = 16223.28271 MB
On scale calculation = 16223.29053 MB
Before interleave = 16223.29053 MB
After interleave = 16223.35303 MB
After matmul = 16223.35352 MB
Before local copies matmul = 16223.35352 MB
After local copies = 16223.35498 MB
fter compute chunk allocated = 16223.28271 MB
Memory after cuda sdpa 16223.29052734375 MB
1
Memory before offload  16223.26904296875 MB
Memory after offload  16223.26904296875 MB
Memory before cuda sdpa 16223.28271484375 MB
On entering CUDA sdpa main function  allocated = 16223.28271 MB
Before first SDPA allocated = 16223.28271 MB
On chunked entry = 16223.28271 MB
On scale calculation = 16223.29053 MB
Before interleave = 16223.29053 MB
After interleave = 16223.79053 MB
After matmul = 16231.91748 MB
Before local copies matmul = 16231.91748 MB
After local copies = 16231.92041 MB
After first SDPA allocated = 16231.40771 MB
After first copy allocated = 16231.40771 MB
On chunked entry = 16231.40771 MB
On scale calculation = 16231.41553 MB
Before interleave = 16231.41553 MB
After interleave = 16231.47803 MB
After matmul = 16231.47852 MB
Before local copies matmul = 16231.47852 MB
After local copies = 16231.47998 MB
fter compute chunk allocated = 16231.40771 MB
Memory after cuda sdpa 16231.41552734375 MB
1
Memory before offload  16231.39404296875 MB
Memory after offload  16231.39404296875 MB
Memory before cuda sdpa 16231.40771484375 MB
On entering CUDA sdpa main function  allocated = 16231.40771 MB
Before first SDPA allocated = 16231.40771 MB
On chunked entry = 16231.40771 MB
On scale calculation = 16231.41553 MB
Before interleave = 16231.41553 MB
After interleave = 16231.91553 MB
After matmul = 16240.04248 MB
Before local copies matmul = 16240.04248 MB
After local copies = 16240.04541 MB
After first SDPA allocated = 16239.53271 MB
After first copy allocated = 16239.53271 MB
On chunked entry = 16239.53271 MB
On scale calculation = 16239.54053 MB
Before interleave = 16239.54053 MB
After interleave = 16239.60303 MB
After matmul = 16239.60352 MB
Before local copies matmul = 16239.60352 MB
After local copies = 16239.60498 MB
fter compute chunk allocated = 16239.53271 MB
Memory after cuda sdpa 16239.54052734375 MB
1
Memory before offload  16239.51904296875 MB
Memory after offload  16239.51904296875 MB
Memory before cuda sdpa 16239.53271484375 MB
On entering CUDA sdpa main function  allocated = 16239.53271 MB
Before first SDPA allocated = 16239.53271 MB
On chunked entry = 16239.53271 MB
On scale calculation = 16239.54053 MB
Before interleave = 16239.54053 MB
After interleave = 16240.04053 MB
After matmul = 16248.16748 MB
Before local copies matmul = 16248.16748 MB
After local copies = 16248.17041 MB
After first SDPA allocated = 16247.65771 MB
After first copy allocated = 16247.65771 MB
On chunked entry = 16247.65771 MB
On scale calculation = 16247.66553 MB
Before interleave = 16247.66553 MB
After interleave = 16247.72803 MB
After matmul = 16247.72852 MB
Before local copies matmul = 16247.72852 MB
After local copies = 16247.72998 MB
fter compute chunk allocated = 16247.65771 MB
Memory after cuda sdpa 16247.66552734375 MB
1
Memory before offload  16247.64404296875 MB
Memory after offload  16247.64404296875 MB
Memory before cuda sdpa 16247.65771484375 MB
On entering CUDA sdpa main function  allocated = 16247.65771 MB
Before first SDPA allocated = 16247.65771 MB
On chunked entry = 16247.65771 MB
On scale calculation = 16247.66553 MB
Before interleave = 16247.66553 MB
After interleave = 16248.16553 MB
After matmul = 16256.29248 MB
Before local copies matmul = 16256.29248 MB
After local copies = 16256.29541 MB
After first SDPA allocated = 16255.78271 MB
After first copy allocated = 16255.78271 MB
On chunked entry = 16255.78271 MB
On scale calculation = 16255.79053 MB
Before interleave = 16255.79053 MB
After interleave = 16255.85303 MB
After matmul = 16255.85352 MB
Before local copies matmul = 16255.85352 MB
After local copies = 16255.85498 MB
fter compute chunk allocated = 16255.78271 MB
Memory after cuda sdpa 16255.79052734375 MB
1
Memory before offload  16255.76904296875 MB
Memory after offload  16255.76904296875 MB
Memory before cuda sdpa 16255.78271484375 MB
On entering CUDA sdpa main function  allocated = 16255.78271 MB
Before first SDPA allocated = 16255.78271 MB
On chunked entry = 16255.78271 MB
On scale calculation = 16255.79053 MB
Before interleave = 16255.79053 MB
After interleave = 16256.29053 MB
After matmul = 16264.41748 MB
Before local copies matmul = 16264.41748 MB
After local copies = 16264.42041 MB
After first SDPA allocated = 16263.90771 MB
After first copy allocated = 16263.90771 MB
On chunked entry = 16263.90771 MB
On scale calculation = 16263.91553 MB
Before interleave = 16263.91553 MB
After interleave = 16263.97803 MB
After matmul = 16263.97852 MB
Before local copies matmul = 16263.97852 MB
After local copies = 16263.97998 MB
fter compute chunk allocated = 16263.90771 MB
Memory after cuda sdpa 16263.91552734375 MB
1
Memory before offload  16263.89404296875 MB
Memory after offload  16263.89404296875 MB
Memory before cuda sdpa 16263.90771484375 MB
On entering CUDA sdpa main function  allocated = 16263.90771 MB
Before first SDPA allocated = 16263.90771 MB
On chunked entry = 16263.90771 MB
On scale calculation = 16263.91553 MB
Before interleave = 16263.91553 MB
After interleave = 16264.41553 MB
After matmul = 16272.54248 MB
Before local copies matmul = 16272.54248 MB
After local copies = 16272.54541 MB
After first SDPA allocated = 16272.03271 MB
After first copy allocated = 16272.03271 MB
On chunked entry = 16272.03271 MB
On scale calculation = 16272.04053 MB
Before interleave = 16272.04053 MB
After interleave = 16272.10303 MB
After matmul = 16272.10352 MB
Before local copies matmul = 16272.10352 MB
After local copies = 16272.10498 MB
fter compute chunk allocated = 16272.03271 MB
Memory after cuda sdpa 16272.04052734375 MB
1
Memory before offload  16272.01904296875 MB
Memory after offload  16272.01904296875 MB
Memory before cuda sdpa 16272.03271484375 MB
On entering CUDA sdpa main function  allocated = 16272.03271 MB
Before first SDPA allocated = 16272.03271 MB
On chunked entry = 16272.03271 MB
On scale calculation = 16272.04053 MB
Before interleave = 16272.04053 MB
After interleave = 16272.54053 MB
After matmul = 16280.66748 MB
Before local copies matmul = 16280.66748 MB
After local copies = 16280.67041 MB
After first SDPA allocated = 16280.15771 MB
After first copy allocated = 16280.15771 MB
On chunked entry = 16280.15771 MB
On scale calculation = 16280.16553 MB
Before interleave = 16280.16553 MB
After interleave = 16280.22803 MB
After matmul = 16280.22852 MB
Before local copies matmul = 16280.22852 MB
After local copies = 16280.22998 MB
fter compute chunk allocated = 16280.15771 MB
Memory after cuda sdpa 16280.16552734375 MB
1
Memory before offload  16280.14404296875 MB
Memory after offload  16280.14404296875 MB
Memory before cuda sdpa 16280.15771484375 MB
On entering CUDA sdpa main function  allocated = 16280.15771 MB
Before first SDPA allocated = 16280.15771 MB
On chunked entry = 16280.15771 MB
On scale calculation = 16280.16553 MB
Before interleave = 16280.16553 MB
After interleave = 16280.66553 MB
After matmul = 16288.79248 MB
Before local copies matmul = 16288.79248 MB
After local copies = 16288.79541 MB
After first SDPA allocated = 16288.28271 MB
After first copy allocated = 16288.28271 MB
On chunked entry = 16288.28271 MB
On scale calculation = 16288.29053 MB
Before interleave = 16288.29053 MB
After interleave = 16288.35303 MB
After matmul = 16288.35352 MB
Before local copies matmul = 16288.35352 MB
After local copies = 16288.35498 MB
fter compute chunk allocated = 16288.28271 MB
Memory after cuda sdpa 16288.29052734375 MB
1
Memory before offload  16288.26904296875 MB
Memory after offload  16288.26904296875 MB
Memory before cuda sdpa 16288.28271484375 MB
On entering CUDA sdpa main function  allocated = 16288.28271 MB
Before first SDPA allocated = 16288.28271 MB
On chunked entry = 16288.28271 MB
On scale calculation = 16288.29053 MB
Before interleave = 16288.29053 MB
After interleave = 16288.79053 MB
After matmul = 16296.91748 MB
Before local copies matmul = 16296.91748 MB
After local copies = 16296.92041 MB
After first SDPA allocated = 16296.40771 MB
After first copy allocated = 16296.40771 MB
On chunked entry = 16296.40771 MB
On scale calculation = 16296.41553 MB
Before interleave = 16296.41553 MB
After interleave = 16296.47803 MB
After matmul = 16296.47852 MB
Before local copies matmul = 16296.47852 MB
After local copies = 16296.47998 MB
fter compute chunk allocated = 16296.40771 MB
Memory after cuda sdpa 16296.41552734375 MB
1
Memory before offload  16296.39404296875 MB
Memory after offload  16296.39404296875 MB
Memory before cuda sdpa 16296.40771484375 MB
On entering CUDA sdpa main function  allocated = 16296.40771 MB
Before first SDPA allocated = 16296.40771 MB
On chunked entry = 16296.40771 MB
On scale calculation = 16296.41553 MB
Before interleave = 16296.41553 MB
After interleave = 16296.91553 MB
After matmul = 16305.04248 MB
Before local copies matmul = 16305.04248 MB
After local copies = 16305.04541 MB
After first SDPA allocated = 16304.53271 MB
After first copy allocated = 16304.53271 MB
On chunked entry = 16304.53271 MB
On scale calculation = 16304.54053 MB
Before interleave = 16304.54053 MB
After interleave = 16304.60303 MB
After matmul = 16304.60352 MB
Before local copies matmul = 16304.60352 MB
After local copies = 16304.60498 MB
fter compute chunk allocated = 16304.53271 MB
Memory after cuda sdpa 16304.54052734375 MB
1
Memory before offload  16304.51904296875 MB
Memory after offload  16304.51904296875 MB
Memory before cuda sdpa 16304.53271484375 MB
On entering CUDA sdpa main function  allocated = 16304.53271 MB
Before first SDPA allocated = 16304.53271 MB
On chunked entry = 16304.53271 MB
On scale calculation = 16304.54053 MB
Before interleave = 16304.54053 MB
After interleave = 16305.04053 MB
After matmul = 16313.16748 MB
Before local copies matmul = 16313.16748 MB
After local copies = 16313.17041 MB
After first SDPA allocated = 16312.65771 MB
After first copy allocated = 16312.65771 MB
On chunked entry = 16312.65771 MB
On scale calculation = 16312.66553 MB
Before interleave = 16312.66553 MB
After interleave = 16312.72803 MB
After matmul = 16312.72852 MB
Before local copies matmul = 16312.72852 MB
After local copies = 16312.72998 MB
fter compute chunk allocated = 16312.65771 MB
Memory after cuda sdpa 16312.66552734375 MB
1
Memory before offload  16312.64404296875 MB
Memory after offload  16312.64404296875 MB
Memory before cuda sdpa 16312.65771484375 MB
On entering CUDA sdpa main function  allocated = 16312.65771 MB
Before first SDPA allocated = 16312.65771 MB
On chunked entry = 16312.65771 MB
On scale calculation = 16312.66553 MB
Before interleave = 16312.66553 MB
After interleave = 16313.16553 MB
After matmul = 16321.29248 MB
Before local copies matmul = 16321.29248 MB
After local copies = 16321.29541 MB
After first SDPA allocated = 16320.78271 MB
After first copy allocated = 16320.78271 MB
On chunked entry = 16320.78271 MB
On scale calculation = 16320.79053 MB
Before interleave = 16320.79053 MB
After interleave = 16320.85303 MB
After matmul = 16320.85352 MB
Before local copies matmul = 16320.85352 MB
After local copies = 16320.85498 MB
fter compute chunk allocated = 16320.78271 MB
Memory after cuda sdpa 16320.79052734375 MB
1
Memory before offload  16320.76904296875 MB
Memory after offload  16320.76904296875 MB
Memory before cuda sdpa 16320.78271484375 MB
On entering CUDA sdpa main function  allocated = 16320.78271 MB
Before first SDPA allocated = 16320.78271 MB
On chunked entry = 16320.78271 MB
On scale calculation = 16320.79053 MB
Before interleave = 16320.79053 MB
After interleave = 16321.29053 MB
After matmul = 16329.41748 MB
Before local copies matmul = 16329.41748 MB
After local copies = 16329.42041 MB
After first SDPA allocated = 16328.90771 MB
After first copy allocated = 16328.90771 MB
On chunked entry = 16328.90771 MB
On scale calculation = 16328.91553 MB
Before interleave = 16328.91553 MB
After interleave = 16328.97803 MB
After matmul = 16328.97852 MB
Before local copies matmul = 16328.97852 MB
After local copies = 16328.97998 MB
fter compute chunk allocated = 16328.90771 MB
Memory after cuda sdpa 16328.91552734375 MB
1
Memory before offload  16328.89404296875 MB
Memory after offload  16328.89404296875 MB
Memory before cuda sdpa 16328.90771484375 MB
On entering CUDA sdpa main function  allocated = 16328.90771 MB
Before first SDPA allocated = 16328.90771 MB
On chunked entry = 16328.90771 MB
On scale calculation = 16328.91553 MB
Before interleave = 16328.91553 MB
After interleave = 16329.41553 MB
After matmul = 16337.54248 MB
Before local copies matmul = 16337.54248 MB
After local copies = 16337.54541 MB
After first SDPA allocated = 16337.03271 MB
After first copy allocated = 16337.03271 MB
On chunked entry = 16337.03271 MB
On scale calculation = 16337.04053 MB
Before interleave = 16337.04053 MB
After interleave = 16337.10303 MB
After matmul = 16337.10352 MB
Before local copies matmul = 16337.10352 MB
After local copies = 16337.10498 MB
fter compute chunk allocated = 16337.03271 MB
Memory after cuda sdpa 16337.04052734375 MB
1
Memory before offload  16337.01904296875 MB
Memory after offload  16337.01904296875 MB
Memory before cuda sdpa 16337.03271484375 MB
On entering CUDA sdpa main function  allocated = 16337.03271 MB
Before first SDPA allocated = 16337.03271 MB
On chunked entry = 16337.03271 MB
On scale calculation = 16337.04053 MB
Before interleave = 16337.04053 MB
After interleave = 16337.54053 MB
After matmul = 16345.66748 MB
Before local copies matmul = 16345.66748 MB
After local copies = 16345.67041 MB
After first SDPA allocated = 16345.15771 MB
After first copy allocated = 16345.15771 MB
On chunked entry = 16345.15771 MB
On scale calculation = 16345.16553 MB
Before interleave = 16345.16553 MB
After interleave = 16345.22803 MB
After matmul = 16345.22852 MB
Before local copies matmul = 16345.22852 MB
After local copies = 16345.22998 MB
fter compute chunk allocated = 16345.15771 MB
Memory after cuda sdpa 16345.16552734375 MB
1
Memory before offload  16345.14404296875 MB
Memory after offload  16345.14404296875 MB
Memory before cuda sdpa 16345.15771484375 MB
On entering CUDA sdpa main function  allocated = 16345.15771 MB
Before first SDPA allocated = 16345.15771 MB
On chunked entry = 16345.15771 MB
On scale calculation = 16345.16553 MB
Before interleave = 16345.16553 MB
After interleave = 16345.66553 MB
After matmul = 16353.79248 MB
Before local copies matmul = 16353.79248 MB
After local copies = 16353.79541 MB
After first SDPA allocated = 16353.28271 MB
After first copy allocated = 16353.28271 MB
On chunked entry = 16353.28271 MB
On scale calculation = 16353.29053 MB
Before interleave = 16353.29053 MB
After interleave = 16353.35303 MB
After matmul = 16353.35352 MB
Before local copies matmul = 16353.35352 MB
After local copies = 16353.35498 MB
fter compute chunk allocated = 16353.28271 MB
Memory after cuda sdpa 16353.29052734375 MB
1
Memory before offload  16353.26904296875 MB
Memory after offload  16353.26904296875 MB
Memory before cuda sdpa 16353.28271484375 MB
On entering CUDA sdpa main function  allocated = 16353.28271 MB
Before first SDPA allocated = 16353.28271 MB
On chunked entry = 16353.28271 MB
On scale calculation = 16353.29053 MB
Before interleave = 16353.29053 MB
After interleave = 16353.79053 MB
After matmul = 16361.91748 MB
Before local copies matmul = 16361.91748 MB
After local copies = 16361.92041 MB
After first SDPA allocated = 16361.40771 MB
After first copy allocated = 16361.40771 MB
On chunked entry = 16361.40771 MB
On scale calculation = 16361.41553 MB
Before interleave = 16361.41553 MB
After interleave = 16361.47803 MB
After matmul = 16361.47852 MB
Before local copies matmul = 16361.47852 MB
After local copies = 16361.47998 MB
fter compute chunk allocated = 16361.40771 MB
Memory after cuda sdpa 16361.41552734375 MB
1
Memory before offload  16361.39404296875 MB
Memory after offload  16361.39404296875 MB
Memory before cuda sdpa 16361.40771484375 MB
On entering CUDA sdpa main function  allocated = 16361.40771 MB
Before first SDPA allocated = 16361.40771 MB
On chunked entry = 16361.40771 MB
On scale calculation = 16361.41553 MB
Before interleave = 16361.41553 MB
After interleave = 16361.91553 MB
After matmul = 16370.04248 MB
Before local copies matmul = 16370.04248 MB
After local copies = 16370.04541 MB
After first SDPA allocated = 16369.53271 MB
After first copy allocated = 16369.53271 MB
On chunked entry = 16369.53271 MB
On scale calculation = 16369.54053 MB
Before interleave = 16369.54053 MB
After interleave = 16369.60303 MB
After matmul = 16369.60352 MB
Before local copies matmul = 16369.60352 MB
After local copies = 16369.60498 MB
fter compute chunk allocated = 16369.53271 MB
Memory after cuda sdpa 16369.54052734375 MB
1
Memory before offload  16369.51904296875 MB
Memory after offload  16369.51904296875 MB
Memory before cuda sdpa 16369.53271484375 MB
On entering CUDA sdpa main function  allocated = 16369.53271 MB
Before first SDPA allocated = 16369.53271 MB
On chunked entry = 16369.53271 MB
On scale calculation = 16369.54053 MB
Before interleave = 16369.54053 MB
After interleave = 16370.04053 MB
After matmul = 16378.16748 MB
Before local copies matmul = 16378.16748 MB
After local copies = 16378.17041 MB
After first SDPA allocated = 16377.65771 MB
After first copy allocated = 16377.65771 MB
On chunked entry = 16377.65771 MB
On scale calculation = 16377.66553 MB
Before interleave = 16377.66553 MB
After interleave = 16377.72803 MB
After matmul = 16377.72852 MB
Before local copies matmul = 16377.72852 MB
After local copies = 16377.72998 MB
fter compute chunk allocated = 16377.65771 MB
Memory after cuda sdpa 16377.66552734375 MB
1
Memory before offload  16377.64404296875 MB
Memory after offload  16377.64404296875 MB
Memory before cuda sdpa 16377.65771484375 MB
On entering CUDA sdpa main function  allocated = 16377.65771 MB
Before first SDPA allocated = 16377.65771 MB
On chunked entry = 16377.65771 MB
On scale calculation = 16377.66553 MB
Before interleave = 16377.66553 MB
After interleave = 16378.16553 MB
After matmul = 16386.29248 MB
Before local copies matmul = 16386.29248 MB
After local copies = 16386.29541 MB
After first SDPA allocated = 16385.78271 MB
After first copy allocated = 16385.78271 MB
On chunked entry = 16385.78271 MB
On scale calculation = 16385.79053 MB
Before interleave = 16385.79053 MB
After interleave = 16385.85303 MB
After matmul = 16385.85352 MB
Before local copies matmul = 16385.85352 MB
After local copies = 16385.85498 MB
fter compute chunk allocated = 16385.78271 MB
Memory after cuda sdpa 16385.79052734375 MB
Decode step 5
1
Memory before offload  16385.76953125 MB
Memory after offload  16385.76953125 MB
Memory before cuda sdpa 16385.783203125 MB
On entering CUDA sdpa main function  allocated = 16385.78320 MB
Before first SDPA allocated = 16385.78320 MB
On chunked entry = 16385.78320 MB
On scale calculation = 16385.79102 MB
Before interleave = 16385.79102 MB
After interleave = 16386.29102 MB
After matmul = 16394.41797 MB
Before local copies matmul = 16394.41797 MB
After local copies = 16394.42090 MB
After first SDPA allocated = 16393.90820 MB
After first copy allocated = 16393.90820 MB
On chunked entry = 16393.90820 MB
On scale calculation = 16393.91602 MB
Before interleave = 16393.91602 MB
After interleave = 16393.99414 MB
After matmul = 16393.99463 MB
Before local copies matmul = 16393.99463 MB
After local copies = 16393.99609 MB
fter compute chunk allocated = 16393.90820 MB
Memory after cuda sdpa 16393.916015625 MB
1
Memory before offload  16393.89453125 MB
Memory after offload  16393.89453125 MB
Memory before cuda sdpa 16393.908203125 MB
On entering CUDA sdpa main function  allocated = 16393.90820 MB
Before first SDPA allocated = 16393.90820 MB
On chunked entry = 16393.90820 MB
On scale calculation = 16393.91602 MB
Before interleave = 16393.91602 MB
After interleave = 16394.41602 MB
After matmul = 16402.54297 MB
Before local copies matmul = 16402.54297 MB
After local copies = 16402.54590 MB
After first SDPA allocated = 16402.03320 MB
After first copy allocated = 16402.03320 MB
On chunked entry = 16402.03320 MB
On scale calculation = 16402.04102 MB
Before interleave = 16402.04102 MB
After interleave = 16402.11914 MB
After matmul = 16402.11963 MB
Before local copies matmul = 16402.11963 MB
After local copies = 16402.12109 MB
fter compute chunk allocated = 16402.03320 MB
Memory after cuda sdpa 16402.041015625 MB
1
Memory before offload  16402.01953125 MB
Memory after offload  16402.01953125 MB
Memory before cuda sdpa 16402.033203125 MB
On entering CUDA sdpa main function  allocated = 16402.03320 MB
Before first SDPA allocated = 16402.03320 MB
On chunked entry = 16402.03320 MB
On scale calculation = 16402.04102 MB
Before interleave = 16402.04102 MB
After interleave = 16402.54102 MB
After matmul = 16410.66797 MB
Before local copies matmul = 16410.66797 MB
After local copies = 16410.67090 MB
After first SDPA allocated = 16410.15820 MB
After first copy allocated = 16410.15820 MB
On chunked entry = 16410.15820 MB
On scale calculation = 16410.16602 MB
Before interleave = 16410.16602 MB
After interleave = 16410.24414 MB
After matmul = 16410.24463 MB
Before local copies matmul = 16410.24463 MB
After local copies = 16410.24609 MB
fter compute chunk allocated = 16410.15820 MB
Memory after cuda sdpa 16410.166015625 MB
1
Memory before offload  16410.14453125 MB
Memory after offload  16410.14453125 MB
Memory before cuda sdpa 16410.158203125 MB
On entering CUDA sdpa main function  allocated = 16410.15820 MB
Before first SDPA allocated = 16410.15820 MB
On chunked entry = 16410.15820 MB
On scale calculation = 16410.16602 MB
Before interleave = 16410.16602 MB
After interleave = 16410.66602 MB
After matmul = 16418.79297 MB
Before local copies matmul = 16418.79297 MB
After local copies = 16418.79590 MB
After first SDPA allocated = 16418.28320 MB
After first copy allocated = 16418.28320 MB
On chunked entry = 16418.28320 MB
On scale calculation = 16418.29102 MB
Before interleave = 16418.29102 MB
After interleave = 16418.36914 MB
After matmul = 16418.36963 MB
Before local copies matmul = 16418.36963 MB
After local copies = 16418.37109 MB
fter compute chunk allocated = 16418.28320 MB
Memory after cuda sdpa 16418.291015625 MB
1
Memory before offload  16418.26953125 MB
Memory after offload  16418.26953125 MB
Memory before cuda sdpa 16418.283203125 MB
On entering CUDA sdpa main function  allocated = 16418.28320 MB
Before first SDPA allocated = 16418.28320 MB
On chunked entry = 16418.28320 MB
On scale calculation = 16418.29102 MB
Before interleave = 16418.29102 MB
After interleave = 16418.79102 MB
After matmul = 16426.91797 MB
Before local copies matmul = 16426.91797 MB
After local copies = 16426.92090 MB
After first SDPA allocated = 16426.40820 MB
After first copy allocated = 16426.40820 MB
On chunked entry = 16426.40820 MB
On scale calculation = 16426.41602 MB
Before interleave = 16426.41602 MB
After interleave = 16426.49414 MB
After matmul = 16426.49463 MB
Before local copies matmul = 16426.49463 MB
After local copies = 16426.49609 MB
fter compute chunk allocated = 16426.40820 MB
Memory after cuda sdpa 16426.416015625 MB
1
Memory before offload  16426.39453125 MB
Memory after offload  16426.39453125 MB
Memory before cuda sdpa 16426.408203125 MB
On entering CUDA sdpa main function  allocated = 16426.40820 MB
Before first SDPA allocated = 16426.40820 MB
On chunked entry = 16426.40820 MB
On scale calculation = 16426.41602 MB
Before interleave = 16426.41602 MB
After interleave = 16426.91602 MB
After matmul = 16435.04297 MB
Before local copies matmul = 16435.04297 MB
After local copies = 16435.04590 MB
After first SDPA allocated = 16434.53320 MB
After first copy allocated = 16434.53320 MB
On chunked entry = 16434.53320 MB
On scale calculation = 16434.54102 MB
Before interleave = 16434.54102 MB
After interleave = 16434.61914 MB
After matmul = 16434.61963 MB
Before local copies matmul = 16434.61963 MB
After local copies = 16434.62109 MB
fter compute chunk allocated = 16434.53320 MB
Memory after cuda sdpa 16434.541015625 MB
1
Memory before offload  16434.51953125 MB
Memory after offload  16434.51953125 MB
Memory before cuda sdpa 16434.533203125 MB
On entering CUDA sdpa main function  allocated = 16434.53320 MB
Before first SDPA allocated = 16434.53320 MB
On chunked entry = 16434.53320 MB
On scale calculation = 16434.54102 MB
Before interleave = 16434.54102 MB
After interleave = 16435.04102 MB
After matmul = 16443.16797 MB
Before local copies matmul = 16443.16797 MB
After local copies = 16443.17090 MB
After first SDPA allocated = 16442.65820 MB
After first copy allocated = 16442.65820 MB
On chunked entry = 16442.65820 MB
On scale calculation = 16442.66602 MB
Before interleave = 16442.66602 MB
After interleave = 16442.74414 MB
After matmul = 16442.74463 MB
Before local copies matmul = 16442.74463 MB
After local copies = 16442.74609 MB
fter compute chunk allocated = 16442.65820 MB
Memory after cuda sdpa 16442.666015625 MB
1
Memory before offload  16442.64453125 MB
Memory after offload  16442.64453125 MB
Memory before cuda sdpa 16442.658203125 MB
On entering CUDA sdpa main function  allocated = 16442.65820 MB
Before first SDPA allocated = 16442.65820 MB
On chunked entry = 16442.65820 MB
On scale calculation = 16442.66602 MB
Before interleave = 16442.66602 MB
After interleave = 16443.16602 MB
After matmul = 16451.29297 MB
Before local copies matmul = 16451.29297 MB
After local copies = 16451.29590 MB
After first SDPA allocated = 16450.78320 MB
After first copy allocated = 16450.78320 MB
On chunked entry = 16450.78320 MB
On scale calculation = 16450.79102 MB
Before interleave = 16450.79102 MB
After interleave = 16450.86914 MB
After matmul = 16450.86963 MB
Before local copies matmul = 16450.86963 MB
After local copies = 16450.87109 MB
fter compute chunk allocated = 16450.78320 MB
Memory after cuda sdpa 16450.791015625 MB
1
Memory before offload  16450.76953125 MB
Memory after offload  16450.76953125 MB
Memory before cuda sdpa 16450.783203125 MB
On entering CUDA sdpa main function  allocated = 16450.78320 MB
Before first SDPA allocated = 16450.78320 MB
On chunked entry = 16450.78320 MB
On scale calculation = 16450.79102 MB
Before interleave = 16450.79102 MB
After interleave = 16451.29102 MB
After matmul = 16459.41797 MB
Before local copies matmul = 16459.41797 MB
After local copies = 16459.42090 MB
After first SDPA allocated = 16458.90820 MB
After first copy allocated = 16458.90820 MB
On chunked entry = 16458.90820 MB
On scale calculation = 16458.91602 MB
Before interleave = 16458.91602 MB
After interleave = 16458.99414 MB
After matmul = 16458.99463 MB
Before local copies matmul = 16458.99463 MB
After local copies = 16458.99609 MB
fter compute chunk allocated = 16458.90820 MB
Memory after cuda sdpa 16458.916015625 MB
1
Memory before offload  16458.89453125 MB
Memory after offload  16458.89453125 MB
Memory before cuda sdpa 16458.908203125 MB
On entering CUDA sdpa main function  allocated = 16458.90820 MB
Before first SDPA allocated = 16458.90820 MB
On chunked entry = 16458.90820 MB
On scale calculation = 16458.91602 MB
Before interleave = 16458.91602 MB
After interleave = 16459.41602 MB
After matmul = 16467.54297 MB
Before local copies matmul = 16467.54297 MB
After local copies = 16467.54590 MB
After first SDPA allocated = 16467.03320 MB
After first copy allocated = 16467.03320 MB
On chunked entry = 16467.03320 MB
On scale calculation = 16467.04102 MB
Before interleave = 16467.04102 MB
After interleave = 16467.11914 MB
After matmul = 16467.11963 MB
Before local copies matmul = 16467.11963 MB
After local copies = 16467.12109 MB
fter compute chunk allocated = 16467.03320 MB
Memory after cuda sdpa 16467.041015625 MB
1
Memory before offload  16467.01953125 MB
Memory after offload  16467.01953125 MB
Memory before cuda sdpa 16467.033203125 MB
On entering CUDA sdpa main function  allocated = 16467.03320 MB
Before first SDPA allocated = 16467.03320 MB
On chunked entry = 16467.03320 MB
On scale calculation = 16467.04102 MB
Before interleave = 16467.04102 MB
After interleave = 16467.54102 MB
After matmul = 16475.66797 MB
Before local copies matmul = 16475.66797 MB
After local copies = 16475.67090 MB
After first SDPA allocated = 16475.15820 MB
After first copy allocated = 16475.15820 MB
On chunked entry = 16475.15820 MB
On scale calculation = 16475.16602 MB
Before interleave = 16475.16602 MB
After interleave = 16475.24414 MB
After matmul = 16475.24463 MB
Before local copies matmul = 16475.24463 MB
After local copies = 16475.24609 MB
fter compute chunk allocated = 16475.15820 MB
Memory after cuda sdpa 16475.166015625 MB
1
Memory before offload  16475.14453125 MB
Memory after offload  16475.14453125 MB
Memory before cuda sdpa 16475.158203125 MB
On entering CUDA sdpa main function  allocated = 16475.15820 MB
Before first SDPA allocated = 16475.15820 MB
On chunked entry = 16475.15820 MB
On scale calculation = 16475.16602 MB
Before interleave = 16475.16602 MB
After interleave = 16475.66602 MB
After matmul = 16483.79297 MB
Before local copies matmul = 16483.79297 MB
After local copies = 16483.79590 MB
After first SDPA allocated = 16483.28320 MB
After first copy allocated = 16483.28320 MB
On chunked entry = 16483.28320 MB
On scale calculation = 16483.29102 MB
Before interleave = 16483.29102 MB
After interleave = 16483.36914 MB
After matmul = 16483.36963 MB
Before local copies matmul = 16483.36963 MB
After local copies = 16483.37109 MB
fter compute chunk allocated = 16483.28320 MB
Memory after cuda sdpa 16483.291015625 MB
1
Memory before offload  16483.26953125 MB
Memory after offload  16483.26953125 MB
Memory before cuda sdpa 16483.283203125 MB
On entering CUDA sdpa main function  allocated = 16483.28320 MB
Before first SDPA allocated = 16483.28320 MB
On chunked entry = 16483.28320 MB
On scale calculation = 16483.29102 MB
Before interleave = 16483.29102 MB
After interleave = 16483.79102 MB
After matmul = 16491.91797 MB
Before local copies matmul = 16491.91797 MB
After local copies = 16491.92090 MB
After first SDPA allocated = 16491.40820 MB
After first copy allocated = 16491.40820 MB
On chunked entry = 16491.40820 MB
On scale calculation = 16491.41602 MB
Before interleave = 16491.41602 MB
After interleave = 16491.49414 MB
After matmul = 16491.49463 MB
Before local copies matmul = 16491.49463 MB
After local copies = 16491.49609 MB
fter compute chunk allocated = 16491.40820 MB
Memory after cuda sdpa 16491.416015625 MB
1
Memory before offload  16491.39453125 MB
Memory after offload  16491.39453125 MB
Memory before cuda sdpa 16491.408203125 MB
On entering CUDA sdpa main function  allocated = 16491.40820 MB
Before first SDPA allocated = 16491.40820 MB
On chunked entry = 16491.40820 MB
On scale calculation = 16491.41602 MB
Before interleave = 16491.41602 MB
After interleave = 16491.91602 MB
After matmul = 16500.04297 MB
Before local copies matmul = 16500.04297 MB
After local copies = 16500.04590 MB
After first SDPA allocated = 16499.53320 MB
After first copy allocated = 16499.53320 MB
On chunked entry = 16499.53320 MB
On scale calculation = 16499.54102 MB
Before interleave = 16499.54102 MB
After interleave = 16499.61914 MB
After matmul = 16499.61963 MB
Before local copies matmul = 16499.61963 MB
After local copies = 16499.62109 MB
fter compute chunk allocated = 16499.53320 MB
Memory after cuda sdpa 16499.541015625 MB
1
Memory before offload  16499.51953125 MB
Memory after offload  16499.51953125 MB
Memory before cuda sdpa 16499.533203125 MB
On entering CUDA sdpa main function  allocated = 16499.53320 MB
Before first SDPA allocated = 16499.53320 MB
On chunked entry = 16499.53320 MB
On scale calculation = 16499.54102 MB
Before interleave = 16499.54102 MB
After interleave = 16500.04102 MB
After matmul = 16508.16797 MB
Before local copies matmul = 16508.16797 MB
After local copies = 16508.17090 MB
After first SDPA allocated = 16507.65820 MB
After first copy allocated = 16507.65820 MB
On chunked entry = 16507.65820 MB
On scale calculation = 16507.66602 MB
Before interleave = 16507.66602 MB
After interleave = 16507.74414 MB
After matmul = 16507.74463 MB
Before local copies matmul = 16507.74463 MB
After local copies = 16507.74609 MB
fter compute chunk allocated = 16507.65820 MB
Memory after cuda sdpa 16507.666015625 MB
1
Memory before offload  16507.64453125 MB
Memory after offload  16507.64453125 MB
Memory before cuda sdpa 16507.658203125 MB
On entering CUDA sdpa main function  allocated = 16507.65820 MB
Before first SDPA allocated = 16507.65820 MB
On chunked entry = 16507.65820 MB
On scale calculation = 16507.66602 MB
Before interleave = 16507.66602 MB
After interleave = 16508.16602 MB
After matmul = 16516.29297 MB
Before local copies matmul = 16516.29297 MB
After local copies = 16516.29590 MB
After first SDPA allocated = 16515.78320 MB
After first copy allocated = 16515.78320 MB
On chunked entry = 16515.78320 MB
On scale calculation = 16515.79102 MB
Before interleave = 16515.79102 MB
After interleave = 16515.86914 MB
After matmul = 16515.86963 MB
Before local copies matmul = 16515.86963 MB
After local copies = 16515.87109 MB
fter compute chunk allocated = 16515.78320 MB
Memory after cuda sdpa 16515.791015625 MB
1
Memory before offload  16515.76953125 MB
Memory after offload  16515.76953125 MB
Memory before cuda sdpa 16515.783203125 MB
On entering CUDA sdpa main function  allocated = 16515.78320 MB
Before first SDPA allocated = 16515.78320 MB
On chunked entry = 16515.78320 MB
On scale calculation = 16515.79102 MB
Before interleave = 16515.79102 MB
After interleave = 16516.29102 MB
After matmul = 16524.41797 MB
Before local copies matmul = 16524.41797 MB
After local copies = 16524.42090 MB
After first SDPA allocated = 16523.90820 MB
After first copy allocated = 16523.90820 MB
On chunked entry = 16523.90820 MB
On scale calculation = 16523.91602 MB
Before interleave = 16523.91602 MB
After interleave = 16523.99414 MB
After matmul = 16523.99463 MB
Before local copies matmul = 16523.99463 MB
After local copies = 16523.99609 MB
fter compute chunk allocated = 16523.90820 MB
Memory after cuda sdpa 16523.916015625 MB
1
Memory before offload  16523.89453125 MB
Memory after offload  16523.89453125 MB
Memory before cuda sdpa 16523.908203125 MB
On entering CUDA sdpa main function  allocated = 16523.90820 MB
Before first SDPA allocated = 16523.90820 MB
On chunked entry = 16523.90820 MB
On scale calculation = 16523.91602 MB
Before interleave = 16523.91602 MB
After interleave = 16524.41602 MB
After matmul = 16532.54297 MB
Before local copies matmul = 16532.54297 MB
After local copies = 16532.54590 MB
After first SDPA allocated = 16532.03320 MB
After first copy allocated = 16532.03320 MB
On chunked entry = 16532.03320 MB
On scale calculation = 16532.04102 MB
Before interleave = 16532.04102 MB
After interleave = 16532.11914 MB
After matmul = 16532.11963 MB
Before local copies matmul = 16532.11963 MB
After local copies = 16532.12109 MB
fter compute chunk allocated = 16532.03320 MB
Memory after cuda sdpa 16532.041015625 MB
1
Memory before offload  16532.01953125 MB
Memory after offload  16532.01953125 MB
Memory before cuda sdpa 16532.033203125 MB
On entering CUDA sdpa main function  allocated = 16532.03320 MB
Before first SDPA allocated = 16532.03320 MB
On chunked entry = 16532.03320 MB
On scale calculation = 16532.04102 MB
Before interleave = 16532.04102 MB
After interleave = 16532.54102 MB
After matmul = 16540.66797 MB
Before local copies matmul = 16540.66797 MB
After local copies = 16540.67090 MB
After first SDPA allocated = 16540.15820 MB
After first copy allocated = 16540.15820 MB
On chunked entry = 16540.15820 MB
On scale calculation = 16540.16602 MB
Before interleave = 16540.16602 MB
After interleave = 16540.24414 MB
After matmul = 16540.24463 MB
Before local copies matmul = 16540.24463 MB
After local copies = 16540.24609 MB
fter compute chunk allocated = 16540.15820 MB
Memory after cuda sdpa 16540.166015625 MB
1
Memory before offload  16540.14453125 MB
Memory after offload  16540.14453125 MB
Memory before cuda sdpa 16540.158203125 MB
On entering CUDA sdpa main function  allocated = 16540.15820 MB
Before first SDPA allocated = 16540.15820 MB
On chunked entry = 16540.15820 MB
On scale calculation = 16540.16602 MB
Before interleave = 16540.16602 MB
After interleave = 16540.66602 MB
After matmul = 16548.79297 MB
Before local copies matmul = 16548.79297 MB
After local copies = 16548.79590 MB
After first SDPA allocated = 16548.28320 MB
After first copy allocated = 16548.28320 MB
On chunked entry = 16548.28320 MB
On scale calculation = 16548.29102 MB
Before interleave = 16548.29102 MB
After interleave = 16548.36914 MB
After matmul = 16548.36963 MB
Before local copies matmul = 16548.36963 MB
After local copies = 16548.37109 MB
fter compute chunk allocated = 16548.28320 MB
Memory after cuda sdpa 16548.291015625 MB
1
Memory before offload  16548.26953125 MB
Memory after offload  16548.26953125 MB
Memory before cuda sdpa 16548.283203125 MB
On entering CUDA sdpa main function  allocated = 16548.28320 MB
Before first SDPA allocated = 16548.28320 MB
On chunked entry = 16548.28320 MB
On scale calculation = 16548.29102 MB
Before interleave = 16548.29102 MB
After interleave = 16548.79102 MB
After matmul = 16556.91797 MB
Before local copies matmul = 16556.91797 MB
After local copies = 16556.92090 MB
After first SDPA allocated = 16556.40820 MB
After first copy allocated = 16556.40820 MB
On chunked entry = 16556.40820 MB
On scale calculation = 16556.41602 MB
Before interleave = 16556.41602 MB
After interleave = 16556.49414 MB
After matmul = 16556.49463 MB
Before local copies matmul = 16556.49463 MB
After local copies = 16556.49609 MB
fter compute chunk allocated = 16556.40820 MB
Memory after cuda sdpa 16556.416015625 MB
1
Memory before offload  16556.39453125 MB
Memory after offload  16556.39453125 MB
Memory before cuda sdpa 16556.408203125 MB
On entering CUDA sdpa main function  allocated = 16556.40820 MB
Before first SDPA allocated = 16556.40820 MB
On chunked entry = 16556.40820 MB
On scale calculation = 16556.41602 MB
Before interleave = 16556.41602 MB
After interleave = 16556.91602 MB
After matmul = 16565.04297 MB
Before local copies matmul = 16565.04297 MB
After local copies = 16565.04590 MB
After first SDPA allocated = 16564.53320 MB
After first copy allocated = 16564.53320 MB
On chunked entry = 16564.53320 MB
On scale calculation = 16564.54102 MB
Before interleave = 16564.54102 MB
After interleave = 16564.61914 MB
After matmul = 16564.61963 MB
Before local copies matmul = 16564.61963 MB
After local copies = 16564.62109 MB
fter compute chunk allocated = 16564.53320 MB
Memory after cuda sdpa 16564.541015625 MB
1
Memory before offload  16564.51953125 MB
Memory after offload  16564.51953125 MB
Memory before cuda sdpa 16564.533203125 MB
On entering CUDA sdpa main function  allocated = 16564.53320 MB
Before first SDPA allocated = 16564.53320 MB
On chunked entry = 16564.53320 MB
On scale calculation = 16564.54102 MB
Before interleave = 16564.54102 MB
After interleave = 16565.04102 MB
After matmul = 16573.16797 MB
Before local copies matmul = 16573.16797 MB
After local copies = 16573.17090 MB
After first SDPA allocated = 16572.65820 MB
After first copy allocated = 16572.65820 MB
On chunked entry = 16572.65820 MB
On scale calculation = 16572.66602 MB
Before interleave = 16572.66602 MB
After interleave = 16572.74414 MB
After matmul = 16572.74463 MB
Before local copies matmul = 16572.74463 MB
After local copies = 16572.74609 MB
fter compute chunk allocated = 16572.65820 MB
Memory after cuda sdpa 16572.666015625 MB
1
Memory before offload  16572.64453125 MB
Memory after offload  16572.64453125 MB
Memory before cuda sdpa 16572.658203125 MB
On entering CUDA sdpa main function  allocated = 16572.65820 MB
Before first SDPA allocated = 16572.65820 MB
On chunked entry = 16572.65820 MB
On scale calculation = 16572.66602 MB
Before interleave = 16572.66602 MB
After interleave = 16573.16602 MB
After matmul = 16581.29297 MB
Before local copies matmul = 16581.29297 MB
After local copies = 16581.29590 MB
After first SDPA allocated = 16580.78320 MB
After first copy allocated = 16580.78320 MB
On chunked entry = 16580.78320 MB
On scale calculation = 16580.79102 MB
Before interleave = 16580.79102 MB
After interleave = 16580.86914 MB
After matmul = 16580.86963 MB
Before local copies matmul = 16580.86963 MB
After local copies = 16580.87109 MB
fter compute chunk allocated = 16580.78320 MB
Memory after cuda sdpa 16580.791015625 MB
1
Memory before offload  16580.76953125 MB
Memory after offload  16580.76953125 MB
Memory before cuda sdpa 16580.783203125 MB
On entering CUDA sdpa main function  allocated = 16580.78320 MB
Before first SDPA allocated = 16580.78320 MB
On chunked entry = 16580.78320 MB
On scale calculation = 16580.79102 MB
Before interleave = 16580.79102 MB
After interleave = 16581.29102 MB
After matmul = 16589.41797 MB
Before local copies matmul = 16589.41797 MB
After local copies = 16589.42090 MB
After first SDPA allocated = 16588.90820 MB
After first copy allocated = 16588.90820 MB
On chunked entry = 16588.90820 MB
On scale calculation = 16588.91602 MB
Before interleave = 16588.91602 MB
After interleave = 16588.99414 MB
After matmul = 16588.99463 MB
Before local copies matmul = 16588.99463 MB
After local copies = 16588.99609 MB
fter compute chunk allocated = 16588.90820 MB
Memory after cuda sdpa 16588.916015625 MB
1
Memory before offload  16588.89453125 MB
Memory after offload  16588.89453125 MB
Memory before cuda sdpa 16588.908203125 MB
On entering CUDA sdpa main function  allocated = 16588.90820 MB
Before first SDPA allocated = 16588.90820 MB
On chunked entry = 16588.90820 MB
On scale calculation = 16588.91602 MB
Before interleave = 16588.91602 MB
After interleave = 16589.41602 MB
After matmul = 16597.54297 MB
Before local copies matmul = 16597.54297 MB
After local copies = 16597.54590 MB
After first SDPA allocated = 16597.03320 MB
After first copy allocated = 16597.03320 MB
On chunked entry = 16597.03320 MB
On scale calculation = 16597.04102 MB
Before interleave = 16597.04102 MB
After interleave = 16597.11914 MB
After matmul = 16597.11963 MB
Before local copies matmul = 16597.11963 MB
After local copies = 16597.12109 MB
fter compute chunk allocated = 16597.03320 MB
Memory after cuda sdpa 16597.041015625 MB
1
Memory before offload  16597.01953125 MB
Memory after offload  16597.01953125 MB
Memory before cuda sdpa 16597.033203125 MB
On entering CUDA sdpa main function  allocated = 16597.03320 MB
Before first SDPA allocated = 16597.03320 MB
On chunked entry = 16597.03320 MB
On scale calculation = 16597.04102 MB
Before interleave = 16597.04102 MB
After interleave = 16597.54102 MB
After matmul = 16605.66797 MB
Before local copies matmul = 16605.66797 MB
After local copies = 16605.67090 MB
After first SDPA allocated = 16605.15820 MB
After first copy allocated = 16605.15820 MB
On chunked entry = 16605.15820 MB
On scale calculation = 16605.16602 MB
Before interleave = 16605.16602 MB
After interleave = 16605.24414 MB
After matmul = 16605.24463 MB
Before local copies matmul = 16605.24463 MB
After local copies = 16605.24609 MB
fter compute chunk allocated = 16605.15820 MB
Memory after cuda sdpa 16605.166015625 MB
1
Memory before offload  16605.14453125 MB
Memory after offload  16605.14453125 MB
Memory before cuda sdpa 16605.158203125 MB
On entering CUDA sdpa main function  allocated = 16605.15820 MB
Before first SDPA allocated = 16605.15820 MB
On chunked entry = 16605.15820 MB
On scale calculation = 16605.16602 MB
Before interleave = 16605.16602 MB
After interleave = 16605.66602 MB
After matmul = 16613.79297 MB
Before local copies matmul = 16613.79297 MB
After local copies = 16613.79590 MB
After first SDPA allocated = 16613.28320 MB
After first copy allocated = 16613.28320 MB
On chunked entry = 16613.28320 MB
On scale calculation = 16613.29102 MB
Before interleave = 16613.29102 MB
After interleave = 16613.36914 MB
After matmul = 16613.36963 MB
Before local copies matmul = 16613.36963 MB
After local copies = 16613.37109 MB
fter compute chunk allocated = 16613.28320 MB
Memory after cuda sdpa 16613.291015625 MB
1
Memory before offload  16613.26953125 MB
Memory after offload  16613.26953125 MB
Memory before cuda sdpa 16613.283203125 MB
On entering CUDA sdpa main function  allocated = 16613.28320 MB
Before first SDPA allocated = 16613.28320 MB
On chunked entry = 16613.28320 MB
On scale calculation = 16613.29102 MB
Before interleave = 16613.29102 MB
After interleave = 16613.79102 MB
After matmul = 16621.91797 MB
Before local copies matmul = 16621.91797 MB
After local copies = 16621.92090 MB
After first SDPA allocated = 16621.40820 MB
After first copy allocated = 16621.40820 MB
On chunked entry = 16621.40820 MB
On scale calculation = 16621.41602 MB
Before interleave = 16621.41602 MB
After interleave = 16621.49414 MB
After matmul = 16621.49463 MB
Before local copies matmul = 16621.49463 MB
After local copies = 16621.49609 MB
fter compute chunk allocated = 16621.40820 MB
Memory after cuda sdpa 16621.416015625 MB
1
Memory before offload  16621.39453125 MB
Memory after offload  16621.39453125 MB
Memory before cuda sdpa 16621.408203125 MB
On entering CUDA sdpa main function  allocated = 16621.40820 MB
Before first SDPA allocated = 16621.40820 MB
On chunked entry = 16621.40820 MB
On scale calculation = 16621.41602 MB
Before interleave = 16621.41602 MB
After interleave = 16621.91602 MB
After matmul = 16630.04297 MB
Before local copies matmul = 16630.04297 MB
After local copies = 16630.04590 MB
After first SDPA allocated = 16629.53320 MB
After first copy allocated = 16629.53320 MB
On chunked entry = 16629.53320 MB
On scale calculation = 16629.54102 MB
Before interleave = 16629.54102 MB
After interleave = 16629.61914 MB
After matmul = 16629.61963 MB
Before local copies matmul = 16629.61963 MB
After local copies = 16629.62109 MB
fter compute chunk allocated = 16629.53320 MB
Memory after cuda sdpa 16629.541015625 MB
1
Memory before offload  16629.51953125 MB
Memory after offload  16629.51953125 MB
Memory before cuda sdpa 16629.533203125 MB
On entering CUDA sdpa main function  allocated = 16629.53320 MB
Before first SDPA allocated = 16629.53320 MB
On chunked entry = 16629.53320 MB
On scale calculation = 16629.54102 MB
Before interleave = 16629.54102 MB
After interleave = 16630.04102 MB
After matmul = 16638.16797 MB
Before local copies matmul = 16638.16797 MB
After local copies = 16638.17090 MB
After first SDPA allocated = 16637.65820 MB
After first copy allocated = 16637.65820 MB
On chunked entry = 16637.65820 MB
On scale calculation = 16637.66602 MB
Before interleave = 16637.66602 MB
After interleave = 16637.74414 MB
After matmul = 16637.74463 MB
Before local copies matmul = 16637.74463 MB
After local copies = 16637.74609 MB
fter compute chunk allocated = 16637.65820 MB
Memory after cuda sdpa 16637.666015625 MB
1
Memory before offload  16637.64453125 MB
Memory after offload  16637.64453125 MB
Memory before cuda sdpa 16637.658203125 MB
On entering CUDA sdpa main function  allocated = 16637.65820 MB
Before first SDPA allocated = 16637.65820 MB
On chunked entry = 16637.65820 MB
On scale calculation = 16637.66602 MB
Before interleave = 16637.66602 MB
After interleave = 16638.16602 MB
After matmul = 16646.29297 MB
Before local copies matmul = 16646.29297 MB
After local copies = 16646.29590 MB
After first SDPA allocated = 16645.78320 MB
After first copy allocated = 16645.78320 MB
On chunked entry = 16645.78320 MB
On scale calculation = 16645.79102 MB
Before interleave = 16645.79102 MB
After interleave = 16645.86914 MB
After matmul = 16645.86963 MB
Before local copies matmul = 16645.86963 MB
After local copies = 16645.87109 MB
fter compute chunk allocated = 16645.78320 MB
Memory after cuda sdpa 16645.791015625 MB
Decode step 6
1
Memory before offload  16645.77001953125 MB
Memory after offload  16645.77001953125 MB
Memory before cuda sdpa 16645.78369140625 MB
On entering CUDA sdpa main function  allocated = 16645.78369 MB
Before first SDPA allocated = 16645.78369 MB
On chunked entry = 16645.78369 MB
On scale calculation = 16645.79150 MB
Before interleave = 16645.79150 MB
After interleave = 16646.29150 MB
After matmul = 16654.41846 MB
Before local copies matmul = 16654.41846 MB
After local copies = 16654.42139 MB
After first SDPA allocated = 16653.90869 MB
After first copy allocated = 16653.90869 MB
On chunked entry = 16653.90869 MB
On scale calculation = 16653.91650 MB
Before interleave = 16653.91650 MB
After interleave = 16654.01025 MB
After matmul = 16654.01074 MB
Before local copies matmul = 16654.01074 MB
After local copies = 16654.01221 MB
fter compute chunk allocated = 16653.90869 MB
Memory after cuda sdpa 16653.91650390625 MB
1
Memory before offload  16653.89501953125 MB
Memory after offload  16653.89501953125 MB
Memory before cuda sdpa 16653.90869140625 MB
On entering CUDA sdpa main function  allocated = 16653.90869 MB
Before first SDPA allocated = 16653.90869 MB
On chunked entry = 16653.90869 MB
On scale calculation = 16653.91650 MB
Before interleave = 16653.91650 MB
After interleave = 16654.41650 MB
After matmul = 16662.54346 MB
Before local copies matmul = 16662.54346 MB
After local copies = 16662.54639 MB
After first SDPA allocated = 16662.03369 MB
After first copy allocated = 16662.03369 MB
On chunked entry = 16662.03369 MB
On scale calculation = 16662.04150 MB
Before interleave = 16662.04150 MB
After interleave = 16662.13525 MB
After matmul = 16662.13574 MB
Before local copies matmul = 16662.13574 MB
After local copies = 16662.13721 MB
fter compute chunk allocated = 16662.03369 MB
Memory after cuda sdpa 16662.04150390625 MB
1
Memory before offload  16662.02001953125 MB
Memory after offload  16662.02001953125 MB
Memory before cuda sdpa 16662.03369140625 MB
On entering CUDA sdpa main function  allocated = 16662.03369 MB
Before first SDPA allocated = 16662.03369 MB
On chunked entry = 16662.03369 MB
On scale calculation = 16662.04150 MB
Before interleave = 16662.04150 MB
After interleave = 16662.54150 MB
After matmul = 16670.66846 MB
Before local copies matmul = 16670.66846 MB
After local copies = 16670.67139 MB
After first SDPA allocated = 16670.15869 MB
After first copy allocated = 16670.15869 MB
On chunked entry = 16670.15869 MB
On scale calculation = 16670.16650 MB
Before interleave = 16670.16650 MB
After interleave = 16670.26025 MB
After matmul = 16670.26074 MB
Before local copies matmul = 16670.26074 MB
After local copies = 16670.26221 MB
fter compute chunk allocated = 16670.15869 MB
Memory after cuda sdpa 16670.16650390625 MB
1
Memory before offload  16670.14501953125 MB
Memory after offload  16670.14501953125 MB
Memory before cuda sdpa 16670.15869140625 MB
On entering CUDA sdpa main function  allocated = 16670.15869 MB
Before first SDPA allocated = 16670.15869 MB
On chunked entry = 16670.15869 MB
On scale calculation = 16670.16650 MB
Before interleave = 16670.16650 MB
After interleave = 16670.66650 MB
After matmul = 16678.79346 MB
Before local copies matmul = 16678.79346 MB
After local copies = 16678.79639 MB
After first SDPA allocated = 16678.28369 MB
After first copy allocated = 16678.28369 MB
On chunked entry = 16678.28369 MB
On scale calculation = 16678.29150 MB
Before interleave = 16678.29150 MB
After interleave = 16678.38525 MB
After matmul = 16678.38574 MB
Before local copies matmul = 16678.38574 MB
After local copies = 16678.38721 MB
fter compute chunk allocated = 16678.28369 MB
Memory after cuda sdpa 16678.29150390625 MB
1
Memory before offload  16678.27001953125 MB
Memory after offload  16678.27001953125 MB
Memory before cuda sdpa 16678.28369140625 MB
On entering CUDA sdpa main function  allocated = 16678.28369 MB
Before first SDPA allocated = 16678.28369 MB
On chunked entry = 16678.28369 MB
On scale calculation = 16678.29150 MB
Before interleave = 16678.29150 MB
After interleave = 16678.79150 MB
After matmul = 16686.91846 MB
Before local copies matmul = 16686.91846 MB
After local copies = 16686.92139 MB
After first SDPA allocated = 16686.40869 MB
After first copy allocated = 16686.40869 MB
On chunked entry = 16686.40869 MB
On scale calculation = 16686.41650 MB
Before interleave = 16686.41650 MB
After interleave = 16686.51025 MB
After matmul = 16686.51074 MB
Before local copies matmul = 16686.51074 MB
After local copies = 16686.51221 MB
fter compute chunk allocated = 16686.40869 MB
Memory after cuda sdpa 16686.41650390625 MB
1
Memory before offload  16686.39501953125 MB
Memory after offload  16686.39501953125 MB
Memory before cuda sdpa 16686.40869140625 MB
On entering CUDA sdpa main function  allocated = 16686.40869 MB
Before first SDPA allocated = 16686.40869 MB
On chunked entry = 16686.40869 MB
On scale calculation = 16686.41650 MB
Before interleave = 16686.41650 MB
After interleave = 16686.91650 MB
After matmul = 16695.04346 MB
Before local copies matmul = 16695.04346 MB
After local copies = 16695.04639 MB
After first SDPA allocated = 16694.53369 MB
After first copy allocated = 16694.53369 MB
On chunked entry = 16694.53369 MB
On scale calculation = 16694.54150 MB
Before interleave = 16694.54150 MB
After interleave = 16694.63525 MB
After matmul = 16694.63574 MB
Before local copies matmul = 16694.63574 MB
After local copies = 16694.63721 MB
fter compute chunk allocated = 16694.53369 MB
Memory after cuda sdpa 16694.54150390625 MB
1
Memory before offload  16694.52001953125 MB
Memory after offload  16694.52001953125 MB
Memory before cuda sdpa 16694.53369140625 MB
On entering CUDA sdpa main function  allocated = 16694.53369 MB
Before first SDPA allocated = 16694.53369 MB
On chunked entry = 16694.53369 MB
On scale calculation = 16694.54150 MB
Before interleave = 16694.54150 MB
After interleave = 16695.04150 MB
After matmul = 16703.16846 MB
Before local copies matmul = 16703.16846 MB
After local copies = 16703.17139 MB
After first SDPA allocated = 16702.65869 MB
After first copy allocated = 16702.65869 MB
On chunked entry = 16702.65869 MB
On scale calculation = 16702.66650 MB
Before interleave = 16702.66650 MB
After interleave = 16702.76025 MB
After matmul = 16702.76074 MB
Before local copies matmul = 16702.76074 MB
After local copies = 16702.76221 MB
fter compute chunk allocated = 16702.65869 MB
Memory after cuda sdpa 16702.66650390625 MB
1
Memory before offload  16702.64501953125 MB
Memory after offload  16702.64501953125 MB
Memory before cuda sdpa 16702.65869140625 MB
On entering CUDA sdpa main function  allocated = 16702.65869 MB
Before first SDPA allocated = 16702.65869 MB
On chunked entry = 16702.65869 MB
On scale calculation = 16702.66650 MB
Before interleave = 16702.66650 MB
After interleave = 16703.16650 MB
After matmul = 16711.29346 MB
Before local copies matmul = 16711.29346 MB
After local copies = 16711.29639 MB
After first SDPA allocated = 16710.78369 MB
After first copy allocated = 16710.78369 MB
On chunked entry = 16710.78369 MB
On scale calculation = 16710.79150 MB
Before interleave = 16710.79150 MB
After interleave = 16710.88525 MB
After matmul = 16710.88574 MB
Before local copies matmul = 16710.88574 MB
After local copies = 16710.88721 MB
fter compute chunk allocated = 16710.78369 MB
Memory after cuda sdpa 16710.79150390625 MB
1
Memory before offload  16710.77001953125 MB
Memory after offload  16710.77001953125 MB
Memory before cuda sdpa 16710.78369140625 MB
On entering CUDA sdpa main function  allocated = 16710.78369 MB
Before first SDPA allocated = 16710.78369 MB
On chunked entry = 16710.78369 MB
On scale calculation = 16710.79150 MB
Before interleave = 16710.79150 MB
After interleave = 16711.29150 MB
After matmul = 16719.41846 MB
Before local copies matmul = 16719.41846 MB
After local copies = 16719.42139 MB
After first SDPA allocated = 16718.90869 MB
After first copy allocated = 16718.90869 MB
On chunked entry = 16718.90869 MB
On scale calculation = 16718.91650 MB
Before interleave = 16718.91650 MB
After interleave = 16719.01025 MB
After matmul = 16719.01074 MB
Before local copies matmul = 16719.01074 MB
After local copies = 16719.01221 MB
fter compute chunk allocated = 16718.90869 MB
Memory after cuda sdpa 16718.91650390625 MB
1
Memory before offload  16718.89501953125 MB
Memory after offload  16718.89501953125 MB
Memory before cuda sdpa 16718.90869140625 MB
On entering CUDA sdpa main function  allocated = 16718.90869 MB
Before first SDPA allocated = 16718.90869 MB
On chunked entry = 16718.90869 MB
On scale calculation = 16718.91650 MB
Before interleave = 16718.91650 MB
After interleave = 16719.41650 MB
After matmul = 16727.54346 MB
Before local copies matmul = 16727.54346 MB
After local copies = 16727.54639 MB
After first SDPA allocated = 16727.03369 MB
After first copy allocated = 16727.03369 MB
On chunked entry = 16727.03369 MB
On scale calculation = 16727.04150 MB
Before interleave = 16727.04150 MB
After interleave = 16727.13525 MB
After matmul = 16727.13574 MB
Before local copies matmul = 16727.13574 MB
After local copies = 16727.13721 MB
fter compute chunk allocated = 16727.03369 MB
Memory after cuda sdpa 16727.04150390625 MB
1
Memory before offload  16727.02001953125 MB
Memory after offload  16727.02001953125 MB
Memory before cuda sdpa 16727.03369140625 MB
On entering CUDA sdpa main function  allocated = 16727.03369 MB
Before first SDPA allocated = 16727.03369 MB
On chunked entry = 16727.03369 MB
On scale calculation = 16727.04150 MB
Before interleave = 16727.04150 MB
After interleave = 16727.54150 MB
After matmul = 16735.66846 MB
Before local copies matmul = 16735.66846 MB
After local copies = 16735.67139 MB
After first SDPA allocated = 16735.15869 MB
After first copy allocated = 16735.15869 MB
On chunked entry = 16735.15869 MB
On scale calculation = 16735.16650 MB
Before interleave = 16735.16650 MB
After interleave = 16735.26025 MB
After matmul = 16735.26074 MB
Before local copies matmul = 16735.26074 MB
After local copies = 16735.26221 MB
fter compute chunk allocated = 16735.15869 MB
Memory after cuda sdpa 16735.16650390625 MB
1
Memory before offload  16735.14501953125 MB
Memory after offload  16735.14501953125 MB
Memory before cuda sdpa 16735.15869140625 MB
On entering CUDA sdpa main function  allocated = 16735.15869 MB
Before first SDPA allocated = 16735.15869 MB
On chunked entry = 16735.15869 MB
On scale calculation = 16735.16650 MB
Before interleave = 16735.16650 MB
After interleave = 16735.66650 MB
After matmul = 16743.79346 MB
Before local copies matmul = 16743.79346 MB
After local copies = 16743.79639 MB
After first SDPA allocated = 16743.28369 MB
After first copy allocated = 16743.28369 MB
On chunked entry = 16743.28369 MB
On scale calculation = 16743.29150 MB
Before interleave = 16743.29150 MB
After interleave = 16743.38525 MB
After matmul = 16743.38574 MB
Before local copies matmul = 16743.38574 MB
After local copies = 16743.38721 MB
fter compute chunk allocated = 16743.28369 MB
Memory after cuda sdpa 16743.29150390625 MB
1
Memory before offload  16743.27001953125 MB
Memory after offload  16743.27001953125 MB
Memory before cuda sdpa 16743.28369140625 MB
On entering CUDA sdpa main function  allocated = 16743.28369 MB
Before first SDPA allocated = 16743.28369 MB
On chunked entry = 16743.28369 MB
On scale calculation = 16743.29150 MB
Before interleave = 16743.29150 MB
After interleave = 16743.79150 MB
After matmul = 16751.91846 MB
Before local copies matmul = 16751.91846 MB
After local copies = 16751.92139 MB
After first SDPA allocated = 16751.40869 MB
After first copy allocated = 16751.40869 MB
On chunked entry = 16751.40869 MB
On scale calculation = 16751.41650 MB
Before interleave = 16751.41650 MB
After interleave = 16751.51025 MB
After matmul = 16751.51074 MB
Before local copies matmul = 16751.51074 MB
After local copies = 16751.51221 MB
fter compute chunk allocated = 16751.40869 MB
Memory after cuda sdpa 16751.41650390625 MB
1
Memory before offload  16751.39501953125 MB
Memory after offload  16751.39501953125 MB
Memory before cuda sdpa 16751.40869140625 MB
On entering CUDA sdpa main function  allocated = 16751.40869 MB
Before first SDPA allocated = 16751.40869 MB
On chunked entry = 16751.40869 MB
On scale calculation = 16751.41650 MB
Before interleave = 16751.41650 MB
After interleave = 16751.91650 MB
After matmul = 16760.04346 MB
Before local copies matmul = 16760.04346 MB
After local copies = 16760.04639 MB
After first SDPA allocated = 16759.53369 MB
After first copy allocated = 16759.53369 MB
On chunked entry = 16759.53369 MB
On scale calculation = 16759.54150 MB
Before interleave = 16759.54150 MB
After interleave = 16759.63525 MB
After matmul = 16759.63574 MB
Before local copies matmul = 16759.63574 MB
After local copies = 16759.63721 MB
fter compute chunk allocated = 16759.53369 MB
Memory after cuda sdpa 16759.54150390625 MB
1
Memory before offload  16759.52001953125 MB
Memory after offload  16759.52001953125 MB
Memory before cuda sdpa 16759.53369140625 MB
On entering CUDA sdpa main function  allocated = 16759.53369 MB
Before first SDPA allocated = 16759.53369 MB
On chunked entry = 16759.53369 MB
On scale calculation = 16759.54150 MB
Before interleave = 16759.54150 MB
After interleave = 16760.04150 MB
After matmul = 16768.16846 MB
Before local copies matmul = 16768.16846 MB
After local copies = 16768.17139 MB
After first SDPA allocated = 16767.65869 MB
After first copy allocated = 16767.65869 MB
On chunked entry = 16767.65869 MB
On scale calculation = 16767.66650 MB
Before interleave = 16767.66650 MB
After interleave = 16767.76025 MB
After matmul = 16767.76074 MB
Before local copies matmul = 16767.76074 MB
After local copies = 16767.76221 MB
fter compute chunk allocated = 16767.65869 MB
Memory after cuda sdpa 16767.66650390625 MB
1
Memory before offload  16767.64501953125 MB
Memory after offload  16767.64501953125 MB
Memory before cuda sdpa 16767.65869140625 MB
On entering CUDA sdpa main function  allocated = 16767.65869 MB
Before first SDPA allocated = 16767.65869 MB
On chunked entry = 16767.65869 MB
On scale calculation = 16767.66650 MB
Before interleave = 16767.66650 MB
After interleave = 16768.16650 MB
After matmul = 16776.29346 MB
Before local copies matmul = 16776.29346 MB
After local copies = 16776.29639 MB
After first SDPA allocated = 16775.78369 MB
After first copy allocated = 16775.78369 MB
On chunked entry = 16775.78369 MB
On scale calculation = 16775.79150 MB
Before interleave = 16775.79150 MB
After interleave = 16775.88525 MB
After matmul = 16775.88574 MB
Before local copies matmul = 16775.88574 MB
After local copies = 16775.88721 MB
fter compute chunk allocated = 16775.78369 MB
Memory after cuda sdpa 16775.79150390625 MB
1
Memory before offload  16775.77001953125 MB
Memory after offload  16775.77001953125 MB
Memory before cuda sdpa 16775.78369140625 MB
On entering CUDA sdpa main function  allocated = 16775.78369 MB
Before first SDPA allocated = 16775.78369 MB
On chunked entry = 16775.78369 MB
On scale calculation = 16775.79150 MB
Before interleave = 16775.79150 MB
After interleave = 16776.29150 MB
After matmul = 16784.41846 MB
Before local copies matmul = 16784.41846 MB
After local copies = 16784.42139 MB
After first SDPA allocated = 16783.90869 MB
After first copy allocated = 16783.90869 MB
On chunked entry = 16783.90869 MB
On scale calculation = 16783.91650 MB
Before interleave = 16783.91650 MB
After interleave = 16784.01025 MB
After matmul = 16784.01074 MB
Before local copies matmul = 16784.01074 MB
After local copies = 16784.01221 MB
fter compute chunk allocated = 16783.90869 MB
Memory after cuda sdpa 16783.91650390625 MB
1
Memory before offload  16783.89501953125 MB
Memory after offload  16783.89501953125 MB
Memory before cuda sdpa 16783.90869140625 MB
On entering CUDA sdpa main function  allocated = 16783.90869 MB
Before first SDPA allocated = 16783.90869 MB
On chunked entry = 16783.90869 MB
On scale calculation = 16783.91650 MB
Before interleave = 16783.91650 MB
After interleave = 16784.41650 MB
After matmul = 16792.54346 MB
Before local copies matmul = 16792.54346 MB
After local copies = 16792.54639 MB
After first SDPA allocated = 16792.03369 MB
After first copy allocated = 16792.03369 MB
On chunked entry = 16792.03369 MB
On scale calculation = 16792.04150 MB
Before interleave = 16792.04150 MB
After interleave = 16792.13525 MB
After matmul = 16792.13574 MB
Before local copies matmul = 16792.13574 MB
After local copies = 16792.13721 MB
fter compute chunk allocated = 16792.03369 MB
Memory after cuda sdpa 16792.04150390625 MB
1
Memory before offload  16792.02001953125 MB
Memory after offload  16792.02001953125 MB
Memory before cuda sdpa 16792.03369140625 MB
On entering CUDA sdpa main function  allocated = 16792.03369 MB
Before first SDPA allocated = 16792.03369 MB
On chunked entry = 16792.03369 MB
On scale calculation = 16792.04150 MB
Before interleave = 16792.04150 MB
After interleave = 16792.54150 MB
After matmul = 16800.66846 MB
Before local copies matmul = 16800.66846 MB
After local copies = 16800.67139 MB
After first SDPA allocated = 16800.15869 MB
After first copy allocated = 16800.15869 MB
On chunked entry = 16800.15869 MB
On scale calculation = 16800.16650 MB
Before interleave = 16800.16650 MB
After interleave = 16800.26025 MB
After matmul = 16800.26074 MB
Before local copies matmul = 16800.26074 MB
After local copies = 16800.26221 MB
fter compute chunk allocated = 16800.15869 MB
Memory after cuda sdpa 16800.16650390625 MB
1
Memory before offload  16800.14501953125 MB
Memory after offload  16800.14501953125 MB
Memory before cuda sdpa 16800.15869140625 MB
On entering CUDA sdpa main function  allocated = 16800.15869 MB
Before first SDPA allocated = 16800.15869 MB
On chunked entry = 16800.15869 MB
On scale calculation = 16800.16650 MB
Before interleave = 16800.16650 MB
After interleave = 16800.66650 MB
After matmul = 16808.79346 MB
Before local copies matmul = 16808.79346 MB
After local copies = 16808.79639 MB
After first SDPA allocated = 16808.28369 MB
After first copy allocated = 16808.28369 MB
On chunked entry = 16808.28369 MB
On scale calculation = 16808.29150 MB
Before interleave = 16808.29150 MB
After interleave = 16808.38525 MB
After matmul = 16808.38574 MB
Before local copies matmul = 16808.38574 MB
After local copies = 16808.38721 MB
fter compute chunk allocated = 16808.28369 MB
Memory after cuda sdpa 16808.29150390625 MB
1
Memory before offload  16808.27001953125 MB
Memory after offload  16808.27001953125 MB
Memory before cuda sdpa 16808.28369140625 MB
On entering CUDA sdpa main function  allocated = 16808.28369 MB
Before first SDPA allocated = 16808.28369 MB
On chunked entry = 16808.28369 MB
On scale calculation = 16808.29150 MB
Before interleave = 16808.29150 MB
After interleave = 16808.79150 MB
After matmul = 16816.91846 MB
Before local copies matmul = 16816.91846 MB
After local copies = 16816.92139 MB
After first SDPA allocated = 16816.40869 MB
After first copy allocated = 16816.40869 MB
On chunked entry = 16816.40869 MB
On scale calculation = 16816.41650 MB
Before interleave = 16816.41650 MB
After interleave = 16816.51025 MB
After matmul = 16816.51074 MB
Before local copies matmul = 16816.51074 MB
After local copies = 16816.51221 MB
fter compute chunk allocated = 16816.40869 MB
Memory after cuda sdpa 16816.41650390625 MB
1
Memory before offload  16816.39501953125 MB
Memory after offload  16816.39501953125 MB
Memory before cuda sdpa 16816.40869140625 MB
On entering CUDA sdpa main function  allocated = 16816.40869 MB
Before first SDPA allocated = 16816.40869 MB
On chunked entry = 16816.40869 MB
On scale calculation = 16816.41650 MB
Before interleave = 16816.41650 MB
After interleave = 16816.91650 MB
After matmul = 16825.04346 MB
Before local copies matmul = 16825.04346 MB
After local copies = 16825.04639 MB
After first SDPA allocated = 16824.53369 MB
After first copy allocated = 16824.53369 MB
On chunked entry = 16824.53369 MB
On scale calculation = 16824.54150 MB
Before interleave = 16824.54150 MB
After interleave = 16824.63525 MB
After matmul = 16824.63574 MB
Before local copies matmul = 16824.63574 MB
After local copies = 16824.63721 MB
fter compute chunk allocated = 16824.53369 MB
Memory after cuda sdpa 16824.54150390625 MB
1
Memory before offload  16824.52001953125 MB
Memory after offload  16824.52001953125 MB
Memory before cuda sdpa 16824.53369140625 MB
On entering CUDA sdpa main function  allocated = 16824.53369 MB
Before first SDPA allocated = 16824.53369 MB
On chunked entry = 16824.53369 MB
On scale calculation = 16824.54150 MB
Before interleave = 16824.54150 MB
After interleave = 16825.04150 MB
After matmul = 16833.16846 MB
Before local copies matmul = 16833.16846 MB
After local copies = 16833.17139 MB
After first SDPA allocated = 16832.65869 MB
After first copy allocated = 16832.65869 MB
On chunked entry = 16832.65869 MB
On scale calculation = 16832.66650 MB
Before interleave = 16832.66650 MB
After interleave = 16832.76025 MB
After matmul = 16832.76074 MB
Before local copies matmul = 16832.76074 MB
After local copies = 16832.76221 MB
fter compute chunk allocated = 16832.65869 MB
Memory after cuda sdpa 16832.66650390625 MB
1
Memory before offload  16832.64501953125 MB
Memory after offload  16832.64501953125 MB
Memory before cuda sdpa 16832.65869140625 MB
On entering CUDA sdpa main function  allocated = 16832.65869 MB
Before first SDPA allocated = 16832.65869 MB
On chunked entry = 16832.65869 MB
On scale calculation = 16832.66650 MB
Before interleave = 16832.66650 MB
After interleave = 16833.16650 MB
After matmul = 16841.29346 MB
Before local copies matmul = 16841.29346 MB
After local copies = 16841.29639 MB
After first SDPA allocated = 16840.78369 MB
After first copy allocated = 16840.78369 MB
On chunked entry = 16840.78369 MB
On scale calculation = 16840.79150 MB
Before interleave = 16840.79150 MB
After interleave = 16840.88525 MB
After matmul = 16840.88574 MB
Before local copies matmul = 16840.88574 MB
After local copies = 16840.88721 MB
fter compute chunk allocated = 16840.78369 MB
Memory after cuda sdpa 16840.79150390625 MB
1
Memory before offload  16840.77001953125 MB
Memory after offload  16840.77001953125 MB
Memory before cuda sdpa 16840.78369140625 MB
On entering CUDA sdpa main function  allocated = 16840.78369 MB
Before first SDPA allocated = 16840.78369 MB
On chunked entry = 16840.78369 MB
On scale calculation = 16840.79150 MB
Before interleave = 16840.79150 MB
After interleave = 16841.29150 MB
After matmul = 16849.41846 MB
Before local copies matmul = 16849.41846 MB
After local copies = 16849.42139 MB
After first SDPA allocated = 16848.90869 MB
After first copy allocated = 16848.90869 MB
On chunked entry = 16848.90869 MB
On scale calculation = 16848.91650 MB
Before interleave = 16848.91650 MB
After interleave = 16849.01025 MB
After matmul = 16849.01074 MB
Before local copies matmul = 16849.01074 MB
After local copies = 16849.01221 MB
fter compute chunk allocated = 16848.90869 MB
Memory after cuda sdpa 16848.91650390625 MB
1
Memory before offload  16848.89501953125 MB
Memory after offload  16848.89501953125 MB
Memory before cuda sdpa 16848.90869140625 MB
On entering CUDA sdpa main function  allocated = 16848.90869 MB
Before first SDPA allocated = 16848.90869 MB
On chunked entry = 16848.90869 MB
On scale calculation = 16848.91650 MB
Before interleave = 16848.91650 MB
After interleave = 16849.41650 MB
After matmul = 16857.54346 MB
Before local copies matmul = 16857.54346 MB
After local copies = 16857.54639 MB
After first SDPA allocated = 16857.03369 MB
After first copy allocated = 16857.03369 MB
On chunked entry = 16857.03369 MB
On scale calculation = 16857.04150 MB
Before interleave = 16857.04150 MB
After interleave = 16857.13525 MB
After matmul = 16857.13574 MB
Before local copies matmul = 16857.13574 MB
After local copies = 16857.13721 MB
fter compute chunk allocated = 16857.03369 MB
Memory after cuda sdpa 16857.04150390625 MB
1
Memory before offload  16857.02001953125 MB
Memory after offload  16857.02001953125 MB
Memory before cuda sdpa 16857.03369140625 MB
On entering CUDA sdpa main function  allocated = 16857.03369 MB
Before first SDPA allocated = 16857.03369 MB
On chunked entry = 16857.03369 MB
On scale calculation = 16857.04150 MB
Before interleave = 16857.04150 MB
After interleave = 16857.54150 MB
After matmul = 16865.66846 MB
Before local copies matmul = 16865.66846 MB
After local copies = 16865.67139 MB
After first SDPA allocated = 16865.15869 MB
After first copy allocated = 16865.15869 MB
On chunked entry = 16865.15869 MB
On scale calculation = 16865.16650 MB
Before interleave = 16865.16650 MB
After interleave = 16865.26025 MB
After matmul = 16865.26074 MB
Before local copies matmul = 16865.26074 MB
After local copies = 16865.26221 MB
fter compute chunk allocated = 16865.15869 MB
Memory after cuda sdpa 16865.16650390625 MB
1
Memory before offload  16865.14501953125 MB
Memory after offload  16865.14501953125 MB
Memory before cuda sdpa 16865.15869140625 MB
On entering CUDA sdpa main function  allocated = 16865.15869 MB
Before first SDPA allocated = 16865.15869 MB
On chunked entry = 16865.15869 MB
On scale calculation = 16865.16650 MB
Before interleave = 16865.16650 MB
After interleave = 16865.66650 MB
After matmul = 16873.79346 MB
Before local copies matmul = 16873.79346 MB
After local copies = 16873.79639 MB
After first SDPA allocated = 16873.28369 MB
After first copy allocated = 16873.28369 MB
On chunked entry = 16873.28369 MB
On scale calculation = 16873.29150 MB
Before interleave = 16873.29150 MB
After interleave = 16873.38525 MB
After matmul = 16873.38574 MB
Before local copies matmul = 16873.38574 MB
After local copies = 16873.38721 MB
fter compute chunk allocated = 16873.28369 MB
Memory after cuda sdpa 16873.29150390625 MB
1
Memory before offload  16873.27001953125 MB
Memory after offload  16873.27001953125 MB
Memory before cuda sdpa 16873.28369140625 MB
On entering CUDA sdpa main function  allocated = 16873.28369 MB
Before first SDPA allocated = 16873.28369 MB
On chunked entry = 16873.28369 MB
On scale calculation = 16873.29150 MB
Before interleave = 16873.29150 MB
After interleave = 16873.79150 MB
After matmul = 16881.91846 MB
Before local copies matmul = 16881.91846 MB
After local copies = 16881.92139 MB
After first SDPA allocated = 16881.40869 MB
After first copy allocated = 16881.40869 MB
On chunked entry = 16881.40869 MB
On scale calculation = 16881.41650 MB
Before interleave = 16881.41650 MB
After interleave = 16881.51025 MB
After matmul = 16881.51074 MB
Before local copies matmul = 16881.51074 MB
After local copies = 16881.51221 MB
fter compute chunk allocated = 16881.40869 MB
Memory after cuda sdpa 16881.41650390625 MB
1
Memory before offload  16881.39501953125 MB
Memory after offload  16881.39501953125 MB
Memory before cuda sdpa 16881.40869140625 MB
On entering CUDA sdpa main function  allocated = 16881.40869 MB
Before first SDPA allocated = 16881.40869 MB
On chunked entry = 16881.40869 MB
On scale calculation = 16881.41650 MB
Before interleave = 16881.41650 MB
After interleave = 16881.91650 MB
After matmul = 16890.04346 MB
Before local copies matmul = 16890.04346 MB
After local copies = 16890.04639 MB
After first SDPA allocated = 16889.53369 MB
After first copy allocated = 16889.53369 MB
On chunked entry = 16889.53369 MB
On scale calculation = 16889.54150 MB
Before interleave = 16889.54150 MB
After interleave = 16889.63525 MB
After matmul = 16889.63574 MB
Before local copies matmul = 16889.63574 MB
After local copies = 16889.63721 MB
fter compute chunk allocated = 16889.53369 MB
Memory after cuda sdpa 16889.54150390625 MB
1
Memory before offload  16889.52001953125 MB
Memory after offload  16889.52001953125 MB
Memory before cuda sdpa 16889.53369140625 MB
On entering CUDA sdpa main function  allocated = 16889.53369 MB
Before first SDPA allocated = 16889.53369 MB
On chunked entry = 16889.53369 MB
On scale calculation = 16889.54150 MB
Before interleave = 16889.54150 MB
After interleave = 16890.04150 MB
After matmul = 16898.16846 MB
Before local copies matmul = 16898.16846 MB
After local copies = 16898.17139 MB
After first SDPA allocated = 16897.65869 MB
After first copy allocated = 16897.65869 MB
On chunked entry = 16897.65869 MB
On scale calculation = 16897.66650 MB
Before interleave = 16897.66650 MB
After interleave = 16897.76025 MB
After matmul = 16897.76074 MB
Before local copies matmul = 16897.76074 MB
After local copies = 16897.76221 MB
fter compute chunk allocated = 16897.65869 MB
Memory after cuda sdpa 16897.66650390625 MB
1
Memory before offload  16897.64501953125 MB
Memory after offload  16897.64501953125 MB
Memory before cuda sdpa 16897.65869140625 MB
On entering CUDA sdpa main function  allocated = 16897.65869 MB
Before first SDPA allocated = 16897.65869 MB
On chunked entry = 16897.65869 MB
On scale calculation = 16897.66650 MB
Before interleave = 16897.66650 MB
After interleave = 16898.16650 MB
After matmul = 16906.29346 MB
Before local copies matmul = 16906.29346 MB
After local copies = 16906.29639 MB
After first SDPA allocated = 16905.78369 MB
After first copy allocated = 16905.78369 MB
On chunked entry = 16905.78369 MB
On scale calculation = 16905.79150 MB
Before interleave = 16905.79150 MB
After interleave = 16905.88525 MB
After matmul = 16905.88574 MB
Before local copies matmul = 16905.88574 MB
After local copies = 16905.88721 MB
fter compute chunk allocated = 16905.78369 MB
Memory after cuda sdpa 16905.79150390625 MB
Decode step 7
1
Memory before offload  16905.7705078125 MB
Memory after offload  16905.7705078125 MB
Memory before cuda sdpa 16905.7841796875 MB
On entering CUDA sdpa main function  allocated = 16905.78418 MB
Before first SDPA allocated = 16905.78418 MB
On chunked entry = 16905.78418 MB
On scale calculation = 16905.79199 MB
Before interleave = 16905.79199 MB
After interleave = 16906.29199 MB
After matmul = 16914.41895 MB
Before local copies matmul = 16914.41895 MB
After local copies = 16914.42188 MB
After first SDPA allocated = 16913.90918 MB
After first copy allocated = 16913.90918 MB
On chunked entry = 16913.90918 MB
On scale calculation = 16913.91699 MB
Before interleave = 16913.91699 MB
After interleave = 16914.02637 MB
After matmul = 16914.02686 MB
Before local copies matmul = 16914.02686 MB
After local copies = 16914.02832 MB
fter compute chunk allocated = 16913.90918 MB
Memory after cuda sdpa 16913.9169921875 MB
1
Memory before offload  16913.8955078125 MB
Memory after offload  16913.8955078125 MB
Memory before cuda sdpa 16913.9091796875 MB
On entering CUDA sdpa main function  allocated = 16913.90918 MB
Before first SDPA allocated = 16913.90918 MB
On chunked entry = 16913.90918 MB
On scale calculation = 16913.91699 MB
Before interleave = 16913.91699 MB
After interleave = 16914.41699 MB
After matmul = 16922.54395 MB
Before local copies matmul = 16922.54395 MB
After local copies = 16922.54688 MB
After first SDPA allocated = 16922.03418 MB
After first copy allocated = 16922.03418 MB
On chunked entry = 16922.03418 MB
On scale calculation = 16922.04199 MB
Before interleave = 16922.04199 MB
After interleave = 16922.15137 MB
After matmul = 16922.15186 MB
Before local copies matmul = 16922.15186 MB
After local copies = 16922.15332 MB
fter compute chunk allocated = 16922.03418 MB
Memory after cuda sdpa 16922.0419921875 MB
1
Memory before offload  16922.0205078125 MB
Memory after offload  16922.0205078125 MB
Memory before cuda sdpa 16922.0341796875 MB
On entering CUDA sdpa main function  allocated = 16922.03418 MB
Before first SDPA allocated = 16922.03418 MB
On chunked entry = 16922.03418 MB
On scale calculation = 16922.04199 MB
Before interleave = 16922.04199 MB
After interleave = 16922.54199 MB
After matmul = 16930.66895 MB
Before local copies matmul = 16930.66895 MB
After local copies = 16930.67188 MB
After first SDPA allocated = 16930.15918 MB
After first copy allocated = 16930.15918 MB
On chunked entry = 16930.15918 MB
On scale calculation = 16930.16699 MB
Before interleave = 16930.16699 MB
After interleave = 16930.27637 MB
After matmul = 16930.27686 MB
Before local copies matmul = 16930.27686 MB
After local copies = 16930.27832 MB
fter compute chunk allocated = 16930.15918 MB
Memory after cuda sdpa 16930.1669921875 MB
1
Memory before offload  16930.1455078125 MB
Memory after offload  16930.1455078125 MB
Memory before cuda sdpa 16930.1591796875 MB
On entering CUDA sdpa main function  allocated = 16930.15918 MB
Before first SDPA allocated = 16930.15918 MB
On chunked entry = 16930.15918 MB
On scale calculation = 16930.16699 MB
Before interleave = 16930.16699 MB
After interleave = 16930.66699 MB
After matmul = 16938.79395 MB
Before local copies matmul = 16938.79395 MB
After local copies = 16938.79688 MB
After first SDPA allocated = 16938.28418 MB
After first copy allocated = 16938.28418 MB
On chunked entry = 16938.28418 MB
On scale calculation = 16938.29199 MB
Before interleave = 16938.29199 MB
After interleave = 16938.40137 MB
After matmul = 16938.40186 MB
Before local copies matmul = 16938.40186 MB
After local copies = 16938.40332 MB
fter compute chunk allocated = 16938.28418 MB
Memory after cuda sdpa 16938.2919921875 MB
1
Memory before offload  16938.2705078125 MB
Memory after offload  16938.2705078125 MB
Memory before cuda sdpa 16938.2841796875 MB
On entering CUDA sdpa main function  allocated = 16938.28418 MB
Before first SDPA allocated = 16938.28418 MB
On chunked entry = 16938.28418 MB
On scale calculation = 16938.29199 MB
Before interleave = 16938.29199 MB
After interleave = 16938.79199 MB
After matmul = 16946.91895 MB
Before local copies matmul = 16946.91895 MB
After local copies = 16946.92188 MB
After first SDPA allocated = 16946.40918 MB
After first copy allocated = 16946.40918 MB
On chunked entry = 16946.40918 MB
On scale calculation = 16946.41699 MB
Before interleave = 16946.41699 MB
After interleave = 16946.52637 MB
After matmul = 16946.52686 MB
Before local copies matmul = 16946.52686 MB
After local copies = 16946.52832 MB
fter compute chunk allocated = 16946.40918 MB
Memory after cuda sdpa 16946.4169921875 MB
1
Memory before offload  16946.3955078125 MB
Memory after offload  16946.3955078125 MB
Memory before cuda sdpa 16946.4091796875 MB
On entering CUDA sdpa main function  allocated = 16946.40918 MB
Before first SDPA allocated = 16946.40918 MB
On chunked entry = 16946.40918 MB
On scale calculation = 16946.41699 MB
Before interleave = 16946.41699 MB
After interleave = 16946.91699 MB
After matmul = 16955.04395 MB
Before local copies matmul = 16955.04395 MB
After local copies = 16955.04688 MB
After first SDPA allocated = 16954.53418 MB
After first copy allocated = 16954.53418 MB
On chunked entry = 16954.53418 MB
On scale calculation = 16954.54199 MB
Before interleave = 16954.54199 MB
After interleave = 16954.65137 MB
After matmul = 16954.65186 MB
Before local copies matmul = 16954.65186 MB
After local copies = 16954.65332 MB
fter compute chunk allocated = 16954.53418 MB
Memory after cuda sdpa 16954.5419921875 MB
1
Memory before offload  16954.5205078125 MB
Memory after offload  16954.5205078125 MB
Memory before cuda sdpa 16954.5341796875 MB
On entering CUDA sdpa main function  allocated = 16954.53418 MB
Before first SDPA allocated = 16954.53418 MB
On chunked entry = 16954.53418 MB
On scale calculation = 16954.54199 MB
Before interleave = 16954.54199 MB
After interleave = 16955.04199 MB
After matmul = 16963.16895 MB
Before local copies matmul = 16963.16895 MB
After local copies = 16963.17188 MB
After first SDPA allocated = 16962.65918 MB
After first copy allocated = 16962.65918 MB
On chunked entry = 16962.65918 MB
On scale calculation = 16962.66699 MB
Before interleave = 16962.66699 MB
After interleave = 16962.77637 MB
After matmul = 16962.77686 MB
Before local copies matmul = 16962.77686 MB
After local copies = 16962.77832 MB
fter compute chunk allocated = 16962.65918 MB
Memory after cuda sdpa 16962.6669921875 MB
1
Memory before offload  16962.6455078125 MB
Memory after offload  16962.6455078125 MB
Memory before cuda sdpa 16962.6591796875 MB
On entering CUDA sdpa main function  allocated = 16962.65918 MB
Before first SDPA allocated = 16962.65918 MB
On chunked entry = 16962.65918 MB
On scale calculation = 16962.66699 MB
Before interleave = 16962.66699 MB
After interleave = 16963.16699 MB
After matmul = 16971.29395 MB
Before local copies matmul = 16971.29395 MB
After local copies = 16971.29688 MB
After first SDPA allocated = 16970.78418 MB
After first copy allocated = 16970.78418 MB
On chunked entry = 16970.78418 MB
On scale calculation = 16970.79199 MB
Before interleave = 16970.79199 MB
After interleave = 16970.90137 MB
After matmul = 16970.90186 MB
Before local copies matmul = 16970.90186 MB
After local copies = 16970.90332 MB
fter compute chunk allocated = 16970.78418 MB
Memory after cuda sdpa 16970.7919921875 MB
1
Memory before offload  16970.7705078125 MB
Memory after offload  16970.7705078125 MB
Memory before cuda sdpa 16970.7841796875 MB
On entering CUDA sdpa main function  allocated = 16970.78418 MB
Before first SDPA allocated = 16970.78418 MB
On chunked entry = 16970.78418 MB
On scale calculation = 16970.79199 MB
Before interleave = 16970.79199 MB
After interleave = 16971.29199 MB
After matmul = 16979.41895 MB
Before local copies matmul = 16979.41895 MB
After local copies = 16979.42188 MB
After first SDPA allocated = 16978.90918 MB
After first copy allocated = 16978.90918 MB
On chunked entry = 16978.90918 MB
On scale calculation = 16978.91699 MB
Before interleave = 16978.91699 MB
After interleave = 16979.02637 MB
After matmul = 16979.02686 MB
Before local copies matmul = 16979.02686 MB
After local copies = 16979.02832 MB
fter compute chunk allocated = 16978.90918 MB
Memory after cuda sdpa 16978.9169921875 MB
1
Memory before offload  16978.8955078125 MB
Memory after offload  16978.8955078125 MB
Memory before cuda sdpa 16978.9091796875 MB
On entering CUDA sdpa main function  allocated = 16978.90918 MB
Before first SDPA allocated = 16978.90918 MB
On chunked entry = 16978.90918 MB
On scale calculation = 16978.91699 MB
Before interleave = 16978.91699 MB
After interleave = 16979.41699 MB
After matmul = 16987.54395 MB
Before local copies matmul = 16987.54395 MB
After local copies = 16987.54688 MB
After first SDPA allocated = 16987.03418 MB
After first copy allocated = 16987.03418 MB
On chunked entry = 16987.03418 MB
On scale calculation = 16987.04199 MB
Before interleave = 16987.04199 MB
After interleave = 16987.15137 MB
After matmul = 16987.15186 MB
Before local copies matmul = 16987.15186 MB
After local copies = 16987.15332 MB
fter compute chunk allocated = 16987.03418 MB
Memory after cuda sdpa 16987.0419921875 MB
1
Memory before offload  16987.0205078125 MB
Memory after offload  16987.0205078125 MB
Memory before cuda sdpa 16987.0341796875 MB
On entering CUDA sdpa main function  allocated = 16987.03418 MB
Before first SDPA allocated = 16987.03418 MB
On chunked entry = 16987.03418 MB
On scale calculation = 16987.04199 MB
Before interleave = 16987.04199 MB
After interleave = 16987.54199 MB
After matmul = 16995.66895 MB
Before local copies matmul = 16995.66895 MB
After local copies = 16995.67188 MB
After first SDPA allocated = 16995.15918 MB
After first copy allocated = 16995.15918 MB
On chunked entry = 16995.15918 MB
On scale calculation = 16995.16699 MB
Before interleave = 16995.16699 MB
After interleave = 16995.27637 MB
After matmul = 16995.27686 MB
Before local copies matmul = 16995.27686 MB
After local copies = 16995.27832 MB
fter compute chunk allocated = 16995.15918 MB
Memory after cuda sdpa 16995.1669921875 MB
1
Memory before offload  16995.1455078125 MB
Memory after offload  16995.1455078125 MB
Memory before cuda sdpa 16995.1591796875 MB
On entering CUDA sdpa main function  allocated = 16995.15918 MB
Before first SDPA allocated = 16995.15918 MB
On chunked entry = 16995.15918 MB
On scale calculation = 16995.16699 MB
Before interleave = 16995.16699 MB
After interleave = 16995.66699 MB
After matmul = 17003.79395 MB
Before local copies matmul = 17003.79395 MB
After local copies = 17003.79688 MB
After first SDPA allocated = 17003.28418 MB
After first copy allocated = 17003.28418 MB
On chunked entry = 17003.28418 MB
On scale calculation = 17003.29199 MB
Before interleave = 17003.29199 MB
After interleave = 17003.40137 MB
After matmul = 17003.40186 MB
Before local copies matmul = 17003.40186 MB
After local copies = 17003.40332 MB
fter compute chunk allocated = 17003.28418 MB
Memory after cuda sdpa 17003.2919921875 MB
1
Memory before offload  17003.2705078125 MB
Memory after offload  17003.2705078125 MB
Memory before cuda sdpa 17003.2841796875 MB
On entering CUDA sdpa main function  allocated = 17003.28418 MB
Before first SDPA allocated = 17003.28418 MB
On chunked entry = 17003.28418 MB
On scale calculation = 17003.29199 MB
Before interleave = 17003.29199 MB
After interleave = 17003.79199 MB
After matmul = 17011.91895 MB
Before local copies matmul = 17011.91895 MB
After local copies = 17011.92188 MB
After first SDPA allocated = 17011.40918 MB
After first copy allocated = 17011.40918 MB
On chunked entry = 17011.40918 MB
On scale calculation = 17011.41699 MB
Before interleave = 17011.41699 MB
After interleave = 17011.52637 MB
After matmul = 17011.52686 MB
Before local copies matmul = 17011.52686 MB
After local copies = 17011.52832 MB
fter compute chunk allocated = 17011.40918 MB
Memory after cuda sdpa 17011.4169921875 MB
1
Memory before offload  17011.3955078125 MB
Memory after offload  17011.3955078125 MB
Memory before cuda sdpa 17011.4091796875 MB
On entering CUDA sdpa main function  allocated = 17011.40918 MB
Before first SDPA allocated = 17011.40918 MB
On chunked entry = 17011.40918 MB
On scale calculation = 17011.41699 MB
Before interleave = 17011.41699 MB
After interleave = 17011.91699 MB
After matmul = 17020.04395 MB
Before local copies matmul = 17020.04395 MB
After local copies = 17020.04688 MB
After first SDPA allocated = 17019.53418 MB
After first copy allocated = 17019.53418 MB
On chunked entry = 17019.53418 MB
On scale calculation = 17019.54199 MB
Before interleave = 17019.54199 MB
After interleave = 17019.65137 MB
After matmul = 17019.65186 MB
Before local copies matmul = 17019.65186 MB
After local copies = 17019.65332 MB
fter compute chunk allocated = 17019.53418 MB
Memory after cuda sdpa 17019.5419921875 MB
1
Memory before offload  17019.5205078125 MB
Memory after offload  17019.5205078125 MB
Memory before cuda sdpa 17019.5341796875 MB
On entering CUDA sdpa main function  allocated = 17019.53418 MB
Before first SDPA allocated = 17019.53418 MB
On chunked entry = 17019.53418 MB
On scale calculation = 17019.54199 MB
Before interleave = 17019.54199 MB
After interleave = 17020.04199 MB
After matmul = 17028.16895 MB
Before local copies matmul = 17028.16895 MB
After local copies = 17028.17188 MB
After first SDPA allocated = 17027.65918 MB
After first copy allocated = 17027.65918 MB
On chunked entry = 17027.65918 MB
On scale calculation = 17027.66699 MB
Before interleave = 17027.66699 MB
After interleave = 17027.77637 MB
After matmul = 17027.77686 MB
Before local copies matmul = 17027.77686 MB
After local copies = 17027.77832 MB
fter compute chunk allocated = 17027.65918 MB
Memory after cuda sdpa 17027.6669921875 MB
1
Memory before offload  17027.6455078125 MB
Memory after offload  17027.6455078125 MB
Memory before cuda sdpa 17027.6591796875 MB
On entering CUDA sdpa main function  allocated = 17027.65918 MB
Before first SDPA allocated = 17027.65918 MB
On chunked entry = 17027.65918 MB
On scale calculation = 17027.66699 MB
Before interleave = 17027.66699 MB
After interleave = 17028.16699 MB
After matmul = 17036.29395 MB
Before local copies matmul = 17036.29395 MB
After local copies = 17036.29688 MB
After first SDPA allocated = 17035.78418 MB
After first copy allocated = 17035.78418 MB
On chunked entry = 17035.78418 MB
On scale calculation = 17035.79199 MB
Before interleave = 17035.79199 MB
After interleave = 17035.90137 MB
After matmul = 17035.90186 MB
Before local copies matmul = 17035.90186 MB
After local copies = 17035.90332 MB
fter compute chunk allocated = 17035.78418 MB
Memory after cuda sdpa 17035.7919921875 MB
1
Memory before offload  17035.7705078125 MB
Memory after offload  17035.7705078125 MB
Memory before cuda sdpa 17035.7841796875 MB
On entering CUDA sdpa main function  allocated = 17035.78418 MB
Before first SDPA allocated = 17035.78418 MB
On chunked entry = 17035.78418 MB
On scale calculation = 17035.79199 MB
Before interleave = 17035.79199 MB
After interleave = 17036.29199 MB
After matmul = 17044.41895 MB
Before local copies matmul = 17044.41895 MB
After local copies = 17044.42188 MB
After first SDPA allocated = 17043.90918 MB
After first copy allocated = 17043.90918 MB
On chunked entry = 17043.90918 MB
On scale calculation = 17043.91699 MB
Before interleave = 17043.91699 MB
After interleave = 17044.02637 MB
After matmul = 17044.02686 MB
Before local copies matmul = 17044.02686 MB
After local copies = 17044.02832 MB
fter compute chunk allocated = 17043.90918 MB
Memory after cuda sdpa 17043.9169921875 MB
1
Memory before offload  17043.8955078125 MB
Memory after offload  17043.8955078125 MB
Memory before cuda sdpa 17043.9091796875 MB
On entering CUDA sdpa main function  allocated = 17043.90918 MB
Before first SDPA allocated = 17043.90918 MB
On chunked entry = 17043.90918 MB
On scale calculation = 17043.91699 MB
Before interleave = 17043.91699 MB
After interleave = 17044.41699 MB
After matmul = 17052.54395 MB
Before local copies matmul = 17052.54395 MB
After local copies = 17052.54688 MB
After first SDPA allocated = 17052.03418 MB
After first copy allocated = 17052.03418 MB
On chunked entry = 17052.03418 MB
On scale calculation = 17052.04199 MB
Before interleave = 17052.04199 MB
After interleave = 17052.15137 MB
After matmul = 17052.15186 MB
Before local copies matmul = 17052.15186 MB
After local copies = 17052.15332 MB
fter compute chunk allocated = 17052.03418 MB
Memory after cuda sdpa 17052.0419921875 MB
1
Memory before offload  17052.0205078125 MB
Memory after offload  17052.0205078125 MB
Memory before cuda sdpa 17052.0341796875 MB
On entering CUDA sdpa main function  allocated = 17052.03418 MB
Before first SDPA allocated = 17052.03418 MB
On chunked entry = 17052.03418 MB
On scale calculation = 17052.04199 MB
Before interleave = 17052.04199 MB
After interleave = 17052.54199 MB
After matmul = 17060.66895 MB
Before local copies matmul = 17060.66895 MB
After local copies = 17060.67188 MB
After first SDPA allocated = 17060.15918 MB
After first copy allocated = 17060.15918 MB
On chunked entry = 17060.15918 MB
On scale calculation = 17060.16699 MB
Before interleave = 17060.16699 MB
After interleave = 17060.27637 MB
After matmul = 17060.27686 MB
Before local copies matmul = 17060.27686 MB
After local copies = 17060.27832 MB
fter compute chunk allocated = 17060.15918 MB
Memory after cuda sdpa 17060.1669921875 MB
1
Memory before offload  17060.1455078125 MB
Memory after offload  17060.1455078125 MB
Memory before cuda sdpa 17060.1591796875 MB
On entering CUDA sdpa main function  allocated = 17060.15918 MB
Before first SDPA allocated = 17060.15918 MB
On chunked entry = 17060.15918 MB
On scale calculation = 17060.16699 MB
Before interleave = 17060.16699 MB
After interleave = 17060.66699 MB
After matmul = 17068.79395 MB
Before local copies matmul = 17068.79395 MB
After local copies = 17068.79688 MB
After first SDPA allocated = 17068.28418 MB
After first copy allocated = 17068.28418 MB
On chunked entry = 17068.28418 MB
On scale calculation = 17068.29199 MB
Before interleave = 17068.29199 MB
After interleave = 17068.40137 MB
After matmul = 17068.40186 MB
Before local copies matmul = 17068.40186 MB
After local copies = 17068.40332 MB
fter compute chunk allocated = 17068.28418 MB
Memory after cuda sdpa 17068.2919921875 MB
1
Memory before offload  17068.2705078125 MB
Memory after offload  17068.2705078125 MB
Memory before cuda sdpa 17068.2841796875 MB
On entering CUDA sdpa main function  allocated = 17068.28418 MB
Before first SDPA allocated = 17068.28418 MB
On chunked entry = 17068.28418 MB
On scale calculation = 17068.29199 MB
Before interleave = 17068.29199 MB
After interleave = 17068.79199 MB
After matmul = 17076.91895 MB
Before local copies matmul = 17076.91895 MB
After local copies = 17076.92188 MB
After first SDPA allocated = 17076.40918 MB
After first copy allocated = 17076.40918 MB
On chunked entry = 17076.40918 MB
On scale calculation = 17076.41699 MB
Before interleave = 17076.41699 MB
After interleave = 17076.52637 MB
After matmul = 17076.52686 MB
Before local copies matmul = 17076.52686 MB
After local copies = 17076.52832 MB
fter compute chunk allocated = 17076.40918 MB
Memory after cuda sdpa 17076.4169921875 MB
1
Memory before offload  17076.3955078125 MB
Memory after offload  17076.3955078125 MB
Memory before cuda sdpa 17076.4091796875 MB
On entering CUDA sdpa main function  allocated = 17076.40918 MB
Before first SDPA allocated = 17076.40918 MB
On chunked entry = 17076.40918 MB
On scale calculation = 17076.41699 MB
Before interleave = 17076.41699 MB
After interleave = 17076.91699 MB
After matmul = 17085.04395 MB
Before local copies matmul = 17085.04395 MB
After local copies = 17085.04688 MB
After first SDPA allocated = 17084.53418 MB
After first copy allocated = 17084.53418 MB
On chunked entry = 17084.53418 MB
On scale calculation = 17084.54199 MB
Before interleave = 17084.54199 MB
After interleave = 17084.65137 MB
After matmul = 17084.65186 MB
Before local copies matmul = 17084.65186 MB
After local copies = 17084.65332 MB
fter compute chunk allocated = 17084.53418 MB
Memory after cuda sdpa 17084.5419921875 MB
1
Memory before offload  17084.5205078125 MB
Memory after offload  17084.5205078125 MB
Memory before cuda sdpa 17084.5341796875 MB
On entering CUDA sdpa main function  allocated = 17084.53418 MB
Before first SDPA allocated = 17084.53418 MB
On chunked entry = 17084.53418 MB
On scale calculation = 17084.54199 MB
Before interleave = 17084.54199 MB
After interleave = 17085.04199 MB
After matmul = 17093.16895 MB
Before local copies matmul = 17093.16895 MB
After local copies = 17093.17188 MB
After first SDPA allocated = 17092.65918 MB
After first copy allocated = 17092.65918 MB
On chunked entry = 17092.65918 MB
On scale calculation = 17092.66699 MB
Before interleave = 17092.66699 MB
After interleave = 17092.77637 MB
After matmul = 17092.77686 MB
Before local copies matmul = 17092.77686 MB
After local copies = 17092.77832 MB
fter compute chunk allocated = 17092.65918 MB
Memory after cuda sdpa 17092.6669921875 MB
1
Memory before offload  17092.6455078125 MB
Memory after offload  17092.6455078125 MB
Memory before cuda sdpa 17092.6591796875 MB
On entering CUDA sdpa main function  allocated = 17092.65918 MB
Before first SDPA allocated = 17092.65918 MB
On chunked entry = 17092.65918 MB
On scale calculation = 17092.66699 MB
Before interleave = 17092.66699 MB
After interleave = 17093.16699 MB
After matmul = 17101.29395 MB
Before local copies matmul = 17101.29395 MB
After local copies = 17101.29688 MB
After first SDPA allocated = 17100.78418 MB
After first copy allocated = 17100.78418 MB
On chunked entry = 17100.78418 MB
On scale calculation = 17100.79199 MB
Before interleave = 17100.79199 MB
After interleave = 17100.90137 MB
After matmul = 17100.90186 MB
Before local copies matmul = 17100.90186 MB
After local copies = 17100.90332 MB
fter compute chunk allocated = 17100.78418 MB
Memory after cuda sdpa 17100.7919921875 MB
1
Memory before offload  17100.7705078125 MB
Memory after offload  17100.7705078125 MB
Memory before cuda sdpa 17100.7841796875 MB
On entering CUDA sdpa main function  allocated = 17100.78418 MB
Before first SDPA allocated = 17100.78418 MB
On chunked entry = 17100.78418 MB
On scale calculation = 17100.79199 MB
Before interleave = 17100.79199 MB
After interleave = 17101.29199 MB
After matmul = 17109.41895 MB
Before local copies matmul = 17109.41895 MB
After local copies = 17109.42188 MB
After first SDPA allocated = 17108.90918 MB
After first copy allocated = 17108.90918 MB
On chunked entry = 17108.90918 MB
On scale calculation = 17108.91699 MB
Before interleave = 17108.91699 MB
After interleave = 17109.02637 MB
After matmul = 17109.02686 MB
Before local copies matmul = 17109.02686 MB
After local copies = 17109.02832 MB
fter compute chunk allocated = 17108.90918 MB
Memory after cuda sdpa 17108.9169921875 MB
1
Memory before offload  17108.8955078125 MB
Memory after offload  17108.8955078125 MB
Memory before cuda sdpa 17108.9091796875 MB
On entering CUDA sdpa main function  allocated = 17108.90918 MB
Before first SDPA allocated = 17108.90918 MB
On chunked entry = 17108.90918 MB
On scale calculation = 17108.91699 MB
Before interleave = 17108.91699 MB
After interleave = 17109.41699 MB
After matmul = 17117.54395 MB
Before local copies matmul = 17117.54395 MB
After local copies = 17117.54688 MB
After first SDPA allocated = 17117.03418 MB
After first copy allocated = 17117.03418 MB
On chunked entry = 17117.03418 MB
On scale calculation = 17117.04199 MB
Before interleave = 17117.04199 MB
After interleave = 17117.15137 MB
After matmul = 17117.15186 MB
Before local copies matmul = 17117.15186 MB
After local copies = 17117.15332 MB
fter compute chunk allocated = 17117.03418 MB
Memory after cuda sdpa 17117.0419921875 MB
1
Memory before offload  17117.0205078125 MB
Memory after offload  17117.0205078125 MB
Memory before cuda sdpa 17117.0341796875 MB
On entering CUDA sdpa main function  allocated = 17117.03418 MB
Before first SDPA allocated = 17117.03418 MB
On chunked entry = 17117.03418 MB
On scale calculation = 17117.04199 MB
Before interleave = 17117.04199 MB
After interleave = 17117.54199 MB
After matmul = 17125.66895 MB
Before local copies matmul = 17125.66895 MB
After local copies = 17125.67188 MB
After first SDPA allocated = 17125.15918 MB
After first copy allocated = 17125.15918 MB
On chunked entry = 17125.15918 MB
On scale calculation = 17125.16699 MB
Before interleave = 17125.16699 MB
After interleave = 17125.27637 MB
After matmul = 17125.27686 MB
Before local copies matmul = 17125.27686 MB
After local copies = 17125.27832 MB
fter compute chunk allocated = 17125.15918 MB
Memory after cuda sdpa 17125.1669921875 MB
1
Memory before offload  17125.1455078125 MB
Memory after offload  17125.1455078125 MB
Memory before cuda sdpa 17125.1591796875 MB
On entering CUDA sdpa main function  allocated = 17125.15918 MB
Before first SDPA allocated = 17125.15918 MB
On chunked entry = 17125.15918 MB
On scale calculation = 17125.16699 MB
Before interleave = 17125.16699 MB
After interleave = 17125.66699 MB
After matmul = 17133.79395 MB
Before local copies matmul = 17133.79395 MB
After local copies = 17133.79688 MB
After first SDPA allocated = 17133.28418 MB
After first copy allocated = 17133.28418 MB
On chunked entry = 17133.28418 MB
On scale calculation = 17133.29199 MB
Before interleave = 17133.29199 MB
After interleave = 17133.40137 MB
After matmul = 17133.40186 MB
Before local copies matmul = 17133.40186 MB
After local copies = 17133.40332 MB
fter compute chunk allocated = 17133.28418 MB
Memory after cuda sdpa 17133.2919921875 MB
1
Memory before offload  17133.2705078125 MB
Memory after offload  17133.2705078125 MB
Memory before cuda sdpa 17133.2841796875 MB
On entering CUDA sdpa main function  allocated = 17133.28418 MB
Before first SDPA allocated = 17133.28418 MB
On chunked entry = 17133.28418 MB
On scale calculation = 17133.29199 MB
Before interleave = 17133.29199 MB
After interleave = 17133.79199 MB
After matmul = 17141.91895 MB
Before local copies matmul = 17141.91895 MB
After local copies = 17141.92188 MB
After first SDPA allocated = 17141.40918 MB
After first copy allocated = 17141.40918 MB
On chunked entry = 17141.40918 MB
On scale calculation = 17141.41699 MB
Before interleave = 17141.41699 MB
After interleave = 17141.52637 MB
After matmul = 17141.52686 MB
Before local copies matmul = 17141.52686 MB
After local copies = 17141.52832 MB
fter compute chunk allocated = 17141.40918 MB
Memory after cuda sdpa 17141.4169921875 MB
1
Memory before offload  17141.3955078125 MB
Memory after offload  17141.3955078125 MB
Memory before cuda sdpa 17141.4091796875 MB
On entering CUDA sdpa main function  allocated = 17141.40918 MB
Before first SDPA allocated = 17141.40918 MB
On chunked entry = 17141.40918 MB
On scale calculation = 17141.41699 MB
Before interleave = 17141.41699 MB
After interleave = 17141.91699 MB
After matmul = 17150.04395 MB
Before local copies matmul = 17150.04395 MB
After local copies = 17150.04688 MB
After first SDPA allocated = 17149.53418 MB
After first copy allocated = 17149.53418 MB
On chunked entry = 17149.53418 MB
On scale calculation = 17149.54199 MB
Before interleave = 17149.54199 MB
After interleave = 17149.65137 MB
After matmul = 17149.65186 MB
Before local copies matmul = 17149.65186 MB
After local copies = 17149.65332 MB
fter compute chunk allocated = 17149.53418 MB
Memory after cuda sdpa 17149.5419921875 MB
1
Memory before offload  17149.5205078125 MB
Memory after offload  17149.5205078125 MB
Memory before cuda sdpa 17149.5341796875 MB
On entering CUDA sdpa main function  allocated = 17149.53418 MB
Before first SDPA allocated = 17149.53418 MB
On chunked entry = 17149.53418 MB
On scale calculation = 17149.54199 MB
Before interleave = 17149.54199 MB
After interleave = 17150.04199 MB
After matmul = 17158.16895 MB
Before local copies matmul = 17158.16895 MB
After local copies = 17158.17188 MB
After first SDPA allocated = 17157.65918 MB
After first copy allocated = 17157.65918 MB
On chunked entry = 17157.65918 MB
On scale calculation = 17157.66699 MB
Before interleave = 17157.66699 MB
After interleave = 17157.77637 MB
After matmul = 17157.77686 MB
Before local copies matmul = 17157.77686 MB
After local copies = 17157.77832 MB
fter compute chunk allocated = 17157.65918 MB
Memory after cuda sdpa 17157.6669921875 MB
1
Memory before offload  17157.6455078125 MB
Memory after offload  17157.6455078125 MB
Memory before cuda sdpa 17157.6591796875 MB
On entering CUDA sdpa main function  allocated = 17157.65918 MB
Before first SDPA allocated = 17157.65918 MB
On chunked entry = 17157.65918 MB
On scale calculation = 17157.66699 MB
Before interleave = 17157.66699 MB
After interleave = 17158.16699 MB
After matmul = 17166.29395 MB
Before local copies matmul = 17166.29395 MB
After local copies = 17166.29688 MB
After first SDPA allocated = 17165.78418 MB
After first copy allocated = 17165.78418 MB
On chunked entry = 17165.78418 MB
On scale calculation = 17165.79199 MB
Before interleave = 17165.79199 MB
After interleave = 17165.90137 MB
After matmul = 17165.90186 MB
Before local copies matmul = 17165.90186 MB
After local copies = 17165.90332 MB
fter compute chunk allocated = 17165.78418 MB
Memory after cuda sdpa 17165.7919921875 MB
Decode step 8
1
Memory before offload  17165.77099609375 MB
Memory after offload  17165.77099609375 MB
Memory before cuda sdpa 17165.78466796875 MB
On entering CUDA sdpa main function  allocated = 17165.78467 MB
Before first SDPA allocated = 17165.78467 MB
On chunked entry = 17165.78467 MB
On scale calculation = 17165.79248 MB
Before interleave = 17165.79248 MB
After interleave = 17166.29248 MB
After matmul = 17174.41943 MB
Before local copies matmul = 17174.41943 MB
After local copies = 17174.42236 MB
After first SDPA allocated = 17173.90967 MB
After first copy allocated = 17173.90967 MB
On chunked entry = 17173.90967 MB
On scale calculation = 17173.91748 MB
Before interleave = 17173.91748 MB
After interleave = 17174.04248 MB
After matmul = 17174.04297 MB
Before local copies matmul = 17174.04297 MB
After local copies = 17174.04443 MB
fter compute chunk allocated = 17173.90967 MB
Memory after cuda sdpa 17173.91748046875 MB
1
Memory before offload  17173.89599609375 MB
Memory after offload  17173.89599609375 MB
Memory before cuda sdpa 17173.90966796875 MB
On entering CUDA sdpa main function  allocated = 17173.90967 MB
Before first SDPA allocated = 17173.90967 MB
On chunked entry = 17173.90967 MB
On scale calculation = 17173.91748 MB
Before interleave = 17173.91748 MB
After interleave = 17174.41748 MB
After matmul = 17182.54443 MB
Before local copies matmul = 17182.54443 MB
After local copies = 17182.54736 MB
After first SDPA allocated = 17182.03467 MB
After first copy allocated = 17182.03467 MB
On chunked entry = 17182.03467 MB
On scale calculation = 17182.04248 MB
Before interleave = 17182.04248 MB
After interleave = 17182.16748 MB
After matmul = 17182.16797 MB
Before local copies matmul = 17182.16797 MB
After local copies = 17182.16943 MB
fter compute chunk allocated = 17182.03467 MB
Memory after cuda sdpa 17182.04248046875 MB
1
Memory before offload  17182.02099609375 MB
Memory after offload  17182.02099609375 MB
Memory before cuda sdpa 17182.03466796875 MB
On entering CUDA sdpa main function  allocated = 17182.03467 MB
Before first SDPA allocated = 17182.03467 MB
On chunked entry = 17182.03467 MB
On scale calculation = 17182.04248 MB
Before interleave = 17182.04248 MB
After interleave = 17182.54248 MB
After matmul = 17190.66943 MB
Before local copies matmul = 17190.66943 MB
After local copies = 17190.67236 MB
After first SDPA allocated = 17190.15967 MB
After first copy allocated = 17190.15967 MB
On chunked entry = 17190.15967 MB
On scale calculation = 17190.16748 MB
Before interleave = 17190.16748 MB
After interleave = 17190.29248 MB
After matmul = 17190.29297 MB
Before local copies matmul = 17190.29297 MB
After local copies = 17190.29443 MB
fter compute chunk allocated = 17190.15967 MB
Memory after cuda sdpa 17190.16748046875 MB
1
Memory before offload  17190.14599609375 MB
Memory after offload  17190.14599609375 MB
Memory before cuda sdpa 17190.15966796875 MB
On entering CUDA sdpa main function  allocated = 17190.15967 MB
Before first SDPA allocated = 17190.15967 MB
On chunked entry = 17190.15967 MB
On scale calculation = 17190.16748 MB
Before interleave = 17190.16748 MB
After interleave = 17190.66748 MB
After matmul = 17198.79443 MB
Before local copies matmul = 17198.79443 MB
After local copies = 17198.79736 MB
After first SDPA allocated = 17198.28467 MB
After first copy allocated = 17198.28467 MB
On chunked entry = 17198.28467 MB
On scale calculation = 17198.29248 MB
Before interleave = 17198.29248 MB
After interleave = 17198.41748 MB
After matmul = 17198.41797 MB
Before local copies matmul = 17198.41797 MB
After local copies = 17198.41943 MB
fter compute chunk allocated = 17198.28467 MB
Memory after cuda sdpa 17198.29248046875 MB
1
Memory before offload  17198.27099609375 MB
Memory after offload  17198.27099609375 MB
Memory before cuda sdpa 17198.28466796875 MB
On entering CUDA sdpa main function  allocated = 17198.28467 MB
Before first SDPA allocated = 17198.28467 MB
On chunked entry = 17198.28467 MB
On scale calculation = 17198.29248 MB
Before interleave = 17198.29248 MB
After interleave = 17198.79248 MB
After matmul = 17206.91943 MB
Before local copies matmul = 17206.91943 MB
After local copies = 17206.92236 MB
After first SDPA allocated = 17206.40967 MB
After first copy allocated = 17206.40967 MB
On chunked entry = 17206.40967 MB
On scale calculation = 17206.41748 MB
Before interleave = 17206.41748 MB
After interleave = 17206.54248 MB
After matmul = 17206.54297 MB
Before local copies matmul = 17206.54297 MB
After local copies = 17206.54443 MB
fter compute chunk allocated = 17206.40967 MB
Memory after cuda sdpa 17206.41748046875 MB
1
Memory before offload  17206.39599609375 MB
Memory after offload  17206.39599609375 MB
Memory before cuda sdpa 17206.40966796875 MB
On entering CUDA sdpa main function  allocated = 17206.40967 MB
Before first SDPA allocated = 17206.40967 MB
On chunked entry = 17206.40967 MB
On scale calculation = 17206.41748 MB
Before interleave = 17206.41748 MB
After interleave = 17206.91748 MB
After matmul = 17215.04443 MB
Before local copies matmul = 17215.04443 MB
After local copies = 17215.04736 MB
After first SDPA allocated = 17214.53467 MB
After first copy allocated = 17214.53467 MB
On chunked entry = 17214.53467 MB
On scale calculation = 17214.54248 MB
Before interleave = 17214.54248 MB
After interleave = 17214.66748 MB
After matmul = 17214.66797 MB
Before local copies matmul = 17214.66797 MB
After local copies = 17214.66943 MB
fter compute chunk allocated = 17214.53467 MB
Memory after cuda sdpa 17214.54248046875 MB
1
Memory before offload  17214.52099609375 MB
Memory after offload  17214.52099609375 MB
Memory before cuda sdpa 17214.53466796875 MB
On entering CUDA sdpa main function  allocated = 17214.53467 MB
Before first SDPA allocated = 17214.53467 MB
On chunked entry = 17214.53467 MB
On scale calculation = 17214.54248 MB
Before interleave = 17214.54248 MB
After interleave = 17215.04248 MB
After matmul = 17223.16943 MB
Before local copies matmul = 17223.16943 MB
After local copies = 17223.17236 MB
After first SDPA allocated = 17222.65967 MB
After first copy allocated = 17222.65967 MB
On chunked entry = 17222.65967 MB
On scale calculation = 17222.66748 MB
Before interleave = 17222.66748 MB
After interleave = 17222.79248 MB
After matmul = 17222.79297 MB
Before local copies matmul = 17222.79297 MB
After local copies = 17222.79443 MB
fter compute chunk allocated = 17222.65967 MB
Memory after cuda sdpa 17222.66748046875 MB
1
Memory before offload  17222.64599609375 MB
Memory after offload  17222.64599609375 MB
Memory before cuda sdpa 17222.65966796875 MB
On entering CUDA sdpa main function  allocated = 17222.65967 MB
Before first SDPA allocated = 17222.65967 MB
On chunked entry = 17222.65967 MB
On scale calculation = 17222.66748 MB
Before interleave = 17222.66748 MB
After interleave = 17223.16748 MB
After matmul = 17231.29443 MB
Before local copies matmul = 17231.29443 MB
After local copies = 17231.29736 MB
After first SDPA allocated = 17230.78467 MB
After first copy allocated = 17230.78467 MB
On chunked entry = 17230.78467 MB
On scale calculation = 17230.79248 MB
Before interleave = 17230.79248 MB
After interleave = 17230.91748 MB
After matmul = 17230.91797 MB
Before local copies matmul = 17230.91797 MB
After local copies = 17230.91943 MB
fter compute chunk allocated = 17230.78467 MB
Memory after cuda sdpa 17230.79248046875 MB
1
Memory before offload  17230.77099609375 MB
Memory after offload  17230.77099609375 MB
Memory before cuda sdpa 17230.78466796875 MB
On entering CUDA sdpa main function  allocated = 17230.78467 MB
Before first SDPA allocated = 17230.78467 MB
On chunked entry = 17230.78467 MB
On scale calculation = 17230.79248 MB
Before interleave = 17230.79248 MB
After interleave = 17231.29248 MB
After matmul = 17239.41943 MB
Before local copies matmul = 17239.41943 MB
After local copies = 17239.42236 MB
After first SDPA allocated = 17238.90967 MB
After first copy allocated = 17238.90967 MB
On chunked entry = 17238.90967 MB
On scale calculation = 17238.91748 MB
Before interleave = 17238.91748 MB
After interleave = 17239.04248 MB
After matmul = 17239.04297 MB
Before local copies matmul = 17239.04297 MB
After local copies = 17239.04443 MB
fter compute chunk allocated = 17238.90967 MB
Memory after cuda sdpa 17238.91748046875 MB
1
Memory before offload  17238.89599609375 MB
Memory after offload  17238.89599609375 MB
Memory before cuda sdpa 17238.90966796875 MB
On entering CUDA sdpa main function  allocated = 17238.90967 MB
Before first SDPA allocated = 17238.90967 MB
On chunked entry = 17238.90967 MB
On scale calculation = 17238.91748 MB
Before interleave = 17238.91748 MB
After interleave = 17239.41748 MB
After matmul = 17247.54443 MB
Before local copies matmul = 17247.54443 MB
After local copies = 17247.54736 MB
After first SDPA allocated = 17247.03467 MB
After first copy allocated = 17247.03467 MB
On chunked entry = 17247.03467 MB
On scale calculation = 17247.04248 MB
Before interleave = 17247.04248 MB
After interleave = 17247.16748 MB
After matmul = 17247.16797 MB
Before local copies matmul = 17247.16797 MB
After local copies = 17247.16943 MB
fter compute chunk allocated = 17247.03467 MB
Memory after cuda sdpa 17247.04248046875 MB
1
Memory before offload  17247.02099609375 MB
Memory after offload  17247.02099609375 MB
Memory before cuda sdpa 17247.03466796875 MB
On entering CUDA sdpa main function  allocated = 17247.03467 MB
Before first SDPA allocated = 17247.03467 MB
On chunked entry = 17247.03467 MB
On scale calculation = 17247.04248 MB
Before interleave = 17247.04248 MB
After interleave = 17247.54248 MB
After matmul = 17255.66943 MB
Before local copies matmul = 17255.66943 MB
After local copies = 17255.67236 MB
After first SDPA allocated = 17255.15967 MB
After first copy allocated = 17255.15967 MB
On chunked entry = 17255.15967 MB
On scale calculation = 17255.16748 MB
Before interleave = 17255.16748 MB
After interleave = 17255.29248 MB
After matmul = 17255.29297 MB
Before local copies matmul = 17255.29297 MB
After local copies = 17255.29443 MB
fter compute chunk allocated = 17255.15967 MB
Memory after cuda sdpa 17255.16748046875 MB
1
Memory before offload  17255.14599609375 MB
Memory after offload  17255.14599609375 MB
Memory before cuda sdpa 17255.15966796875 MB
On entering CUDA sdpa main function  allocated = 17255.15967 MB
Before first SDPA allocated = 17255.15967 MB
On chunked entry = 17255.15967 MB
On scale calculation = 17255.16748 MB
Before interleave = 17255.16748 MB
After interleave = 17255.66748 MB
After matmul = 17263.79443 MB
Before local copies matmul = 17263.79443 MB
After local copies = 17263.79736 MB
After first SDPA allocated = 17263.28467 MB
After first copy allocated = 17263.28467 MB
On chunked entry = 17263.28467 MB
On scale calculation = 17263.29248 MB
Before interleave = 17263.29248 MB
After interleave = 17263.41748 MB
After matmul = 17263.41797 MB
Before local copies matmul = 17263.41797 MB
After local copies = 17263.41943 MB
fter compute chunk allocated = 17263.28467 MB
Memory after cuda sdpa 17263.29248046875 MB
1
Memory before offload  17263.27099609375 MB
Memory after offload  17263.27099609375 MB
Memory before cuda sdpa 17263.28466796875 MB
On entering CUDA sdpa main function  allocated = 17263.28467 MB
Before first SDPA allocated = 17263.28467 MB
On chunked entry = 17263.28467 MB
On scale calculation = 17263.29248 MB
Before interleave = 17263.29248 MB
After interleave = 17263.79248 MB
After matmul = 17271.91943 MB
Before local copies matmul = 17271.91943 MB
After local copies = 17271.92236 MB
After first SDPA allocated = 17271.40967 MB
After first copy allocated = 17271.40967 MB
On chunked entry = 17271.40967 MB
On scale calculation = 17271.41748 MB
Before interleave = 17271.41748 MB
After interleave = 17271.54248 MB
After matmul = 17271.54297 MB
Before local copies matmul = 17271.54297 MB
After local copies = 17271.54443 MB
fter compute chunk allocated = 17271.40967 MB
Memory after cuda sdpa 17271.41748046875 MB
1
Memory before offload  17271.39599609375 MB
Memory after offload  17271.39599609375 MB
Memory before cuda sdpa 17271.40966796875 MB
On entering CUDA sdpa main function  allocated = 17271.40967 MB
Before first SDPA allocated = 17271.40967 MB
On chunked entry = 17271.40967 MB
On scale calculation = 17271.41748 MB
Before interleave = 17271.41748 MB
After interleave = 17271.91748 MB
After matmul = 17280.04443 MB
Before local copies matmul = 17280.04443 MB
After local copies = 17280.04736 MB
After first SDPA allocated = 17279.53467 MB
After first copy allocated = 17279.53467 MB
On chunked entry = 17279.53467 MB
On scale calculation = 17279.54248 MB
Before interleave = 17279.54248 MB
After interleave = 17279.66748 MB
After matmul = 17279.66797 MB
Before local copies matmul = 17279.66797 MB
After local copies = 17279.66943 MB
fter compute chunk allocated = 17279.53467 MB
Memory after cuda sdpa 17279.54248046875 MB
1
Memory before offload  17279.52099609375 MB
Memory after offload  17279.52099609375 MB
Memory before cuda sdpa 17279.53466796875 MB
On entering CUDA sdpa main function  allocated = 17279.53467 MB
Before first SDPA allocated = 17279.53467 MB
On chunked entry = 17279.53467 MB
On scale calculation = 17279.54248 MB
Before interleave = 17279.54248 MB
After interleave = 17280.04248 MB
After matmul = 17288.16943 MB
Before local copies matmul = 17288.16943 MB
After local copies = 17288.17236 MB
After first SDPA allocated = 17287.65967 MB
After first copy allocated = 17287.65967 MB
On chunked entry = 17287.65967 MB
On scale calculation = 17287.66748 MB
Before interleave = 17287.66748 MB
After interleave = 17287.79248 MB
After matmul = 17287.79297 MB
Before local copies matmul = 17287.79297 MB
After local copies = 17287.79443 MB
fter compute chunk allocated = 17287.65967 MB
Memory after cuda sdpa 17287.66748046875 MB
1
Memory before offload  17287.64599609375 MB
Memory after offload  17287.64599609375 MB
Memory before cuda sdpa 17287.65966796875 MB
On entering CUDA sdpa main function  allocated = 17287.65967 MB
Before first SDPA allocated = 17287.65967 MB
On chunked entry = 17287.65967 MB
On scale calculation = 17287.66748 MB
Before interleave = 17287.66748 MB
After interleave = 17288.16748 MB
After matmul = 17296.29443 MB
Before local copies matmul = 17296.29443 MB
After local copies = 17296.29736 MB
After first SDPA allocated = 17295.78467 MB
After first copy allocated = 17295.78467 MB
On chunked entry = 17295.78467 MB
On scale calculation = 17295.79248 MB
Before interleave = 17295.79248 MB
After interleave = 17295.91748 MB
After matmul = 17295.91797 MB
Before local copies matmul = 17295.91797 MB
After local copies = 17295.91943 MB
fter compute chunk allocated = 17295.78467 MB
Memory after cuda sdpa 17295.79248046875 MB
1
Memory before offload  17295.77099609375 MB
Memory after offload  17295.77099609375 MB
Memory before cuda sdpa 17295.78466796875 MB
On entering CUDA sdpa main function  allocated = 17295.78467 MB
Before first SDPA allocated = 17295.78467 MB
On chunked entry = 17295.78467 MB
On scale calculation = 17295.79248 MB
Before interleave = 17295.79248 MB
After interleave = 17296.29248 MB
After matmul = 17304.41943 MB
Before local copies matmul = 17304.41943 MB
After local copies = 17304.42236 MB
After first SDPA allocated = 17303.90967 MB
After first copy allocated = 17303.90967 MB
On chunked entry = 17303.90967 MB
On scale calculation = 17303.91748 MB
Before interleave = 17303.91748 MB
After interleave = 17304.04248 MB
After matmul = 17304.04297 MB
Before local copies matmul = 17304.04297 MB
After local copies = 17304.04443 MB
fter compute chunk allocated = 17303.90967 MB
Memory after cuda sdpa 17303.91748046875 MB
1
Memory before offload  17303.89599609375 MB
Memory after offload  17303.89599609375 MB
Memory before cuda sdpa 17303.90966796875 MB
On entering CUDA sdpa main function  allocated = 17303.90967 MB
Before first SDPA allocated = 17303.90967 MB
On chunked entry = 17303.90967 MB
On scale calculation = 17303.91748 MB
Before interleave = 17303.91748 MB
After interleave = 17304.41748 MB
After matmul = 17312.54443 MB
Before local copies matmul = 17312.54443 MB
After local copies = 17312.54736 MB
After first SDPA allocated = 17312.03467 MB
After first copy allocated = 17312.03467 MB
On chunked entry = 17312.03467 MB
On scale calculation = 17312.04248 MB
Before interleave = 17312.04248 MB
After interleave = 17312.16748 MB
After matmul = 17312.16797 MB
Before local copies matmul = 17312.16797 MB
After local copies = 17312.16943 MB
fter compute chunk allocated = 17312.03467 MB
Memory after cuda sdpa 17312.04248046875 MB
1
Memory before offload  17312.02099609375 MB
Memory after offload  17312.02099609375 MB
Memory before cuda sdpa 17312.03466796875 MB
On entering CUDA sdpa main function  allocated = 17312.03467 MB
Before first SDPA allocated = 17312.03467 MB
On chunked entry = 17312.03467 MB
On scale calculation = 17312.04248 MB
Before interleave = 17312.04248 MB
After interleave = 17312.54248 MB
After matmul = 17320.66943 MB
Before local copies matmul = 17320.66943 MB
After local copies = 17320.67236 MB
After first SDPA allocated = 17320.15967 MB
After first copy allocated = 17320.15967 MB
On chunked entry = 17320.15967 MB
On scale calculation = 17320.16748 MB
Before interleave = 17320.16748 MB
After interleave = 17320.29248 MB
After matmul = 17320.29297 MB
Before local copies matmul = 17320.29297 MB
After local copies = 17320.29443 MB
fter compute chunk allocated = 17320.15967 MB
Memory after cuda sdpa 17320.16748046875 MB
1
Memory before offload  17320.14599609375 MB
Memory after offload  17320.14599609375 MB
Memory before cuda sdpa 17320.15966796875 MB
On entering CUDA sdpa main function  allocated = 17320.15967 MB
Before first SDPA allocated = 17320.15967 MB
On chunked entry = 17320.15967 MB
On scale calculation = 17320.16748 MB
Before interleave = 17320.16748 MB
After interleave = 17320.66748 MB
After matmul = 17328.79443 MB
Before local copies matmul = 17328.79443 MB
After local copies = 17328.79736 MB
After first SDPA allocated = 17328.28467 MB
After first copy allocated = 17328.28467 MB
On chunked entry = 17328.28467 MB
On scale calculation = 17328.29248 MB
Before interleave = 17328.29248 MB
After interleave = 17328.41748 MB
After matmul = 17328.41797 MB
Before local copies matmul = 17328.41797 MB
After local copies = 17328.41943 MB
fter compute chunk allocated = 17328.28467 MB
Memory after cuda sdpa 17328.29248046875 MB
1
Memory before offload  17328.27099609375 MB
Memory after offload  17328.27099609375 MB
Memory before cuda sdpa 17328.28466796875 MB
On entering CUDA sdpa main function  allocated = 17328.28467 MB
Before first SDPA allocated = 17328.28467 MB
On chunked entry = 17328.28467 MB
On scale calculation = 17328.29248 MB
Before interleave = 17328.29248 MB
After interleave = 17328.79248 MB
After matmul = 17336.91943 MB
Before local copies matmul = 17336.91943 MB
After local copies = 17336.92236 MB
After first SDPA allocated = 17336.40967 MB
After first copy allocated = 17336.40967 MB
On chunked entry = 17336.40967 MB
On scale calculation = 17336.41748 MB
Before interleave = 17336.41748 MB
After interleave = 17336.54248 MB
After matmul = 17336.54297 MB
Before local copies matmul = 17336.54297 MB
After local copies = 17336.54443 MB
fter compute chunk allocated = 17336.40967 MB
Memory after cuda sdpa 17336.41748046875 MB
1
Memory before offload  17336.39599609375 MB
Memory after offload  17336.39599609375 MB
Memory before cuda sdpa 17336.40966796875 MB
On entering CUDA sdpa main function  allocated = 17336.40967 MB
Before first SDPA allocated = 17336.40967 MB
On chunked entry = 17336.40967 MB
On scale calculation = 17336.41748 MB
Before interleave = 17336.41748 MB
After interleave = 17336.91748 MB
After matmul = 17345.04443 MB
Before local copies matmul = 17345.04443 MB
After local copies = 17345.04736 MB
After first SDPA allocated = 17344.53467 MB
After first copy allocated = 17344.53467 MB
On chunked entry = 17344.53467 MB
On scale calculation = 17344.54248 MB
Before interleave = 17344.54248 MB
After interleave = 17344.66748 MB
After matmul = 17344.66797 MB
Before local copies matmul = 17344.66797 MB
After local copies = 17344.66943 MB
fter compute chunk allocated = 17344.53467 MB
Memory after cuda sdpa 17344.54248046875 MB
1
Memory before offload  17344.52099609375 MB
Memory after offload  17344.52099609375 MB
Memory before cuda sdpa 17344.53466796875 MB
On entering CUDA sdpa main function  allocated = 17344.53467 MB
Before first SDPA allocated = 17344.53467 MB
On chunked entry = 17344.53467 MB
On scale calculation = 17344.54248 MB
Before interleave = 17344.54248 MB
After interleave = 17345.04248 MB
After matmul = 17353.16943 MB
Before local copies matmul = 17353.16943 MB
After local copies = 17353.17236 MB
After first SDPA allocated = 17352.65967 MB
After first copy allocated = 17352.65967 MB
On chunked entry = 17352.65967 MB
On scale calculation = 17352.66748 MB
Before interleave = 17352.66748 MB
After interleave = 17352.79248 MB
After matmul = 17352.79297 MB
Before local copies matmul = 17352.79297 MB
After local copies = 17352.79443 MB
fter compute chunk allocated = 17352.65967 MB
Memory after cuda sdpa 17352.66748046875 MB
1
Memory before offload  17352.64599609375 MB
Memory after offload  17352.64599609375 MB
Memory before cuda sdpa 17352.65966796875 MB
On entering CUDA sdpa main function  allocated = 17352.65967 MB
Before first SDPA allocated = 17352.65967 MB
On chunked entry = 17352.65967 MB
On scale calculation = 17352.66748 MB
Before interleave = 17352.66748 MB
After interleave = 17353.16748 MB
After matmul = 17361.29443 MB
Before local copies matmul = 17361.29443 MB
After local copies = 17361.29736 MB
After first SDPA allocated = 17360.78467 MB
After first copy allocated = 17360.78467 MB
On chunked entry = 17360.78467 MB
On scale calculation = 17360.79248 MB
Before interleave = 17360.79248 MB
After interleave = 17360.91748 MB
After matmul = 17360.91797 MB
Before local copies matmul = 17360.91797 MB
After local copies = 17360.91943 MB
fter compute chunk allocated = 17360.78467 MB
Memory after cuda sdpa 17360.79248046875 MB
1
Memory before offload  17360.77099609375 MB
Memory after offload  17360.77099609375 MB
Memory before cuda sdpa 17360.78466796875 MB
On entering CUDA sdpa main function  allocated = 17360.78467 MB
Before first SDPA allocated = 17360.78467 MB
On chunked entry = 17360.78467 MB
On scale calculation = 17360.79248 MB
Before interleave = 17360.79248 MB
After interleave = 17361.29248 MB
After matmul = 17369.41943 MB
Before local copies matmul = 17369.41943 MB
After local copies = 17369.42236 MB
After first SDPA allocated = 17368.90967 MB
After first copy allocated = 17368.90967 MB
On chunked entry = 17368.90967 MB
On scale calculation = 17368.91748 MB
Before interleave = 17368.91748 MB
After interleave = 17369.04248 MB
After matmul = 17369.04297 MB
Before local copies matmul = 17369.04297 MB
After local copies = 17369.04443 MB
fter compute chunk allocated = 17368.90967 MB
Memory after cuda sdpa 17368.91748046875 MB
1
Memory before offload  17368.89599609375 MB
Memory after offload  17368.89599609375 MB
Memory before cuda sdpa 17368.90966796875 MB
On entering CUDA sdpa main function  allocated = 17368.90967 MB
Before first SDPA allocated = 17368.90967 MB
On chunked entry = 17368.90967 MB
On scale calculation = 17368.91748 MB
Before interleave = 17368.91748 MB
After interleave = 17369.41748 MB
After matmul = 17377.54443 MB
Before local copies matmul = 17377.54443 MB
After local copies = 17377.54736 MB
After first SDPA allocated = 17377.03467 MB
After first copy allocated = 17377.03467 MB
On chunked entry = 17377.03467 MB
On scale calculation = 17377.04248 MB
Before interleave = 17377.04248 MB
After interleave = 17377.16748 MB
After matmul = 17377.16797 MB
Before local copies matmul = 17377.16797 MB
After local copies = 17377.16943 MB
fter compute chunk allocated = 17377.03467 MB
Memory after cuda sdpa 17377.04248046875 MB
1
Memory before offload  17377.02099609375 MB
Memory after offload  17377.02099609375 MB
Memory before cuda sdpa 17377.03466796875 MB
On entering CUDA sdpa main function  allocated = 17377.03467 MB
Before first SDPA allocated = 17377.03467 MB
On chunked entry = 17377.03467 MB
On scale calculation = 17377.04248 MB
Before interleave = 17377.04248 MB
After interleave = 17377.54248 MB
After matmul = 17385.66943 MB
Before local copies matmul = 17385.66943 MB
After local copies = 17385.67236 MB
After first SDPA allocated = 17385.15967 MB
After first copy allocated = 17385.15967 MB
On chunked entry = 17385.15967 MB
On scale calculation = 17385.16748 MB
Before interleave = 17385.16748 MB
After interleave = 17385.29248 MB
After matmul = 17385.29297 MB
Before local copies matmul = 17385.29297 MB
After local copies = 17385.29443 MB
fter compute chunk allocated = 17385.15967 MB
Memory after cuda sdpa 17385.16748046875 MB
1
Memory before offload  17385.14599609375 MB
Memory after offload  17385.14599609375 MB
Memory before cuda sdpa 17385.15966796875 MB
On entering CUDA sdpa main function  allocated = 17385.15967 MB
Before first SDPA allocated = 17385.15967 MB
On chunked entry = 17385.15967 MB
On scale calculation = 17385.16748 MB
Before interleave = 17385.16748 MB
After interleave = 17385.66748 MB
After matmul = 17393.79443 MB
Before local copies matmul = 17393.79443 MB
After local copies = 17393.79736 MB
After first SDPA allocated = 17393.28467 MB
After first copy allocated = 17393.28467 MB
On chunked entry = 17393.28467 MB
On scale calculation = 17393.29248 MB
Before interleave = 17393.29248 MB
After interleave = 17393.41748 MB
After matmul = 17393.41797 MB
Before local copies matmul = 17393.41797 MB
After local copies = 17393.41943 MB
fter compute chunk allocated = 17393.28467 MB
Memory after cuda sdpa 17393.29248046875 MB
1
Memory before offload  17393.27099609375 MB
Memory after offload  17393.27099609375 MB
Memory before cuda sdpa 17393.28466796875 MB
On entering CUDA sdpa main function  allocated = 17393.28467 MB
Before first SDPA allocated = 17393.28467 MB
On chunked entry = 17393.28467 MB
On scale calculation = 17393.29248 MB
Before interleave = 17393.29248 MB
After interleave = 17393.79248 MB
After matmul = 17401.91943 MB
Before local copies matmul = 17401.91943 MB
After local copies = 17401.92236 MB
After first SDPA allocated = 17401.40967 MB
After first copy allocated = 17401.40967 MB
On chunked entry = 17401.40967 MB
On scale calculation = 17401.41748 MB
Before interleave = 17401.41748 MB
After interleave = 17401.54248 MB
After matmul = 17401.54297 MB
Before local copies matmul = 17401.54297 MB
After local copies = 17401.54443 MB
fter compute chunk allocated = 17401.40967 MB
Memory after cuda sdpa 17401.41748046875 MB
1
Memory before offload  17401.39599609375 MB
Memory after offload  17401.39599609375 MB
Memory before cuda sdpa 17401.40966796875 MB
On entering CUDA sdpa main function  allocated = 17401.40967 MB
Before first SDPA allocated = 17401.40967 MB
On chunked entry = 17401.40967 MB
On scale calculation = 17401.41748 MB
Before interleave = 17401.41748 MB
After interleave = 17401.91748 MB
After matmul = 17410.04443 MB
Before local copies matmul = 17410.04443 MB
After local copies = 17410.04736 MB
After first SDPA allocated = 17409.53467 MB
After first copy allocated = 17409.53467 MB
On chunked entry = 17409.53467 MB
On scale calculation = 17409.54248 MB
Before interleave = 17409.54248 MB
After interleave = 17409.66748 MB
After matmul = 17409.66797 MB
Before local copies matmul = 17409.66797 MB
After local copies = 17409.66943 MB
fter compute chunk allocated = 17409.53467 MB
Memory after cuda sdpa 17409.54248046875 MB
1
Memory before offload  17409.52099609375 MB
Memory after offload  17409.52099609375 MB
Memory before cuda sdpa 17409.53466796875 MB
On entering CUDA sdpa main function  allocated = 17409.53467 MB
Before first SDPA allocated = 17409.53467 MB
On chunked entry = 17409.53467 MB
On scale calculation = 17409.54248 MB
Before interleave = 17409.54248 MB
After interleave = 17410.04248 MB
After matmul = 17418.16943 MB
Before local copies matmul = 17418.16943 MB
After local copies = 17418.17236 MB
After first SDPA allocated = 17417.65967 MB
After first copy allocated = 17417.65967 MB
On chunked entry = 17417.65967 MB
On scale calculation = 17417.66748 MB
Before interleave = 17417.66748 MB
After interleave = 17417.79248 MB
After matmul = 17417.79297 MB
Before local copies matmul = 17417.79297 MB
After local copies = 17417.79443 MB
fter compute chunk allocated = 17417.65967 MB
Memory after cuda sdpa 17417.66748046875 MB
1
Memory before offload  17417.64599609375 MB
Memory after offload  17417.64599609375 MB
Memory before cuda sdpa 17417.65966796875 MB
On entering CUDA sdpa main function  allocated = 17417.65967 MB
Before first SDPA allocated = 17417.65967 MB
On chunked entry = 17417.65967 MB
On scale calculation = 17417.66748 MB
Before interleave = 17417.66748 MB
After interleave = 17418.16748 MB
After matmul = 17426.29443 MB
Before local copies matmul = 17426.29443 MB
After local copies = 17426.29736 MB
After first SDPA allocated = 17425.78467 MB
After first copy allocated = 17425.78467 MB
On chunked entry = 17425.78467 MB
On scale calculation = 17425.79248 MB
Before interleave = 17425.79248 MB
After interleave = 17425.91748 MB
After matmul = 17425.91797 MB
Before local copies matmul = 17425.91797 MB
After local copies = 17425.91943 MB
fter compute chunk allocated = 17425.78467 MB
Memory after cuda sdpa 17425.79248046875 MB
Decode step 9
1
Memory before offload  17425.771484375 MB
Memory after offload  17425.771484375 MB
Memory before cuda sdpa 17425.78515625 MB
On entering CUDA sdpa main function  allocated = 17425.78516 MB
Before first SDPA allocated = 17425.78516 MB
On chunked entry = 17425.78516 MB
On scale calculation = 17425.79297 MB
Before interleave = 17425.79297 MB
After interleave = 17426.29297 MB
After matmul = 17434.41992 MB
Before local copies matmul = 17434.41992 MB
After local copies = 17434.42285 MB
After first SDPA allocated = 17433.91016 MB
After first copy allocated = 17433.91016 MB
On chunked entry = 17433.91016 MB
On scale calculation = 17433.91797 MB
Before interleave = 17433.91797 MB
After interleave = 17434.05859 MB
After matmul = 17434.05957 MB
Before local copies matmul = 17434.05957 MB
After local copies = 17434.06152 MB
fter compute chunk allocated = 17433.91016 MB
Memory after cuda sdpa 17433.91796875 MB
1
Memory before offload  17433.896484375 MB
Memory after offload  17433.896484375 MB
Memory before cuda sdpa 17433.91015625 MB
On entering CUDA sdpa main function  allocated = 17433.91016 MB
Before first SDPA allocated = 17433.91016 MB
On chunked entry = 17433.91016 MB
On scale calculation = 17433.91797 MB
Before interleave = 17433.91797 MB
After interleave = 17434.41797 MB
After matmul = 17442.54492 MB
Before local copies matmul = 17442.54492 MB
After local copies = 17442.54785 MB
After first SDPA allocated = 17442.03516 MB
After first copy allocated = 17442.03516 MB
On chunked entry = 17442.03516 MB
On scale calculation = 17442.04297 MB
Before interleave = 17442.04297 MB
After interleave = 17442.18359 MB
After matmul = 17442.18457 MB
Before local copies matmul = 17442.18457 MB
After local copies = 17442.18652 MB
fter compute chunk allocated = 17442.03516 MB
Memory after cuda sdpa 17442.04296875 MB
1
Memory before offload  17442.021484375 MB
Memory after offload  17442.021484375 MB
Memory before cuda sdpa 17442.03515625 MB
On entering CUDA sdpa main function  allocated = 17442.03516 MB
Before first SDPA allocated = 17442.03516 MB
On chunked entry = 17442.03516 MB
On scale calculation = 17442.04297 MB
Before interleave = 17442.04297 MB
After interleave = 17442.54297 MB
After matmul = 17450.66992 MB
Before local copies matmul = 17450.66992 MB
After local copies = 17450.67285 MB
After first SDPA allocated = 17450.16016 MB
After first copy allocated = 17450.16016 MB
On chunked entry = 17450.16016 MB
On scale calculation = 17450.16797 MB
Before interleave = 17450.16797 MB
After interleave = 17450.30859 MB
After matmul = 17450.30957 MB
Before local copies matmul = 17450.30957 MB
After local copies = 17450.31152 MB
fter compute chunk allocated = 17450.16016 MB
Memory after cuda sdpa 17450.16796875 MB
1
Memory before offload  17450.146484375 MB
Memory after offload  17450.146484375 MB
Memory before cuda sdpa 17450.16015625 MB
On entering CUDA sdpa main function  allocated = 17450.16016 MB
Before first SDPA allocated = 17450.16016 MB
On chunked entry = 17450.16016 MB
On scale calculation = 17450.16797 MB
Before interleave = 17450.16797 MB
After interleave = 17450.66797 MB
After matmul = 17458.79492 MB
Before local copies matmul = 17458.79492 MB
After local copies = 17458.79785 MB
After first SDPA allocated = 17458.28516 MB
After first copy allocated = 17458.28516 MB
On chunked entry = 17458.28516 MB
On scale calculation = 17458.29297 MB
Before interleave = 17458.29297 MB
After interleave = 17458.43359 MB
After matmul = 17458.43457 MB
Before local copies matmul = 17458.43457 MB
After local copies = 17458.43652 MB
fter compute chunk allocated = 17458.28516 MB
Memory after cuda sdpa 17458.29296875 MB
1
Memory before offload  17458.271484375 MB
Memory after offload  17458.271484375 MB
Memory before cuda sdpa 17458.28515625 MB
On entering CUDA sdpa main function  allocated = 17458.28516 MB
Before first SDPA allocated = 17458.28516 MB
On chunked entry = 17458.28516 MB
On scale calculation = 17458.29297 MB
Before interleave = 17458.29297 MB
After interleave = 17458.79297 MB
After matmul = 17466.91992 MB
Before local copies matmul = 17466.91992 MB
After local copies = 17466.92285 MB
After first SDPA allocated = 17466.41016 MB
After first copy allocated = 17466.41016 MB
On chunked entry = 17466.41016 MB
On scale calculation = 17466.41797 MB
Before interleave = 17466.41797 MB
After interleave = 17466.55859 MB
After matmul = 17466.55957 MB
Before local copies matmul = 17466.55957 MB
After local copies = 17466.56152 MB
fter compute chunk allocated = 17466.41016 MB
Memory after cuda sdpa 17466.41796875 MB
1
Memory before offload  17466.396484375 MB
Memory after offload  17466.396484375 MB
Memory before cuda sdpa 17466.41015625 MB
On entering CUDA sdpa main function  allocated = 17466.41016 MB
Before first SDPA allocated = 17466.41016 MB
On chunked entry = 17466.41016 MB
On scale calculation = 17466.41797 MB
Before interleave = 17466.41797 MB
After interleave = 17466.91797 MB
After matmul = 17475.04492 MB
Before local copies matmul = 17475.04492 MB
After local copies = 17475.04785 MB
After first SDPA allocated = 17474.53516 MB
After first copy allocated = 17474.53516 MB
On chunked entry = 17474.53516 MB
On scale calculation = 17474.54297 MB
Before interleave = 17474.54297 MB
After interleave = 17474.68359 MB
After matmul = 17474.68457 MB
Before local copies matmul = 17474.68457 MB
After local copies = 17474.68652 MB
fter compute chunk allocated = 17474.53516 MB
Memory after cuda sdpa 17474.54296875 MB
1
Memory before offload  17474.521484375 MB
Memory after offload  17474.521484375 MB
Memory before cuda sdpa 17474.53515625 MB
On entering CUDA sdpa main function  allocated = 17474.53516 MB
Before first SDPA allocated = 17474.53516 MB
On chunked entry = 17474.53516 MB
On scale calculation = 17474.54297 MB
Before interleave = 17474.54297 MB
After interleave = 17475.04297 MB
After matmul = 17483.16992 MB
Before local copies matmul = 17483.16992 MB
After local copies = 17483.17285 MB
After first SDPA allocated = 17482.66016 MB
After first copy allocated = 17482.66016 MB
On chunked entry = 17482.66016 MB
On scale calculation = 17482.66797 MB
Before interleave = 17482.66797 MB
After interleave = 17482.80859 MB
After matmul = 17482.80957 MB
Before local copies matmul = 17482.80957 MB
After local copies = 17482.81152 MB
fter compute chunk allocated = 17482.66016 MB
Memory after cuda sdpa 17482.66796875 MB
1
Memory before offload  17482.646484375 MB
Memory after offload  17482.646484375 MB
Memory before cuda sdpa 17482.66015625 MB
On entering CUDA sdpa main function  allocated = 17482.66016 MB
Before first SDPA allocated = 17482.66016 MB
On chunked entry = 17482.66016 MB
On scale calculation = 17482.66797 MB
Before interleave = 17482.66797 MB
After interleave = 17483.16797 MB
After matmul = 17491.29492 MB
Before local copies matmul = 17491.29492 MB
After local copies = 17491.29785 MB
After first SDPA allocated = 17490.78516 MB
After first copy allocated = 17490.78516 MB
On chunked entry = 17490.78516 MB
On scale calculation = 17490.79297 MB
Before interleave = 17490.79297 MB
After interleave = 17490.93359 MB
After matmul = 17490.93457 MB
Before local copies matmul = 17490.93457 MB
After local copies = 17490.93652 MB
fter compute chunk allocated = 17490.78516 MB
Memory after cuda sdpa 17490.79296875 MB
1
Memory before offload  17490.771484375 MB
Memory after offload  17490.771484375 MB
Memory before cuda sdpa 17490.78515625 MB
On entering CUDA sdpa main function  allocated = 17490.78516 MB
Before first SDPA allocated = 17490.78516 MB
On chunked entry = 17490.78516 MB
On scale calculation = 17490.79297 MB
Before interleave = 17490.79297 MB
After interleave = 17491.29297 MB
After matmul = 17499.41992 MB
Before local copies matmul = 17499.41992 MB
After local copies = 17499.42285 MB
After first SDPA allocated = 17498.91016 MB
After first copy allocated = 17498.91016 MB
On chunked entry = 17498.91016 MB
On scale calculation = 17498.91797 MB
Before interleave = 17498.91797 MB
After interleave = 17499.05859 MB
After matmul = 17499.05957 MB
Before local copies matmul = 17499.05957 MB
After local copies = 17499.06152 MB
fter compute chunk allocated = 17498.91016 MB
Memory after cuda sdpa 17498.91796875 MB
1
Memory before offload  17498.896484375 MB
Memory after offload  17498.896484375 MB
Memory before cuda sdpa 17498.91015625 MB
On entering CUDA sdpa main function  allocated = 17498.91016 MB
Before first SDPA allocated = 17498.91016 MB
On chunked entry = 17498.91016 MB
On scale calculation = 17498.91797 MB
Before interleave = 17498.91797 MB
After interleave = 17499.41797 MB
After matmul = 17507.54492 MB
Before local copies matmul = 17507.54492 MB
After local copies = 17507.54785 MB
After first SDPA allocated = 17507.03516 MB
After first copy allocated = 17507.03516 MB
On chunked entry = 17507.03516 MB
On scale calculation = 17507.04297 MB
Before interleave = 17507.04297 MB
After interleave = 17507.18359 MB
After matmul = 17507.18457 MB
Before local copies matmul = 17507.18457 MB
After local copies = 17507.18652 MB
fter compute chunk allocated = 17507.03516 MB
Memory after cuda sdpa 17507.04296875 MB
1
Memory before offload  17507.021484375 MB
Memory after offload  17507.021484375 MB
Memory before cuda sdpa 17507.03515625 MB
On entering CUDA sdpa main function  allocated = 17507.03516 MB
Before first SDPA allocated = 17507.03516 MB
On chunked entry = 17507.03516 MB
On scale calculation = 17507.04297 MB
Before interleave = 17507.04297 MB
After interleave = 17507.54297 MB
After matmul = 17515.66992 MB
Before local copies matmul = 17515.66992 MB
After local copies = 17515.67285 MB
After first SDPA allocated = 17515.16016 MB
After first copy allocated = 17515.16016 MB
On chunked entry = 17515.16016 MB
On scale calculation = 17515.16797 MB
Before interleave = 17515.16797 MB
After interleave = 17515.30859 MB
After matmul = 17515.30957 MB
Before local copies matmul = 17515.30957 MB
After local copies = 17515.31152 MB
fter compute chunk allocated = 17515.16016 MB
Memory after cuda sdpa 17515.16796875 MB
1
Memory before offload  17515.146484375 MB
Memory after offload  17515.146484375 MB
Memory before cuda sdpa 17515.16015625 MB
On entering CUDA sdpa main function  allocated = 17515.16016 MB
Before first SDPA allocated = 17515.16016 MB
On chunked entry = 17515.16016 MB
On scale calculation = 17515.16797 MB
Before interleave = 17515.16797 MB
After interleave = 17515.66797 MB
After matmul = 17523.79492 MB
Before local copies matmul = 17523.79492 MB
After local copies = 17523.79785 MB
After first SDPA allocated = 17523.28516 MB
After first copy allocated = 17523.28516 MB
On chunked entry = 17523.28516 MB
On scale calculation = 17523.29297 MB
Before interleave = 17523.29297 MB
After interleave = 17523.43359 MB
After matmul = 17523.43457 MB
Before local copies matmul = 17523.43457 MB
After local copies = 17523.43652 MB
fter compute chunk allocated = 17523.28516 MB
Memory after cuda sdpa 17523.29296875 MB
1
Memory before offload  17523.271484375 MB
Memory after offload  17523.271484375 MB
Memory before cuda sdpa 17523.28515625 MB
On entering CUDA sdpa main function  allocated = 17523.28516 MB
Before first SDPA allocated = 17523.28516 MB
On chunked entry = 17523.28516 MB
On scale calculation = 17523.29297 MB
Before interleave = 17523.29297 MB
After interleave = 17523.79297 MB
After matmul = 17531.91992 MB
Before local copies matmul = 17531.91992 MB
After local copies = 17531.92285 MB
After first SDPA allocated = 17531.41016 MB
After first copy allocated = 17531.41016 MB
On chunked entry = 17531.41016 MB
On scale calculation = 17531.41797 MB
Before interleave = 17531.41797 MB
After interleave = 17531.55859 MB
After matmul = 17531.55957 MB
Before local copies matmul = 17531.55957 MB
After local copies = 17531.56152 MB
fter compute chunk allocated = 17531.41016 MB
Memory after cuda sdpa 17531.41796875 MB
1
Memory before offload  17531.396484375 MB
Memory after offload  17531.396484375 MB
Memory before cuda sdpa 17531.41015625 MB
On entering CUDA sdpa main function  allocated = 17531.41016 MB
Before first SDPA allocated = 17531.41016 MB
On chunked entry = 17531.41016 MB
On scale calculation = 17531.41797 MB
Before interleave = 17531.41797 MB
After interleave = 17531.91797 MB
After matmul = 17540.04492 MB
Before local copies matmul = 17540.04492 MB
After local copies = 17540.04785 MB
After first SDPA allocated = 17539.53516 MB
After first copy allocated = 17539.53516 MB
On chunked entry = 17539.53516 MB
On scale calculation = 17539.54297 MB
Before interleave = 17539.54297 MB
After interleave = 17539.68359 MB
After matmul = 17539.68457 MB
Before local copies matmul = 17539.68457 MB
After local copies = 17539.68652 MB
fter compute chunk allocated = 17539.53516 MB
Memory after cuda sdpa 17539.54296875 MB
1
Memory before offload  17539.521484375 MB
Memory after offload  17539.521484375 MB
Memory before cuda sdpa 17539.53515625 MB
On entering CUDA sdpa main function  allocated = 17539.53516 MB
Before first SDPA allocated = 17539.53516 MB
On chunked entry = 17539.53516 MB
On scale calculation = 17539.54297 MB
Before interleave = 17539.54297 MB
After interleave = 17540.04297 MB
After matmul = 17548.16992 MB
Before local copies matmul = 17548.16992 MB
After local copies = 17548.17285 MB
After first SDPA allocated = 17547.66016 MB
After first copy allocated = 17547.66016 MB
On chunked entry = 17547.66016 MB
On scale calculation = 17547.66797 MB
Before interleave = 17547.66797 MB
After interleave = 17547.80859 MB
After matmul = 17547.80957 MB
Before local copies matmul = 17547.80957 MB
After local copies = 17547.81152 MB
fter compute chunk allocated = 17547.66016 MB
Memory after cuda sdpa 17547.66796875 MB
1
Memory before offload  17547.646484375 MB
Memory after offload  17547.646484375 MB
Memory before cuda sdpa 17547.66015625 MB
On entering CUDA sdpa main function  allocated = 17547.66016 MB
Before first SDPA allocated = 17547.66016 MB
On chunked entry = 17547.66016 MB
On scale calculation = 17547.66797 MB
Before interleave = 17547.66797 MB
After interleave = 17548.16797 MB
After matmul = 17556.29492 MB
Before local copies matmul = 17556.29492 MB
After local copies = 17556.29785 MB
After first SDPA allocated = 17555.78516 MB
After first copy allocated = 17555.78516 MB
On chunked entry = 17555.78516 MB
On scale calculation = 17555.79297 MB
Before interleave = 17555.79297 MB
After interleave = 17555.93359 MB
After matmul = 17555.93457 MB
Before local copies matmul = 17555.93457 MB
After local copies = 17555.93652 MB
fter compute chunk allocated = 17555.78516 MB
Memory after cuda sdpa 17555.79296875 MB
1
Memory before offload  17555.771484375 MB
Memory after offload  17555.771484375 MB
Memory before cuda sdpa 17555.78515625 MB
On entering CUDA sdpa main function  allocated = 17555.78516 MB
Before first SDPA allocated = 17555.78516 MB
On chunked entry = 17555.78516 MB
On scale calculation = 17555.79297 MB
Before interleave = 17555.79297 MB
After interleave = 17556.29297 MB
After matmul = 17564.41992 MB
Before local copies matmul = 17564.41992 MB
After local copies = 17564.42285 MB
After first SDPA allocated = 17563.91016 MB
After first copy allocated = 17563.91016 MB
On chunked entry = 17563.91016 MB
On scale calculation = 17563.91797 MB
Before interleave = 17563.91797 MB
After interleave = 17564.05859 MB
After matmul = 17564.05957 MB
Before local copies matmul = 17564.05957 MB
After local copies = 17564.06152 MB
fter compute chunk allocated = 17563.91016 MB
Memory after cuda sdpa 17563.91796875 MB
1
Memory before offload  17563.896484375 MB
Memory after offload  17563.896484375 MB
Memory before cuda sdpa 17563.91015625 MB
On entering CUDA sdpa main function  allocated = 17563.91016 MB
Before first SDPA allocated = 17563.91016 MB
On chunked entry = 17563.91016 MB
On scale calculation = 17563.91797 MB
Before interleave = 17563.91797 MB
After interleave = 17564.41797 MB
After matmul = 17572.54492 MB
Before local copies matmul = 17572.54492 MB
After local copies = 17572.54785 MB
After first SDPA allocated = 17572.03516 MB
After first copy allocated = 17572.03516 MB
On chunked entry = 17572.03516 MB
On scale calculation = 17572.04297 MB
Before interleave = 17572.04297 MB
After interleave = 17572.18359 MB
After matmul = 17572.18457 MB
Before local copies matmul = 17572.18457 MB
After local copies = 17572.18652 MB
fter compute chunk allocated = 17572.03516 MB
Memory after cuda sdpa 17572.04296875 MB
1
Memory before offload  17572.021484375 MB
Memory after offload  17572.021484375 MB
Memory before cuda sdpa 17572.03515625 MB
On entering CUDA sdpa main function  allocated = 17572.03516 MB
Before first SDPA allocated = 17572.03516 MB
On chunked entry = 17572.03516 MB
On scale calculation = 17572.04297 MB
Before interleave = 17572.04297 MB
After interleave = 17572.54297 MB
After matmul = 17580.66992 MB
Before local copies matmul = 17580.66992 MB
After local copies = 17580.67285 MB
After first SDPA allocated = 17580.16016 MB
After first copy allocated = 17580.16016 MB
On chunked entry = 17580.16016 MB
On scale calculation = 17580.16797 MB
Before interleave = 17580.16797 MB
After interleave = 17580.30859 MB
After matmul = 17580.30957 MB
Before local copies matmul = 17580.30957 MB
After local copies = 17580.31152 MB
fter compute chunk allocated = 17580.16016 MB
Memory after cuda sdpa 17580.16796875 MB
1
Memory before offload  17580.146484375 MB
Memory after offload  17580.146484375 MB
Memory before cuda sdpa 17580.16015625 MB
On entering CUDA sdpa main function  allocated = 17580.16016 MB
Before first SDPA allocated = 17580.16016 MB
On chunked entry = 17580.16016 MB
On scale calculation = 17580.16797 MB
Before interleave = 17580.16797 MB
After interleave = 17580.66797 MB
After matmul = 17588.79492 MB
Before local copies matmul = 17588.79492 MB
After local copies = 17588.79785 MB
After first SDPA allocated = 17588.28516 MB
After first copy allocated = 17588.28516 MB
On chunked entry = 17588.28516 MB
On scale calculation = 17588.29297 MB
Before interleave = 17588.29297 MB
After interleave = 17588.43359 MB
After matmul = 17588.43457 MB
Before local copies matmul = 17588.43457 MB
After local copies = 17588.43652 MB
fter compute chunk allocated = 17588.28516 MB
Memory after cuda sdpa 17588.29296875 MB
1
Memory before offload  17588.271484375 MB
Memory after offload  17588.271484375 MB
Memory before cuda sdpa 17588.28515625 MB
On entering CUDA sdpa main function  allocated = 17588.28516 MB
Before first SDPA allocated = 17588.28516 MB
On chunked entry = 17588.28516 MB
On scale calculation = 17588.29297 MB
Before interleave = 17588.29297 MB
After interleave = 17588.79297 MB
After matmul = 17596.91992 MB
Before local copies matmul = 17596.91992 MB
After local copies = 17596.92285 MB
After first SDPA allocated = 17596.41016 MB
After first copy allocated = 17596.41016 MB
On chunked entry = 17596.41016 MB
On scale calculation = 17596.41797 MB
Before interleave = 17596.41797 MB
After interleave = 17596.55859 MB
After matmul = 17596.55957 MB
Before local copies matmul = 17596.55957 MB
After local copies = 17596.56152 MB
fter compute chunk allocated = 17596.41016 MB
Memory after cuda sdpa 17596.41796875 MB
1
Memory before offload  17596.396484375 MB
Memory after offload  17596.396484375 MB
Memory before cuda sdpa 17596.41015625 MB
On entering CUDA sdpa main function  allocated = 17596.41016 MB
Before first SDPA allocated = 17596.41016 MB
On chunked entry = 17596.41016 MB
On scale calculation = 17596.41797 MB
Before interleave = 17596.41797 MB
After interleave = 17596.91797 MB
After matmul = 17605.04492 MB
Before local copies matmul = 17605.04492 MB
After local copies = 17605.04785 MB
After first SDPA allocated = 17604.53516 MB
After first copy allocated = 17604.53516 MB
On chunked entry = 17604.53516 MB
On scale calculation = 17604.54297 MB
Before interleave = 17604.54297 MB
After interleave = 17604.68359 MB
After matmul = 17604.68457 MB
Before local copies matmul = 17604.68457 MB
After local copies = 17604.68652 MB
fter compute chunk allocated = 17604.53516 MB
Memory after cuda sdpa 17604.54296875 MB
1
Memory before offload  17604.521484375 MB
Memory after offload  17604.521484375 MB
Memory before cuda sdpa 17604.53515625 MB
On entering CUDA sdpa main function  allocated = 17604.53516 MB
Before first SDPA allocated = 17604.53516 MB
On chunked entry = 17604.53516 MB
On scale calculation = 17604.54297 MB
Before interleave = 17604.54297 MB
After interleave = 17605.04297 MB
After matmul = 17613.16992 MB
Before local copies matmul = 17613.16992 MB
After local copies = 17613.17285 MB
After first SDPA allocated = 17612.66016 MB
After first copy allocated = 17612.66016 MB
On chunked entry = 17612.66016 MB
On scale calculation = 17612.66797 MB
Before interleave = 17612.66797 MB
After interleave = 17612.80859 MB
After matmul = 17612.80957 MB
Before local copies matmul = 17612.80957 MB
After local copies = 17612.81152 MB
fter compute chunk allocated = 17612.66016 MB
Memory after cuda sdpa 17612.66796875 MB
1
Memory before offload  17612.646484375 MB
Memory after offload  17612.646484375 MB
Memory before cuda sdpa 17612.66015625 MB
On entering CUDA sdpa main function  allocated = 17612.66016 MB
Before first SDPA allocated = 17612.66016 MB
On chunked entry = 17612.66016 MB
On scale calculation = 17612.66797 MB
Before interleave = 17612.66797 MB
After interleave = 17613.16797 MB
After matmul = 17621.29492 MB
Before local copies matmul = 17621.29492 MB
After local copies = 17621.29785 MB
After first SDPA allocated = 17620.78516 MB
After first copy allocated = 17620.78516 MB
On chunked entry = 17620.78516 MB
On scale calculation = 17620.79297 MB
Before interleave = 17620.79297 MB
After interleave = 17620.93359 MB
After matmul = 17620.93457 MB
Before local copies matmul = 17620.93457 MB
After local copies = 17620.93652 MB
fter compute chunk allocated = 17620.78516 MB
Memory after cuda sdpa 17620.79296875 MB
1
Memory before offload  17620.771484375 MB
Memory after offload  17620.771484375 MB
Memory before cuda sdpa 17620.78515625 MB
On entering CUDA sdpa main function  allocated = 17620.78516 MB
Before first SDPA allocated = 17620.78516 MB
On chunked entry = 17620.78516 MB
On scale calculation = 17620.79297 MB
Before interleave = 17620.79297 MB
After interleave = 17621.29297 MB
After matmul = 17629.41992 MB
Before local copies matmul = 17629.41992 MB
After local copies = 17629.42285 MB
After first SDPA allocated = 17628.91016 MB
After first copy allocated = 17628.91016 MB
On chunked entry = 17628.91016 MB
On scale calculation = 17628.91797 MB
Before interleave = 17628.91797 MB
After interleave = 17629.05859 MB
After matmul = 17629.05957 MB
Before local copies matmul = 17629.05957 MB
After local copies = 17629.06152 MB
fter compute chunk allocated = 17628.91016 MB
Memory after cuda sdpa 17628.91796875 MB
1
Memory before offload  17628.896484375 MB
Memory after offload  17628.896484375 MB
Memory before cuda sdpa 17628.91015625 MB
On entering CUDA sdpa main function  allocated = 17628.91016 MB
Before first SDPA allocated = 17628.91016 MB
On chunked entry = 17628.91016 MB
On scale calculation = 17628.91797 MB
Before interleave = 17628.91797 MB
After interleave = 17629.41797 MB
After matmul = 17637.54492 MB
Before local copies matmul = 17637.54492 MB
After local copies = 17637.54785 MB
After first SDPA allocated = 17637.03516 MB
After first copy allocated = 17637.03516 MB
On chunked entry = 17637.03516 MB
On scale calculation = 17637.04297 MB
Before interleave = 17637.04297 MB
After interleave = 17637.18359 MB
After matmul = 17637.18457 MB
Before local copies matmul = 17637.18457 MB
After local copies = 17637.18652 MB
fter compute chunk allocated = 17637.03516 MB
Memory after cuda sdpa 17637.04296875 MB
1
Memory before offload  17637.021484375 MB
Memory after offload  17637.021484375 MB
Memory before cuda sdpa 17637.03515625 MB
On entering CUDA sdpa main function  allocated = 17637.03516 MB
Before first SDPA allocated = 17637.03516 MB
On chunked entry = 17637.03516 MB
On scale calculation = 17637.04297 MB
Before interleave = 17637.04297 MB
After interleave = 17637.54297 MB
After matmul = 17645.66992 MB
Before local copies matmul = 17645.66992 MB
After local copies = 17645.67285 MB
After first SDPA allocated = 17645.16016 MB
After first copy allocated = 17645.16016 MB
On chunked entry = 17645.16016 MB
On scale calculation = 17645.16797 MB
Before interleave = 17645.16797 MB
After interleave = 17645.30859 MB
After matmul = 17645.30957 MB
Before local copies matmul = 17645.30957 MB
After local copies = 17645.31152 MB
fter compute chunk allocated = 17645.16016 MB
Memory after cuda sdpa 17645.16796875 MB
1
Memory before offload  17645.146484375 MB
Memory after offload  17645.146484375 MB
Memory before cuda sdpa 17645.16015625 MB
On entering CUDA sdpa main function  allocated = 17645.16016 MB
Before first SDPA allocated = 17645.16016 MB
On chunked entry = 17645.16016 MB
On scale calculation = 17645.16797 MB
Before interleave = 17645.16797 MB
After interleave = 17645.66797 MB
After matmul = 17653.79492 MB
Before local copies matmul = 17653.79492 MB
After local copies = 17653.79785 MB
After first SDPA allocated = 17653.28516 MB
After first copy allocated = 17653.28516 MB
On chunked entry = 17653.28516 MB
On scale calculation = 17653.29297 MB
Before interleave = 17653.29297 MB
After interleave = 17653.43359 MB
After matmul = 17653.43457 MB
Before local copies matmul = 17653.43457 MB
After local copies = 17653.43652 MB
fter compute chunk allocated = 17653.28516 MB
Memory after cuda sdpa 17653.29296875 MB
1
Memory before offload  17653.271484375 MB
Memory after offload  17653.271484375 MB
Memory before cuda sdpa 17653.28515625 MB
On entering CUDA sdpa main function  allocated = 17653.28516 MB
Before first SDPA allocated = 17653.28516 MB
On chunked entry = 17653.28516 MB
On scale calculation = 17653.29297 MB
Before interleave = 17653.29297 MB
After interleave = 17653.79297 MB
After matmul = 17661.91992 MB
Before local copies matmul = 17661.91992 MB
After local copies = 17661.92285 MB
After first SDPA allocated = 17661.41016 MB
After first copy allocated = 17661.41016 MB
On chunked entry = 17661.41016 MB
On scale calculation = 17661.41797 MB
Before interleave = 17661.41797 MB
After interleave = 17661.55859 MB
After matmul = 17661.55957 MB
Before local copies matmul = 17661.55957 MB
After local copies = 17661.56152 MB
fter compute chunk allocated = 17661.41016 MB
Memory after cuda sdpa 17661.41796875 MB
1
Memory before offload  17661.396484375 MB
Memory after offload  17661.396484375 MB
Memory before cuda sdpa 17661.41015625 MB
On entering CUDA sdpa main function  allocated = 17661.41016 MB
Before first SDPA allocated = 17661.41016 MB
On chunked entry = 17661.41016 MB
On scale calculation = 17661.41797 MB
Before interleave = 17661.41797 MB
After interleave = 17661.91797 MB
After matmul = 17670.04492 MB
Before local copies matmul = 17670.04492 MB
After local copies = 17670.04785 MB
After first SDPA allocated = 17669.53516 MB
After first copy allocated = 17669.53516 MB
On chunked entry = 17669.53516 MB
On scale calculation = 17669.54297 MB
Before interleave = 17669.54297 MB
After interleave = 17669.68359 MB
After matmul = 17669.68457 MB
Before local copies matmul = 17669.68457 MB
After local copies = 17669.68652 MB
fter compute chunk allocated = 17669.53516 MB
Memory after cuda sdpa 17669.54296875 MB
1
Memory before offload  17669.521484375 MB
Memory after offload  17669.521484375 MB
Memory before cuda sdpa 17669.53515625 MB
On entering CUDA sdpa main function  allocated = 17669.53516 MB
Before first SDPA allocated = 17669.53516 MB
On chunked entry = 17669.53516 MB
On scale calculation = 17669.54297 MB
Before interleave = 17669.54297 MB
After interleave = 17670.04297 MB
After matmul = 17678.16992 MB
Before local copies matmul = 17678.16992 MB
After local copies = 17678.17285 MB
After first SDPA allocated = 17677.66016 MB
After first copy allocated = 17677.66016 MB
On chunked entry = 17677.66016 MB
On scale calculation = 17677.66797 MB
Before interleave = 17677.66797 MB
After interleave = 17677.80859 MB
After matmul = 17677.80957 MB
Before local copies matmul = 17677.80957 MB
After local copies = 17677.81152 MB
fter compute chunk allocated = 17677.66016 MB
Memory after cuda sdpa 17677.66796875 MB
1
Memory before offload  17677.646484375 MB
Memory after offload  17677.646484375 MB
Memory before cuda sdpa 17677.66015625 MB
On entering CUDA sdpa main function  allocated = 17677.66016 MB
Before first SDPA allocated = 17677.66016 MB
On chunked entry = 17677.66016 MB
On scale calculation = 17677.66797 MB
Before interleave = 17677.66797 MB
After interleave = 17678.16797 MB
After matmul = 17686.29492 MB
Before local copies matmul = 17686.29492 MB
After local copies = 17686.29785 MB
After first SDPA allocated = 17685.78516 MB
After first copy allocated = 17685.78516 MB
On chunked entry = 17685.78516 MB
On scale calculation = 17685.79297 MB
Before interleave = 17685.79297 MB
After interleave = 17685.93359 MB
After matmul = 17685.93457 MB
Before local copies matmul = 17685.93457 MB
After local copies = 17685.93652 MB
fter compute chunk allocated = 17685.78516 MB
Memory after cuda sdpa 17685.79296875 MB
Decode step 10
1
Memory before offload  17685.77197265625 MB
Memory after offload  17685.77197265625 MB
Memory before cuda sdpa 17685.78564453125 MB
On entering CUDA sdpa main function  allocated = 17685.78564 MB
Before first SDPA allocated = 17685.78564 MB
On chunked entry = 17685.78564 MB
On scale calculation = 17685.79346 MB
Before interleave = 17685.79346 MB
After interleave = 17686.29346 MB
After matmul = 17694.42041 MB
Before local copies matmul = 17694.42041 MB
After local copies = 17694.42334 MB
After first SDPA allocated = 17693.91064 MB
After first copy allocated = 17693.91064 MB
On chunked entry = 17693.91064 MB
On scale calculation = 17693.91846 MB
Before interleave = 17693.91846 MB
After interleave = 17694.07471 MB
After matmul = 17694.07568 MB
Before local copies matmul = 17694.07568 MB
After local copies = 17694.07764 MB
fter compute chunk allocated = 17693.91064 MB
Memory after cuda sdpa 17693.91845703125 MB
1
Memory before offload  17693.89697265625 MB
Memory after offload  17693.89697265625 MB
Memory before cuda sdpa 17693.91064453125 MB
On entering CUDA sdpa main function  allocated = 17693.91064 MB
Before first SDPA allocated = 17693.91064 MB
On chunked entry = 17693.91064 MB
On scale calculation = 17693.91846 MB
Before interleave = 17693.91846 MB
After interleave = 17694.41846 MB
After matmul = 17702.54541 MB
Before local copies matmul = 17702.54541 MB
After local copies = 17702.54834 MB
After first SDPA allocated = 17702.03564 MB
After first copy allocated = 17702.03564 MB
On chunked entry = 17702.03564 MB
On scale calculation = 17702.04346 MB
Before interleave = 17702.04346 MB
After interleave = 17702.19971 MB
After matmul = 17702.20068 MB
Before local copies matmul = 17702.20068 MB
After local copies = 17702.20264 MB
fter compute chunk allocated = 17702.03564 MB
Memory after cuda sdpa 17702.04345703125 MB
1
Memory before offload  17702.02197265625 MB
Memory after offload  17702.02197265625 MB
Memory before cuda sdpa 17702.03564453125 MB
On entering CUDA sdpa main function  allocated = 17702.03564 MB
Before first SDPA allocated = 17702.03564 MB
On chunked entry = 17702.03564 MB
On scale calculation = 17702.04346 MB
Before interleave = 17702.04346 MB
After interleave = 17702.54346 MB
After matmul = 17710.67041 MB
Before local copies matmul = 17710.67041 MB
After local copies = 17710.67334 MB
After first SDPA allocated = 17710.16064 MB
After first copy allocated = 17710.16064 MB
On chunked entry = 17710.16064 MB
On scale calculation = 17710.16846 MB
Before interleave = 17710.16846 MB
After interleave = 17710.32471 MB
After matmul = 17710.32568 MB
Before local copies matmul = 17710.32568 MB
After local copies = 17710.32764 MB
fter compute chunk allocated = 17710.16064 MB
Memory after cuda sdpa 17710.16845703125 MB
1
Memory before offload  17710.14697265625 MB
Memory after offload  17710.14697265625 MB
Memory before cuda sdpa 17710.16064453125 MB
On entering CUDA sdpa main function  allocated = 17710.16064 MB
Before first SDPA allocated = 17710.16064 MB
On chunked entry = 17710.16064 MB
On scale calculation = 17710.16846 MB
Before interleave = 17710.16846 MB
After interleave = 17710.66846 MB
After matmul = 17718.79541 MB
Before local copies matmul = 17718.79541 MB
After local copies = 17718.79834 MB
After first SDPA allocated = 17718.28564 MB
After first copy allocated = 17718.28564 MB
On chunked entry = 17718.28564 MB
On scale calculation = 17718.29346 MB
Before interleave = 17718.29346 MB
After interleave = 17718.44971 MB
After matmul = 17718.45068 MB
Before local copies matmul = 17718.45068 MB
After local copies = 17718.45264 MB
fter compute chunk allocated = 17718.28564 MB
Memory after cuda sdpa 17718.29345703125 MB
1
Memory before offload  17718.27197265625 MB
Memory after offload  17718.27197265625 MB
Memory before cuda sdpa 17718.28564453125 MB
On entering CUDA sdpa main function  allocated = 17718.28564 MB
Before first SDPA allocated = 17718.28564 MB
On chunked entry = 17718.28564 MB
On scale calculation = 17718.29346 MB
Before interleave = 17718.29346 MB
After interleave = 17718.79346 MB
After matmul = 17726.92041 MB
Before local copies matmul = 17726.92041 MB
After local copies = 17726.92334 MB
After first SDPA allocated = 17726.41064 MB
After first copy allocated = 17726.41064 MB
On chunked entry = 17726.41064 MB
On scale calculation = 17726.41846 MB
Before interleave = 17726.41846 MB
After interleave = 17726.57471 MB
After matmul = 17726.57568 MB
Before local copies matmul = 17726.57568 MB
After local copies = 17726.57764 MB
fter compute chunk allocated = 17726.41064 MB
Memory after cuda sdpa 17726.41845703125 MB
1
Memory before offload  17726.39697265625 MB
Memory after offload  17726.39697265625 MB
Memory before cuda sdpa 17726.41064453125 MB
On entering CUDA sdpa main function  allocated = 17726.41064 MB
Before first SDPA allocated = 17726.41064 MB
On chunked entry = 17726.41064 MB
On scale calculation = 17726.41846 MB
Before interleave = 17726.41846 MB
After interleave = 17726.91846 MB
After matmul = 17735.04541 MB
Before local copies matmul = 17735.04541 MB
After local copies = 17735.04834 MB
After first SDPA allocated = 17734.53564 MB
After first copy allocated = 17734.53564 MB
On chunked entry = 17734.53564 MB
On scale calculation = 17734.54346 MB
Before interleave = 17734.54346 MB
After interleave = 17734.69971 MB
After matmul = 17734.70068 MB
Before local copies matmul = 17734.70068 MB
After local copies = 17734.70264 MB
fter compute chunk allocated = 17734.53564 MB
Memory after cuda sdpa 17734.54345703125 MB
1
Memory before offload  17734.52197265625 MB
Memory after offload  17734.52197265625 MB
Memory before cuda sdpa 17734.53564453125 MB
On entering CUDA sdpa main function  allocated = 17734.53564 MB
Before first SDPA allocated = 17734.53564 MB
On chunked entry = 17734.53564 MB
On scale calculation = 17734.54346 MB
Before interleave = 17734.54346 MB
After interleave = 17735.04346 MB
After matmul = 17743.17041 MB
Before local copies matmul = 17743.17041 MB
After local copies = 17743.17334 MB
After first SDPA allocated = 17742.66064 MB
After first copy allocated = 17742.66064 MB
On chunked entry = 17742.66064 MB
On scale calculation = 17742.66846 MB
Before interleave = 17742.66846 MB
After interleave = 17742.82471 MB
After matmul = 17742.82568 MB
Before local copies matmul = 17742.82568 MB
After local copies = 17742.82764 MB
fter compute chunk allocated = 17742.66064 MB
Memory after cuda sdpa 17742.66845703125 MB
1
Memory before offload  17742.64697265625 MB
Memory after offload  17742.64697265625 MB
Memory before cuda sdpa 17742.66064453125 MB
On entering CUDA sdpa main function  allocated = 17742.66064 MB
Before first SDPA allocated = 17742.66064 MB
On chunked entry = 17742.66064 MB
On scale calculation = 17742.66846 MB
Before interleave = 17742.66846 MB
After interleave = 17743.16846 MB
After matmul = 17751.29541 MB
Before local copies matmul = 17751.29541 MB
After local copies = 17751.29834 MB
After first SDPA allocated = 17750.78564 MB
After first copy allocated = 17750.78564 MB
On chunked entry = 17750.78564 MB
On scale calculation = 17750.79346 MB
Before interleave = 17750.79346 MB
After interleave = 17750.94971 MB
After matmul = 17750.95068 MB
Before local copies matmul = 17750.95068 MB
After local copies = 17750.95264 MB
fter compute chunk allocated = 17750.78564 MB
Memory after cuda sdpa 17750.79345703125 MB
1
Memory before offload  17750.77197265625 MB
Memory after offload  17750.77197265625 MB
Memory before cuda sdpa 17750.78564453125 MB
On entering CUDA sdpa main function  allocated = 17750.78564 MB
Before first SDPA allocated = 17750.78564 MB
On chunked entry = 17750.78564 MB
On scale calculation = 17750.79346 MB
Before interleave = 17750.79346 MB
After interleave = 17751.29346 MB
After matmul = 17759.42041 MB
Before local copies matmul = 17759.42041 MB
After local copies = 17759.42334 MB
After first SDPA allocated = 17758.91064 MB
After first copy allocated = 17758.91064 MB
On chunked entry = 17758.91064 MB
On scale calculation = 17758.91846 MB
Before interleave = 17758.91846 MB
After interleave = 17759.07471 MB
After matmul = 17759.07568 MB
Before local copies matmul = 17759.07568 MB
After local copies = 17759.07764 MB
fter compute chunk allocated = 17758.91064 MB
Memory after cuda sdpa 17758.91845703125 MB
1
Memory before offload  17758.89697265625 MB
Memory after offload  17758.89697265625 MB
Memory before cuda sdpa 17758.91064453125 MB
On entering CUDA sdpa main function  allocated = 17758.91064 MB
Before first SDPA allocated = 17758.91064 MB
On chunked entry = 17758.91064 MB
On scale calculation = 17758.91846 MB
Before interleave = 17758.91846 MB
After interleave = 17759.41846 MB
After matmul = 17767.54541 MB
Before local copies matmul = 17767.54541 MB
After local copies = 17767.54834 MB
After first SDPA allocated = 17767.03564 MB
After first copy allocated = 17767.03564 MB
On chunked entry = 17767.03564 MB
On scale calculation = 17767.04346 MB
Before interleave = 17767.04346 MB
After interleave = 17767.19971 MB
After matmul = 17767.20068 MB
Before local copies matmul = 17767.20068 MB
After local copies = 17767.20264 MB
fter compute chunk allocated = 17767.03564 MB
Memory after cuda sdpa 17767.04345703125 MB
1
Memory before offload  17767.02197265625 MB
Memory after offload  17767.02197265625 MB
Memory before cuda sdpa 17767.03564453125 MB
On entering CUDA sdpa main function  allocated = 17767.03564 MB
Before first SDPA allocated = 17767.03564 MB
On chunked entry = 17767.03564 MB
On scale calculation = 17767.04346 MB
Before interleave = 17767.04346 MB
After interleave = 17767.54346 MB
After matmul = 17775.67041 MB
Before local copies matmul = 17775.67041 MB
After local copies = 17775.67334 MB
After first SDPA allocated = 17775.16064 MB
After first copy allocated = 17775.16064 MB
On chunked entry = 17775.16064 MB
On scale calculation = 17775.16846 MB
Before interleave = 17775.16846 MB
After interleave = 17775.32471 MB
After matmul = 17775.32568 MB
Before local copies matmul = 17775.32568 MB
After local copies = 17775.32764 MB
fter compute chunk allocated = 17775.16064 MB
Memory after cuda sdpa 17775.16845703125 MB
1
Memory before offload  17775.14697265625 MB
Memory after offload  17775.14697265625 MB
Memory before cuda sdpa 17775.16064453125 MB
On entering CUDA sdpa main function  allocated = 17775.16064 MB
Before first SDPA allocated = 17775.16064 MB
On chunked entry = 17775.16064 MB
On scale calculation = 17775.16846 MB
Before interleave = 17775.16846 MB
After interleave = 17775.66846 MB
After matmul = 17783.79541 MB
Before local copies matmul = 17783.79541 MB
After local copies = 17783.79834 MB
After first SDPA allocated = 17783.28564 MB
After first copy allocated = 17783.28564 MB
On chunked entry = 17783.28564 MB
On scale calculation = 17783.29346 MB
Before interleave = 17783.29346 MB
After interleave = 17783.44971 MB
After matmul = 17783.45068 MB
Before local copies matmul = 17783.45068 MB
After local copies = 17783.45264 MB
fter compute chunk allocated = 17783.28564 MB
Memory after cuda sdpa 17783.29345703125 MB
1
Memory before offload  17783.27197265625 MB
Memory after offload  17783.27197265625 MB
Memory before cuda sdpa 17783.28564453125 MB
On entering CUDA sdpa main function  allocated = 17783.28564 MB
Before first SDPA allocated = 17783.28564 MB
On chunked entry = 17783.28564 MB
On scale calculation = 17783.29346 MB
Before interleave = 17783.29346 MB
After interleave = 17783.79346 MB
After matmul = 17791.92041 MB
Before local copies matmul = 17791.92041 MB
After local copies = 17791.92334 MB
After first SDPA allocated = 17791.41064 MB
After first copy allocated = 17791.41064 MB
On chunked entry = 17791.41064 MB
On scale calculation = 17791.41846 MB
Before interleave = 17791.41846 MB
After interleave = 17791.57471 MB
After matmul = 17791.57568 MB
Before local copies matmul = 17791.57568 MB
After local copies = 17791.57764 MB
fter compute chunk allocated = 17791.41064 MB
Memory after cuda sdpa 17791.41845703125 MB
1
Memory before offload  17791.39697265625 MB
Memory after offload  17791.39697265625 MB
Memory before cuda sdpa 17791.41064453125 MB
On entering CUDA sdpa main function  allocated = 17791.41064 MB
Before first SDPA allocated = 17791.41064 MB
On chunked entry = 17791.41064 MB
On scale calculation = 17791.41846 MB
Before interleave = 17791.41846 MB
After interleave = 17791.91846 MB
After matmul = 17800.04541 MB
Before local copies matmul = 17800.04541 MB
After local copies = 17800.04834 MB
After first SDPA allocated = 17799.53564 MB
After first copy allocated = 17799.53564 MB
On chunked entry = 17799.53564 MB
On scale calculation = 17799.54346 MB
Before interleave = 17799.54346 MB
After interleave = 17799.69971 MB
After matmul = 17799.70068 MB
Before local copies matmul = 17799.70068 MB
After local copies = 17799.70264 MB
fter compute chunk allocated = 17799.53564 MB
Memory after cuda sdpa 17799.54345703125 MB
1
Memory before offload  17799.52197265625 MB
Memory after offload  17799.52197265625 MB
Memory before cuda sdpa 17799.53564453125 MB
On entering CUDA sdpa main function  allocated = 17799.53564 MB
Before first SDPA allocated = 17799.53564 MB
On chunked entry = 17799.53564 MB
On scale calculation = 17799.54346 MB
Before interleave = 17799.54346 MB
After interleave = 17800.04346 MB
After matmul = 17808.17041 MB
Before local copies matmul = 17808.17041 MB
After local copies = 17808.17334 MB
After first SDPA allocated = 17807.66064 MB
After first copy allocated = 17807.66064 MB
On chunked entry = 17807.66064 MB
On scale calculation = 17807.66846 MB
Before interleave = 17807.66846 MB
After interleave = 17807.82471 MB
After matmul = 17807.82568 MB
Before local copies matmul = 17807.82568 MB
After local copies = 17807.82764 MB
fter compute chunk allocated = 17807.66064 MB
Memory after cuda sdpa 17807.66845703125 MB
1
Memory before offload  17807.64697265625 MB
Memory after offload  17807.64697265625 MB
Memory before cuda sdpa 17807.66064453125 MB
On entering CUDA sdpa main function  allocated = 17807.66064 MB
Before first SDPA allocated = 17807.66064 MB
On chunked entry = 17807.66064 MB
On scale calculation = 17807.66846 MB
Before interleave = 17807.66846 MB
After interleave = 17808.16846 MB
After matmul = 17816.29541 MB
Before local copies matmul = 17816.29541 MB
After local copies = 17816.29834 MB
After first SDPA allocated = 17815.78564 MB
After first copy allocated = 17815.78564 MB
On chunked entry = 17815.78564 MB
On scale calculation = 17815.79346 MB
Before interleave = 17815.79346 MB
After interleave = 17815.94971 MB
After matmul = 17815.95068 MB
Before local copies matmul = 17815.95068 MB
After local copies = 17815.95264 MB
fter compute chunk allocated = 17815.78564 MB
Memory after cuda sdpa 17815.79345703125 MB
1
Memory before offload  17815.77197265625 MB
Memory after offload  17815.77197265625 MB
Memory before cuda sdpa 17815.78564453125 MB
On entering CUDA sdpa main function  allocated = 17815.78564 MB
Before first SDPA allocated = 17815.78564 MB
On chunked entry = 17815.78564 MB
On scale calculation = 17815.79346 MB
Before interleave = 17815.79346 MB
After interleave = 17816.29346 MB
After matmul = 17824.42041 MB
Before local copies matmul = 17824.42041 MB
After local copies = 17824.42334 MB
After first SDPA allocated = 17823.91064 MB
After first copy allocated = 17823.91064 MB
On chunked entry = 17823.91064 MB
On scale calculation = 17823.91846 MB
Before interleave = 17823.91846 MB
After interleave = 17824.07471 MB
After matmul = 17824.07568 MB
Before local copies matmul = 17824.07568 MB
After local copies = 17824.07764 MB
fter compute chunk allocated = 17823.91064 MB
Memory after cuda sdpa 17823.91845703125 MB
1
Memory before offload  17823.89697265625 MB
Memory after offload  17823.89697265625 MB
Memory before cuda sdpa 17823.91064453125 MB
On entering CUDA sdpa main function  allocated = 17823.91064 MB
Before first SDPA allocated = 17823.91064 MB
On chunked entry = 17823.91064 MB
On scale calculation = 17823.91846 MB
Before interleave = 17823.91846 MB
After interleave = 17824.41846 MB
After matmul = 17832.54541 MB
Before local copies matmul = 17832.54541 MB
After local copies = 17832.54834 MB
After first SDPA allocated = 17832.03564 MB
After first copy allocated = 17832.03564 MB
On chunked entry = 17832.03564 MB
On scale calculation = 17832.04346 MB
Before interleave = 17832.04346 MB
After interleave = 17832.19971 MB
After matmul = 17832.20068 MB
Before local copies matmul = 17832.20068 MB
After local copies = 17832.20264 MB
fter compute chunk allocated = 17832.03564 MB
Memory after cuda sdpa 17832.04345703125 MB
1
Memory before offload  17832.02197265625 MB
Memory after offload  17832.02197265625 MB
Memory before cuda sdpa 17832.03564453125 MB
On entering CUDA sdpa main function  allocated = 17832.03564 MB
Before first SDPA allocated = 17832.03564 MB
On chunked entry = 17832.03564 MB
On scale calculation = 17832.04346 MB
Before interleave = 17832.04346 MB
After interleave = 17832.54346 MB
After matmul = 17840.67041 MB
Before local copies matmul = 17840.67041 MB
After local copies = 17840.67334 MB
After first SDPA allocated = 17840.16064 MB
After first copy allocated = 17840.16064 MB
On chunked entry = 17840.16064 MB
On scale calculation = 17840.16846 MB
Before interleave = 17840.16846 MB
After interleave = 17840.32471 MB
After matmul = 17840.32568 MB
Before local copies matmul = 17840.32568 MB
After local copies = 17840.32764 MB
fter compute chunk allocated = 17840.16064 MB
Memory after cuda sdpa 17840.16845703125 MB
1
Memory before offload  17840.14697265625 MB
Memory after offload  17840.14697265625 MB
Memory before cuda sdpa 17840.16064453125 MB
On entering CUDA sdpa main function  allocated = 17840.16064 MB
Before first SDPA allocated = 17840.16064 MB
On chunked entry = 17840.16064 MB
On scale calculation = 17840.16846 MB
Before interleave = 17840.16846 MB
After interleave = 17840.66846 MB
After matmul = 17848.79541 MB
Before local copies matmul = 17848.79541 MB
After local copies = 17848.79834 MB
After first SDPA allocated = 17848.28564 MB
After first copy allocated = 17848.28564 MB
On chunked entry = 17848.28564 MB
On scale calculation = 17848.29346 MB
Before interleave = 17848.29346 MB
After interleave = 17848.44971 MB
After matmul = 17848.45068 MB
Before local copies matmul = 17848.45068 MB
After local copies = 17848.45264 MB
fter compute chunk allocated = 17848.28564 MB
Memory after cuda sdpa 17848.29345703125 MB
1
Memory before offload  17848.27197265625 MB
Memory after offload  17848.27197265625 MB
Memory before cuda sdpa 17848.28564453125 MB
On entering CUDA sdpa main function  allocated = 17848.28564 MB
Before first SDPA allocated = 17848.28564 MB
On chunked entry = 17848.28564 MB
On scale calculation = 17848.29346 MB
Before interleave = 17848.29346 MB
After interleave = 17848.79346 MB
After matmul = 17856.92041 MB
Before local copies matmul = 17856.92041 MB
After local copies = 17856.92334 MB
After first SDPA allocated = 17856.41064 MB
After first copy allocated = 17856.41064 MB
On chunked entry = 17856.41064 MB
On scale calculation = 17856.41846 MB
Before interleave = 17856.41846 MB
After interleave = 17856.57471 MB
After matmul = 17856.57568 MB
Before local copies matmul = 17856.57568 MB
After local copies = 17856.57764 MB
fter compute chunk allocated = 17856.41064 MB
Memory after cuda sdpa 17856.41845703125 MB
1
Memory before offload  17856.39697265625 MB
Memory after offload  17856.39697265625 MB
Memory before cuda sdpa 17856.41064453125 MB
On entering CUDA sdpa main function  allocated = 17856.41064 MB
Before first SDPA allocated = 17856.41064 MB
On chunked entry = 17856.41064 MB
On scale calculation = 17856.41846 MB
Before interleave = 17856.41846 MB
After interleave = 17856.91846 MB
After matmul = 17865.04541 MB
Before local copies matmul = 17865.04541 MB
After local copies = 17865.04834 MB
After first SDPA allocated = 17864.53564 MB
After first copy allocated = 17864.53564 MB
On chunked entry = 17864.53564 MB
On scale calculation = 17864.54346 MB
Before interleave = 17864.54346 MB
After interleave = 17864.69971 MB
After matmul = 17864.70068 MB
Before local copies matmul = 17864.70068 MB
After local copies = 17864.70264 MB
fter compute chunk allocated = 17864.53564 MB
Memory after cuda sdpa 17864.54345703125 MB
1
Memory before offload  17864.52197265625 MB
Memory after offload  17864.52197265625 MB
Memory before cuda sdpa 17864.53564453125 MB
On entering CUDA sdpa main function  allocated = 17864.53564 MB
Before first SDPA allocated = 17864.53564 MB
On chunked entry = 17864.53564 MB
On scale calculation = 17864.54346 MB
Before interleave = 17864.54346 MB
After interleave = 17865.04346 MB
After matmul = 17873.17041 MB
Before local copies matmul = 17873.17041 MB
After local copies = 17873.17334 MB
After first SDPA allocated = 17872.66064 MB
After first copy allocated = 17872.66064 MB
On chunked entry = 17872.66064 MB
On scale calculation = 17872.66846 MB
Before interleave = 17872.66846 MB
After interleave = 17872.82471 MB
After matmul = 17872.82568 MB
Before local copies matmul = 17872.82568 MB
After local copies = 17872.82764 MB
fter compute chunk allocated = 17872.66064 MB
Memory after cuda sdpa 17872.66845703125 MB
1
Memory before offload  17872.64697265625 MB
Memory after offload  17872.64697265625 MB
Memory before cuda sdpa 17872.66064453125 MB
On entering CUDA sdpa main function  allocated = 17872.66064 MB
Before first SDPA allocated = 17872.66064 MB
On chunked entry = 17872.66064 MB
On scale calculation = 17872.66846 MB
Before interleave = 17872.66846 MB
After interleave = 17873.16846 MB
After matmul = 17881.29541 MB
Before local copies matmul = 17881.29541 MB
After local copies = 17881.29834 MB
After first SDPA allocated = 17880.78564 MB
After first copy allocated = 17880.78564 MB
On chunked entry = 17880.78564 MB
On scale calculation = 17880.79346 MB
Before interleave = 17880.79346 MB
After interleave = 17880.94971 MB
After matmul = 17880.95068 MB
Before local copies matmul = 17880.95068 MB
After local copies = 17880.95264 MB
fter compute chunk allocated = 17880.78564 MB
Memory after cuda sdpa 17880.79345703125 MB
1
Memory before offload  17880.77197265625 MB
Memory after offload  17880.77197265625 MB
Memory before cuda sdpa 17880.78564453125 MB
On entering CUDA sdpa main function  allocated = 17880.78564 MB
Before first SDPA allocated = 17880.78564 MB
On chunked entry = 17880.78564 MB
On scale calculation = 17880.79346 MB
Before interleave = 17880.79346 MB
After interleave = 17881.29346 MB
After matmul = 17889.42041 MB
Before local copies matmul = 17889.42041 MB
After local copies = 17889.42334 MB
After first SDPA allocated = 17888.91064 MB
After first copy allocated = 17888.91064 MB
On chunked entry = 17888.91064 MB
On scale calculation = 17888.91846 MB
Before interleave = 17888.91846 MB
After interleave = 17889.07471 MB
After matmul = 17889.07568 MB
Before local copies matmul = 17889.07568 MB
After local copies = 17889.07764 MB
fter compute chunk allocated = 17888.91064 MB
Memory after cuda sdpa 17888.91845703125 MB
1
Memory before offload  17888.89697265625 MB
Memory after offload  17888.89697265625 MB
Memory before cuda sdpa 17888.91064453125 MB
On entering CUDA sdpa main function  allocated = 17888.91064 MB
Before first SDPA allocated = 17888.91064 MB
On chunked entry = 17888.91064 MB
On scale calculation = 17888.91846 MB
Before interleave = 17888.91846 MB
After interleave = 17889.41846 MB
After matmul = 17897.54541 MB
Before local copies matmul = 17897.54541 MB
After local copies = 17897.54834 MB
After first SDPA allocated = 17897.03564 MB
After first copy allocated = 17897.03564 MB
On chunked entry = 17897.03564 MB
On scale calculation = 17897.04346 MB
Before interleave = 17897.04346 MB
After interleave = 17897.19971 MB
After matmul = 17897.20068 MB
Before local copies matmul = 17897.20068 MB
After local copies = 17897.20264 MB
fter compute chunk allocated = 17897.03564 MB
Memory after cuda sdpa 17897.04345703125 MB
1
Memory before offload  17897.02197265625 MB
Memory after offload  17897.02197265625 MB
Memory before cuda sdpa 17897.03564453125 MB
On entering CUDA sdpa main function  allocated = 17897.03564 MB
Before first SDPA allocated = 17897.03564 MB
On chunked entry = 17897.03564 MB
On scale calculation = 17897.04346 MB
Before interleave = 17897.04346 MB
After interleave = 17897.54346 MB
After matmul = 17905.67041 MB
Before local copies matmul = 17905.67041 MB
After local copies = 17905.67334 MB
After first SDPA allocated = 17905.16064 MB
After first copy allocated = 17905.16064 MB
On chunked entry = 17905.16064 MB
On scale calculation = 17905.16846 MB
Before interleave = 17905.16846 MB
After interleave = 17905.32471 MB
After matmul = 17905.32568 MB
Before local copies matmul = 17905.32568 MB
After local copies = 17905.32764 MB
fter compute chunk allocated = 17905.16064 MB
Memory after cuda sdpa 17905.16845703125 MB
1
Memory before offload  17905.14697265625 MB
Memory after offload  17905.14697265625 MB
Memory before cuda sdpa 17905.16064453125 MB
On entering CUDA sdpa main function  allocated = 17905.16064 MB
Before first SDPA allocated = 17905.16064 MB
On chunked entry = 17905.16064 MB
On scale calculation = 17905.16846 MB
Before interleave = 17905.16846 MB
After interleave = 17905.66846 MB
After matmul = 17913.79541 MB
Before local copies matmul = 17913.79541 MB
After local copies = 17913.79834 MB
After first SDPA allocated = 17913.28564 MB
After first copy allocated = 17913.28564 MB
On chunked entry = 17913.28564 MB
On scale calculation = 17913.29346 MB
Before interleave = 17913.29346 MB
After interleave = 17913.44971 MB
After matmul = 17913.45068 MB
Before local copies matmul = 17913.45068 MB
After local copies = 17913.45264 MB
fter compute chunk allocated = 17913.28564 MB
Memory after cuda sdpa 17913.29345703125 MB
1
Memory before offload  17913.27197265625 MB
Memory after offload  17913.27197265625 MB
Memory before cuda sdpa 17913.28564453125 MB
On entering CUDA sdpa main function  allocated = 17913.28564 MB
Before first SDPA allocated = 17913.28564 MB
On chunked entry = 17913.28564 MB
On scale calculation = 17913.29346 MB
Before interleave = 17913.29346 MB
After interleave = 17913.79346 MB
After matmul = 17921.92041 MB
Before local copies matmul = 17921.92041 MB
After local copies = 17921.92334 MB
After first SDPA allocated = 17921.41064 MB
After first copy allocated = 17921.41064 MB
On chunked entry = 17921.41064 MB
On scale calculation = 17921.41846 MB
Before interleave = 17921.41846 MB
After interleave = 17921.57471 MB
After matmul = 17921.57568 MB
Before local copies matmul = 17921.57568 MB
After local copies = 17921.57764 MB
fter compute chunk allocated = 17921.41064 MB
Memory after cuda sdpa 17921.41845703125 MB
1
Memory before offload  17921.39697265625 MB
Memory after offload  17921.39697265625 MB
Memory before cuda sdpa 17921.41064453125 MB
On entering CUDA sdpa main function  allocated = 17921.41064 MB
Before first SDPA allocated = 17921.41064 MB
On chunked entry = 17921.41064 MB
On scale calculation = 17921.41846 MB
Before interleave = 17921.41846 MB
After interleave = 17921.91846 MB
After matmul = 17930.04541 MB
Before local copies matmul = 17930.04541 MB
After local copies = 17930.04834 MB
After first SDPA allocated = 17929.53564 MB
After first copy allocated = 17929.53564 MB
On chunked entry = 17929.53564 MB
On scale calculation = 17929.54346 MB
Before interleave = 17929.54346 MB
After interleave = 17929.69971 MB
After matmul = 17929.70068 MB
Before local copies matmul = 17929.70068 MB
After local copies = 17929.70264 MB
fter compute chunk allocated = 17929.53564 MB
Memory after cuda sdpa 17929.54345703125 MB
1
Memory before offload  17929.52197265625 MB
Memory after offload  17929.52197265625 MB
Memory before cuda sdpa 17929.53564453125 MB
On entering CUDA sdpa main function  allocated = 17929.53564 MB
Before first SDPA allocated = 17929.53564 MB
On chunked entry = 17929.53564 MB
On scale calculation = 17929.54346 MB
Before interleave = 17929.54346 MB
After interleave = 17930.04346 MB
After matmul = 17938.17041 MB
Before local copies matmul = 17938.17041 MB
After local copies = 17938.17334 MB
After first SDPA allocated = 17937.66064 MB
After first copy allocated = 17937.66064 MB
On chunked entry = 17937.66064 MB
On scale calculation = 17937.66846 MB
Before interleave = 17937.66846 MB
After interleave = 17937.82471 MB
After matmul = 17937.82568 MB
Before local copies matmul = 17937.82568 MB
After local copies = 17937.82764 MB
fter compute chunk allocated = 17937.66064 MB
Memory after cuda sdpa 17937.66845703125 MB
1
Memory before offload  17937.64697265625 MB
Memory after offload  17937.64697265625 MB
Memory before cuda sdpa 17937.66064453125 MB
On entering CUDA sdpa main function  allocated = 17937.66064 MB
Before first SDPA allocated = 17937.66064 MB
On chunked entry = 17937.66064 MB
On scale calculation = 17937.66846 MB
Before interleave = 17937.66846 MB
After interleave = 17938.16846 MB
After matmul = 17946.29541 MB
Before local copies matmul = 17946.29541 MB
After local copies = 17946.29834 MB
After first SDPA allocated = 17945.78564 MB
After first copy allocated = 17945.78564 MB
On chunked entry = 17945.78564 MB
On scale calculation = 17945.79346 MB
Before interleave = 17945.79346 MB
After interleave = 17945.94971 MB
After matmul = 17945.95068 MB
Before local copies matmul = 17945.95068 MB
After local copies = 17945.95264 MB
fter compute chunk allocated = 17945.78564 MB
Memory after cuda sdpa 17945.79345703125 MB
Decode step 11
1
Memory before offload  17945.7724609375 MB
Memory after offload  17945.7724609375 MB
Memory before cuda sdpa 17945.7861328125 MB
On entering CUDA sdpa main function  allocated = 17945.78613 MB
Before first SDPA allocated = 17945.78613 MB
On chunked entry = 17945.78613 MB
On scale calculation = 17945.79395 MB
Before interleave = 17945.79395 MB
After interleave = 17946.29395 MB
After matmul = 17954.42090 MB
Before local copies matmul = 17954.42090 MB
After local copies = 17954.42383 MB
After first SDPA allocated = 17953.91113 MB
After first copy allocated = 17953.91113 MB
On chunked entry = 17953.91113 MB
On scale calculation = 17953.91895 MB
Before interleave = 17953.91895 MB
After interleave = 17954.09082 MB
After matmul = 17954.09180 MB
Before local copies matmul = 17954.09180 MB
After local copies = 17954.09375 MB
fter compute chunk allocated = 17953.91113 MB
Memory after cuda sdpa 17953.9189453125 MB
1
Memory before offload  17953.8974609375 MB
Memory after offload  17953.8974609375 MB
Memory before cuda sdpa 17953.9111328125 MB
On entering CUDA sdpa main function  allocated = 17953.91113 MB
Before first SDPA allocated = 17953.91113 MB
On chunked entry = 17953.91113 MB
On scale calculation = 17953.91895 MB
Before interleave = 17953.91895 MB
After interleave = 17954.41895 MB
After matmul = 17962.54590 MB
Before local copies matmul = 17962.54590 MB
After local copies = 17962.54883 MB
After first SDPA allocated = 17962.03613 MB
After first copy allocated = 17962.03613 MB
On chunked entry = 17962.03613 MB
On scale calculation = 17962.04395 MB
Before interleave = 17962.04395 MB
After interleave = 17962.21582 MB
After matmul = 17962.21680 MB
Before local copies matmul = 17962.21680 MB
After local copies = 17962.21875 MB
fter compute chunk allocated = 17962.03613 MB
Memory after cuda sdpa 17962.0439453125 MB
1
Memory before offload  17962.0224609375 MB
Memory after offload  17962.0224609375 MB
Memory before cuda sdpa 17962.0361328125 MB
On entering CUDA sdpa main function  allocated = 17962.03613 MB
Before first SDPA allocated = 17962.03613 MB
On chunked entry = 17962.03613 MB
On scale calculation = 17962.04395 MB
Before interleave = 17962.04395 MB
After interleave = 17962.54395 MB
After matmul = 17970.67090 MB
Before local copies matmul = 17970.67090 MB
After local copies = 17970.67383 MB
After first SDPA allocated = 17970.16113 MB
After first copy allocated = 17970.16113 MB
On chunked entry = 17970.16113 MB
On scale calculation = 17970.16895 MB
Before interleave = 17970.16895 MB
After interleave = 17970.34082 MB
After matmul = 17970.34180 MB
Before local copies matmul = 17970.34180 MB
After local copies = 17970.34375 MB
fter compute chunk allocated = 17970.16113 MB
Memory after cuda sdpa 17970.1689453125 MB
1
Memory before offload  17970.1474609375 MB
Memory after offload  17970.1474609375 MB
Memory before cuda sdpa 17970.1611328125 MB
On entering CUDA sdpa main function  allocated = 17970.16113 MB
Before first SDPA allocated = 17970.16113 MB
On chunked entry = 17970.16113 MB
On scale calculation = 17970.16895 MB
Before interleave = 17970.16895 MB
After interleave = 17970.66895 MB
After matmul = 17978.79590 MB
Before local copies matmul = 17978.79590 MB
After local copies = 17978.79883 MB
After first SDPA allocated = 17978.28613 MB
After first copy allocated = 17978.28613 MB
On chunked entry = 17978.28613 MB
On scale calculation = 17978.29395 MB
Before interleave = 17978.29395 MB
After interleave = 17978.46582 MB
After matmul = 17978.46680 MB
Before local copies matmul = 17978.46680 MB
After local copies = 17978.46875 MB
fter compute chunk allocated = 17978.28613 MB
Memory after cuda sdpa 17978.2939453125 MB
1
Memory before offload  17978.2724609375 MB
Memory after offload  17978.2724609375 MB
Memory before cuda sdpa 17978.2861328125 MB
On entering CUDA sdpa main function  allocated = 17978.28613 MB
Before first SDPA allocated = 17978.28613 MB
On chunked entry = 17978.28613 MB
On scale calculation = 17978.29395 MB
Before interleave = 17978.29395 MB
After interleave = 17978.79395 MB
After matmul = 17986.92090 MB
Before local copies matmul = 17986.92090 MB
After local copies = 17986.92383 MB
After first SDPA allocated = 17986.41113 MB
After first copy allocated = 17986.41113 MB
On chunked entry = 17986.41113 MB
On scale calculation = 17986.41895 MB
Before interleave = 17986.41895 MB
After interleave = 17986.59082 MB
After matmul = 17986.59180 MB
Before local copies matmul = 17986.59180 MB
After local copies = 17986.59375 MB
fter compute chunk allocated = 17986.41113 MB
Memory after cuda sdpa 17986.4189453125 MB
1
Memory before offload  17986.3974609375 MB
Memory after offload  17986.3974609375 MB
Memory before cuda sdpa 17986.4111328125 MB
On entering CUDA sdpa main function  allocated = 17986.41113 MB
Before first SDPA allocated = 17986.41113 MB
On chunked entry = 17986.41113 MB
On scale calculation = 17986.41895 MB
Before interleave = 17986.41895 MB
After interleave = 17986.91895 MB
After matmul = 17995.04590 MB
Before local copies matmul = 17995.04590 MB
After local copies = 17995.04883 MB
After first SDPA allocated = 17994.53613 MB
After first copy allocated = 17994.53613 MB
On chunked entry = 17994.53613 MB
On scale calculation = 17994.54395 MB
Before interleave = 17994.54395 MB
After interleave = 17994.71582 MB
After matmul = 17994.71680 MB
Before local copies matmul = 17994.71680 MB
After local copies = 17994.71875 MB
fter compute chunk allocated = 17994.53613 MB
Memory after cuda sdpa 17994.5439453125 MB
1
Memory before offload  17994.5224609375 MB
Memory after offload  17994.5224609375 MB
Memory before cuda sdpa 17994.5361328125 MB
On entering CUDA sdpa main function  allocated = 17994.53613 MB
Before first SDPA allocated = 17994.53613 MB
On chunked entry = 17994.53613 MB
On scale calculation = 17994.54395 MB
Before interleave = 17994.54395 MB
After interleave = 17995.04395 MB
After matmul = 18003.17090 MB
Before local copies matmul = 18003.17090 MB
After local copies = 18003.17383 MB
After first SDPA allocated = 18002.66113 MB
After first copy allocated = 18002.66113 MB
On chunked entry = 18002.66113 MB
On scale calculation = 18002.66895 MB
Before interleave = 18002.66895 MB
After interleave = 18002.84082 MB
After matmul = 18002.84180 MB
Before local copies matmul = 18002.84180 MB
After local copies = 18002.84375 MB
fter compute chunk allocated = 18002.66113 MB
Memory after cuda sdpa 18002.6689453125 MB
1
Memory before offload  18002.6474609375 MB
Memory after offload  18002.6474609375 MB
Memory before cuda sdpa 18002.6611328125 MB
On entering CUDA sdpa main function  allocated = 18002.66113 MB
Before first SDPA allocated = 18002.66113 MB
On chunked entry = 18002.66113 MB
On scale calculation = 18002.66895 MB
Before interleave = 18002.66895 MB
After interleave = 18003.16895 MB
After matmul = 18011.29590 MB
Before local copies matmul = 18011.29590 MB
After local copies = 18011.29883 MB
After first SDPA allocated = 18010.78613 MB
After first copy allocated = 18010.78613 MB
On chunked entry = 18010.78613 MB
On scale calculation = 18010.79395 MB
Before interleave = 18010.79395 MB
After interleave = 18010.96582 MB
After matmul = 18010.96680 MB
Before local copies matmul = 18010.96680 MB
After local copies = 18010.96875 MB
fter compute chunk allocated = 18010.78613 MB
Memory after cuda sdpa 18010.7939453125 MB
1
Memory before offload  18010.7724609375 MB
Memory after offload  18010.7724609375 MB
Memory before cuda sdpa 18010.7861328125 MB
On entering CUDA sdpa main function  allocated = 18010.78613 MB
Before first SDPA allocated = 18010.78613 MB
On chunked entry = 18010.78613 MB
On scale calculation = 18010.79395 MB
Before interleave = 18010.79395 MB
After interleave = 18011.29395 MB
After matmul = 18019.42090 MB
Before local copies matmul = 18019.42090 MB
After local copies = 18019.42383 MB
After first SDPA allocated = 18018.91113 MB
After first copy allocated = 18018.91113 MB
On chunked entry = 18018.91113 MB
On scale calculation = 18018.91895 MB
Before interleave = 18018.91895 MB
After interleave = 18019.09082 MB
After matmul = 18019.09180 MB
Before local copies matmul = 18019.09180 MB
After local copies = 18019.09375 MB
fter compute chunk allocated = 18018.91113 MB
Memory after cuda sdpa 18018.9189453125 MB
1
Memory before offload  18018.8974609375 MB
Memory after offload  18018.8974609375 MB
Memory before cuda sdpa 18018.9111328125 MB
On entering CUDA sdpa main function  allocated = 18018.91113 MB
Before first SDPA allocated = 18018.91113 MB
On chunked entry = 18018.91113 MB
On scale calculation = 18018.91895 MB
Before interleave = 18018.91895 MB
After interleave = 18019.41895 MB
After matmul = 18027.54590 MB
Before local copies matmul = 18027.54590 MB
After local copies = 18027.54883 MB
After first SDPA allocated = 18027.03613 MB
After first copy allocated = 18027.03613 MB
On chunked entry = 18027.03613 MB
On scale calculation = 18027.04395 MB
Before interleave = 18027.04395 MB
After interleave = 18027.21582 MB
After matmul = 18027.21680 MB
Before local copies matmul = 18027.21680 MB
After local copies = 18027.21875 MB
fter compute chunk allocated = 18027.03613 MB
Memory after cuda sdpa 18027.0439453125 MB
1
Memory before offload  18027.0224609375 MB
Memory after offload  18027.0224609375 MB
Memory before cuda sdpa 18027.0361328125 MB
On entering CUDA sdpa main function  allocated = 18027.03613 MB
Before first SDPA allocated = 18027.03613 MB
On chunked entry = 18027.03613 MB
On scale calculation = 18027.04395 MB
Before interleave = 18027.04395 MB
After interleave = 18027.54395 MB
After matmul = 18035.67090 MB
Before local copies matmul = 18035.67090 MB
After local copies = 18035.67383 MB
After first SDPA allocated = 18035.16113 MB
After first copy allocated = 18035.16113 MB
On chunked entry = 18035.16113 MB
On scale calculation = 18035.16895 MB
Before interleave = 18035.16895 MB
After interleave = 18035.34082 MB
After matmul = 18035.34180 MB
Before local copies matmul = 18035.34180 MB
After local copies = 18035.34375 MB
fter compute chunk allocated = 18035.16113 MB
Memory after cuda sdpa 18035.1689453125 MB
1
Memory before offload  18035.1474609375 MB
Memory after offload  18035.1474609375 MB
Memory before cuda sdpa 18035.1611328125 MB
On entering CUDA sdpa main function  allocated = 18035.16113 MB
Before first SDPA allocated = 18035.16113 MB
On chunked entry = 18035.16113 MB
On scale calculation = 18035.16895 MB
Before interleave = 18035.16895 MB
After interleave = 18035.66895 MB
After matmul = 18043.79590 MB
Before local copies matmul = 18043.79590 MB
After local copies = 18043.79883 MB
After first SDPA allocated = 18043.28613 MB
After first copy allocated = 18043.28613 MB
On chunked entry = 18043.28613 MB
On scale calculation = 18043.29395 MB
Before interleave = 18043.29395 MB
After interleave = 18043.46582 MB
After matmul = 18043.46680 MB
Before local copies matmul = 18043.46680 MB
After local copies = 18043.46875 MB
fter compute chunk allocated = 18043.28613 MB
Memory after cuda sdpa 18043.2939453125 MB
1
Memory before offload  18043.2724609375 MB
Memory after offload  18043.2724609375 MB
Memory before cuda sdpa 18043.2861328125 MB
On entering CUDA sdpa main function  allocated = 18043.28613 MB
Before first SDPA allocated = 18043.28613 MB
On chunked entry = 18043.28613 MB
On scale calculation = 18043.29395 MB
Before interleave = 18043.29395 MB
After interleave = 18043.79395 MB
After matmul = 18051.92090 MB
Before local copies matmul = 18051.92090 MB
After local copies = 18051.92383 MB
After first SDPA allocated = 18051.41113 MB
After first copy allocated = 18051.41113 MB
On chunked entry = 18051.41113 MB
On scale calculation = 18051.41895 MB
Before interleave = 18051.41895 MB
After interleave = 18051.59082 MB
After matmul = 18051.59180 MB
Before local copies matmul = 18051.59180 MB
After local copies = 18051.59375 MB
fter compute chunk allocated = 18051.41113 MB
Memory after cuda sdpa 18051.4189453125 MB
1
Memory before offload  18051.3974609375 MB
Memory after offload  18051.3974609375 MB
Memory before cuda sdpa 18051.4111328125 MB
On entering CUDA sdpa main function  allocated = 18051.41113 MB
Before first SDPA allocated = 18051.41113 MB
On chunked entry = 18051.41113 MB
On scale calculation = 18051.41895 MB
Before interleave = 18051.41895 MB
After interleave = 18051.91895 MB
After matmul = 18060.04590 MB
Before local copies matmul = 18060.04590 MB
After local copies = 18060.04883 MB
After first SDPA allocated = 18059.53613 MB
After first copy allocated = 18059.53613 MB
On chunked entry = 18059.53613 MB
On scale calculation = 18059.54395 MB
Before interleave = 18059.54395 MB
After interleave = 18059.71582 MB
After matmul = 18059.71680 MB
Before local copies matmul = 18059.71680 MB
After local copies = 18059.71875 MB
fter compute chunk allocated = 18059.53613 MB
Memory after cuda sdpa 18059.5439453125 MB
1
Memory before offload  18059.5224609375 MB
Memory after offload  18059.5224609375 MB
Memory before cuda sdpa 18059.5361328125 MB
On entering CUDA sdpa main function  allocated = 18059.53613 MB
Before first SDPA allocated = 18059.53613 MB
On chunked entry = 18059.53613 MB
On scale calculation = 18059.54395 MB
Before interleave = 18059.54395 MB
After interleave = 18060.04395 MB
After matmul = 18068.17090 MB
Before local copies matmul = 18068.17090 MB
After local copies = 18068.17383 MB
After first SDPA allocated = 18067.66113 MB
After first copy allocated = 18067.66113 MB
On chunked entry = 18067.66113 MB
On scale calculation = 18067.66895 MB
Before interleave = 18067.66895 MB
After interleave = 18067.84082 MB
After matmul = 18067.84180 MB
Before local copies matmul = 18067.84180 MB
After local copies = 18067.84375 MB
fter compute chunk allocated = 18067.66113 MB
Memory after cuda sdpa 18067.6689453125 MB
1
Memory before offload  18067.6474609375 MB
Memory after offload  18067.6474609375 MB
Memory before cuda sdpa 18067.6611328125 MB
On entering CUDA sdpa main function  allocated = 18067.66113 MB
Before first SDPA allocated = 18067.66113 MB
On chunked entry = 18067.66113 MB
On scale calculation = 18067.66895 MB
Before interleave = 18067.66895 MB
After interleave = 18068.16895 MB
After matmul = 18076.29590 MB
Before local copies matmul = 18076.29590 MB
After local copies = 18076.29883 MB
After first SDPA allocated = 18075.78613 MB
After first copy allocated = 18075.78613 MB
On chunked entry = 18075.78613 MB
On scale calculation = 18075.79395 MB
Before interleave = 18075.79395 MB
After interleave = 18075.96582 MB
After matmul = 18075.96680 MB
Before local copies matmul = 18075.96680 MB
After local copies = 18075.96875 MB
fter compute chunk allocated = 18075.78613 MB
Memory after cuda sdpa 18075.7939453125 MB
1
Memory before offload  18075.7724609375 MB
Memory after offload  18075.7724609375 MB
Memory before cuda sdpa 18075.7861328125 MB
On entering CUDA sdpa main function  allocated = 18075.78613 MB
Before first SDPA allocated = 18075.78613 MB
On chunked entry = 18075.78613 MB
On scale calculation = 18075.79395 MB
Before interleave = 18075.79395 MB
After interleave = 18076.29395 MB
After matmul = 18084.42090 MB
Before local copies matmul = 18084.42090 MB
After local copies = 18084.42383 MB
After first SDPA allocated = 18083.91113 MB
After first copy allocated = 18083.91113 MB
On chunked entry = 18083.91113 MB
On scale calculation = 18083.91895 MB
Before interleave = 18083.91895 MB
After interleave = 18084.09082 MB
After matmul = 18084.09180 MB
Before local copies matmul = 18084.09180 MB
After local copies = 18084.09375 MB
fter compute chunk allocated = 18083.91113 MB
Memory after cuda sdpa 18083.9189453125 MB
1
Memory before offload  18083.8974609375 MB
Memory after offload  18083.8974609375 MB
Memory before cuda sdpa 18083.9111328125 MB
On entering CUDA sdpa main function  allocated = 18083.91113 MB
Before first SDPA allocated = 18083.91113 MB
On chunked entry = 18083.91113 MB
On scale calculation = 18083.91895 MB
Before interleave = 18083.91895 MB
After interleave = 18084.41895 MB
After matmul = 18092.54590 MB
Before local copies matmul = 18092.54590 MB
After local copies = 18092.54883 MB
After first SDPA allocated = 18092.03613 MB
After first copy allocated = 18092.03613 MB
On chunked entry = 18092.03613 MB
On scale calculation = 18092.04395 MB
Before interleave = 18092.04395 MB
After interleave = 18092.21582 MB
After matmul = 18092.21680 MB
Before local copies matmul = 18092.21680 MB
After local copies = 18092.21875 MB
fter compute chunk allocated = 18092.03613 MB
Memory after cuda sdpa 18092.0439453125 MB
1
Memory before offload  18092.0224609375 MB
Memory after offload  18092.0224609375 MB
Memory before cuda sdpa 18092.0361328125 MB
On entering CUDA sdpa main function  allocated = 18092.03613 MB
Before first SDPA allocated = 18092.03613 MB
On chunked entry = 18092.03613 MB
On scale calculation = 18092.04395 MB
Before interleave = 18092.04395 MB
After interleave = 18092.54395 MB
After matmul = 18100.67090 MB
Before local copies matmul = 18100.67090 MB
After local copies = 18100.67383 MB
After first SDPA allocated = 18100.16113 MB
After first copy allocated = 18100.16113 MB
On chunked entry = 18100.16113 MB
On scale calculation = 18100.16895 MB
Before interleave = 18100.16895 MB
After interleave = 18100.34082 MB
After matmul = 18100.34180 MB
Before local copies matmul = 18100.34180 MB
After local copies = 18100.34375 MB
fter compute chunk allocated = 18100.16113 MB
Memory after cuda sdpa 18100.1689453125 MB
1
Memory before offload  18100.1474609375 MB
Memory after offload  18100.1474609375 MB
Memory before cuda sdpa 18100.1611328125 MB
On entering CUDA sdpa main function  allocated = 18100.16113 MB
Before first SDPA allocated = 18100.16113 MB
On chunked entry = 18100.16113 MB
On scale calculation = 18100.16895 MB
Before interleave = 18100.16895 MB
After interleave = 18100.66895 MB
After matmul = 18108.79590 MB
Before local copies matmul = 18108.79590 MB
After local copies = 18108.79883 MB
After first SDPA allocated = 18108.28613 MB
After first copy allocated = 18108.28613 MB
On chunked entry = 18108.28613 MB
On scale calculation = 18108.29395 MB
Before interleave = 18108.29395 MB
After interleave = 18108.46582 MB
After matmul = 18108.46680 MB
Before local copies matmul = 18108.46680 MB
After local copies = 18108.46875 MB
fter compute chunk allocated = 18108.28613 MB
Memory after cuda sdpa 18108.2939453125 MB
1
Memory before offload  18108.2724609375 MB
Memory after offload  18108.2724609375 MB
Memory before cuda sdpa 18108.2861328125 MB
On entering CUDA sdpa main function  allocated = 18108.28613 MB
Before first SDPA allocated = 18108.28613 MB
On chunked entry = 18108.28613 MB
On scale calculation = 18108.29395 MB
Before interleave = 18108.29395 MB
After interleave = 18108.79395 MB
After matmul = 18116.92090 MB
Before local copies matmul = 18116.92090 MB
After local copies = 18116.92383 MB
After first SDPA allocated = 18116.41113 MB
After first copy allocated = 18116.41113 MB
On chunked entry = 18116.41113 MB
On scale calculation = 18116.41895 MB
Before interleave = 18116.41895 MB
After interleave = 18116.59082 MB
After matmul = 18116.59180 MB
Before local copies matmul = 18116.59180 MB
After local copies = 18116.59375 MB
fter compute chunk allocated = 18116.41113 MB
Memory after cuda sdpa 18116.4189453125 MB
1
Memory before offload  18116.3974609375 MB
Memory after offload  18116.3974609375 MB
Memory before cuda sdpa 18116.4111328125 MB
On entering CUDA sdpa main function  allocated = 18116.41113 MB
Before first SDPA allocated = 18116.41113 MB
On chunked entry = 18116.41113 MB
On scale calculation = 18116.41895 MB
Before interleave = 18116.41895 MB
After interleave = 18116.91895 MB
After matmul = 18125.04590 MB
Before local copies matmul = 18125.04590 MB
After local copies = 18125.04883 MB
After first SDPA allocated = 18124.53613 MB
After first copy allocated = 18124.53613 MB
On chunked entry = 18124.53613 MB
On scale calculation = 18124.54395 MB
Before interleave = 18124.54395 MB
After interleave = 18124.71582 MB
After matmul = 18124.71680 MB
Before local copies matmul = 18124.71680 MB
After local copies = 18124.71875 MB
fter compute chunk allocated = 18124.53613 MB
Memory after cuda sdpa 18124.5439453125 MB
1
Memory before offload  18124.5224609375 MB
Memory after offload  18124.5224609375 MB
Memory before cuda sdpa 18124.5361328125 MB
On entering CUDA sdpa main function  allocated = 18124.53613 MB
Before first SDPA allocated = 18124.53613 MB
On chunked entry = 18124.53613 MB
On scale calculation = 18124.54395 MB
Before interleave = 18124.54395 MB
After interleave = 18125.04395 MB
After matmul = 18133.17090 MB
Before local copies matmul = 18133.17090 MB
After local copies = 18133.17383 MB
After first SDPA allocated = 18132.66113 MB
After first copy allocated = 18132.66113 MB
On chunked entry = 18132.66113 MB
On scale calculation = 18132.66895 MB
Before interleave = 18132.66895 MB
After interleave = 18132.84082 MB
After matmul = 18132.84180 MB
Before local copies matmul = 18132.84180 MB
After local copies = 18132.84375 MB
fter compute chunk allocated = 18132.66113 MB
Memory after cuda sdpa 18132.6689453125 MB
1
Memory before offload  18132.6474609375 MB
Memory after offload  18132.6474609375 MB
Memory before cuda sdpa 18132.6611328125 MB
On entering CUDA sdpa main function  allocated = 18132.66113 MB
Before first SDPA allocated = 18132.66113 MB
On chunked entry = 18132.66113 MB
On scale calculation = 18132.66895 MB
Before interleave = 18132.66895 MB
After interleave = 18133.16895 MB
After matmul = 18141.29590 MB
Before local copies matmul = 18141.29590 MB
After local copies = 18141.29883 MB
After first SDPA allocated = 18140.78613 MB
After first copy allocated = 18140.78613 MB
On chunked entry = 18140.78613 MB
On scale calculation = 18140.79395 MB
Before interleave = 18140.79395 MB
After interleave = 18140.96582 MB
After matmul = 18140.96680 MB
Before local copies matmul = 18140.96680 MB
After local copies = 18140.96875 MB
fter compute chunk allocated = 18140.78613 MB
Memory after cuda sdpa 18140.7939453125 MB
1
Memory before offload  18140.7724609375 MB
Memory after offload  18140.7724609375 MB
Memory before cuda sdpa 18140.7861328125 MB
On entering CUDA sdpa main function  allocated = 18140.78613 MB
Before first SDPA allocated = 18140.78613 MB
On chunked entry = 18140.78613 MB
On scale calculation = 18140.79395 MB
Before interleave = 18140.79395 MB
After interleave = 18141.29395 MB
After matmul = 18149.42090 MB
Before local copies matmul = 18149.42090 MB
After local copies = 18149.42383 MB
After first SDPA allocated = 18148.91113 MB
After first copy allocated = 18148.91113 MB
On chunked entry = 18148.91113 MB
On scale calculation = 18148.91895 MB
Before interleave = 18148.91895 MB
After interleave = 18149.09082 MB
After matmul = 18149.09180 MB
Before local copies matmul = 18149.09180 MB
After local copies = 18149.09375 MB
fter compute chunk allocated = 18148.91113 MB
Memory after cuda sdpa 18148.9189453125 MB
1
Memory before offload  18148.8974609375 MB
Memory after offload  18148.8974609375 MB
Memory before cuda sdpa 18148.9111328125 MB
On entering CUDA sdpa main function  allocated = 18148.91113 MB
Before first SDPA allocated = 18148.91113 MB
On chunked entry = 18148.91113 MB
On scale calculation = 18148.91895 MB
Before interleave = 18148.91895 MB
After interleave = 18149.41895 MB
After matmul = 18157.54590 MB
Before local copies matmul = 18157.54590 MB
After local copies = 18157.54883 MB
After first SDPA allocated = 18157.03613 MB
After first copy allocated = 18157.03613 MB
On chunked entry = 18157.03613 MB
On scale calculation = 18157.04395 MB
Before interleave = 18157.04395 MB
After interleave = 18157.21582 MB
After matmul = 18157.21680 MB
Before local copies matmul = 18157.21680 MB
After local copies = 18157.21875 MB
fter compute chunk allocated = 18157.03613 MB
Memory after cuda sdpa 18157.0439453125 MB
1
Memory before offload  18157.0224609375 MB
Memory after offload  18157.0224609375 MB
Memory before cuda sdpa 18157.0361328125 MB
On entering CUDA sdpa main function  allocated = 18157.03613 MB
Before first SDPA allocated = 18157.03613 MB
On chunked entry = 18157.03613 MB
On scale calculation = 18157.04395 MB
Before interleave = 18157.04395 MB
After interleave = 18157.54395 MB
After matmul = 18165.67090 MB
Before local copies matmul = 18165.67090 MB
After local copies = 18165.67383 MB
After first SDPA allocated = 18165.16113 MB
After first copy allocated = 18165.16113 MB
On chunked entry = 18165.16113 MB
On scale calculation = 18165.16895 MB
Before interleave = 18165.16895 MB
After interleave = 18165.34082 MB
After matmul = 18165.34180 MB
Before local copies matmul = 18165.34180 MB
After local copies = 18165.34375 MB
fter compute chunk allocated = 18165.16113 MB
Memory after cuda sdpa 18165.1689453125 MB
1
Memory before offload  18165.1474609375 MB
Memory after offload  18165.1474609375 MB
Memory before cuda sdpa 18165.1611328125 MB
On entering CUDA sdpa main function  allocated = 18165.16113 MB
Before first SDPA allocated = 18165.16113 MB
On chunked entry = 18165.16113 MB
On scale calculation = 18165.16895 MB
Before interleave = 18165.16895 MB
After interleave = 18165.66895 MB
After matmul = 18173.79590 MB
Before local copies matmul = 18173.79590 MB
After local copies = 18173.79883 MB
After first SDPA allocated = 18173.28613 MB
After first copy allocated = 18173.28613 MB
On chunked entry = 18173.28613 MB
On scale calculation = 18173.29395 MB
Before interleave = 18173.29395 MB
After interleave = 18173.46582 MB
After matmul = 18173.46680 MB
Before local copies matmul = 18173.46680 MB
After local copies = 18173.46875 MB
fter compute chunk allocated = 18173.28613 MB
Memory after cuda sdpa 18173.2939453125 MB
1
Memory before offload  18173.2724609375 MB
Memory after offload  18173.2724609375 MB
Memory before cuda sdpa 18173.2861328125 MB
On entering CUDA sdpa main function  allocated = 18173.28613 MB
Before first SDPA allocated = 18173.28613 MB
On chunked entry = 18173.28613 MB
On scale calculation = 18173.29395 MB
Before interleave = 18173.29395 MB
After interleave = 18173.79395 MB
After matmul = 18181.92090 MB
Before local copies matmul = 18181.92090 MB
After local copies = 18181.92383 MB
After first SDPA allocated = 18181.41113 MB
After first copy allocated = 18181.41113 MB
On chunked entry = 18181.41113 MB
On scale calculation = 18181.41895 MB
Before interleave = 18181.41895 MB
After interleave = 18181.59082 MB
After matmul = 18181.59180 MB
Before local copies matmul = 18181.59180 MB
After local copies = 18181.59375 MB
fter compute chunk allocated = 18181.41113 MB
Memory after cuda sdpa 18181.4189453125 MB
1
Memory before offload  18181.3974609375 MB
Memory after offload  18181.3974609375 MB
Memory before cuda sdpa 18181.4111328125 MB
On entering CUDA sdpa main function  allocated = 18181.41113 MB
Before first SDPA allocated = 18181.41113 MB
On chunked entry = 18181.41113 MB
On scale calculation = 18181.41895 MB
Before interleave = 18181.41895 MB
After interleave = 18181.91895 MB
After matmul = 18190.04590 MB
Before local copies matmul = 18190.04590 MB
After local copies = 18190.04883 MB
After first SDPA allocated = 18189.53613 MB
After first copy allocated = 18189.53613 MB
On chunked entry = 18189.53613 MB
On scale calculation = 18189.54395 MB
Before interleave = 18189.54395 MB
After interleave = 18189.71582 MB
After matmul = 18189.71680 MB
Before local copies matmul = 18189.71680 MB
After local copies = 18189.71875 MB
fter compute chunk allocated = 18189.53613 MB
Memory after cuda sdpa 18189.5439453125 MB
1
Memory before offload  18189.5224609375 MB
Memory after offload  18189.5224609375 MB
Memory before cuda sdpa 18189.5361328125 MB
On entering CUDA sdpa main function  allocated = 18189.53613 MB
Before first SDPA allocated = 18189.53613 MB
On chunked entry = 18189.53613 MB
On scale calculation = 18189.54395 MB
Before interleave = 18189.54395 MB
After interleave = 18190.04395 MB
After matmul = 18198.17090 MB
Before local copies matmul = 18198.17090 MB
After local copies = 18198.17383 MB
After first SDPA allocated = 18197.66113 MB
After first copy allocated = 18197.66113 MB
On chunked entry = 18197.66113 MB
On scale calculation = 18197.66895 MB
Before interleave = 18197.66895 MB
After interleave = 18197.84082 MB
After matmul = 18197.84180 MB
Before local copies matmul = 18197.84180 MB
After local copies = 18197.84375 MB
fter compute chunk allocated = 18197.66113 MB
Memory after cuda sdpa 18197.6689453125 MB
1
Memory before offload  18197.6474609375 MB
Memory after offload  18197.6474609375 MB
Memory before cuda sdpa 18197.6611328125 MB
On entering CUDA sdpa main function  allocated = 18197.66113 MB
Before first SDPA allocated = 18197.66113 MB
On chunked entry = 18197.66113 MB
On scale calculation = 18197.66895 MB
Before interleave = 18197.66895 MB
After interleave = 18198.16895 MB
After matmul = 18206.29590 MB
Before local copies matmul = 18206.29590 MB
After local copies = 18206.29883 MB
After first SDPA allocated = 18205.78613 MB
After first copy allocated = 18205.78613 MB
On chunked entry = 18205.78613 MB
On scale calculation = 18205.79395 MB
Before interleave = 18205.79395 MB
After interleave = 18205.96582 MB
After matmul = 18205.96680 MB
Before local copies matmul = 18205.96680 MB
After local copies = 18205.96875 MB
fter compute chunk allocated = 18205.78613 MB
Memory after cuda sdpa 18205.7939453125 MB
Decode step 12
1
Memory before offload  18205.77294921875 MB
Memory after offload  18205.77294921875 MB
Memory before cuda sdpa 18205.78662109375 MB
On entering CUDA sdpa main function  allocated = 18205.78662 MB
Before first SDPA allocated = 18205.78662 MB
On chunked entry = 18205.78662 MB
On scale calculation = 18205.79443 MB
Before interleave = 18205.79443 MB
After interleave = 18206.29443 MB
After matmul = 18214.42139 MB
Before local copies matmul = 18214.42139 MB
After local copies = 18214.42432 MB
After first SDPA allocated = 18213.91162 MB
After first copy allocated = 18213.91162 MB
On chunked entry = 18213.91162 MB
On scale calculation = 18213.91943 MB
Before interleave = 18213.91943 MB
After interleave = 18214.10693 MB
After matmul = 18214.10791 MB
Before local copies matmul = 18214.10791 MB
After local copies = 18214.10986 MB
fter compute chunk allocated = 18213.91162 MB
Memory after cuda sdpa 18213.91943359375 MB
1
Memory before offload  18213.89794921875 MB
Memory after offload  18213.89794921875 MB
Memory before cuda sdpa 18213.91162109375 MB
On entering CUDA sdpa main function  allocated = 18213.91162 MB
Before first SDPA allocated = 18213.91162 MB
On chunked entry = 18213.91162 MB
On scale calculation = 18213.91943 MB
Before interleave = 18213.91943 MB
After interleave = 18214.41943 MB
After matmul = 18222.54639 MB
Before local copies matmul = 18222.54639 MB
After local copies = 18222.54932 MB
After first SDPA allocated = 18222.03662 MB
After first copy allocated = 18222.03662 MB
On chunked entry = 18222.03662 MB
On scale calculation = 18222.04443 MB
Before interleave = 18222.04443 MB
After interleave = 18222.23193 MB
After matmul = 18222.23291 MB
Before local copies matmul = 18222.23291 MB
After local copies = 18222.23486 MB
fter compute chunk allocated = 18222.03662 MB
Memory after cuda sdpa 18222.04443359375 MB
1
Memory before offload  18222.02294921875 MB
Memory after offload  18222.02294921875 MB
Memory before cuda sdpa 18222.03662109375 MB
On entering CUDA sdpa main function  allocated = 18222.03662 MB
Before first SDPA allocated = 18222.03662 MB
On chunked entry = 18222.03662 MB
On scale calculation = 18222.04443 MB
Before interleave = 18222.04443 MB
After interleave = 18222.54443 MB
After matmul = 18230.67139 MB
Before local copies matmul = 18230.67139 MB
After local copies = 18230.67432 MB
After first SDPA allocated = 18230.16162 MB
After first copy allocated = 18230.16162 MB
On chunked entry = 18230.16162 MB
On scale calculation = 18230.16943 MB
Before interleave = 18230.16943 MB
After interleave = 18230.35693 MB
After matmul = 18230.35791 MB
Before local copies matmul = 18230.35791 MB
After local copies = 18230.35986 MB
fter compute chunk allocated = 18230.16162 MB
Memory after cuda sdpa 18230.16943359375 MB
1
Memory before offload  18230.14794921875 MB
Memory after offload  18230.14794921875 MB
Memory before cuda sdpa 18230.16162109375 MB
On entering CUDA sdpa main function  allocated = 18230.16162 MB
Before first SDPA allocated = 18230.16162 MB
On chunked entry = 18230.16162 MB
On scale calculation = 18230.16943 MB
Before interleave = 18230.16943 MB
After interleave = 18230.66943 MB
After matmul = 18238.79639 MB
Before local copies matmul = 18238.79639 MB
After local copies = 18238.79932 MB
After first SDPA allocated = 18238.28662 MB
After first copy allocated = 18238.28662 MB
On chunked entry = 18238.28662 MB
On scale calculation = 18238.29443 MB
Before interleave = 18238.29443 MB
After interleave = 18238.48193 MB
After matmul = 18238.48291 MB
Before local copies matmul = 18238.48291 MB
After local copies = 18238.48486 MB
fter compute chunk allocated = 18238.28662 MB
Memory after cuda sdpa 18238.29443359375 MB
1
Memory before offload  18238.27294921875 MB
Memory after offload  18238.27294921875 MB
Memory before cuda sdpa 18238.28662109375 MB
On entering CUDA sdpa main function  allocated = 18238.28662 MB
Before first SDPA allocated = 18238.28662 MB
On chunked entry = 18238.28662 MB
On scale calculation = 18238.29443 MB
Before interleave = 18238.29443 MB
After interleave = 18238.79443 MB
After matmul = 18246.92139 MB
Before local copies matmul = 18246.92139 MB
After local copies = 18246.92432 MB
After first SDPA allocated = 18246.41162 MB
After first copy allocated = 18246.41162 MB
On chunked entry = 18246.41162 MB
On scale calculation = 18246.41943 MB
Before interleave = 18246.41943 MB
After interleave = 18246.60693 MB
After matmul = 18246.60791 MB
Before local copies matmul = 18246.60791 MB
After local copies = 18246.60986 MB
fter compute chunk allocated = 18246.41162 MB
Memory after cuda sdpa 18246.41943359375 MB
1
Memory before offload  18246.39794921875 MB
Memory after offload  18246.39794921875 MB
Memory before cuda sdpa 18246.41162109375 MB
On entering CUDA sdpa main function  allocated = 18246.41162 MB
Before first SDPA allocated = 18246.41162 MB
On chunked entry = 18246.41162 MB
On scale calculation = 18246.41943 MB
Before interleave = 18246.41943 MB
After interleave = 18246.91943 MB
After matmul = 18255.04639 MB
Before local copies matmul = 18255.04639 MB
After local copies = 18255.04932 MB
After first SDPA allocated = 18254.53662 MB
After first copy allocated = 18254.53662 MB
On chunked entry = 18254.53662 MB
On scale calculation = 18254.54443 MB
Before interleave = 18254.54443 MB
After interleave = 18254.73193 MB
After matmul = 18254.73291 MB
Before local copies matmul = 18254.73291 MB
After local copies = 18254.73486 MB
fter compute chunk allocated = 18254.53662 MB
Memory after cuda sdpa 18254.54443359375 MB
1
Memory before offload  18254.52294921875 MB
Memory after offload  18254.52294921875 MB
Memory before cuda sdpa 18254.53662109375 MB
On entering CUDA sdpa main function  allocated = 18254.53662 MB
Before first SDPA allocated = 18254.53662 MB
On chunked entry = 18254.53662 MB
On scale calculation = 18254.54443 MB
Before interleave = 18254.54443 MB
After interleave = 18255.04443 MB
After matmul = 18263.17139 MB
Before local copies matmul = 18263.17139 MB
After local copies = 18263.17432 MB
After first SDPA allocated = 18262.66162 MB
After first copy allocated = 18262.66162 MB
On chunked entry = 18262.66162 MB
On scale calculation = 18262.66943 MB
Before interleave = 18262.66943 MB
After interleave = 18262.85693 MB
After matmul = 18262.85791 MB
Before local copies matmul = 18262.85791 MB
After local copies = 18262.85986 MB
fter compute chunk allocated = 18262.66162 MB
Memory after cuda sdpa 18262.66943359375 MB
1
Memory before offload  18262.64794921875 MB
Memory after offload  18262.64794921875 MB
Memory before cuda sdpa 18262.66162109375 MB
On entering CUDA sdpa main function  allocated = 18262.66162 MB
Before first SDPA allocated = 18262.66162 MB
On chunked entry = 18262.66162 MB
On scale calculation = 18262.66943 MB
Before interleave = 18262.66943 MB
After interleave = 18263.16943 MB
After matmul = 18271.29639 MB
Before local copies matmul = 18271.29639 MB
After local copies = 18271.29932 MB
After first SDPA allocated = 18270.78662 MB
After first copy allocated = 18270.78662 MB
On chunked entry = 18270.78662 MB
On scale calculation = 18270.79443 MB
Before interleave = 18270.79443 MB
After interleave = 18270.98193 MB
After matmul = 18270.98291 MB
Before local copies matmul = 18270.98291 MB
After local copies = 18270.98486 MB
fter compute chunk allocated = 18270.78662 MB
Memory after cuda sdpa 18270.79443359375 MB
1
Memory before offload  18270.77294921875 MB
Memory after offload  18270.77294921875 MB
Memory before cuda sdpa 18270.78662109375 MB
On entering CUDA sdpa main function  allocated = 18270.78662 MB
Before first SDPA allocated = 18270.78662 MB
On chunked entry = 18270.78662 MB
On scale calculation = 18270.79443 MB
Before interleave = 18270.79443 MB
After interleave = 18271.29443 MB
After matmul = 18279.42139 MB
Before local copies matmul = 18279.42139 MB
After local copies = 18279.42432 MB
After first SDPA allocated = 18278.91162 MB
After first copy allocated = 18278.91162 MB
On chunked entry = 18278.91162 MB
On scale calculation = 18278.91943 MB
Before interleave = 18278.91943 MB
After interleave = 18279.10693 MB
After matmul = 18279.10791 MB
Before local copies matmul = 18279.10791 MB
After local copies = 18279.10986 MB
fter compute chunk allocated = 18278.91162 MB
Memory after cuda sdpa 18278.91943359375 MB
1
Memory before offload  18278.89794921875 MB
Memory after offload  18278.89794921875 MB
Memory before cuda sdpa 18278.91162109375 MB
On entering CUDA sdpa main function  allocated = 18278.91162 MB
Before first SDPA allocated = 18278.91162 MB
On chunked entry = 18278.91162 MB
On scale calculation = 18278.91943 MB
Before interleave = 18278.91943 MB
After interleave = 18279.41943 MB
After matmul = 18287.54639 MB
Before local copies matmul = 18287.54639 MB
After local copies = 18287.54932 MB
After first SDPA allocated = 18287.03662 MB
After first copy allocated = 18287.03662 MB
On chunked entry = 18287.03662 MB
On scale calculation = 18287.04443 MB
Before interleave = 18287.04443 MB
After interleave = 18287.23193 MB
After matmul = 18287.23291 MB
Before local copies matmul = 18287.23291 MB
After local copies = 18287.23486 MB
fter compute chunk allocated = 18287.03662 MB
Memory after cuda sdpa 18287.04443359375 MB
1
Memory before offload  18287.02294921875 MB
Memory after offload  18287.02294921875 MB
Memory before cuda sdpa 18287.03662109375 MB
On entering CUDA sdpa main function  allocated = 18287.03662 MB
Before first SDPA allocated = 18287.03662 MB
On chunked entry = 18287.03662 MB
On scale calculation = 18287.04443 MB
Before interleave = 18287.04443 MB
After interleave = 18287.54443 MB
After matmul = 18295.67139 MB
Before local copies matmul = 18295.67139 MB
After local copies = 18295.67432 MB
After first SDPA allocated = 18295.16162 MB
After first copy allocated = 18295.16162 MB
On chunked entry = 18295.16162 MB
On scale calculation = 18295.16943 MB
Before interleave = 18295.16943 MB
After interleave = 18295.35693 MB
After matmul = 18295.35791 MB
Before local copies matmul = 18295.35791 MB
After local copies = 18295.35986 MB
fter compute chunk allocated = 18295.16162 MB
Memory after cuda sdpa 18295.16943359375 MB
1
Memory before offload  18295.14794921875 MB
Memory after offload  18295.14794921875 MB
Memory before cuda sdpa 18295.16162109375 MB
On entering CUDA sdpa main function  allocated = 18295.16162 MB
Before first SDPA allocated = 18295.16162 MB
On chunked entry = 18295.16162 MB
On scale calculation = 18295.16943 MB
Before interleave = 18295.16943 MB
After interleave = 18295.66943 MB
After matmul = 18303.79639 MB
Before local copies matmul = 18303.79639 MB
After local copies = 18303.79932 MB
After first SDPA allocated = 18303.28662 MB
After first copy allocated = 18303.28662 MB
On chunked entry = 18303.28662 MB
On scale calculation = 18303.29443 MB
Before interleave = 18303.29443 MB
After interleave = 18303.48193 MB
After matmul = 18303.48291 MB
Before local copies matmul = 18303.48291 MB
After local copies = 18303.48486 MB
fter compute chunk allocated = 18303.28662 MB
Memory after cuda sdpa 18303.29443359375 MB
1
Memory before offload  18303.27294921875 MB
Memory after offload  18303.27294921875 MB
Memory before cuda sdpa 18303.28662109375 MB
On entering CUDA sdpa main function  allocated = 18303.28662 MB
Before first SDPA allocated = 18303.28662 MB
On chunked entry = 18303.28662 MB
On scale calculation = 18303.29443 MB
Before interleave = 18303.29443 MB
After interleave = 18303.79443 MB
After matmul = 18311.92139 MB
Before local copies matmul = 18311.92139 MB
After local copies = 18311.92432 MB
After first SDPA allocated = 18311.41162 MB
After first copy allocated = 18311.41162 MB
On chunked entry = 18311.41162 MB
On scale calculation = 18311.41943 MB
Before interleave = 18311.41943 MB
After interleave = 18311.60693 MB
After matmul = 18311.60791 MB
Before local copies matmul = 18311.60791 MB
After local copies = 18311.60986 MB
fter compute chunk allocated = 18311.41162 MB
Memory after cuda sdpa 18311.41943359375 MB
1
Memory before offload  18311.39794921875 MB
Memory after offload  18311.39794921875 MB
Memory before cuda sdpa 18311.41162109375 MB
On entering CUDA sdpa main function  allocated = 18311.41162 MB
Before first SDPA allocated = 18311.41162 MB
On chunked entry = 18311.41162 MB
On scale calculation = 18311.41943 MB
Before interleave = 18311.41943 MB
After interleave = 18311.91943 MB
After matmul = 18320.04639 MB
Before local copies matmul = 18320.04639 MB
After local copies = 18320.04932 MB
After first SDPA allocated = 18319.53662 MB
After first copy allocated = 18319.53662 MB
On chunked entry = 18319.53662 MB
On scale calculation = 18319.54443 MB
Before interleave = 18319.54443 MB
After interleave = 18319.73193 MB
After matmul = 18319.73291 MB
Before local copies matmul = 18319.73291 MB
After local copies = 18319.73486 MB
fter compute chunk allocated = 18319.53662 MB
Memory after cuda sdpa 18319.54443359375 MB
1
Memory before offload  18319.52294921875 MB
Memory after offload  18319.52294921875 MB
Memory before cuda sdpa 18319.53662109375 MB
On entering CUDA sdpa main function  allocated = 18319.53662 MB
Before first SDPA allocated = 18319.53662 MB
On chunked entry = 18319.53662 MB
On scale calculation = 18319.54443 MB
Before interleave = 18319.54443 MB
After interleave = 18320.04443 MB
After matmul = 18328.17139 MB
Before local copies matmul = 18328.17139 MB
After local copies = 18328.17432 MB
After first SDPA allocated = 18327.66162 MB
After first copy allocated = 18327.66162 MB
On chunked entry = 18327.66162 MB
On scale calculation = 18327.66943 MB
Before interleave = 18327.66943 MB
After interleave = 18327.85693 MB
After matmul = 18327.85791 MB
Before local copies matmul = 18327.85791 MB
After local copies = 18327.85986 MB
fter compute chunk allocated = 18327.66162 MB
Memory after cuda sdpa 18327.66943359375 MB
1
Memory before offload  18327.64794921875 MB
Memory after offload  18327.64794921875 MB
Memory before cuda sdpa 18327.66162109375 MB
On entering CUDA sdpa main function  allocated = 18327.66162 MB
Before first SDPA allocated = 18327.66162 MB
On chunked entry = 18327.66162 MB
On scale calculation = 18327.66943 MB
Before interleave = 18327.66943 MB
After interleave = 18328.16943 MB
After matmul = 18336.29639 MB
Before local copies matmul = 18336.29639 MB
After local copies = 18336.29932 MB
After first SDPA allocated = 18335.78662 MB
After first copy allocated = 18335.78662 MB
On chunked entry = 18335.78662 MB
On scale calculation = 18335.79443 MB
Before interleave = 18335.79443 MB
After interleave = 18335.98193 MB
After matmul = 18335.98291 MB
Before local copies matmul = 18335.98291 MB
After local copies = 18335.98486 MB
fter compute chunk allocated = 18335.78662 MB
Memory after cuda sdpa 18335.79443359375 MB
1
Memory before offload  18335.77294921875 MB
Memory after offload  18335.77294921875 MB
Memory before cuda sdpa 18335.78662109375 MB
On entering CUDA sdpa main function  allocated = 18335.78662 MB
Before first SDPA allocated = 18335.78662 MB
On chunked entry = 18335.78662 MB
On scale calculation = 18335.79443 MB
Before interleave = 18335.79443 MB
After interleave = 18336.29443 MB
After matmul = 18344.42139 MB
Before local copies matmul = 18344.42139 MB
After local copies = 18344.42432 MB
After first SDPA allocated = 18343.91162 MB
After first copy allocated = 18343.91162 MB
On chunked entry = 18343.91162 MB
On scale calculation = 18343.91943 MB
Before interleave = 18343.91943 MB
After interleave = 18344.10693 MB
After matmul = 18344.10791 MB
Before local copies matmul = 18344.10791 MB
After local copies = 18344.10986 MB
fter compute chunk allocated = 18343.91162 MB
Memory after cuda sdpa 18343.91943359375 MB
1
Memory before offload  18343.89794921875 MB
Memory after offload  18343.89794921875 MB
Memory before cuda sdpa 18343.91162109375 MB
On entering CUDA sdpa main function  allocated = 18343.91162 MB
Before first SDPA allocated = 18343.91162 MB
On chunked entry = 18343.91162 MB
On scale calculation = 18343.91943 MB
Before interleave = 18343.91943 MB
After interleave = 18344.41943 MB
After matmul = 18352.54639 MB
Before local copies matmul = 18352.54639 MB
After local copies = 18352.54932 MB
After first SDPA allocated = 18352.03662 MB
After first copy allocated = 18352.03662 MB
On chunked entry = 18352.03662 MB
On scale calculation = 18352.04443 MB
Before interleave = 18352.04443 MB
After interleave = 18352.23193 MB
After matmul = 18352.23291 MB
Before local copies matmul = 18352.23291 MB
After local copies = 18352.23486 MB
fter compute chunk allocated = 18352.03662 MB
Memory after cuda sdpa 18352.04443359375 MB
1
Memory before offload  18352.02294921875 MB
Memory after offload  18352.02294921875 MB
Memory before cuda sdpa 18352.03662109375 MB
On entering CUDA sdpa main function  allocated = 18352.03662 MB
Before first SDPA allocated = 18352.03662 MB
On chunked entry = 18352.03662 MB
On scale calculation = 18352.04443 MB
Before interleave = 18352.04443 MB
After interleave = 18352.54443 MB
After matmul = 18360.67139 MB
Before local copies matmul = 18360.67139 MB
After local copies = 18360.67432 MB
After first SDPA allocated = 18360.16162 MB
After first copy allocated = 18360.16162 MB
On chunked entry = 18360.16162 MB
On scale calculation = 18360.16943 MB
Before interleave = 18360.16943 MB
After interleave = 18360.35693 MB
After matmul = 18360.35791 MB
Before local copies matmul = 18360.35791 MB
After local copies = 18360.35986 MB
fter compute chunk allocated = 18360.16162 MB
Memory after cuda sdpa 18360.16943359375 MB
1
Memory before offload  18360.14794921875 MB
Memory after offload  18360.14794921875 MB
Memory before cuda sdpa 18360.16162109375 MB
On entering CUDA sdpa main function  allocated = 18360.16162 MB
Before first SDPA allocated = 18360.16162 MB
On chunked entry = 18360.16162 MB
On scale calculation = 18360.16943 MB
Before interleave = 18360.16943 MB
After interleave = 18360.66943 MB
After matmul = 18368.79639 MB
Before local copies matmul = 18368.79639 MB
After local copies = 18368.79932 MB
After first SDPA allocated = 18368.28662 MB
After first copy allocated = 18368.28662 MB
On chunked entry = 18368.28662 MB
On scale calculation = 18368.29443 MB
Before interleave = 18368.29443 MB
After interleave = 18368.48193 MB
After matmul = 18368.48291 MB
Before local copies matmul = 18368.48291 MB
After local copies = 18368.48486 MB
fter compute chunk allocated = 18368.28662 MB
Memory after cuda sdpa 18368.29443359375 MB
1
Memory before offload  18368.27294921875 MB
Memory after offload  18368.27294921875 MB
Memory before cuda sdpa 18368.28662109375 MB
On entering CUDA sdpa main function  allocated = 18368.28662 MB
Before first SDPA allocated = 18368.28662 MB
On chunked entry = 18368.28662 MB
On scale calculation = 18368.29443 MB
Before interleave = 18368.29443 MB
After interleave = 18368.79443 MB
After matmul = 18376.92139 MB
Before local copies matmul = 18376.92139 MB
After local copies = 18376.92432 MB
After first SDPA allocated = 18376.41162 MB
After first copy allocated = 18376.41162 MB
On chunked entry = 18376.41162 MB
On scale calculation = 18376.41943 MB
Before interleave = 18376.41943 MB
After interleave = 18376.60693 MB
After matmul = 18376.60791 MB
Before local copies matmul = 18376.60791 MB
After local copies = 18376.60986 MB
fter compute chunk allocated = 18376.41162 MB
Memory after cuda sdpa 18376.41943359375 MB
1
Memory before offload  18376.39794921875 MB
Memory after offload  18376.39794921875 MB
Memory before cuda sdpa 18376.41162109375 MB
On entering CUDA sdpa main function  allocated = 18376.41162 MB
Before first SDPA allocated = 18376.41162 MB
On chunked entry = 18376.41162 MB
On scale calculation = 18376.41943 MB
Before interleave = 18376.41943 MB
After interleave = 18376.91943 MB
After matmul = 18385.04639 MB
Before local copies matmul = 18385.04639 MB
After local copies = 18385.04932 MB
After first SDPA allocated = 18384.53662 MB
After first copy allocated = 18384.53662 MB
On chunked entry = 18384.53662 MB
On scale calculation = 18384.54443 MB
Before interleave = 18384.54443 MB
After interleave = 18384.73193 MB
After matmul = 18384.73291 MB
Before local copies matmul = 18384.73291 MB
After local copies = 18384.73486 MB
fter compute chunk allocated = 18384.53662 MB
Memory after cuda sdpa 18384.54443359375 MB
1
Memory before offload  18384.52294921875 MB
Memory after offload  18384.52294921875 MB
Memory before cuda sdpa 18384.53662109375 MB
On entering CUDA sdpa main function  allocated = 18384.53662 MB
Before first SDPA allocated = 18384.53662 MB
On chunked entry = 18384.53662 MB
On scale calculation = 18384.54443 MB
Before interleave = 18384.54443 MB
After interleave = 18385.04443 MB
After matmul = 18393.17139 MB
Before local copies matmul = 18393.17139 MB
After local copies = 18393.17432 MB
After first SDPA allocated = 18392.66162 MB
After first copy allocated = 18392.66162 MB
On chunked entry = 18392.66162 MB
On scale calculation = 18392.66943 MB
Before interleave = 18392.66943 MB
After interleave = 18392.85693 MB
After matmul = 18392.85791 MB
Before local copies matmul = 18392.85791 MB
After local copies = 18392.85986 MB
fter compute chunk allocated = 18392.66162 MB
Memory after cuda sdpa 18392.66943359375 MB
1
Memory before offload  18392.64794921875 MB
Memory after offload  18392.64794921875 MB
Memory before cuda sdpa 18392.66162109375 MB
On entering CUDA sdpa main function  allocated = 18392.66162 MB
Before first SDPA allocated = 18392.66162 MB
On chunked entry = 18392.66162 MB
On scale calculation = 18392.66943 MB
Before interleave = 18392.66943 MB
After interleave = 18393.16943 MB
After matmul = 18401.29639 MB
Before local copies matmul = 18401.29639 MB
After local copies = 18401.29932 MB
After first SDPA allocated = 18400.78662 MB
After first copy allocated = 18400.78662 MB
On chunked entry = 18400.78662 MB
On scale calculation = 18400.79443 MB
Before interleave = 18400.79443 MB
After interleave = 18400.98193 MB
After matmul = 18400.98291 MB
Before local copies matmul = 18400.98291 MB
After local copies = 18400.98486 MB
fter compute chunk allocated = 18400.78662 MB
Memory after cuda sdpa 18400.79443359375 MB
1
Memory before offload  18400.77294921875 MB
Memory after offload  18400.77294921875 MB
Memory before cuda sdpa 18400.78662109375 MB
On entering CUDA sdpa main function  allocated = 18400.78662 MB
Before first SDPA allocated = 18400.78662 MB
On chunked entry = 18400.78662 MB
On scale calculation = 18400.79443 MB
Before interleave = 18400.79443 MB
After interleave = 18401.29443 MB
After matmul = 18409.42139 MB
Before local copies matmul = 18409.42139 MB
After local copies = 18409.42432 MB
After first SDPA allocated = 18408.91162 MB
After first copy allocated = 18408.91162 MB
On chunked entry = 18408.91162 MB
On scale calculation = 18408.91943 MB
Before interleave = 18408.91943 MB
After interleave = 18409.10693 MB
After matmul = 18409.10791 MB
Before local copies matmul = 18409.10791 MB
After local copies = 18409.10986 MB
fter compute chunk allocated = 18408.91162 MB
Memory after cuda sdpa 18408.91943359375 MB
1
Memory before offload  18408.89794921875 MB
Memory after offload  18408.89794921875 MB
Memory before cuda sdpa 18408.91162109375 MB
On entering CUDA sdpa main function  allocated = 18408.91162 MB
Before first SDPA allocated = 18408.91162 MB
On chunked entry = 18408.91162 MB
On scale calculation = 18408.91943 MB
Before interleave = 18408.91943 MB
After interleave = 18409.41943 MB
After matmul = 18417.54639 MB
Before local copies matmul = 18417.54639 MB
After local copies = 18417.54932 MB
After first SDPA allocated = 18417.03662 MB
After first copy allocated = 18417.03662 MB
On chunked entry = 18417.03662 MB
On scale calculation = 18417.04443 MB
Before interleave = 18417.04443 MB
After interleave = 18417.23193 MB
After matmul = 18417.23291 MB
Before local copies matmul = 18417.23291 MB
After local copies = 18417.23486 MB
fter compute chunk allocated = 18417.03662 MB
Memory after cuda sdpa 18417.04443359375 MB
1
Memory before offload  18417.02294921875 MB
Memory after offload  18417.02294921875 MB
Memory before cuda sdpa 18417.03662109375 MB
On entering CUDA sdpa main function  allocated = 18417.03662 MB
Before first SDPA allocated = 18417.03662 MB
On chunked entry = 18417.03662 MB
On scale calculation = 18417.04443 MB
Before interleave = 18417.04443 MB
After interleave = 18417.54443 MB
After matmul = 18425.67139 MB
Before local copies matmul = 18425.67139 MB
After local copies = 18425.67432 MB
After first SDPA allocated = 18425.16162 MB
After first copy allocated = 18425.16162 MB
On chunked entry = 18425.16162 MB
On scale calculation = 18425.16943 MB
Before interleave = 18425.16943 MB
After interleave = 18425.35693 MB
After matmul = 18425.35791 MB
Before local copies matmul = 18425.35791 MB
After local copies = 18425.35986 MB
fter compute chunk allocated = 18425.16162 MB
Memory after cuda sdpa 18425.16943359375 MB
1
Memory before offload  18425.14794921875 MB
Memory after offload  18425.14794921875 MB
Memory before cuda sdpa 18425.16162109375 MB
On entering CUDA sdpa main function  allocated = 18425.16162 MB
Before first SDPA allocated = 18425.16162 MB
On chunked entry = 18425.16162 MB
On scale calculation = 18425.16943 MB
Before interleave = 18425.16943 MB
After interleave = 18425.66943 MB
After matmul = 18433.79639 MB
Before local copies matmul = 18433.79639 MB
After local copies = 18433.79932 MB
After first SDPA allocated = 18433.28662 MB
After first copy allocated = 18433.28662 MB
On chunked entry = 18433.28662 MB
On scale calculation = 18433.29443 MB
Before interleave = 18433.29443 MB
After interleave = 18433.48193 MB
After matmul = 18433.48291 MB
Before local copies matmul = 18433.48291 MB
After local copies = 18433.48486 MB
fter compute chunk allocated = 18433.28662 MB
Memory after cuda sdpa 18433.29443359375 MB
1
Memory before offload  18433.27294921875 MB
Memory after offload  18433.27294921875 MB
Memory before cuda sdpa 18433.28662109375 MB
On entering CUDA sdpa main function  allocated = 18433.28662 MB
Before first SDPA allocated = 18433.28662 MB
On chunked entry = 18433.28662 MB
On scale calculation = 18433.29443 MB
Before interleave = 18433.29443 MB
After interleave = 18433.79443 MB
After matmul = 18441.92139 MB
Before local copies matmul = 18441.92139 MB
After local copies = 18441.92432 MB
After first SDPA allocated = 18441.41162 MB
After first copy allocated = 18441.41162 MB
On chunked entry = 18441.41162 MB
On scale calculation = 18441.41943 MB
Before interleave = 18441.41943 MB
After interleave = 18441.60693 MB
After matmul = 18441.60791 MB
Before local copies matmul = 18441.60791 MB
After local copies = 18441.60986 MB
fter compute chunk allocated = 18441.41162 MB
Memory after cuda sdpa 18441.41943359375 MB
1
Memory before offload  18441.39794921875 MB
Memory after offload  18441.39794921875 MB
Memory before cuda sdpa 18441.41162109375 MB
On entering CUDA sdpa main function  allocated = 18441.41162 MB
Before first SDPA allocated = 18441.41162 MB
On chunked entry = 18441.41162 MB
On scale calculation = 18441.41943 MB
Before interleave = 18441.41943 MB
After interleave = 18441.91943 MB
After matmul = 18450.04639 MB
Before local copies matmul = 18450.04639 MB
After local copies = 18450.04932 MB
After first SDPA allocated = 18449.53662 MB
After first copy allocated = 18449.53662 MB
On chunked entry = 18449.53662 MB
On scale calculation = 18449.54443 MB
Before interleave = 18449.54443 MB
After interleave = 18449.73193 MB
After matmul = 18449.73291 MB
Before local copies matmul = 18449.73291 MB
After local copies = 18449.73486 MB
fter compute chunk allocated = 18449.53662 MB
Memory after cuda sdpa 18449.54443359375 MB
1
Memory before offload  18449.52294921875 MB
Memory after offload  18449.52294921875 MB
Memory before cuda sdpa 18449.53662109375 MB
On entering CUDA sdpa main function  allocated = 18449.53662 MB
Before first SDPA allocated = 18449.53662 MB
On chunked entry = 18449.53662 MB
On scale calculation = 18449.54443 MB
Before interleave = 18449.54443 MB
After interleave = 18450.04443 MB
After matmul = 18458.17139 MB
Before local copies matmul = 18458.17139 MB
After local copies = 18458.17432 MB
After first SDPA allocated = 18457.66162 MB
After first copy allocated = 18457.66162 MB
On chunked entry = 18457.66162 MB
On scale calculation = 18457.66943 MB
Before interleave = 18457.66943 MB
After interleave = 18457.85693 MB
After matmul = 18457.85791 MB
Before local copies matmul = 18457.85791 MB
After local copies = 18457.85986 MB
fter compute chunk allocated = 18457.66162 MB
Memory after cuda sdpa 18457.66943359375 MB
1
Memory before offload  18457.64794921875 MB
Memory after offload  18457.64794921875 MB
Memory before cuda sdpa 18457.66162109375 MB
On entering CUDA sdpa main function  allocated = 18457.66162 MB
Before first SDPA allocated = 18457.66162 MB
On chunked entry = 18457.66162 MB
On scale calculation = 18457.66943 MB
Before interleave = 18457.66943 MB
After interleave = 18458.16943 MB
After matmul = 18466.29639 MB
Before local copies matmul = 18466.29639 MB
After local copies = 18466.29932 MB
After first SDPA allocated = 18465.78662 MB
After first copy allocated = 18465.78662 MB
On chunked entry = 18465.78662 MB
On scale calculation = 18465.79443 MB
Before interleave = 18465.79443 MB
After interleave = 18465.98193 MB
After matmul = 18465.98291 MB
Before local copies matmul = 18465.98291 MB
After local copies = 18465.98486 MB
fter compute chunk allocated = 18465.78662 MB
Memory after cuda sdpa 18465.79443359375 MB
Decode step 13
1
Memory before offload  18465.7734375 MB
Memory after offload  18465.7734375 MB
Memory before cuda sdpa 18465.787109375 MB
On entering CUDA sdpa main function  allocated = 18465.78711 MB
Before first SDPA allocated = 18465.78711 MB
On chunked entry = 18465.78711 MB
On scale calculation = 18465.79492 MB
Before interleave = 18465.79492 MB
After interleave = 18466.29492 MB
After matmul = 18474.42188 MB
Before local copies matmul = 18474.42188 MB
After local copies = 18474.42480 MB
After first SDPA allocated = 18473.91211 MB
After first copy allocated = 18473.91211 MB
On chunked entry = 18473.91211 MB
On scale calculation = 18473.91992 MB
Before interleave = 18473.91992 MB
After interleave = 18474.12305 MB
After matmul = 18474.12402 MB
Before local copies matmul = 18474.12402 MB
After local copies = 18474.12598 MB
fter compute chunk allocated = 18473.91211 MB
Memory after cuda sdpa 18473.919921875 MB
1
Memory before offload  18473.8984375 MB
Memory after offload  18473.8984375 MB
Memory before cuda sdpa 18473.912109375 MB
On entering CUDA sdpa main function  allocated = 18473.91211 MB
Before first SDPA allocated = 18473.91211 MB
On chunked entry = 18473.91211 MB
On scale calculation = 18473.91992 MB
Before interleave = 18473.91992 MB
After interleave = 18474.41992 MB
After matmul = 18482.54688 MB
Before local copies matmul = 18482.54688 MB
After local copies = 18482.54980 MB
After first SDPA allocated = 18482.03711 MB
After first copy allocated = 18482.03711 MB
On chunked entry = 18482.03711 MB
On scale calculation = 18482.04492 MB
Before interleave = 18482.04492 MB
After interleave = 18482.24805 MB
After matmul = 18482.24902 MB
Before local copies matmul = 18482.24902 MB
After local copies = 18482.25098 MB
fter compute chunk allocated = 18482.03711 MB
Memory after cuda sdpa 18482.044921875 MB
1
Memory before offload  18482.0234375 MB
Memory after offload  18482.0234375 MB
Memory before cuda sdpa 18482.037109375 MB
On entering CUDA sdpa main function  allocated = 18482.03711 MB
Before first SDPA allocated = 18482.03711 MB
On chunked entry = 18482.03711 MB
On scale calculation = 18482.04492 MB
Before interleave = 18482.04492 MB
After interleave = 18482.54492 MB
After matmul = 18490.67188 MB
Before local copies matmul = 18490.67188 MB
After local copies = 18490.67480 MB
After first SDPA allocated = 18490.16211 MB
After first copy allocated = 18490.16211 MB
On chunked entry = 18490.16211 MB
On scale calculation = 18490.16992 MB
Before interleave = 18490.16992 MB
After interleave = 18490.37305 MB
After matmul = 18490.37402 MB
Before local copies matmul = 18490.37402 MB
After local copies = 18490.37598 MB
fter compute chunk allocated = 18490.16211 MB
Memory after cuda sdpa 18490.169921875 MB
1
Memory before offload  18490.1484375 MB
Memory after offload  18490.1484375 MB
Memory before cuda sdpa 18490.162109375 MB
On entering CUDA sdpa main function  allocated = 18490.16211 MB
Before first SDPA allocated = 18490.16211 MB
On chunked entry = 18490.16211 MB
On scale calculation = 18490.16992 MB
Before interleave = 18490.16992 MB
After interleave = 18490.66992 MB
After matmul = 18498.79688 MB
Before local copies matmul = 18498.79688 MB
After local copies = 18498.79980 MB
After first SDPA allocated = 18498.28711 MB
After first copy allocated = 18498.28711 MB
On chunked entry = 18498.28711 MB
On scale calculation = 18498.29492 MB
Before interleave = 18498.29492 MB
After interleave = 18498.49805 MB
After matmul = 18498.49902 MB
Before local copies matmul = 18498.49902 MB
After local copies = 18498.50098 MB
fter compute chunk allocated = 18498.28711 MB
Memory after cuda sdpa 18498.294921875 MB
1
Memory before offload  18498.2734375 MB
Memory after offload  18498.2734375 MB
Memory before cuda sdpa 18498.287109375 MB
On entering CUDA sdpa main function  allocated = 18498.28711 MB
Before first SDPA allocated = 18498.28711 MB
On chunked entry = 18498.28711 MB
On scale calculation = 18498.29492 MB
Before interleave = 18498.29492 MB
After interleave = 18498.79492 MB
After matmul = 18506.92188 MB
Before local copies matmul = 18506.92188 MB
After local copies = 18506.92480 MB
After first SDPA allocated = 18506.41211 MB
After first copy allocated = 18506.41211 MB
On chunked entry = 18506.41211 MB
On scale calculation = 18506.41992 MB
Before interleave = 18506.41992 MB
After interleave = 18506.62305 MB
After matmul = 18506.62402 MB
Before local copies matmul = 18506.62402 MB
After local copies = 18506.62598 MB
fter compute chunk allocated = 18506.41211 MB
Memory after cuda sdpa 18506.419921875 MB
1
Memory before offload  18506.3984375 MB
Memory after offload  18506.3984375 MB
Memory before cuda sdpa 18506.412109375 MB
On entering CUDA sdpa main function  allocated = 18506.41211 MB
Before first SDPA allocated = 18506.41211 MB
On chunked entry = 18506.41211 MB
On scale calculation = 18506.41992 MB
Before interleave = 18506.41992 MB
After interleave = 18506.91992 MB
After matmul = 18515.04688 MB
Before local copies matmul = 18515.04688 MB
After local copies = 18515.04980 MB
After first SDPA allocated = 18514.53711 MB
After first copy allocated = 18514.53711 MB
On chunked entry = 18514.53711 MB
On scale calculation = 18514.54492 MB
Before interleave = 18514.54492 MB
After interleave = 18514.74805 MB
After matmul = 18514.74902 MB
Before local copies matmul = 18514.74902 MB
After local copies = 18514.75098 MB
fter compute chunk allocated = 18514.53711 MB
Memory after cuda sdpa 18514.544921875 MB
1
Memory before offload  18514.5234375 MB
Memory after offload  18514.5234375 MB
Memory before cuda sdpa 18514.537109375 MB
On entering CUDA sdpa main function  allocated = 18514.53711 MB
Before first SDPA allocated = 18514.53711 MB
On chunked entry = 18514.53711 MB
On scale calculation = 18514.54492 MB
Before interleave = 18514.54492 MB
After interleave = 18515.04492 MB
After matmul = 18523.17188 MB
Before local copies matmul = 18523.17188 MB
After local copies = 18523.17480 MB
After first SDPA allocated = 18522.66211 MB
After first copy allocated = 18522.66211 MB
On chunked entry = 18522.66211 MB
On scale calculation = 18522.66992 MB
Before interleave = 18522.66992 MB
After interleave = 18522.87305 MB
After matmul = 18522.87402 MB
Before local copies matmul = 18522.87402 MB
After local copies = 18522.87598 MB
fter compute chunk allocated = 18522.66211 MB
Memory after cuda sdpa 18522.669921875 MB
1
Memory before offload  18522.6484375 MB
Memory after offload  18522.6484375 MB
Memory before cuda sdpa 18522.662109375 MB
On entering CUDA sdpa main function  allocated = 18522.66211 MB
Before first SDPA allocated = 18522.66211 MB
On chunked entry = 18522.66211 MB
On scale calculation = 18522.66992 MB
Before interleave = 18522.66992 MB
After interleave = 18523.16992 MB
After matmul = 18531.29688 MB
Before local copies matmul = 18531.29688 MB
After local copies = 18531.29980 MB
After first SDPA allocated = 18530.78711 MB
After first copy allocated = 18530.78711 MB
On chunked entry = 18530.78711 MB
On scale calculation = 18530.79492 MB
Before interleave = 18530.79492 MB
After interleave = 18530.99805 MB
After matmul = 18530.99902 MB
Before local copies matmul = 18530.99902 MB
After local copies = 18531.00098 MB
fter compute chunk allocated = 18530.78711 MB
Memory after cuda sdpa 18530.794921875 MB
1
Memory before offload  18530.7734375 MB
Memory after offload  18530.7734375 MB
Memory before cuda sdpa 18530.787109375 MB
On entering CUDA sdpa main function  allocated = 18530.78711 MB
Before first SDPA allocated = 18530.78711 MB
On chunked entry = 18530.78711 MB
On scale calculation = 18530.79492 MB
Before interleave = 18530.79492 MB
After interleave = 18531.29492 MB
After matmul = 18539.42188 MB
Before local copies matmul = 18539.42188 MB
After local copies = 18539.42480 MB
After first SDPA allocated = 18538.91211 MB
After first copy allocated = 18538.91211 MB
On chunked entry = 18538.91211 MB
On scale calculation = 18538.91992 MB
Before interleave = 18538.91992 MB
After interleave = 18539.12305 MB
After matmul = 18539.12402 MB
Before local copies matmul = 18539.12402 MB
After local copies = 18539.12598 MB
fter compute chunk allocated = 18538.91211 MB
Memory after cuda sdpa 18538.919921875 MB
1
Memory before offload  18538.8984375 MB
Memory after offload  18538.8984375 MB
Memory before cuda sdpa 18538.912109375 MB
On entering CUDA sdpa main function  allocated = 18538.91211 MB
Before first SDPA allocated = 18538.91211 MB
On chunked entry = 18538.91211 MB
On scale calculation = 18538.91992 MB
Before interleave = 18538.91992 MB
After interleave = 18539.41992 MB
After matmul = 18547.54688 MB
Before local copies matmul = 18547.54688 MB
After local copies = 18547.54980 MB
After first SDPA allocated = 18547.03711 MB
After first copy allocated = 18547.03711 MB
On chunked entry = 18547.03711 MB
On scale calculation = 18547.04492 MB
Before interleave = 18547.04492 MB
After interleave = 18547.24805 MB
After matmul = 18547.24902 MB
Before local copies matmul = 18547.24902 MB
After local copies = 18547.25098 MB
fter compute chunk allocated = 18547.03711 MB
Memory after cuda sdpa 18547.044921875 MB
1
Memory before offload  18547.0234375 MB
Memory after offload  18547.0234375 MB
Memory before cuda sdpa 18547.037109375 MB
On entering CUDA sdpa main function  allocated = 18547.03711 MB
Before first SDPA allocated = 18547.03711 MB
On chunked entry = 18547.03711 MB
On scale calculation = 18547.04492 MB
Before interleave = 18547.04492 MB
After interleave = 18547.54492 MB
After matmul = 18555.67188 MB
Before local copies matmul = 18555.67188 MB
After local copies = 18555.67480 MB
After first SDPA allocated = 18555.16211 MB
After first copy allocated = 18555.16211 MB
On chunked entry = 18555.16211 MB
On scale calculation = 18555.16992 MB
Before interleave = 18555.16992 MB
After interleave = 18555.37305 MB
After matmul = 18555.37402 MB
Before local copies matmul = 18555.37402 MB
After local copies = 18555.37598 MB
fter compute chunk allocated = 18555.16211 MB
Memory after cuda sdpa 18555.169921875 MB
1
Memory before offload  18555.1484375 MB
Memory after offload  18555.1484375 MB
Memory before cuda sdpa 18555.162109375 MB
On entering CUDA sdpa main function  allocated = 18555.16211 MB
Before first SDPA allocated = 18555.16211 MB
On chunked entry = 18555.16211 MB
On scale calculation = 18555.16992 MB
Before interleave = 18555.16992 MB
After interleave = 18555.66992 MB
After matmul = 18563.79688 MB
Before local copies matmul = 18563.79688 MB
After local copies = 18563.79980 MB
After first SDPA allocated = 18563.28711 MB
After first copy allocated = 18563.28711 MB
On chunked entry = 18563.28711 MB
On scale calculation = 18563.29492 MB
Before interleave = 18563.29492 MB
After interleave = 18563.49805 MB
After matmul = 18563.49902 MB
Before local copies matmul = 18563.49902 MB
After local copies = 18563.50098 MB
fter compute chunk allocated = 18563.28711 MB
Memory after cuda sdpa 18563.294921875 MB
1
Memory before offload  18563.2734375 MB
Memory after offload  18563.2734375 MB
Memory before cuda sdpa 18563.287109375 MB
On entering CUDA sdpa main function  allocated = 18563.28711 MB
Before first SDPA allocated = 18563.28711 MB
On chunked entry = 18563.28711 MB
On scale calculation = 18563.29492 MB
Before interleave = 18563.29492 MB
After interleave = 18563.79492 MB
After matmul = 18571.92188 MB
Before local copies matmul = 18571.92188 MB
After local copies = 18571.92480 MB
After first SDPA allocated = 18571.41211 MB
After first copy allocated = 18571.41211 MB
On chunked entry = 18571.41211 MB
On scale calculation = 18571.41992 MB
Before interleave = 18571.41992 MB
After interleave = 18571.62305 MB
After matmul = 18571.62402 MB
Before local copies matmul = 18571.62402 MB
After local copies = 18571.62598 MB
fter compute chunk allocated = 18571.41211 MB
Memory after cuda sdpa 18571.419921875 MB
1
Memory before offload  18571.3984375 MB
Memory after offload  18571.3984375 MB
Memory before cuda sdpa 18571.412109375 MB
On entering CUDA sdpa main function  allocated = 18571.41211 MB
Before first SDPA allocated = 18571.41211 MB
On chunked entry = 18571.41211 MB
On scale calculation = 18571.41992 MB
Before interleave = 18571.41992 MB
After interleave = 18571.91992 MB
After matmul = 18580.04688 MB
Before local copies matmul = 18580.04688 MB
After local copies = 18580.04980 MB
After first SDPA allocated = 18579.53711 MB
After first copy allocated = 18579.53711 MB
On chunked entry = 18579.53711 MB
On scale calculation = 18579.54492 MB
Before interleave = 18579.54492 MB
After interleave = 18579.74805 MB
After matmul = 18579.74902 MB
Before local copies matmul = 18579.74902 MB
After local copies = 18579.75098 MB
fter compute chunk allocated = 18579.53711 MB
Memory after cuda sdpa 18579.544921875 MB
1
Memory before offload  18579.5234375 MB
Memory after offload  18579.5234375 MB
Memory before cuda sdpa 18579.537109375 MB
On entering CUDA sdpa main function  allocated = 18579.53711 MB
Before first SDPA allocated = 18579.53711 MB
On chunked entry = 18579.53711 MB
On scale calculation = 18579.54492 MB
Before interleave = 18579.54492 MB
After interleave = 18580.04492 MB
After matmul = 18588.17188 MB
Before local copies matmul = 18588.17188 MB
After local copies = 18588.17480 MB
After first SDPA allocated = 18587.66211 MB
After first copy allocated = 18587.66211 MB
On chunked entry = 18587.66211 MB
On scale calculation = 18587.66992 MB
Before interleave = 18587.66992 MB
After interleave = 18587.87305 MB
After matmul = 18587.87402 MB
Before local copies matmul = 18587.87402 MB
After local copies = 18587.87598 MB
fter compute chunk allocated = 18587.66211 MB
Memory after cuda sdpa 18587.669921875 MB
1
Memory before offload  18587.6484375 MB
Memory after offload  18587.6484375 MB
Memory before cuda sdpa 18587.662109375 MB
On entering CUDA sdpa main function  allocated = 18587.66211 MB
Before first SDPA allocated = 18587.66211 MB
On chunked entry = 18587.66211 MB
On scale calculation = 18587.66992 MB
Before interleave = 18587.66992 MB
After interleave = 18588.16992 MB
After matmul = 18596.29688 MB
Before local copies matmul = 18596.29688 MB
After local copies = 18596.29980 MB
After first SDPA allocated = 18595.78711 MB
After first copy allocated = 18595.78711 MB
On chunked entry = 18595.78711 MB
On scale calculation = 18595.79492 MB
Before interleave = 18595.79492 MB
After interleave = 18595.99805 MB
After matmul = 18595.99902 MB
Before local copies matmul = 18595.99902 MB
After local copies = 18596.00098 MB
fter compute chunk allocated = 18595.78711 MB
Memory after cuda sdpa 18595.794921875 MB
1
Memory before offload  18595.7734375 MB
Memory after offload  18595.7734375 MB
Memory before cuda sdpa 18595.787109375 MB
On entering CUDA sdpa main function  allocated = 18595.78711 MB
Before first SDPA allocated = 18595.78711 MB
On chunked entry = 18595.78711 MB
On scale calculation = 18595.79492 MB
Before interleave = 18595.79492 MB
After interleave = 18596.29492 MB
After matmul = 18604.42188 MB
Before local copies matmul = 18604.42188 MB
After local copies = 18604.42480 MB
After first SDPA allocated = 18603.91211 MB
After first copy allocated = 18603.91211 MB
On chunked entry = 18603.91211 MB
On scale calculation = 18603.91992 MB
Before interleave = 18603.91992 MB
After interleave = 18604.12305 MB
After matmul = 18604.12402 MB
Before local copies matmul = 18604.12402 MB
After local copies = 18604.12598 MB
fter compute chunk allocated = 18603.91211 MB
Memory after cuda sdpa 18603.919921875 MB
1
Memory before offload  18603.8984375 MB
Memory after offload  18603.8984375 MB
Memory before cuda sdpa 18603.912109375 MB
On entering CUDA sdpa main function  allocated = 18603.91211 MB
Before first SDPA allocated = 18603.91211 MB
On chunked entry = 18603.91211 MB
On scale calculation = 18603.91992 MB
Before interleave = 18603.91992 MB
After interleave = 18604.41992 MB
After matmul = 18612.54688 MB
Before local copies matmul = 18612.54688 MB
After local copies = 18612.54980 MB
After first SDPA allocated = 18612.03711 MB
After first copy allocated = 18612.03711 MB
On chunked entry = 18612.03711 MB
On scale calculation = 18612.04492 MB
Before interleave = 18612.04492 MB
After interleave = 18612.24805 MB
After matmul = 18612.24902 MB
Before local copies matmul = 18612.24902 MB
After local copies = 18612.25098 MB
fter compute chunk allocated = 18612.03711 MB
Memory after cuda sdpa 18612.044921875 MB
1
Memory before offload  18612.0234375 MB
Memory after offload  18612.0234375 MB
Memory before cuda sdpa 18612.037109375 MB
On entering CUDA sdpa main function  allocated = 18612.03711 MB
Before first SDPA allocated = 18612.03711 MB
On chunked entry = 18612.03711 MB
On scale calculation = 18612.04492 MB
Before interleave = 18612.04492 MB
After interleave = 18612.54492 MB
After matmul = 18620.67188 MB
Before local copies matmul = 18620.67188 MB
After local copies = 18620.67480 MB
After first SDPA allocated = 18620.16211 MB
After first copy allocated = 18620.16211 MB
On chunked entry = 18620.16211 MB
On scale calculation = 18620.16992 MB
Before interleave = 18620.16992 MB
After interleave = 18620.37305 MB
After matmul = 18620.37402 MB
Before local copies matmul = 18620.37402 MB
After local copies = 18620.37598 MB
fter compute chunk allocated = 18620.16211 MB
Memory after cuda sdpa 18620.169921875 MB
1
Memory before offload  18620.1484375 MB
Memory after offload  18620.1484375 MB
Memory before cuda sdpa 18620.162109375 MB
On entering CUDA sdpa main function  allocated = 18620.16211 MB
Before first SDPA allocated = 18620.16211 MB
On chunked entry = 18620.16211 MB
On scale calculation = 18620.16992 MB
Before interleave = 18620.16992 MB
After interleave = 18620.66992 MB
After matmul = 18628.79688 MB
Before local copies matmul = 18628.79688 MB
After local copies = 18628.79980 MB
After first SDPA allocated = 18628.28711 MB
After first copy allocated = 18628.28711 MB
On chunked entry = 18628.28711 MB
On scale calculation = 18628.29492 MB
Before interleave = 18628.29492 MB
After interleave = 18628.49805 MB
After matmul = 18628.49902 MB
Before local copies matmul = 18628.49902 MB
After local copies = 18628.50098 MB
fter compute chunk allocated = 18628.28711 MB
Memory after cuda sdpa 18628.294921875 MB
1
Memory before offload  18628.2734375 MB
Memory after offload  18628.2734375 MB
Memory before cuda sdpa 18628.287109375 MB
On entering CUDA sdpa main function  allocated = 18628.28711 MB
Before first SDPA allocated = 18628.28711 MB
On chunked entry = 18628.28711 MB
On scale calculation = 18628.29492 MB
Before interleave = 18628.29492 MB
After interleave = 18628.79492 MB
After matmul = 18636.92188 MB
Before local copies matmul = 18636.92188 MB
After local copies = 18636.92480 MB
After first SDPA allocated = 18636.41211 MB
After first copy allocated = 18636.41211 MB
On chunked entry = 18636.41211 MB
On scale calculation = 18636.41992 MB
Before interleave = 18636.41992 MB
After interleave = 18636.62305 MB
After matmul = 18636.62402 MB
Before local copies matmul = 18636.62402 MB
After local copies = 18636.62598 MB
fter compute chunk allocated = 18636.41211 MB
Memory after cuda sdpa 18636.419921875 MB
1
Memory before offload  18636.3984375 MB
Memory after offload  18636.3984375 MB
Memory before cuda sdpa 18636.412109375 MB
On entering CUDA sdpa main function  allocated = 18636.41211 MB
Before first SDPA allocated = 18636.41211 MB
On chunked entry = 18636.41211 MB
On scale calculation = 18636.41992 MB
Before interleave = 18636.41992 MB
After interleave = 18636.91992 MB
After matmul = 18645.04688 MB
Before local copies matmul = 18645.04688 MB
After local copies = 18645.04980 MB
After first SDPA allocated = 18644.53711 MB
After first copy allocated = 18644.53711 MB
On chunked entry = 18644.53711 MB
On scale calculation = 18644.54492 MB
Before interleave = 18644.54492 MB
After interleave = 18644.74805 MB
After matmul = 18644.74902 MB
Before local copies matmul = 18644.74902 MB
After local copies = 18644.75098 MB
fter compute chunk allocated = 18644.53711 MB
Memory after cuda sdpa 18644.544921875 MB
1
Memory before offload  18644.5234375 MB
Memory after offload  18644.5234375 MB
Memory before cuda sdpa 18644.537109375 MB
On entering CUDA sdpa main function  allocated = 18644.53711 MB
Before first SDPA allocated = 18644.53711 MB
On chunked entry = 18644.53711 MB
On scale calculation = 18644.54492 MB
Before interleave = 18644.54492 MB
After interleave = 18645.04492 MB
After matmul = 18653.17188 MB
Before local copies matmul = 18653.17188 MB
After local copies = 18653.17480 MB
After first SDPA allocated = 18652.66211 MB
After first copy allocated = 18652.66211 MB
On chunked entry = 18652.66211 MB
On scale calculation = 18652.66992 MB
Before interleave = 18652.66992 MB
After interleave = 18652.87305 MB
After matmul = 18652.87402 MB
Before local copies matmul = 18652.87402 MB
After local copies = 18652.87598 MB
fter compute chunk allocated = 18652.66211 MB
Memory after cuda sdpa 18652.669921875 MB
1
Memory before offload  18652.6484375 MB
Memory after offload  18652.6484375 MB
Memory before cuda sdpa 18652.662109375 MB
On entering CUDA sdpa main function  allocated = 18652.66211 MB
Before first SDPA allocated = 18652.66211 MB
On chunked entry = 18652.66211 MB
On scale calculation = 18652.66992 MB
Before interleave = 18652.66992 MB
After interleave = 18653.16992 MB
After matmul = 18661.29688 MB
Before local copies matmul = 18661.29688 MB
After local copies = 18661.29980 MB
After first SDPA allocated = 18660.78711 MB
After first copy allocated = 18660.78711 MB
On chunked entry = 18660.78711 MB
On scale calculation = 18660.79492 MB
Before interleave = 18660.79492 MB
After interleave = 18660.99805 MB
After matmul = 18660.99902 MB
Before local copies matmul = 18660.99902 MB
After local copies = 18661.00098 MB
fter compute chunk allocated = 18660.78711 MB
Memory after cuda sdpa 18660.794921875 MB
1
Memory before offload  18660.7734375 MB
Memory after offload  18660.7734375 MB
Memory before cuda sdpa 18660.787109375 MB
On entering CUDA sdpa main function  allocated = 18660.78711 MB
Before first SDPA allocated = 18660.78711 MB
On chunked entry = 18660.78711 MB
On scale calculation = 18660.79492 MB
Before interleave = 18660.79492 MB
After interleave = 18661.29492 MB
After matmul = 18669.42188 MB
Before local copies matmul = 18669.42188 MB
After local copies = 18669.42480 MB
After first SDPA allocated = 18668.91211 MB
After first copy allocated = 18668.91211 MB
On chunked entry = 18668.91211 MB
On scale calculation = 18668.91992 MB
Before interleave = 18668.91992 MB
After interleave = 18669.12305 MB
After matmul = 18669.12402 MB
Before local copies matmul = 18669.12402 MB
After local copies = 18669.12598 MB
fter compute chunk allocated = 18668.91211 MB
Memory after cuda sdpa 18668.919921875 MB
1
Memory before offload  18668.8984375 MB
Memory after offload  18668.8984375 MB
Memory before cuda sdpa 18668.912109375 MB
On entering CUDA sdpa main function  allocated = 18668.91211 MB
Before first SDPA allocated = 18668.91211 MB
On chunked entry = 18668.91211 MB
On scale calculation = 18668.91992 MB
Before interleave = 18668.91992 MB
After interleave = 18669.41992 MB
After matmul = 18677.54688 MB
Before local copies matmul = 18677.54688 MB
After local copies = 18677.54980 MB
After first SDPA allocated = 18677.03711 MB
After first copy allocated = 18677.03711 MB
On chunked entry = 18677.03711 MB
On scale calculation = 18677.04492 MB
Before interleave = 18677.04492 MB
After interleave = 18677.24805 MB
After matmul = 18677.24902 MB
Before local copies matmul = 18677.24902 MB
After local copies = 18677.25098 MB
fter compute chunk allocated = 18677.03711 MB
Memory after cuda sdpa 18677.044921875 MB
1
Memory before offload  18677.0234375 MB
Memory after offload  18677.0234375 MB
Memory before cuda sdpa 18677.037109375 MB
On entering CUDA sdpa main function  allocated = 18677.03711 MB
Before first SDPA allocated = 18677.03711 MB
On chunked entry = 18677.03711 MB
On scale calculation = 18677.04492 MB
Before interleave = 18677.04492 MB
After interleave = 18677.54492 MB
After matmul = 18685.67188 MB
Before local copies matmul = 18685.67188 MB
After local copies = 18685.67480 MB
After first SDPA allocated = 18685.16211 MB
After first copy allocated = 18685.16211 MB
On chunked entry = 18685.16211 MB
On scale calculation = 18685.16992 MB
Before interleave = 18685.16992 MB
After interleave = 18685.37305 MB
After matmul = 18685.37402 MB
Before local copies matmul = 18685.37402 MB
After local copies = 18685.37598 MB
fter compute chunk allocated = 18685.16211 MB
Memory after cuda sdpa 18685.169921875 MB
1
Memory before offload  18685.1484375 MB
Memory after offload  18685.1484375 MB
Memory before cuda sdpa 18685.162109375 MB
On entering CUDA sdpa main function  allocated = 18685.16211 MB
Before first SDPA allocated = 18685.16211 MB
On chunked entry = 18685.16211 MB
On scale calculation = 18685.16992 MB
Before interleave = 18685.16992 MB
After interleave = 18685.66992 MB
After matmul = 18693.79688 MB
Before local copies matmul = 18693.79688 MB
After local copies = 18693.79980 MB
After first SDPA allocated = 18693.28711 MB
After first copy allocated = 18693.28711 MB
On chunked entry = 18693.28711 MB
On scale calculation = 18693.29492 MB
Before interleave = 18693.29492 MB
After interleave = 18693.49805 MB
After matmul = 18693.49902 MB
Before local copies matmul = 18693.49902 MB
After local copies = 18693.50098 MB
fter compute chunk allocated = 18693.28711 MB
Memory after cuda sdpa 18693.294921875 MB
1
Memory before offload  18693.2734375 MB
Memory after offload  18693.2734375 MB
Memory before cuda sdpa 18693.287109375 MB
On entering CUDA sdpa main function  allocated = 18693.28711 MB
Before first SDPA allocated = 18693.28711 MB
On chunked entry = 18693.28711 MB
On scale calculation = 18693.29492 MB
Before interleave = 18693.29492 MB
After interleave = 18693.79492 MB
After matmul = 18701.92188 MB
Before local copies matmul = 18701.92188 MB
After local copies = 18701.92480 MB
After first SDPA allocated = 18701.41211 MB
After first copy allocated = 18701.41211 MB
On chunked entry = 18701.41211 MB
On scale calculation = 18701.41992 MB
Before interleave = 18701.41992 MB
After interleave = 18701.62305 MB
After matmul = 18701.62402 MB
Before local copies matmul = 18701.62402 MB
After local copies = 18701.62598 MB
fter compute chunk allocated = 18701.41211 MB
Memory after cuda sdpa 18701.419921875 MB
1
Memory before offload  18701.3984375 MB
Memory after offload  18701.3984375 MB
Memory before cuda sdpa 18701.412109375 MB
On entering CUDA sdpa main function  allocated = 18701.41211 MB
Before first SDPA allocated = 18701.41211 MB
On chunked entry = 18701.41211 MB
On scale calculation = 18701.41992 MB
Before interleave = 18701.41992 MB
After interleave = 18701.91992 MB
After matmul = 18710.04688 MB
Before local copies matmul = 18710.04688 MB
After local copies = 18710.04980 MB
After first SDPA allocated = 18709.53711 MB
After first copy allocated = 18709.53711 MB
On chunked entry = 18709.53711 MB
On scale calculation = 18709.54492 MB
Before interleave = 18709.54492 MB
After interleave = 18709.74805 MB
After matmul = 18709.74902 MB
Before local copies matmul = 18709.74902 MB
After local copies = 18709.75098 MB
fter compute chunk allocated = 18709.53711 MB
Memory after cuda sdpa 18709.544921875 MB
1
Memory before offload  18709.5234375 MB
Memory after offload  18709.5234375 MB
Memory before cuda sdpa 18709.537109375 MB
On entering CUDA sdpa main function  allocated = 18709.53711 MB
Before first SDPA allocated = 18709.53711 MB
On chunked entry = 18709.53711 MB
On scale calculation = 18709.54492 MB
Before interleave = 18709.54492 MB
After interleave = 18710.04492 MB
After matmul = 18718.17188 MB
Before local copies matmul = 18718.17188 MB
After local copies = 18718.17480 MB
After first SDPA allocated = 18717.66211 MB
After first copy allocated = 18717.66211 MB
On chunked entry = 18717.66211 MB
On scale calculation = 18717.66992 MB
Before interleave = 18717.66992 MB
After interleave = 18717.87305 MB
After matmul = 18717.87402 MB
Before local copies matmul = 18717.87402 MB
After local copies = 18717.87598 MB
fter compute chunk allocated = 18717.66211 MB
Memory after cuda sdpa 18717.669921875 MB
1
Memory before offload  18717.6484375 MB
Memory after offload  18717.6484375 MB
Memory before cuda sdpa 18717.662109375 MB
On entering CUDA sdpa main function  allocated = 18717.66211 MB
Before first SDPA allocated = 18717.66211 MB
On chunked entry = 18717.66211 MB
On scale calculation = 18717.66992 MB
Before interleave = 18717.66992 MB
After interleave = 18718.16992 MB
After matmul = 18726.29688 MB
Before local copies matmul = 18726.29688 MB
After local copies = 18726.29980 MB
After first SDPA allocated = 18725.78711 MB
After first copy allocated = 18725.78711 MB
On chunked entry = 18725.78711 MB
On scale calculation = 18725.79492 MB
Before interleave = 18725.79492 MB
After interleave = 18725.99805 MB
After matmul = 18725.99902 MB
Before local copies matmul = 18725.99902 MB
After local copies = 18726.00098 MB
fter compute chunk allocated = 18725.78711 MB
Memory after cuda sdpa 18725.794921875 MB
Decode step 14
1
Memory before offload  18725.77392578125 MB
Memory after offload  18725.77392578125 MB
Memory before cuda sdpa 18725.78759765625 MB
On entering CUDA sdpa main function  allocated = 18725.78760 MB
Before first SDPA allocated = 18725.78760 MB
On chunked entry = 18725.78760 MB
On scale calculation = 18725.79541 MB
Before interleave = 18725.79541 MB
After interleave = 18726.29541 MB
After matmul = 18734.42236 MB
Before local copies matmul = 18734.42236 MB
After local copies = 18734.42529 MB
After first SDPA allocated = 18733.91260 MB
After first copy allocated = 18733.91260 MB
On chunked entry = 18733.91260 MB
On scale calculation = 18733.92041 MB
Before interleave = 18733.92041 MB
After interleave = 18734.13916 MB
After matmul = 18734.14014 MB
Before local copies matmul = 18734.14014 MB
After local copies = 18734.14209 MB
fter compute chunk allocated = 18733.91260 MB
Memory after cuda sdpa 18733.92041015625 MB
1
Memory before offload  18733.89892578125 MB
Memory after offload  18733.89892578125 MB
Memory before cuda sdpa 18733.91259765625 MB
On entering CUDA sdpa main function  allocated = 18733.91260 MB
Before first SDPA allocated = 18733.91260 MB
On chunked entry = 18733.91260 MB
On scale calculation = 18733.92041 MB
Before interleave = 18733.92041 MB
After interleave = 18734.42041 MB
After matmul = 18742.54736 MB
Before local copies matmul = 18742.54736 MB
After local copies = 18742.55029 MB
After first SDPA allocated = 18742.03760 MB
After first copy allocated = 18742.03760 MB
On chunked entry = 18742.03760 MB
On scale calculation = 18742.04541 MB
Before interleave = 18742.04541 MB
After interleave = 18742.26416 MB
After matmul = 18742.26514 MB
Before local copies matmul = 18742.26514 MB
After local copies = 18742.26709 MB
fter compute chunk allocated = 18742.03760 MB
Memory after cuda sdpa 18742.04541015625 MB
1
Memory before offload  18742.02392578125 MB
Memory after offload  18742.02392578125 MB
Memory before cuda sdpa 18742.03759765625 MB
On entering CUDA sdpa main function  allocated = 18742.03760 MB
Before first SDPA allocated = 18742.03760 MB
On chunked entry = 18742.03760 MB
On scale calculation = 18742.04541 MB
Before interleave = 18742.04541 MB
After interleave = 18742.54541 MB
After matmul = 18750.67236 MB
Before local copies matmul = 18750.67236 MB
After local copies = 18750.67529 MB
After first SDPA allocated = 18750.16260 MB
After first copy allocated = 18750.16260 MB
On chunked entry = 18750.16260 MB
On scale calculation = 18750.17041 MB
Before interleave = 18750.17041 MB
After interleave = 18750.38916 MB
After matmul = 18750.39014 MB
Before local copies matmul = 18750.39014 MB
After local copies = 18750.39209 MB
fter compute chunk allocated = 18750.16260 MB
Memory after cuda sdpa 18750.17041015625 MB
1
Memory before offload  18750.14892578125 MB
Memory after offload  18750.14892578125 MB
Memory before cuda sdpa 18750.16259765625 MB
On entering CUDA sdpa main function  allocated = 18750.16260 MB
Before first SDPA allocated = 18750.16260 MB
On chunked entry = 18750.16260 MB
On scale calculation = 18750.17041 MB
Before interleave = 18750.17041 MB
After interleave = 18750.67041 MB
After matmul = 18758.79736 MB
Before local copies matmul = 18758.79736 MB
After local copies = 18758.80029 MB
After first SDPA allocated = 18758.28760 MB
After first copy allocated = 18758.28760 MB
On chunked entry = 18758.28760 MB
On scale calculation = 18758.29541 MB
Before interleave = 18758.29541 MB
After interleave = 18758.51416 MB
After matmul = 18758.51514 MB
Before local copies matmul = 18758.51514 MB
After local copies = 18758.51709 MB
fter compute chunk allocated = 18758.28760 MB
Memory after cuda sdpa 18758.29541015625 MB
1
Memory before offload  18758.27392578125 MB
Memory after offload  18758.27392578125 MB
Memory before cuda sdpa 18758.28759765625 MB
On entering CUDA sdpa main function  allocated = 18758.28760 MB
Before first SDPA allocated = 18758.28760 MB
On chunked entry = 18758.28760 MB
On scale calculation = 18758.29541 MB
Before interleave = 18758.29541 MB
After interleave = 18758.79541 MB
After matmul = 18766.92236 MB
Before local copies matmul = 18766.92236 MB
After local copies = 18766.92529 MB
After first SDPA allocated = 18766.41260 MB
After first copy allocated = 18766.41260 MB
On chunked entry = 18766.41260 MB
On scale calculation = 18766.42041 MB
Before interleave = 18766.42041 MB
After interleave = 18766.63916 MB
After matmul = 18766.64014 MB
Before local copies matmul = 18766.64014 MB
After local copies = 18766.64209 MB
fter compute chunk allocated = 18766.41260 MB
Memory after cuda sdpa 18766.42041015625 MB
1
Memory before offload  18766.39892578125 MB
Memory after offload  18766.39892578125 MB
Memory before cuda sdpa 18766.41259765625 MB
On entering CUDA sdpa main function  allocated = 18766.41260 MB
Before first SDPA allocated = 18766.41260 MB
On chunked entry = 18766.41260 MB
On scale calculation = 18766.42041 MB
Before interleave = 18766.42041 MB
After interleave = 18766.92041 MB
After matmul = 18775.04736 MB
Before local copies matmul = 18775.04736 MB
After local copies = 18775.05029 MB
After first SDPA allocated = 18774.53760 MB
After first copy allocated = 18774.53760 MB
On chunked entry = 18774.53760 MB
On scale calculation = 18774.54541 MB
Before interleave = 18774.54541 MB
After interleave = 18774.76416 MB
After matmul = 18774.76514 MB
Before local copies matmul = 18774.76514 MB
After local copies = 18774.76709 MB
fter compute chunk allocated = 18774.53760 MB
Memory after cuda sdpa 18774.54541015625 MB
1
Memory before offload  18774.52392578125 MB
Memory after offload  18774.52392578125 MB
Memory before cuda sdpa 18774.53759765625 MB
On entering CUDA sdpa main function  allocated = 18774.53760 MB
Before first SDPA allocated = 18774.53760 MB
On chunked entry = 18774.53760 MB
On scale calculation = 18774.54541 MB
Before interleave = 18774.54541 MB
After interleave = 18775.04541 MB
After matmul = 18783.17236 MB
Before local copies matmul = 18783.17236 MB
After local copies = 18783.17529 MB
After first SDPA allocated = 18782.66260 MB
After first copy allocated = 18782.66260 MB
On chunked entry = 18782.66260 MB
On scale calculation = 18782.67041 MB
Before interleave = 18782.67041 MB
After interleave = 18782.88916 MB
After matmul = 18782.89014 MB
Before local copies matmul = 18782.89014 MB
After local copies = 18782.89209 MB
fter compute chunk allocated = 18782.66260 MB
Memory after cuda sdpa 18782.67041015625 MB
1
Memory before offload  18782.64892578125 MB
Memory after offload  18782.64892578125 MB
Memory before cuda sdpa 18782.66259765625 MB
On entering CUDA sdpa main function  allocated = 18782.66260 MB
Before first SDPA allocated = 18782.66260 MB
On chunked entry = 18782.66260 MB
On scale calculation = 18782.67041 MB
Before interleave = 18782.67041 MB
After interleave = 18783.17041 MB
After matmul = 18791.29736 MB
Before local copies matmul = 18791.29736 MB
After local copies = 18791.30029 MB
After first SDPA allocated = 18790.78760 MB
After first copy allocated = 18790.78760 MB
On chunked entry = 18790.78760 MB
On scale calculation = 18790.79541 MB
Before interleave = 18790.79541 MB
After interleave = 18791.01416 MB
After matmul = 18791.01514 MB
Before local copies matmul = 18791.01514 MB
After local copies = 18791.01709 MB
fter compute chunk allocated = 18790.78760 MB
Memory after cuda sdpa 18790.79541015625 MB
1
Memory before offload  18790.77392578125 MB
Memory after offload  18790.77392578125 MB
Memory before cuda sdpa 18790.78759765625 MB
On entering CUDA sdpa main function  allocated = 18790.78760 MB
Before first SDPA allocated = 18790.78760 MB
On chunked entry = 18790.78760 MB
On scale calculation = 18790.79541 MB
Before interleave = 18790.79541 MB
After interleave = 18791.29541 MB
After matmul = 18799.42236 MB
Before local copies matmul = 18799.42236 MB
After local copies = 18799.42529 MB
After first SDPA allocated = 18798.91260 MB
After first copy allocated = 18798.91260 MB
On chunked entry = 18798.91260 MB
On scale calculation = 18798.92041 MB
Before interleave = 18798.92041 MB
After interleave = 18799.13916 MB
After matmul = 18799.14014 MB
Before local copies matmul = 18799.14014 MB
After local copies = 18799.14209 MB
fter compute chunk allocated = 18798.91260 MB
Memory after cuda sdpa 18798.92041015625 MB
1
Memory before offload  18798.89892578125 MB
Memory after offload  18798.89892578125 MB
Memory before cuda sdpa 18798.91259765625 MB
On entering CUDA sdpa main function  allocated = 18798.91260 MB
Before first SDPA allocated = 18798.91260 MB
On chunked entry = 18798.91260 MB
On scale calculation = 18798.92041 MB
Before interleave = 18798.92041 MB
After interleave = 18799.42041 MB
After matmul = 18807.54736 MB
Before local copies matmul = 18807.54736 MB
After local copies = 18807.55029 MB
After first SDPA allocated = 18807.03760 MB
After first copy allocated = 18807.03760 MB
On chunked entry = 18807.03760 MB
On scale calculation = 18807.04541 MB
Before interleave = 18807.04541 MB
After interleave = 18807.26416 MB
After matmul = 18807.26514 MB
Before local copies matmul = 18807.26514 MB
After local copies = 18807.26709 MB
fter compute chunk allocated = 18807.03760 MB
Memory after cuda sdpa 18807.04541015625 MB
1
Memory before offload  18807.02392578125 MB
Memory after offload  18807.02392578125 MB
Memory before cuda sdpa 18807.03759765625 MB
On entering CUDA sdpa main function  allocated = 18807.03760 MB
Before first SDPA allocated = 18807.03760 MB
On chunked entry = 18807.03760 MB
On scale calculation = 18807.04541 MB
Before interleave = 18807.04541 MB
After interleave = 18807.54541 MB
After matmul = 18815.67236 MB
Before local copies matmul = 18815.67236 MB
After local copies = 18815.67529 MB
After first SDPA allocated = 18815.16260 MB
After first copy allocated = 18815.16260 MB
On chunked entry = 18815.16260 MB
On scale calculation = 18815.17041 MB
Before interleave = 18815.17041 MB
After interleave = 18815.38916 MB
After matmul = 18815.39014 MB
Before local copies matmul = 18815.39014 MB
After local copies = 18815.39209 MB
fter compute chunk allocated = 18815.16260 MB
Memory after cuda sdpa 18815.17041015625 MB
1
Memory before offload  18815.14892578125 MB
Memory after offload  18815.14892578125 MB
Memory before cuda sdpa 18815.16259765625 MB
On entering CUDA sdpa main function  allocated = 18815.16260 MB
Before first SDPA allocated = 18815.16260 MB
On chunked entry = 18815.16260 MB
On scale calculation = 18815.17041 MB
Before interleave = 18815.17041 MB
After interleave = 18815.67041 MB
After matmul = 18823.79736 MB
Before local copies matmul = 18823.79736 MB
After local copies = 18823.80029 MB
After first SDPA allocated = 18823.28760 MB
After first copy allocated = 18823.28760 MB
On chunked entry = 18823.28760 MB
On scale calculation = 18823.29541 MB
Before interleave = 18823.29541 MB
After interleave = 18823.51416 MB
After matmul = 18823.51514 MB
Before local copies matmul = 18823.51514 MB
After local copies = 18823.51709 MB
fter compute chunk allocated = 18823.28760 MB
Memory after cuda sdpa 18823.29541015625 MB
1
Memory before offload  18823.27392578125 MB
Memory after offload  18823.27392578125 MB
Memory before cuda sdpa 18823.28759765625 MB
On entering CUDA sdpa main function  allocated = 18823.28760 MB
Before first SDPA allocated = 18823.28760 MB
On chunked entry = 18823.28760 MB
On scale calculation = 18823.29541 MB
Before interleave = 18823.29541 MB
After interleave = 18823.79541 MB
After matmul = 18831.92236 MB
Before local copies matmul = 18831.92236 MB
After local copies = 18831.92529 MB
After first SDPA allocated = 18831.41260 MB
After first copy allocated = 18831.41260 MB
On chunked entry = 18831.41260 MB
On scale calculation = 18831.42041 MB
Before interleave = 18831.42041 MB
After interleave = 18831.63916 MB
After matmul = 18831.64014 MB
Before local copies matmul = 18831.64014 MB
After local copies = 18831.64209 MB
fter compute chunk allocated = 18831.41260 MB
Memory after cuda sdpa 18831.42041015625 MB
1
Memory before offload  18831.39892578125 MB
Memory after offload  18831.39892578125 MB
Memory before cuda sdpa 18831.41259765625 MB
On entering CUDA sdpa main function  allocated = 18831.41260 MB
Before first SDPA allocated = 18831.41260 MB
On chunked entry = 18831.41260 MB
On scale calculation = 18831.42041 MB
Before interleave = 18831.42041 MB
After interleave = 18831.92041 MB
After matmul = 18840.04736 MB
Before local copies matmul = 18840.04736 MB
After local copies = 18840.05029 MB
After first SDPA allocated = 18839.53760 MB
After first copy allocated = 18839.53760 MB
On chunked entry = 18839.53760 MB
On scale calculation = 18839.54541 MB
Before interleave = 18839.54541 MB
After interleave = 18839.76416 MB
After matmul = 18839.76514 MB
Before local copies matmul = 18839.76514 MB
After local copies = 18839.76709 MB
fter compute chunk allocated = 18839.53760 MB
Memory after cuda sdpa 18839.54541015625 MB
1
Memory before offload  18839.52392578125 MB
Memory after offload  18839.52392578125 MB
Memory before cuda sdpa 18839.53759765625 MB
On entering CUDA sdpa main function  allocated = 18839.53760 MB
Before first SDPA allocated = 18839.53760 MB
On chunked entry = 18839.53760 MB
On scale calculation = 18839.54541 MB
Before interleave = 18839.54541 MB
After interleave = 18840.04541 MB
After matmul = 18848.17236 MB
Before local copies matmul = 18848.17236 MB
After local copies = 18848.17529 MB
After first SDPA allocated = 18847.66260 MB
After first copy allocated = 18847.66260 MB
On chunked entry = 18847.66260 MB
On scale calculation = 18847.67041 MB
Before interleave = 18847.67041 MB
After interleave = 18847.88916 MB
After matmul = 18847.89014 MB
Before local copies matmul = 18847.89014 MB
After local copies = 18847.89209 MB
fter compute chunk allocated = 18847.66260 MB
Memory after cuda sdpa 18847.67041015625 MB
1
Memory before offload  18847.64892578125 MB
Memory after offload  18847.64892578125 MB
Memory before cuda sdpa 18847.66259765625 MB
On entering CUDA sdpa main function  allocated = 18847.66260 MB
Before first SDPA allocated = 18847.66260 MB
On chunked entry = 18847.66260 MB
On scale calculation = 18847.67041 MB
Before interleave = 18847.67041 MB
After interleave = 18848.17041 MB
After matmul = 18856.29736 MB
Before local copies matmul = 18856.29736 MB
After local copies = 18856.30029 MB
After first SDPA allocated = 18855.78760 MB
After first copy allocated = 18855.78760 MB
On chunked entry = 18855.78760 MB
On scale calculation = 18855.79541 MB
Before interleave = 18855.79541 MB
After interleave = 18856.01416 MB
After matmul = 18856.01514 MB
Before local copies matmul = 18856.01514 MB
After local copies = 18856.01709 MB
fter compute chunk allocated = 18855.78760 MB
Memory after cuda sdpa 18855.79541015625 MB
1
Memory before offload  18855.77392578125 MB
Memory after offload  18855.77392578125 MB
Memory before cuda sdpa 18855.78759765625 MB
On entering CUDA sdpa main function  allocated = 18855.78760 MB
Before first SDPA allocated = 18855.78760 MB
On chunked entry = 18855.78760 MB
On scale calculation = 18855.79541 MB
Before interleave = 18855.79541 MB
After interleave = 18856.29541 MB
After matmul = 18864.42236 MB
Before local copies matmul = 18864.42236 MB
After local copies = 18864.42529 MB
After first SDPA allocated = 18863.91260 MB
After first copy allocated = 18863.91260 MB
On chunked entry = 18863.91260 MB
On scale calculation = 18863.92041 MB
Before interleave = 18863.92041 MB
After interleave = 18864.13916 MB
After matmul = 18864.14014 MB
Before local copies matmul = 18864.14014 MB
After local copies = 18864.14209 MB
fter compute chunk allocated = 18863.91260 MB
Memory after cuda sdpa 18863.92041015625 MB
1
Memory before offload  18863.89892578125 MB
Memory after offload  18863.89892578125 MB
Memory before cuda sdpa 18863.91259765625 MB
On entering CUDA sdpa main function  allocated = 18863.91260 MB
Before first SDPA allocated = 18863.91260 MB
On chunked entry = 18863.91260 MB
On scale calculation = 18863.92041 MB
Before interleave = 18863.92041 MB
After interleave = 18864.42041 MB
After matmul = 18872.54736 MB
Before local copies matmul = 18872.54736 MB
After local copies = 18872.55029 MB
After first SDPA allocated = 18872.03760 MB
After first copy allocated = 18872.03760 MB
On chunked entry = 18872.03760 MB
On scale calculation = 18872.04541 MB
Before interleave = 18872.04541 MB
After interleave = 18872.26416 MB
After matmul = 18872.26514 MB
Before local copies matmul = 18872.26514 MB
After local copies = 18872.26709 MB
fter compute chunk allocated = 18872.03760 MB
Memory after cuda sdpa 18872.04541015625 MB
1
Memory before offload  18872.02392578125 MB
Memory after offload  18872.02392578125 MB
Memory before cuda sdpa 18872.03759765625 MB
On entering CUDA sdpa main function  allocated = 18872.03760 MB
Before first SDPA allocated = 18872.03760 MB
On chunked entry = 18872.03760 MB
On scale calculation = 18872.04541 MB
Before interleave = 18872.04541 MB
After interleave = 18872.54541 MB
After matmul = 18880.67236 MB
Before local copies matmul = 18880.67236 MB
After local copies = 18880.67529 MB
After first SDPA allocated = 18880.16260 MB
After first copy allocated = 18880.16260 MB
On chunked entry = 18880.16260 MB
On scale calculation = 18880.17041 MB
Before interleave = 18880.17041 MB
After interleave = 18880.38916 MB
After matmul = 18880.39014 MB
Before local copies matmul = 18880.39014 MB
After local copies = 18880.39209 MB
fter compute chunk allocated = 18880.16260 MB
Memory after cuda sdpa 18880.17041015625 MB
1
Memory before offload  18880.14892578125 MB
Memory after offload  18880.14892578125 MB
Memory before cuda sdpa 18880.16259765625 MB
On entering CUDA sdpa main function  allocated = 18880.16260 MB
Before first SDPA allocated = 18880.16260 MB
On chunked entry = 18880.16260 MB
On scale calculation = 18880.17041 MB
Before interleave = 18880.17041 MB
After interleave = 18880.67041 MB
After matmul = 18888.79736 MB
Before local copies matmul = 18888.79736 MB
After local copies = 18888.80029 MB
After first SDPA allocated = 18888.28760 MB
After first copy allocated = 18888.28760 MB
On chunked entry = 18888.28760 MB
On scale calculation = 18888.29541 MB
Before interleave = 18888.29541 MB
After interleave = 18888.51416 MB
After matmul = 18888.51514 MB
Before local copies matmul = 18888.51514 MB
After local copies = 18888.51709 MB
fter compute chunk allocated = 18888.28760 MB
Memory after cuda sdpa 18888.29541015625 MB
1
Memory before offload  18888.27392578125 MB
Memory after offload  18888.27392578125 MB
Memory before cuda sdpa 18888.28759765625 MB
On entering CUDA sdpa main function  allocated = 18888.28760 MB
Before first SDPA allocated = 18888.28760 MB
On chunked entry = 18888.28760 MB
On scale calculation = 18888.29541 MB
Before interleave = 18888.29541 MB
After interleave = 18888.79541 MB
After matmul = 18896.92236 MB
Before local copies matmul = 18896.92236 MB
After local copies = 18896.92529 MB
After first SDPA allocated = 18896.41260 MB
After first copy allocated = 18896.41260 MB
On chunked entry = 18896.41260 MB
On scale calculation = 18896.42041 MB
Before interleave = 18896.42041 MB
After interleave = 18896.63916 MB
After matmul = 18896.64014 MB
Before local copies matmul = 18896.64014 MB
After local copies = 18896.64209 MB
fter compute chunk allocated = 18896.41260 MB
Memory after cuda sdpa 18896.42041015625 MB
1
Memory before offload  18896.39892578125 MB
Memory after offload  18896.39892578125 MB
Memory before cuda sdpa 18896.41259765625 MB
On entering CUDA sdpa main function  allocated = 18896.41260 MB
Before first SDPA allocated = 18896.41260 MB
On chunked entry = 18896.41260 MB
On scale calculation = 18896.42041 MB
Before interleave = 18896.42041 MB
After interleave = 18896.92041 MB
After matmul = 18905.04736 MB
Before local copies matmul = 18905.04736 MB
After local copies = 18905.05029 MB
After first SDPA allocated = 18904.53760 MB
After first copy allocated = 18904.53760 MB
On chunked entry = 18904.53760 MB
On scale calculation = 18904.54541 MB
Before interleave = 18904.54541 MB
After interleave = 18904.76416 MB
After matmul = 18904.76514 MB
Before local copies matmul = 18904.76514 MB
After local copies = 18904.76709 MB
fter compute chunk allocated = 18904.53760 MB
Memory after cuda sdpa 18904.54541015625 MB
1
Memory before offload  18904.52392578125 MB
Memory after offload  18904.52392578125 MB
Memory before cuda sdpa 18904.53759765625 MB
On entering CUDA sdpa main function  allocated = 18904.53760 MB
Before first SDPA allocated = 18904.53760 MB
On chunked entry = 18904.53760 MB
On scale calculation = 18904.54541 MB
Before interleave = 18904.54541 MB
After interleave = 18905.04541 MB
After matmul = 18913.17236 MB
Before local copies matmul = 18913.17236 MB
After local copies = 18913.17529 MB
After first SDPA allocated = 18912.66260 MB
After first copy allocated = 18912.66260 MB
On chunked entry = 18912.66260 MB
On scale calculation = 18912.67041 MB
Before interleave = 18912.67041 MB
After interleave = 18912.88916 MB
After matmul = 18912.89014 MB
Before local copies matmul = 18912.89014 MB
After local copies = 18912.89209 MB
fter compute chunk allocated = 18912.66260 MB
Memory after cuda sdpa 18912.67041015625 MB
1
Memory before offload  18912.64892578125 MB
Memory after offload  18912.64892578125 MB
Memory before cuda sdpa 18912.66259765625 MB
On entering CUDA sdpa main function  allocated = 18912.66260 MB
Before first SDPA allocated = 18912.66260 MB
On chunked entry = 18912.66260 MB
On scale calculation = 18912.67041 MB
Before interleave = 18912.67041 MB
After interleave = 18913.17041 MB
After matmul = 18921.29736 MB
Before local copies matmul = 18921.29736 MB
After local copies = 18921.30029 MB
After first SDPA allocated = 18920.78760 MB
After first copy allocated = 18920.78760 MB
On chunked entry = 18920.78760 MB
On scale calculation = 18920.79541 MB
Before interleave = 18920.79541 MB
After interleave = 18921.01416 MB
After matmul = 18921.01514 MB
Before local copies matmul = 18921.01514 MB
After local copies = 18921.01709 MB
fter compute chunk allocated = 18920.78760 MB
Memory after cuda sdpa 18920.79541015625 MB
1
Memory before offload  18920.77392578125 MB
Memory after offload  18920.77392578125 MB
Memory before cuda sdpa 18920.78759765625 MB
On entering CUDA sdpa main function  allocated = 18920.78760 MB
Before first SDPA allocated = 18920.78760 MB
On chunked entry = 18920.78760 MB
On scale calculation = 18920.79541 MB
Before interleave = 18920.79541 MB
After interleave = 18921.29541 MB
After matmul = 18929.42236 MB
Before local copies matmul = 18929.42236 MB
After local copies = 18929.42529 MB
After first SDPA allocated = 18928.91260 MB
After first copy allocated = 18928.91260 MB
On chunked entry = 18928.91260 MB
On scale calculation = 18928.92041 MB
Before interleave = 18928.92041 MB
After interleave = 18929.13916 MB
After matmul = 18929.14014 MB
Before local copies matmul = 18929.14014 MB
After local copies = 18929.14209 MB
fter compute chunk allocated = 18928.91260 MB
Memory after cuda sdpa 18928.92041015625 MB
1
Memory before offload  18928.89892578125 MB
Memory after offload  18928.89892578125 MB
Memory before cuda sdpa 18928.91259765625 MB
On entering CUDA sdpa main function  allocated = 18928.91260 MB
Before first SDPA allocated = 18928.91260 MB
On chunked entry = 18928.91260 MB
On scale calculation = 18928.92041 MB
Before interleave = 18928.92041 MB
After interleave = 18929.42041 MB
After matmul = 18937.54736 MB
Before local copies matmul = 18937.54736 MB
After local copies = 18937.55029 MB
After first SDPA allocated = 18937.03760 MB
After first copy allocated = 18937.03760 MB
On chunked entry = 18937.03760 MB
On scale calculation = 18937.04541 MB
Before interleave = 18937.04541 MB
After interleave = 18937.26416 MB
After matmul = 18937.26514 MB
Before local copies matmul = 18937.26514 MB
After local copies = 18937.26709 MB
fter compute chunk allocated = 18937.03760 MB
Memory after cuda sdpa 18937.04541015625 MB
1
Memory before offload  18937.02392578125 MB
Memory after offload  18937.02392578125 MB
Memory before cuda sdpa 18937.03759765625 MB
On entering CUDA sdpa main function  allocated = 18937.03760 MB
Before first SDPA allocated = 18937.03760 MB
On chunked entry = 18937.03760 MB
On scale calculation = 18937.04541 MB
Before interleave = 18937.04541 MB
After interleave = 18937.54541 MB
After matmul = 18945.67236 MB
Before local copies matmul = 18945.67236 MB
After local copies = 18945.67529 MB
After first SDPA allocated = 18945.16260 MB
After first copy allocated = 18945.16260 MB
On chunked entry = 18945.16260 MB
On scale calculation = 18945.17041 MB
Before interleave = 18945.17041 MB
After interleave = 18945.38916 MB
After matmul = 18945.39014 MB
Before local copies matmul = 18945.39014 MB
After local copies = 18945.39209 MB
fter compute chunk allocated = 18945.16260 MB
Memory after cuda sdpa 18945.17041015625 MB
1
Memory before offload  18945.14892578125 MB
Memory after offload  18945.14892578125 MB
Memory before cuda sdpa 18945.16259765625 MB
On entering CUDA sdpa main function  allocated = 18945.16260 MB
Before first SDPA allocated = 18945.16260 MB
On chunked entry = 18945.16260 MB
On scale calculation = 18945.17041 MB
Before interleave = 18945.17041 MB
After interleave = 18945.67041 MB
After matmul = 18953.79736 MB
Before local copies matmul = 18953.79736 MB
After local copies = 18953.80029 MB
After first SDPA allocated = 18953.28760 MB
After first copy allocated = 18953.28760 MB
On chunked entry = 18953.28760 MB
On scale calculation = 18953.29541 MB
Before interleave = 18953.29541 MB
After interleave = 18953.51416 MB
After matmul = 18953.51514 MB
Before local copies matmul = 18953.51514 MB
After local copies = 18953.51709 MB
fter compute chunk allocated = 18953.28760 MB
Memory after cuda sdpa 18953.29541015625 MB
1
Memory before offload  18953.27392578125 MB
Memory after offload  18953.27392578125 MB
Memory before cuda sdpa 18953.28759765625 MB
On entering CUDA sdpa main function  allocated = 18953.28760 MB
Before first SDPA allocated = 18953.28760 MB
On chunked entry = 18953.28760 MB
On scale calculation = 18953.29541 MB
Before interleave = 18953.29541 MB
After interleave = 18953.79541 MB
After matmul = 18961.92236 MB
Before local copies matmul = 18961.92236 MB
After local copies = 18961.92529 MB
After first SDPA allocated = 18961.41260 MB
After first copy allocated = 18961.41260 MB
On chunked entry = 18961.41260 MB
On scale calculation = 18961.42041 MB
Before interleave = 18961.42041 MB
After interleave = 18961.63916 MB
After matmul = 18961.64014 MB
Before local copies matmul = 18961.64014 MB
After local copies = 18961.64209 MB
fter compute chunk allocated = 18961.41260 MB
Memory after cuda sdpa 18961.42041015625 MB
1
Memory before offload  18961.39892578125 MB
Memory after offload  18961.39892578125 MB
Memory before cuda sdpa 18961.41259765625 MB
On entering CUDA sdpa main function  allocated = 18961.41260 MB
Before first SDPA allocated = 18961.41260 MB
On chunked entry = 18961.41260 MB
On scale calculation = 18961.42041 MB
Before interleave = 18961.42041 MB
After interleave = 18961.92041 MB
After matmul = 18970.04736 MB
Before local copies matmul = 18970.04736 MB
After local copies = 18970.05029 MB
After first SDPA allocated = 18969.53760 MB
After first copy allocated = 18969.53760 MB
On chunked entry = 18969.53760 MB
On scale calculation = 18969.54541 MB
Before interleave = 18969.54541 MB
After interleave = 18969.76416 MB
After matmul = 18969.76514 MB
Before local copies matmul = 18969.76514 MB
After local copies = 18969.76709 MB
fter compute chunk allocated = 18969.53760 MB
Memory after cuda sdpa 18969.54541015625 MB
1
Memory before offload  18969.52392578125 MB
Memory after offload  18969.52392578125 MB
Memory before cuda sdpa 18969.53759765625 MB
On entering CUDA sdpa main function  allocated = 18969.53760 MB
Before first SDPA allocated = 18969.53760 MB
On chunked entry = 18969.53760 MB
On scale calculation = 18969.54541 MB
Before interleave = 18969.54541 MB
After interleave = 18970.04541 MB
After matmul = 18978.17236 MB
Before local copies matmul = 18978.17236 MB
After local copies = 18978.17529 MB
After first SDPA allocated = 18977.66260 MB
After first copy allocated = 18977.66260 MB
On chunked entry = 18977.66260 MB
On scale calculation = 18977.67041 MB
Before interleave = 18977.67041 MB
After interleave = 18977.88916 MB
After matmul = 18977.89014 MB
Before local copies matmul = 18977.89014 MB
After local copies = 18977.89209 MB
fter compute chunk allocated = 18977.66260 MB
Memory after cuda sdpa 18977.67041015625 MB
1
Memory before offload  18977.64892578125 MB
Memory after offload  18977.64892578125 MB
Memory before cuda sdpa 18977.66259765625 MB
On entering CUDA sdpa main function  allocated = 18977.66260 MB
Before first SDPA allocated = 18977.66260 MB
On chunked entry = 18977.66260 MB
On scale calculation = 18977.67041 MB
Before interleave = 18977.67041 MB
After interleave = 18978.17041 MB
After matmul = 18986.29736 MB
Before local copies matmul = 18986.29736 MB
After local copies = 18986.30029 MB
After first SDPA allocated = 18985.78760 MB
After first copy allocated = 18985.78760 MB
On chunked entry = 18985.78760 MB
On scale calculation = 18985.79541 MB
Before interleave = 18985.79541 MB
After interleave = 18986.01416 MB
After matmul = 18986.01514 MB
Before local copies matmul = 18986.01514 MB
After local copies = 18986.01709 MB
fter compute chunk allocated = 18985.78760 MB
Memory after cuda sdpa 18985.79541015625 MB
Decode step 15
1
Memory before offload  18985.7744140625 MB
Memory after offload  18985.7744140625 MB
Memory before cuda sdpa 18985.7880859375 MB
On entering CUDA sdpa main function  allocated = 18985.78809 MB
Before first SDPA allocated = 18985.78809 MB
On chunked entry = 18985.78809 MB
On scale calculation = 18985.79590 MB
Before interleave = 18985.79590 MB
After interleave = 18986.29590 MB
After matmul = 18994.42285 MB
Before local copies matmul = 18994.42285 MB
After local copies = 18994.42578 MB
After first SDPA allocated = 18993.91309 MB
After first copy allocated = 18993.91309 MB
On chunked entry = 18993.91309 MB
On scale calculation = 18993.92090 MB
Before interleave = 18993.92090 MB
After interleave = 18994.15527 MB
After matmul = 18994.15625 MB
Before local copies matmul = 18994.15625 MB
After local copies = 18994.15820 MB
fter compute chunk allocated = 18993.91309 MB
Memory after cuda sdpa 18993.9208984375 MB
1
Memory before offload  18993.8994140625 MB
Memory after offload  18993.8994140625 MB
Memory before cuda sdpa 18993.9130859375 MB
On entering CUDA sdpa main function  allocated = 18993.91309 MB
Before first SDPA allocated = 18993.91309 MB
On chunked entry = 18993.91309 MB
On scale calculation = 18993.92090 MB
Before interleave = 18993.92090 MB
After interleave = 18994.42090 MB
After matmul = 19002.54785 MB
Before local copies matmul = 19002.54785 MB
After local copies = 19002.55078 MB
After first SDPA allocated = 19002.03809 MB
After first copy allocated = 19002.03809 MB
On chunked entry = 19002.03809 MB
On scale calculation = 19002.04590 MB
Before interleave = 19002.04590 MB
After interleave = 19002.28027 MB
After matmul = 19002.28125 MB
Before local copies matmul = 19002.28125 MB
After local copies = 19002.28320 MB
fter compute chunk allocated = 19002.03809 MB
Memory after cuda sdpa 19002.0458984375 MB
1
Memory before offload  19002.0244140625 MB
Memory after offload  19002.0244140625 MB
Memory before cuda sdpa 19002.0380859375 MB
On entering CUDA sdpa main function  allocated = 19002.03809 MB
Before first SDPA allocated = 19002.03809 MB
On chunked entry = 19002.03809 MB
On scale calculation = 19002.04590 MB
Before interleave = 19002.04590 MB
After interleave = 19002.54590 MB
After matmul = 19010.67285 MB
Before local copies matmul = 19010.67285 MB
After local copies = 19010.67578 MB
After first SDPA allocated = 19010.16309 MB
After first copy allocated = 19010.16309 MB
On chunked entry = 19010.16309 MB
On scale calculation = 19010.17090 MB
Before interleave = 19010.17090 MB
After interleave = 19010.40527 MB
After matmul = 19010.40625 MB
Before local copies matmul = 19010.40625 MB
After local copies = 19010.40820 MB
fter compute chunk allocated = 19010.16309 MB
Memory after cuda sdpa 19010.1708984375 MB
1
Memory before offload  19010.1494140625 MB
Memory after offload  19010.1494140625 MB
Memory before cuda sdpa 19010.1630859375 MB
On entering CUDA sdpa main function  allocated = 19010.16309 MB
Before first SDPA allocated = 19010.16309 MB
On chunked entry = 19010.16309 MB
On scale calculation = 19010.17090 MB
Before interleave = 19010.17090 MB
After interleave = 19010.67090 MB
After matmul = 19018.79785 MB
Before local copies matmul = 19018.79785 MB
After local copies = 19018.80078 MB
After first SDPA allocated = 19018.28809 MB
After first copy allocated = 19018.28809 MB
On chunked entry = 19018.28809 MB
On scale calculation = 19018.29590 MB
Before interleave = 19018.29590 MB
After interleave = 19018.53027 MB
After matmul = 19018.53125 MB
Before local copies matmul = 19018.53125 MB
After local copies = 19018.53320 MB
fter compute chunk allocated = 19018.28809 MB
Memory after cuda sdpa 19018.2958984375 MB
1
Memory before offload  19018.2744140625 MB
Memory after offload  19018.2744140625 MB
Memory before cuda sdpa 19018.2880859375 MB
On entering CUDA sdpa main function  allocated = 19018.28809 MB
Before first SDPA allocated = 19018.28809 MB
On chunked entry = 19018.28809 MB
On scale calculation = 19018.29590 MB
Before interleave = 19018.29590 MB
After interleave = 19018.79590 MB
After matmul = 19026.92285 MB
Before local copies matmul = 19026.92285 MB
After local copies = 19026.92578 MB
After first SDPA allocated = 19026.41309 MB
After first copy allocated = 19026.41309 MB
On chunked entry = 19026.41309 MB
On scale calculation = 19026.42090 MB
Before interleave = 19026.42090 MB
After interleave = 19026.65527 MB
After matmul = 19026.65625 MB
Before local copies matmul = 19026.65625 MB
After local copies = 19026.65820 MB
fter compute chunk allocated = 19026.41309 MB
Memory after cuda sdpa 19026.4208984375 MB
1
Memory before offload  19026.3994140625 MB
Memory after offload  19026.3994140625 MB
Memory before cuda sdpa 19026.4130859375 MB
On entering CUDA sdpa main function  allocated = 19026.41309 MB
Before first SDPA allocated = 19026.41309 MB
On chunked entry = 19026.41309 MB
On scale calculation = 19026.42090 MB
Before interleave = 19026.42090 MB
After interleave = 19026.92090 MB
After matmul = 19035.04785 MB
Before local copies matmul = 19035.04785 MB
After local copies = 19035.05078 MB
After first SDPA allocated = 19034.53809 MB
After first copy allocated = 19034.53809 MB
On chunked entry = 19034.53809 MB
On scale calculation = 19034.54590 MB
Before interleave = 19034.54590 MB
After interleave = 19034.78027 MB
After matmul = 19034.78125 MB
Before local copies matmul = 19034.78125 MB
After local copies = 19034.78320 MB
fter compute chunk allocated = 19034.53809 MB
Memory after cuda sdpa 19034.5458984375 MB
1
Memory before offload  19034.5244140625 MB
Memory after offload  19034.5244140625 MB
Memory before cuda sdpa 19034.5380859375 MB
On entering CUDA sdpa main function  allocated = 19034.53809 MB
Before first SDPA allocated = 19034.53809 MB
On chunked entry = 19034.53809 MB
On scale calculation = 19034.54590 MB
Before interleave = 19034.54590 MB
After interleave = 19035.04590 MB
After matmul = 19043.17285 MB
Before local copies matmul = 19043.17285 MB
After local copies = 19043.17578 MB
After first SDPA allocated = 19042.66309 MB
After first copy allocated = 19042.66309 MB
On chunked entry = 19042.66309 MB
On scale calculation = 19042.67090 MB
Before interleave = 19042.67090 MB
After interleave = 19042.90527 MB
After matmul = 19042.90625 MB
Before local copies matmul = 19042.90625 MB
After local copies = 19042.90820 MB
fter compute chunk allocated = 19042.66309 MB
Memory after cuda sdpa 19042.6708984375 MB
1
Memory before offload  19042.6494140625 MB
Memory after offload  19042.6494140625 MB
Memory before cuda sdpa 19042.6630859375 MB
On entering CUDA sdpa main function  allocated = 19042.66309 MB
Before first SDPA allocated = 19042.66309 MB
On chunked entry = 19042.66309 MB
On scale calculation = 19042.67090 MB
Before interleave = 19042.67090 MB
After interleave = 19043.17090 MB
After matmul = 19051.29785 MB
Before local copies matmul = 19051.29785 MB
After local copies = 19051.30078 MB
After first SDPA allocated = 19050.78809 MB
After first copy allocated = 19050.78809 MB
On chunked entry = 19050.78809 MB
On scale calculation = 19050.79590 MB
Before interleave = 19050.79590 MB
After interleave = 19051.03027 MB
After matmul = 19051.03125 MB
Before local copies matmul = 19051.03125 MB
After local copies = 19051.03320 MB
fter compute chunk allocated = 19050.78809 MB
Memory after cuda sdpa 19050.7958984375 MB
1
Memory before offload  19050.7744140625 MB
Memory after offload  19050.7744140625 MB
Memory before cuda sdpa 19050.7880859375 MB
On entering CUDA sdpa main function  allocated = 19050.78809 MB
Before first SDPA allocated = 19050.78809 MB
On chunked entry = 19050.78809 MB
On scale calculation = 19050.79590 MB
Before interleave = 19050.79590 MB
After interleave = 19051.29590 MB
After matmul = 19059.42285 MB
Before local copies matmul = 19059.42285 MB
After local copies = 19059.42578 MB
After first SDPA allocated = 19058.91309 MB
After first copy allocated = 19058.91309 MB
On chunked entry = 19058.91309 MB
On scale calculation = 19058.92090 MB
Before interleave = 19058.92090 MB
After interleave = 19059.15527 MB
After matmul = 19059.15625 MB
Before local copies matmul = 19059.15625 MB
After local copies = 19059.15820 MB
fter compute chunk allocated = 19058.91309 MB
Memory after cuda sdpa 19058.9208984375 MB
1
Memory before offload  19058.8994140625 MB
Memory after offload  19058.8994140625 MB
Memory before cuda sdpa 19058.9130859375 MB
On entering CUDA sdpa main function  allocated = 19058.91309 MB
Before first SDPA allocated = 19058.91309 MB
On chunked entry = 19058.91309 MB
On scale calculation = 19058.92090 MB
Before interleave = 19058.92090 MB
After interleave = 19059.42090 MB
After matmul = 19067.54785 MB
Before local copies matmul = 19067.54785 MB
After local copies = 19067.55078 MB
After first SDPA allocated = 19067.03809 MB
After first copy allocated = 19067.03809 MB
On chunked entry = 19067.03809 MB
On scale calculation = 19067.04590 MB
Before interleave = 19067.04590 MB
After interleave = 19067.28027 MB
After matmul = 19067.28125 MB
Before local copies matmul = 19067.28125 MB
After local copies = 19067.28320 MB
fter compute chunk allocated = 19067.03809 MB
Memory after cuda sdpa 19067.0458984375 MB
1
Memory before offload  19067.0244140625 MB
Memory after offload  19067.0244140625 MB
Memory before cuda sdpa 19067.0380859375 MB
On entering CUDA sdpa main function  allocated = 19067.03809 MB
Before first SDPA allocated = 19067.03809 MB
On chunked entry = 19067.03809 MB
On scale calculation = 19067.04590 MB
Before interleave = 19067.04590 MB
After interleave = 19067.54590 MB
After matmul = 19075.67285 MB
Before local copies matmul = 19075.67285 MB
After local copies = 19075.67578 MB
After first SDPA allocated = 19075.16309 MB
After first copy allocated = 19075.16309 MB
On chunked entry = 19075.16309 MB
On scale calculation = 19075.17090 MB
Before interleave = 19075.17090 MB
After interleave = 19075.40527 MB
After matmul = 19075.40625 MB
Before local copies matmul = 19075.40625 MB
After local copies = 19075.40820 MB
fter compute chunk allocated = 19075.16309 MB
Memory after cuda sdpa 19075.1708984375 MB
1
Memory before offload  19075.1494140625 MB
Memory after offload  19075.1494140625 MB
Memory before cuda sdpa 19075.1630859375 MB
On entering CUDA sdpa main function  allocated = 19075.16309 MB
Before first SDPA allocated = 19075.16309 MB
On chunked entry = 19075.16309 MB
On scale calculation = 19075.17090 MB
Before interleave = 19075.17090 MB
After interleave = 19075.67090 MB
After matmul = 19083.79785 MB
Before local copies matmul = 19083.79785 MB
After local copies = 19083.80078 MB
After first SDPA allocated = 19083.28809 MB
After first copy allocated = 19083.28809 MB
On chunked entry = 19083.28809 MB
On scale calculation = 19083.29590 MB
Before interleave = 19083.29590 MB
After interleave = 19083.53027 MB
After matmul = 19083.53125 MB
Before local copies matmul = 19083.53125 MB
After local copies = 19083.53320 MB
fter compute chunk allocated = 19083.28809 MB
Memory after cuda sdpa 19083.2958984375 MB
1
Memory before offload  19083.2744140625 MB
Memory after offload  19083.2744140625 MB
Memory before cuda sdpa 19083.2880859375 MB
On entering CUDA sdpa main function  allocated = 19083.28809 MB
Before first SDPA allocated = 19083.28809 MB
On chunked entry = 19083.28809 MB
On scale calculation = 19083.29590 MB
Before interleave = 19083.29590 MB
After interleave = 19083.79590 MB
After matmul = 19091.92285 MB
Before local copies matmul = 19091.92285 MB
After local copies = 19091.92578 MB
After first SDPA allocated = 19091.41309 MB
After first copy allocated = 19091.41309 MB
On chunked entry = 19091.41309 MB
On scale calculation = 19091.42090 MB
Before interleave = 19091.42090 MB
After interleave = 19091.65527 MB
After matmul = 19091.65625 MB
Before local copies matmul = 19091.65625 MB
After local copies = 19091.65820 MB
fter compute chunk allocated = 19091.41309 MB
Memory after cuda sdpa 19091.4208984375 MB
1
Memory before offload  19091.3994140625 MB
Memory after offload  19091.3994140625 MB
Memory before cuda sdpa 19091.4130859375 MB
On entering CUDA sdpa main function  allocated = 19091.41309 MB
Before first SDPA allocated = 19091.41309 MB
On chunked entry = 19091.41309 MB
On scale calculation = 19091.42090 MB
Before interleave = 19091.42090 MB
After interleave = 19091.92090 MB
After matmul = 19100.04785 MB
Before local copies matmul = 19100.04785 MB
After local copies = 19100.05078 MB
After first SDPA allocated = 19099.53809 MB
After first copy allocated = 19099.53809 MB
On chunked entry = 19099.53809 MB
On scale calculation = 19099.54590 MB
Before interleave = 19099.54590 MB
After interleave = 19099.78027 MB
After matmul = 19099.78125 MB
Before local copies matmul = 19099.78125 MB
After local copies = 19099.78320 MB
fter compute chunk allocated = 19099.53809 MB
Memory after cuda sdpa 19099.5458984375 MB
1
Memory before offload  19099.5244140625 MB
Memory after offload  19099.5244140625 MB
Memory before cuda sdpa 19099.5380859375 MB
On entering CUDA sdpa main function  allocated = 19099.53809 MB
Before first SDPA allocated = 19099.53809 MB
On chunked entry = 19099.53809 MB
On scale calculation = 19099.54590 MB
Before interleave = 19099.54590 MB
After interleave = 19100.04590 MB
After matmul = 19108.17285 MB
Before local copies matmul = 19108.17285 MB
After local copies = 19108.17578 MB
After first SDPA allocated = 19107.66309 MB
After first copy allocated = 19107.66309 MB
On chunked entry = 19107.66309 MB
On scale calculation = 19107.67090 MB
Before interleave = 19107.67090 MB
After interleave = 19107.90527 MB
After matmul = 19107.90625 MB
Before local copies matmul = 19107.90625 MB
After local copies = 19107.90820 MB
fter compute chunk allocated = 19107.66309 MB
Memory after cuda sdpa 19107.6708984375 MB
1
Memory before offload  19107.6494140625 MB
Memory after offload  19107.6494140625 MB
Memory before cuda sdpa 19107.6630859375 MB
On entering CUDA sdpa main function  allocated = 19107.66309 MB
Before first SDPA allocated = 19107.66309 MB
On chunked entry = 19107.66309 MB
On scale calculation = 19107.67090 MB
Before interleave = 19107.67090 MB
After interleave = 19108.17090 MB
After matmul = 19116.29785 MB
Before local copies matmul = 19116.29785 MB
After local copies = 19116.30078 MB
After first SDPA allocated = 19115.78809 MB
After first copy allocated = 19115.78809 MB
On chunked entry = 19115.78809 MB
On scale calculation = 19115.79590 MB
Before interleave = 19115.79590 MB
After interleave = 19116.03027 MB
After matmul = 19116.03125 MB
Before local copies matmul = 19116.03125 MB
After local copies = 19116.03320 MB
fter compute chunk allocated = 19115.78809 MB
Memory after cuda sdpa 19115.7958984375 MB
1
Memory before offload  19115.7744140625 MB
Memory after offload  19115.7744140625 MB
Memory before cuda sdpa 19115.7880859375 MB
On entering CUDA sdpa main function  allocated = 19115.78809 MB
Before first SDPA allocated = 19115.78809 MB
On chunked entry = 19115.78809 MB
On scale calculation = 19115.79590 MB
Before interleave = 19115.79590 MB
After interleave = 19116.29590 MB
After matmul = 19124.42285 MB
Before local copies matmul = 19124.42285 MB
After local copies = 19124.42578 MB
After first SDPA allocated = 19123.91309 MB
After first copy allocated = 19123.91309 MB
On chunked entry = 19123.91309 MB
On scale calculation = 19123.92090 MB
Before interleave = 19123.92090 MB
After interleave = 19124.15527 MB
After matmul = 19124.15625 MB
Before local copies matmul = 19124.15625 MB
After local copies = 19124.15820 MB
fter compute chunk allocated = 19123.91309 MB
Memory after cuda sdpa 19123.9208984375 MB
1
Memory before offload  19123.8994140625 MB
Memory after offload  19123.8994140625 MB
Memory before cuda sdpa 19123.9130859375 MB
On entering CUDA sdpa main function  allocated = 19123.91309 MB
Before first SDPA allocated = 19123.91309 MB
On chunked entry = 19123.91309 MB
On scale calculation = 19123.92090 MB
Before interleave = 19123.92090 MB
After interleave = 19124.42090 MB
After matmul = 19132.54785 MB
Before local copies matmul = 19132.54785 MB
After local copies = 19132.55078 MB
After first SDPA allocated = 19132.03809 MB
After first copy allocated = 19132.03809 MB
On chunked entry = 19132.03809 MB
On scale calculation = 19132.04590 MB
Before interleave = 19132.04590 MB
After interleave = 19132.28027 MB
After matmul = 19132.28125 MB
Before local copies matmul = 19132.28125 MB
After local copies = 19132.28320 MB
fter compute chunk allocated = 19132.03809 MB
Memory after cuda sdpa 19132.0458984375 MB
1
Memory before offload  19132.0244140625 MB
Memory after offload  19132.0244140625 MB
Memory before cuda sdpa 19132.0380859375 MB
On entering CUDA sdpa main function  allocated = 19132.03809 MB
Before first SDPA allocated = 19132.03809 MB
On chunked entry = 19132.03809 MB
On scale calculation = 19132.04590 MB
Before interleave = 19132.04590 MB
After interleave = 19132.54590 MB
After matmul = 19140.67285 MB
Before local copies matmul = 19140.67285 MB
After local copies = 19140.67578 MB
After first SDPA allocated = 19140.16309 MB
After first copy allocated = 19140.16309 MB
On chunked entry = 19140.16309 MB
On scale calculation = 19140.17090 MB
Before interleave = 19140.17090 MB
After interleave = 19140.40527 MB
After matmul = 19140.40625 MB
Before local copies matmul = 19140.40625 MB
After local copies = 19140.40820 MB
fter compute chunk allocated = 19140.16309 MB
Memory after cuda sdpa 19140.1708984375 MB
1
Memory before offload  19140.1494140625 MB
Memory after offload  19140.1494140625 MB
Memory before cuda sdpa 19140.1630859375 MB
On entering CUDA sdpa main function  allocated = 19140.16309 MB
Before first SDPA allocated = 19140.16309 MB
On chunked entry = 19140.16309 MB
On scale calculation = 19140.17090 MB
Before interleave = 19140.17090 MB
After interleave = 19140.67090 MB
After matmul = 19148.79785 MB
Before local copies matmul = 19148.79785 MB
After local copies = 19148.80078 MB
After first SDPA allocated = 19148.28809 MB
After first copy allocated = 19148.28809 MB
On chunked entry = 19148.28809 MB
On scale calculation = 19148.29590 MB
Before interleave = 19148.29590 MB
After interleave = 19148.53027 MB
After matmul = 19148.53125 MB
Before local copies matmul = 19148.53125 MB
After local copies = 19148.53320 MB
fter compute chunk allocated = 19148.28809 MB
Memory after cuda sdpa 19148.2958984375 MB
1
Memory before offload  19148.2744140625 MB
Memory after offload  19148.2744140625 MB
Memory before cuda sdpa 19148.2880859375 MB
On entering CUDA sdpa main function  allocated = 19148.28809 MB
Before first SDPA allocated = 19148.28809 MB
On chunked entry = 19148.28809 MB
On scale calculation = 19148.29590 MB
Before interleave = 19148.29590 MB
After interleave = 19148.79590 MB
After matmul = 19156.92285 MB
Before local copies matmul = 19156.92285 MB
After local copies = 19156.92578 MB
After first SDPA allocated = 19156.41309 MB
After first copy allocated = 19156.41309 MB
On chunked entry = 19156.41309 MB
On scale calculation = 19156.42090 MB
Before interleave = 19156.42090 MB
After interleave = 19156.65527 MB
After matmul = 19156.65625 MB
Before local copies matmul = 19156.65625 MB
After local copies = 19156.65820 MB
fter compute chunk allocated = 19156.41309 MB
Memory after cuda sdpa 19156.4208984375 MB
1
Memory before offload  19156.3994140625 MB
Memory after offload  19156.3994140625 MB
Memory before cuda sdpa 19156.4130859375 MB
On entering CUDA sdpa main function  allocated = 19156.41309 MB
Before first SDPA allocated = 19156.41309 MB
On chunked entry = 19156.41309 MB
On scale calculation = 19156.42090 MB
Before interleave = 19156.42090 MB
After interleave = 19156.92090 MB
After matmul = 19165.04785 MB
Before local copies matmul = 19165.04785 MB
After local copies = 19165.05078 MB
After first SDPA allocated = 19164.53809 MB
After first copy allocated = 19164.53809 MB
On chunked entry = 19164.53809 MB
On scale calculation = 19164.54590 MB
Before interleave = 19164.54590 MB
After interleave = 19164.78027 MB
After matmul = 19164.78125 MB
Before local copies matmul = 19164.78125 MB
After local copies = 19164.78320 MB
fter compute chunk allocated = 19164.53809 MB
Memory after cuda sdpa 19164.5458984375 MB
1
Memory before offload  19164.5244140625 MB
Memory after offload  19164.5244140625 MB
Memory before cuda sdpa 19164.5380859375 MB
On entering CUDA sdpa main function  allocated = 19164.53809 MB
Before first SDPA allocated = 19164.53809 MB
On chunked entry = 19164.53809 MB
On scale calculation = 19164.54590 MB
Before interleave = 19164.54590 MB
After interleave = 19165.04590 MB
After matmul = 19173.17285 MB
Before local copies matmul = 19173.17285 MB
After local copies = 19173.17578 MB
After first SDPA allocated = 19172.66309 MB
After first copy allocated = 19172.66309 MB
On chunked entry = 19172.66309 MB
On scale calculation = 19172.67090 MB
Before interleave = 19172.67090 MB
After interleave = 19172.90527 MB
After matmul = 19172.90625 MB
Before local copies matmul = 19172.90625 MB
After local copies = 19172.90820 MB
fter compute chunk allocated = 19172.66309 MB
Memory after cuda sdpa 19172.6708984375 MB
1
Memory before offload  19172.6494140625 MB
Memory after offload  19172.6494140625 MB
Memory before cuda sdpa 19172.6630859375 MB
On entering CUDA sdpa main function  allocated = 19172.66309 MB
Before first SDPA allocated = 19172.66309 MB
On chunked entry = 19172.66309 MB
On scale calculation = 19172.67090 MB
Before interleave = 19172.67090 MB
After interleave = 19173.17090 MB
After matmul = 19181.29785 MB
Before local copies matmul = 19181.29785 MB
After local copies = 19181.30078 MB
After first SDPA allocated = 19180.78809 MB
After first copy allocated = 19180.78809 MB
On chunked entry = 19180.78809 MB
On scale calculation = 19180.79590 MB
Before interleave = 19180.79590 MB
After interleave = 19181.03027 MB
After matmul = 19181.03125 MB
Before local copies matmul = 19181.03125 MB
After local copies = 19181.03320 MB
fter compute chunk allocated = 19180.78809 MB
Memory after cuda sdpa 19180.7958984375 MB
1
Memory before offload  19180.7744140625 MB
Memory after offload  19180.7744140625 MB
Memory before cuda sdpa 19180.7880859375 MB
On entering CUDA sdpa main function  allocated = 19180.78809 MB
Before first SDPA allocated = 19180.78809 MB
On chunked entry = 19180.78809 MB
On scale calculation = 19180.79590 MB
Before interleave = 19180.79590 MB
After interleave = 19181.29590 MB
After matmul = 19189.42285 MB
Before local copies matmul = 19189.42285 MB
After local copies = 19189.42578 MB
After first SDPA allocated = 19188.91309 MB
After first copy allocated = 19188.91309 MB
On chunked entry = 19188.91309 MB
On scale calculation = 19188.92090 MB
Before interleave = 19188.92090 MB
After interleave = 19189.15527 MB
After matmul = 19189.15625 MB
Before local copies matmul = 19189.15625 MB
After local copies = 19189.15820 MB
fter compute chunk allocated = 19188.91309 MB
Memory after cuda sdpa 19188.9208984375 MB
1
Memory before offload  19188.8994140625 MB
Memory after offload  19188.8994140625 MB
Memory before cuda sdpa 19188.9130859375 MB
On entering CUDA sdpa main function  allocated = 19188.91309 MB
Before first SDPA allocated = 19188.91309 MB
On chunked entry = 19188.91309 MB
On scale calculation = 19188.92090 MB
Before interleave = 19188.92090 MB
After interleave = 19189.42090 MB
After matmul = 19197.54785 MB
Before local copies matmul = 19197.54785 MB
After local copies = 19197.55078 MB
After first SDPA allocated = 19197.03809 MB
After first copy allocated = 19197.03809 MB
On chunked entry = 19197.03809 MB
On scale calculation = 19197.04590 MB
Before interleave = 19197.04590 MB
After interleave = 19197.28027 MB
After matmul = 19197.28125 MB
Before local copies matmul = 19197.28125 MB
After local copies = 19197.28320 MB
fter compute chunk allocated = 19197.03809 MB
Memory after cuda sdpa 19197.0458984375 MB
1
Memory before offload  19197.0244140625 MB
Memory after offload  19197.0244140625 MB
Memory before cuda sdpa 19197.0380859375 MB
On entering CUDA sdpa main function  allocated = 19197.03809 MB
Before first SDPA allocated = 19197.03809 MB
On chunked entry = 19197.03809 MB
On scale calculation = 19197.04590 MB
Before interleave = 19197.04590 MB
After interleave = 19197.54590 MB
After matmul = 19205.67285 MB
Before local copies matmul = 19205.67285 MB
After local copies = 19205.67578 MB
After first SDPA allocated = 19205.16309 MB
After first copy allocated = 19205.16309 MB
On chunked entry = 19205.16309 MB
On scale calculation = 19205.17090 MB
Before interleave = 19205.17090 MB
After interleave = 19205.40527 MB
After matmul = 19205.40625 MB
Before local copies matmul = 19205.40625 MB
After local copies = 19205.40820 MB
fter compute chunk allocated = 19205.16309 MB
Memory after cuda sdpa 19205.1708984375 MB
1
Memory before offload  19205.1494140625 MB
Memory after offload  19205.1494140625 MB
Memory before cuda sdpa 19205.1630859375 MB
On entering CUDA sdpa main function  allocated = 19205.16309 MB
Before first SDPA allocated = 19205.16309 MB
On chunked entry = 19205.16309 MB
On scale calculation = 19205.17090 MB
Before interleave = 19205.17090 MB
After interleave = 19205.67090 MB
After matmul = 19213.79785 MB
Before local copies matmul = 19213.79785 MB
After local copies = 19213.80078 MB
After first SDPA allocated = 19213.28809 MB
After first copy allocated = 19213.28809 MB
On chunked entry = 19213.28809 MB
On scale calculation = 19213.29590 MB
Before interleave = 19213.29590 MB
After interleave = 19213.53027 MB
After matmul = 19213.53125 MB
Before local copies matmul = 19213.53125 MB
After local copies = 19213.53320 MB
fter compute chunk allocated = 19213.28809 MB
Memory after cuda sdpa 19213.2958984375 MB
1
Memory before offload  19213.2744140625 MB
Memory after offload  19213.2744140625 MB
Memory before cuda sdpa 19213.2880859375 MB
On entering CUDA sdpa main function  allocated = 19213.28809 MB
Before first SDPA allocated = 19213.28809 MB
On chunked entry = 19213.28809 MB
On scale calculation = 19213.29590 MB
Before interleave = 19213.29590 MB
After interleave = 19213.79590 MB
After matmul = 19221.92285 MB
Before local copies matmul = 19221.92285 MB
After local copies = 19221.92578 MB
After first SDPA allocated = 19221.41309 MB
After first copy allocated = 19221.41309 MB
On chunked entry = 19221.41309 MB
On scale calculation = 19221.42090 MB
Before interleave = 19221.42090 MB
After interleave = 19221.65527 MB
After matmul = 19221.65625 MB
Before local copies matmul = 19221.65625 MB
After local copies = 19221.65820 MB
fter compute chunk allocated = 19221.41309 MB
Memory after cuda sdpa 19221.4208984375 MB
1
Memory before offload  19221.3994140625 MB
Memory after offload  19221.3994140625 MB
Memory before cuda sdpa 19221.4130859375 MB
On entering CUDA sdpa main function  allocated = 19221.41309 MB
Before first SDPA allocated = 19221.41309 MB
On chunked entry = 19221.41309 MB
On scale calculation = 19221.42090 MB
Before interleave = 19221.42090 MB
After interleave = 19221.92090 MB
After matmul = 19230.04785 MB
Before local copies matmul = 19230.04785 MB
After local copies = 19230.05078 MB
After first SDPA allocated = 19229.53809 MB
After first copy allocated = 19229.53809 MB
On chunked entry = 19229.53809 MB
On scale calculation = 19229.54590 MB
Before interleave = 19229.54590 MB
After interleave = 19229.78027 MB
After matmul = 19229.78125 MB
Before local copies matmul = 19229.78125 MB
After local copies = 19229.78320 MB
fter compute chunk allocated = 19229.53809 MB
Memory after cuda sdpa 19229.5458984375 MB
1
Memory before offload  19229.5244140625 MB
Memory after offload  19229.5244140625 MB
Memory before cuda sdpa 19229.5380859375 MB
On entering CUDA sdpa main function  allocated = 19229.53809 MB
Before first SDPA allocated = 19229.53809 MB
On chunked entry = 19229.53809 MB
On scale calculation = 19229.54590 MB
Before interleave = 19229.54590 MB
After interleave = 19230.04590 MB
After matmul = 19238.17285 MB
Before local copies matmul = 19238.17285 MB
After local copies = 19238.17578 MB
After first SDPA allocated = 19237.66309 MB
After first copy allocated = 19237.66309 MB
On chunked entry = 19237.66309 MB
On scale calculation = 19237.67090 MB
Before interleave = 19237.67090 MB
After interleave = 19237.90527 MB
After matmul = 19237.90625 MB
Before local copies matmul = 19237.90625 MB
After local copies = 19237.90820 MB
fter compute chunk allocated = 19237.66309 MB
Memory after cuda sdpa 19237.6708984375 MB
1
Memory before offload  19237.6494140625 MB
Memory after offload  19237.6494140625 MB
Memory before cuda sdpa 19237.6630859375 MB
On entering CUDA sdpa main function  allocated = 19237.66309 MB
Before first SDPA allocated = 19237.66309 MB
On chunked entry = 19237.66309 MB
On scale calculation = 19237.67090 MB
Before interleave = 19237.67090 MB
After interleave = 19238.17090 MB
After matmul = 19246.29785 MB
Before local copies matmul = 19246.29785 MB
After local copies = 19246.30078 MB
After first SDPA allocated = 19245.78809 MB
After first copy allocated = 19245.78809 MB
On chunked entry = 19245.78809 MB
On scale calculation = 19245.79590 MB
Before interleave = 19245.79590 MB
After interleave = 19246.03027 MB
After matmul = 19246.03125 MB
Before local copies matmul = 19246.03125 MB
After local copies = 19246.03320 MB
fter compute chunk allocated = 19245.78809 MB
Memory after cuda sdpa 19245.7958984375 MB
Decode step 16
1
Memory before offload  19245.77490234375 MB
Memory after offload  19245.77490234375 MB
Memory before cuda sdpa 19245.78857421875 MB
On entering CUDA sdpa main function  allocated = 19245.78857 MB
Before first SDPA allocated = 19245.78857 MB
On chunked entry = 19245.78857 MB
On scale calculation = 19245.79639 MB
Before interleave = 19245.79639 MB
After interleave = 19246.29639 MB
After matmul = 19254.42334 MB
Before local copies matmul = 19254.42334 MB
After local copies = 19254.42627 MB
After first SDPA allocated = 19253.91357 MB
After first copy allocated = 19253.91357 MB
On chunked entry = 19253.91357 MB
On scale calculation = 19253.92139 MB
Before interleave = 19253.92139 MB
After interleave = 19254.17139 MB
After matmul = 19254.17236 MB
Before local copies matmul = 19254.17236 MB
After local copies = 19254.17432 MB
fter compute chunk allocated = 19253.91357 MB
Memory after cuda sdpa 19253.92138671875 MB
1
Memory before offload  19253.89990234375 MB
Memory after offload  19253.89990234375 MB
Memory before cuda sdpa 19253.91357421875 MB
On entering CUDA sdpa main function  allocated = 19253.91357 MB
Before first SDPA allocated = 19253.91357 MB
On chunked entry = 19253.91357 MB
On scale calculation = 19253.92139 MB
Before interleave = 19253.92139 MB
After interleave = 19254.42139 MB
After matmul = 19262.54834 MB
Before local copies matmul = 19262.54834 MB
After local copies = 19262.55127 MB
After first SDPA allocated = 19262.03857 MB
After first copy allocated = 19262.03857 MB
On chunked entry = 19262.03857 MB
On scale calculation = 19262.04639 MB
Before interleave = 19262.04639 MB
After interleave = 19262.29639 MB
After matmul = 19262.29736 MB
Before local copies matmul = 19262.29736 MB
After local copies = 19262.29932 MB
fter compute chunk allocated = 19262.03857 MB
Memory after cuda sdpa 19262.04638671875 MB
1
Memory before offload  19262.02490234375 MB
Memory after offload  19262.02490234375 MB
Memory before cuda sdpa 19262.03857421875 MB
On entering CUDA sdpa main function  allocated = 19262.03857 MB
Before first SDPA allocated = 19262.03857 MB
On chunked entry = 19262.03857 MB
On scale calculation = 19262.04639 MB
Before interleave = 19262.04639 MB
After interleave = 19262.54639 MB
After matmul = 19270.67334 MB
Before local copies matmul = 19270.67334 MB
After local copies = 19270.67627 MB
After first SDPA allocated = 19270.16357 MB
After first copy allocated = 19270.16357 MB
On chunked entry = 19270.16357 MB
On scale calculation = 19270.17139 MB
Before interleave = 19270.17139 MB
After interleave = 19270.42139 MB
After matmul = 19270.42236 MB
Before local copies matmul = 19270.42236 MB
After local copies = 19270.42432 MB
fter compute chunk allocated = 19270.16357 MB
Memory after cuda sdpa 19270.17138671875 MB
1
Memory before offload  19270.14990234375 MB
Memory after offload  19270.14990234375 MB
Memory before cuda sdpa 19270.16357421875 MB
On entering CUDA sdpa main function  allocated = 19270.16357 MB
Before first SDPA allocated = 19270.16357 MB
On chunked entry = 19270.16357 MB
On scale calculation = 19270.17139 MB
Before interleave = 19270.17139 MB
After interleave = 19270.67139 MB
After matmul = 19278.79834 MB
Before local copies matmul = 19278.79834 MB
After local copies = 19278.80127 MB
After first SDPA allocated = 19278.28857 MB
After first copy allocated = 19278.28857 MB
On chunked entry = 19278.28857 MB
On scale calculation = 19278.29639 MB
Before interleave = 19278.29639 MB
After interleave = 19278.54639 MB
After matmul = 19278.54736 MB
Before local copies matmul = 19278.54736 MB
After local copies = 19278.54932 MB
fter compute chunk allocated = 19278.28857 MB
Memory after cuda sdpa 19278.29638671875 MB
1
Memory before offload  19278.27490234375 MB
Memory after offload  19278.27490234375 MB
Memory before cuda sdpa 19278.28857421875 MB
On entering CUDA sdpa main function  allocated = 19278.28857 MB
Before first SDPA allocated = 19278.28857 MB
On chunked entry = 19278.28857 MB
On scale calculation = 19278.29639 MB
Before interleave = 19278.29639 MB
After interleave = 19278.79639 MB
After matmul = 19286.92334 MB
Before local copies matmul = 19286.92334 MB
After local copies = 19286.92627 MB
After first SDPA allocated = 19286.41357 MB
After first copy allocated = 19286.41357 MB
On chunked entry = 19286.41357 MB
On scale calculation = 19286.42139 MB
Before interleave = 19286.42139 MB
After interleave = 19286.67139 MB
After matmul = 19286.67236 MB
Before local copies matmul = 19286.67236 MB
After local copies = 19286.67432 MB
fter compute chunk allocated = 19286.41357 MB
Memory after cuda sdpa 19286.42138671875 MB
1
Memory before offload  19286.39990234375 MB
Memory after offload  19286.39990234375 MB
Memory before cuda sdpa 19286.41357421875 MB
On entering CUDA sdpa main function  allocated = 19286.41357 MB
Before first SDPA allocated = 19286.41357 MB
On chunked entry = 19286.41357 MB
On scale calculation = 19286.42139 MB
Before interleave = 19286.42139 MB
After interleave = 19286.92139 MB
After matmul = 19295.04834 MB
Before local copies matmul = 19295.04834 MB
After local copies = 19295.05127 MB
After first SDPA allocated = 19294.53857 MB
After first copy allocated = 19294.53857 MB
On chunked entry = 19294.53857 MB
On scale calculation = 19294.54639 MB
Before interleave = 19294.54639 MB
After interleave = 19294.79639 MB
After matmul = 19294.79736 MB
Before local copies matmul = 19294.79736 MB
After local copies = 19294.79932 MB
fter compute chunk allocated = 19294.53857 MB
Memory after cuda sdpa 19294.54638671875 MB
1
Memory before offload  19294.52490234375 MB
Memory after offload  19294.52490234375 MB
Memory before cuda sdpa 19294.53857421875 MB
On entering CUDA sdpa main function  allocated = 19294.53857 MB
Before first SDPA allocated = 19294.53857 MB
On chunked entry = 19294.53857 MB
On scale calculation = 19294.54639 MB
Before interleave = 19294.54639 MB
After interleave = 19295.04639 MB
After matmul = 19303.17334 MB
Before local copies matmul = 19303.17334 MB
After local copies = 19303.17627 MB
After first SDPA allocated = 19302.66357 MB
After first copy allocated = 19302.66357 MB
On chunked entry = 19302.66357 MB
On scale calculation = 19302.67139 MB
Before interleave = 19302.67139 MB
After interleave = 19302.92139 MB
After matmul = 19302.92236 MB
Before local copies matmul = 19302.92236 MB
After local copies = 19302.92432 MB
fter compute chunk allocated = 19302.66357 MB
Memory after cuda sdpa 19302.67138671875 MB
1
Memory before offload  19302.64990234375 MB
Memory after offload  19302.64990234375 MB
Memory before cuda sdpa 19302.66357421875 MB
On entering CUDA sdpa main function  allocated = 19302.66357 MB
Before first SDPA allocated = 19302.66357 MB
On chunked entry = 19302.66357 MB
On scale calculation = 19302.67139 MB
Before interleave = 19302.67139 MB
After interleave = 19303.17139 MB
After matmul = 19311.29834 MB
Before local copies matmul = 19311.29834 MB
After local copies = 19311.30127 MB
After first SDPA allocated = 19310.78857 MB
After first copy allocated = 19310.78857 MB
On chunked entry = 19310.78857 MB
On scale calculation = 19310.79639 MB
Before interleave = 19310.79639 MB
After interleave = 19311.04639 MB
After matmul = 19311.04736 MB
Before local copies matmul = 19311.04736 MB
After local copies = 19311.04932 MB
fter compute chunk allocated = 19310.78857 MB
Memory after cuda sdpa 19310.79638671875 MB
1
Memory before offload  19310.77490234375 MB
Memory after offload  19310.77490234375 MB
Memory before cuda sdpa 19310.78857421875 MB
On entering CUDA sdpa main function  allocated = 19310.78857 MB
Before first SDPA allocated = 19310.78857 MB
On chunked entry = 19310.78857 MB
On scale calculation = 19310.79639 MB
Before interleave = 19310.79639 MB
After interleave = 19311.29639 MB
After matmul = 19319.42334 MB
Before local copies matmul = 19319.42334 MB
After local copies = 19319.42627 MB
After first SDPA allocated = 19318.91357 MB
After first copy allocated = 19318.91357 MB
On chunked entry = 19318.91357 MB
On scale calculation = 19318.92139 MB
Before interleave = 19318.92139 MB
After interleave = 19319.17139 MB
After matmul = 19319.17236 MB
Before local copies matmul = 19319.17236 MB
After local copies = 19319.17432 MB
fter compute chunk allocated = 19318.91357 MB
Memory after cuda sdpa 19318.92138671875 MB
1
Memory before offload  19318.89990234375 MB
Memory after offload  19318.89990234375 MB
Memory before cuda sdpa 19318.91357421875 MB
On entering CUDA sdpa main function  allocated = 19318.91357 MB
Before first SDPA allocated = 19318.91357 MB
On chunked entry = 19318.91357 MB
On scale calculation = 19318.92139 MB
Before interleave = 19318.92139 MB
After interleave = 19319.42139 MB
After matmul = 19327.54834 MB
Before local copies matmul = 19327.54834 MB
After local copies = 19327.55127 MB
After first SDPA allocated = 19327.03857 MB
After first copy allocated = 19327.03857 MB
On chunked entry = 19327.03857 MB
On scale calculation = 19327.04639 MB
Before interleave = 19327.04639 MB
After interleave = 19327.29639 MB
After matmul = 19327.29736 MB
Before local copies matmul = 19327.29736 MB
After local copies = 19327.29932 MB
fter compute chunk allocated = 19327.03857 MB
Memory after cuda sdpa 19327.04638671875 MB
1
Memory before offload  19327.02490234375 MB
Memory after offload  19327.02490234375 MB
Memory before cuda sdpa 19327.03857421875 MB
On entering CUDA sdpa main function  allocated = 19327.03857 MB
Before first SDPA allocated = 19327.03857 MB
On chunked entry = 19327.03857 MB
On scale calculation = 19327.04639 MB
Before interleave = 19327.04639 MB
After interleave = 19327.54639 MB
After matmul = 19335.67334 MB
Before local copies matmul = 19335.67334 MB
After local copies = 19335.67627 MB
After first SDPA allocated = 19335.16357 MB
After first copy allocated = 19335.16357 MB
On chunked entry = 19335.16357 MB
On scale calculation = 19335.17139 MB
Before interleave = 19335.17139 MB
After interleave = 19335.42139 MB
After matmul = 19335.42236 MB
Before local copies matmul = 19335.42236 MB
After local copies = 19335.42432 MB
fter compute chunk allocated = 19335.16357 MB
Memory after cuda sdpa 19335.17138671875 MB
1
Memory before offload  19335.14990234375 MB
Memory after offload  19335.14990234375 MB
Memory before cuda sdpa 19335.16357421875 MB
On entering CUDA sdpa main function  allocated = 19335.16357 MB
Before first SDPA allocated = 19335.16357 MB
On chunked entry = 19335.16357 MB
On scale calculation = 19335.17139 MB
Before interleave = 19335.17139 MB
After interleave = 19335.67139 MB
After matmul = 19343.79834 MB
Before local copies matmul = 19343.79834 MB
After local copies = 19343.80127 MB
After first SDPA allocated = 19343.28857 MB
After first copy allocated = 19343.28857 MB
On chunked entry = 19343.28857 MB
On scale calculation = 19343.29639 MB
Before interleave = 19343.29639 MB
After interleave = 19343.54639 MB
After matmul = 19343.54736 MB
Before local copies matmul = 19343.54736 MB
After local copies = 19343.54932 MB
fter compute chunk allocated = 19343.28857 MB
Memory after cuda sdpa 19343.29638671875 MB
1
Memory before offload  19343.27490234375 MB
Memory after offload  19343.27490234375 MB
Memory before cuda sdpa 19343.28857421875 MB
On entering CUDA sdpa main function  allocated = 19343.28857 MB
Before first SDPA allocated = 19343.28857 MB
On chunked entry = 19343.28857 MB
On scale calculation = 19343.29639 MB
Before interleave = 19343.29639 MB
After interleave = 19343.79639 MB
After matmul = 19351.92334 MB
Before local copies matmul = 19351.92334 MB
After local copies = 19351.92627 MB
After first SDPA allocated = 19351.41357 MB
After first copy allocated = 19351.41357 MB
On chunked entry = 19351.41357 MB
On scale calculation = 19351.42139 MB
Before interleave = 19351.42139 MB
After interleave = 19351.67139 MB
After matmul = 19351.67236 MB
Before local copies matmul = 19351.67236 MB
After local copies = 19351.67432 MB
fter compute chunk allocated = 19351.41357 MB
Memory after cuda sdpa 19351.42138671875 MB
1
Memory before offload  19351.39990234375 MB
Memory after offload  19351.39990234375 MB
Memory before cuda sdpa 19351.41357421875 MB
On entering CUDA sdpa main function  allocated = 19351.41357 MB
Before first SDPA allocated = 19351.41357 MB
On chunked entry = 19351.41357 MB
On scale calculation = 19351.42139 MB
Before interleave = 19351.42139 MB
After interleave = 19351.92139 MB
After matmul = 19360.04834 MB
Before local copies matmul = 19360.04834 MB
After local copies = 19360.05127 MB
After first SDPA allocated = 19359.53857 MB
After first copy allocated = 19359.53857 MB
On chunked entry = 19359.53857 MB
On scale calculation = 19359.54639 MB
Before interleave = 19359.54639 MB
After interleave = 19359.79639 MB
After matmul = 19359.79736 MB
Before local copies matmul = 19359.79736 MB
After local copies = 19359.79932 MB
fter compute chunk allocated = 19359.53857 MB
Memory after cuda sdpa 19359.54638671875 MB
1
Memory before offload  19359.52490234375 MB
Memory after offload  19359.52490234375 MB
Memory before cuda sdpa 19359.53857421875 MB
On entering CUDA sdpa main function  allocated = 19359.53857 MB
Before first SDPA allocated = 19359.53857 MB
On chunked entry = 19359.53857 MB
On scale calculation = 19359.54639 MB
Before interleave = 19359.54639 MB
After interleave = 19360.04639 MB
After matmul = 19368.17334 MB
Before local copies matmul = 19368.17334 MB
After local copies = 19368.17627 MB
After first SDPA allocated = 19367.66357 MB
After first copy allocated = 19367.66357 MB
On chunked entry = 19367.66357 MB
On scale calculation = 19367.67139 MB
Before interleave = 19367.67139 MB
After interleave = 19367.92139 MB
After matmul = 19367.92236 MB
Before local copies matmul = 19367.92236 MB
After local copies = 19367.92432 MB
fter compute chunk allocated = 19367.66357 MB
Memory after cuda sdpa 19367.67138671875 MB
1
Memory before offload  19367.64990234375 MB
Memory after offload  19367.64990234375 MB
Memory before cuda sdpa 19367.66357421875 MB
On entering CUDA sdpa main function  allocated = 19367.66357 MB
Before first SDPA allocated = 19367.66357 MB
On chunked entry = 19367.66357 MB
On scale calculation = 19367.67139 MB
Before interleave = 19367.67139 MB
After interleave = 19368.17139 MB
After matmul = 19376.29834 MB
Before local copies matmul = 19376.29834 MB
After local copies = 19376.30127 MB
After first SDPA allocated = 19375.78857 MB
After first copy allocated = 19375.78857 MB
On chunked entry = 19375.78857 MB
On scale calculation = 19375.79639 MB
Before interleave = 19375.79639 MB
After interleave = 19376.04639 MB
After matmul = 19376.04736 MB
Before local copies matmul = 19376.04736 MB
After local copies = 19376.04932 MB
fter compute chunk allocated = 19375.78857 MB
Memory after cuda sdpa 19375.79638671875 MB
1
Memory before offload  19375.77490234375 MB
Memory after offload  19375.77490234375 MB
Memory before cuda sdpa 19375.78857421875 MB
On entering CUDA sdpa main function  allocated = 19375.78857 MB
Before first SDPA allocated = 19375.78857 MB
On chunked entry = 19375.78857 MB
On scale calculation = 19375.79639 MB
Before interleave = 19375.79639 MB
After interleave = 19376.29639 MB
After matmul = 19384.42334 MB
Before local copies matmul = 19384.42334 MB
After local copies = 19384.42627 MB
After first SDPA allocated = 19383.91357 MB
After first copy allocated = 19383.91357 MB
On chunked entry = 19383.91357 MB
On scale calculation = 19383.92139 MB
Before interleave = 19383.92139 MB
After interleave = 19384.17139 MB
After matmul = 19384.17236 MB
Before local copies matmul = 19384.17236 MB
After local copies = 19384.17432 MB
fter compute chunk allocated = 19383.91357 MB
Memory after cuda sdpa 19383.92138671875 MB
1
Memory before offload  19383.89990234375 MB
Memory after offload  19383.89990234375 MB
Memory before cuda sdpa 19383.91357421875 MB
On entering CUDA sdpa main function  allocated = 19383.91357 MB
Before first SDPA allocated = 19383.91357 MB
On chunked entry = 19383.91357 MB
On scale calculation = 19383.92139 MB
Before interleave = 19383.92139 MB
After interleave = 19384.42139 MB
After matmul = 19392.54834 MB
Before local copies matmul = 19392.54834 MB
After local copies = 19392.55127 MB
After first SDPA allocated = 19392.03857 MB
After first copy allocated = 19392.03857 MB
On chunked entry = 19392.03857 MB
On scale calculation = 19392.04639 MB
Before interleave = 19392.04639 MB
After interleave = 19392.29639 MB
After matmul = 19392.29736 MB
Before local copies matmul = 19392.29736 MB
After local copies = 19392.29932 MB
fter compute chunk allocated = 19392.03857 MB
Memory after cuda sdpa 19392.04638671875 MB
1
Memory before offload  19392.02490234375 MB
Memory after offload  19392.02490234375 MB
Memory before cuda sdpa 19392.03857421875 MB
On entering CUDA sdpa main function  allocated = 19392.03857 MB
Before first SDPA allocated = 19392.03857 MB
On chunked entry = 19392.03857 MB
On scale calculation = 19392.04639 MB
Before interleave = 19392.04639 MB
After interleave = 19392.54639 MB
After matmul = 19400.67334 MB
Before local copies matmul = 19400.67334 MB
After local copies = 19400.67627 MB
After first SDPA allocated = 19400.16357 MB
After first copy allocated = 19400.16357 MB
On chunked entry = 19400.16357 MB
On scale calculation = 19400.17139 MB
Before interleave = 19400.17139 MB
After interleave = 19400.42139 MB
After matmul = 19400.42236 MB
Before local copies matmul = 19400.42236 MB
After local copies = 19400.42432 MB
fter compute chunk allocated = 19400.16357 MB
Memory after cuda sdpa 19400.17138671875 MB
1
Memory before offload  19400.14990234375 MB
Memory after offload  19400.14990234375 MB
Memory before cuda sdpa 19400.16357421875 MB
On entering CUDA sdpa main function  allocated = 19400.16357 MB
Before first SDPA allocated = 19400.16357 MB
On chunked entry = 19400.16357 MB
On scale calculation = 19400.17139 MB
Before interleave = 19400.17139 MB
After interleave = 19400.67139 MB
After matmul = 19408.79834 MB
Before local copies matmul = 19408.79834 MB
After local copies = 19408.80127 MB
After first SDPA allocated = 19408.28857 MB
After first copy allocated = 19408.28857 MB
On chunked entry = 19408.28857 MB
On scale calculation = 19408.29639 MB
Before interleave = 19408.29639 MB
After interleave = 19408.54639 MB
After matmul = 19408.54736 MB
Before local copies matmul = 19408.54736 MB
After local copies = 19408.54932 MB
fter compute chunk allocated = 19408.28857 MB
Memory after cuda sdpa 19408.29638671875 MB
1
Memory before offload  19408.27490234375 MB
Memory after offload  19408.27490234375 MB
Memory before cuda sdpa 19408.28857421875 MB
On entering CUDA sdpa main function  allocated = 19408.28857 MB
Before first SDPA allocated = 19408.28857 MB
On chunked entry = 19408.28857 MB
On scale calculation = 19408.29639 MB
Before interleave = 19408.29639 MB
After interleave = 19408.79639 MB
After matmul = 19416.92334 MB
Before local copies matmul = 19416.92334 MB
After local copies = 19416.92627 MB
After first SDPA allocated = 19416.41357 MB
After first copy allocated = 19416.41357 MB
On chunked entry = 19416.41357 MB
On scale calculation = 19416.42139 MB
Before interleave = 19416.42139 MB
After interleave = 19416.67139 MB
After matmul = 19416.67236 MB
Before local copies matmul = 19416.67236 MB
After local copies = 19416.67432 MB
fter compute chunk allocated = 19416.41357 MB
Memory after cuda sdpa 19416.42138671875 MB
1
Memory before offload  19416.39990234375 MB
Memory after offload  19416.39990234375 MB
Memory before cuda sdpa 19416.41357421875 MB
On entering CUDA sdpa main function  allocated = 19416.41357 MB
Before first SDPA allocated = 19416.41357 MB
On chunked entry = 19416.41357 MB
On scale calculation = 19416.42139 MB
Before interleave = 19416.42139 MB
After interleave = 19416.92139 MB
After matmul = 19425.04834 MB
Before local copies matmul = 19425.04834 MB
After local copies = 19425.05127 MB
After first SDPA allocated = 19424.53857 MB
After first copy allocated = 19424.53857 MB
On chunked entry = 19424.53857 MB
On scale calculation = 19424.54639 MB
Before interleave = 19424.54639 MB
After interleave = 19424.79639 MB
After matmul = 19424.79736 MB
Before local copies matmul = 19424.79736 MB
After local copies = 19424.79932 MB
fter compute chunk allocated = 19424.53857 MB
Memory after cuda sdpa 19424.54638671875 MB
1
Memory before offload  19424.52490234375 MB
Memory after offload  19424.52490234375 MB
Memory before cuda sdpa 19424.53857421875 MB
On entering CUDA sdpa main function  allocated = 19424.53857 MB
Before first SDPA allocated = 19424.53857 MB
On chunked entry = 19424.53857 MB
On scale calculation = 19424.54639 MB
Before interleave = 19424.54639 MB
After interleave = 19425.04639 MB
After matmul = 19433.17334 MB
Before local copies matmul = 19433.17334 MB
After local copies = 19433.17627 MB
After first SDPA allocated = 19432.66357 MB
After first copy allocated = 19432.66357 MB
On chunked entry = 19432.66357 MB
On scale calculation = 19432.67139 MB
Before interleave = 19432.67139 MB
After interleave = 19432.92139 MB
After matmul = 19432.92236 MB
Before local copies matmul = 19432.92236 MB
After local copies = 19432.92432 MB
fter compute chunk allocated = 19432.66357 MB
Memory after cuda sdpa 19432.67138671875 MB
1
Memory before offload  19432.64990234375 MB
Memory after offload  19432.64990234375 MB
Memory before cuda sdpa 19432.66357421875 MB
On entering CUDA sdpa main function  allocated = 19432.66357 MB
Before first SDPA allocated = 19432.66357 MB
On chunked entry = 19432.66357 MB
On scale calculation = 19432.67139 MB
Before interleave = 19432.67139 MB
After interleave = 19433.17139 MB
After matmul = 19441.29834 MB
Before local copies matmul = 19441.29834 MB
After local copies = 19441.30127 MB
After first SDPA allocated = 19440.78857 MB
After first copy allocated = 19440.78857 MB
On chunked entry = 19440.78857 MB
On scale calculation = 19440.79639 MB
Before interleave = 19440.79639 MB
After interleave = 19441.04639 MB
After matmul = 19441.04736 MB
Before local copies matmul = 19441.04736 MB
After local copies = 19441.04932 MB
fter compute chunk allocated = 19440.78857 MB
Memory after cuda sdpa 19440.79638671875 MB
1
Memory before offload  19440.77490234375 MB
Memory after offload  19440.77490234375 MB
Memory before cuda sdpa 19440.78857421875 MB
On entering CUDA sdpa main function  allocated = 19440.78857 MB
Before first SDPA allocated = 19440.78857 MB
On chunked entry = 19440.78857 MB
On scale calculation = 19440.79639 MB
Before interleave = 19440.79639 MB
After interleave = 19441.29639 MB
After matmul = 19449.42334 MB
Before local copies matmul = 19449.42334 MB
After local copies = 19449.42627 MB
After first SDPA allocated = 19448.91357 MB
After first copy allocated = 19448.91357 MB
On chunked entry = 19448.91357 MB
On scale calculation = 19448.92139 MB
Before interleave = 19448.92139 MB
After interleave = 19449.17139 MB
After matmul = 19449.17236 MB
Before local copies matmul = 19449.17236 MB
After local copies = 19449.17432 MB
fter compute chunk allocated = 19448.91357 MB
Memory after cuda sdpa 19448.92138671875 MB
1
Memory before offload  19448.89990234375 MB
Memory after offload  19448.89990234375 MB
Memory before cuda sdpa 19448.91357421875 MB
On entering CUDA sdpa main function  allocated = 19448.91357 MB
Before first SDPA allocated = 19448.91357 MB
On chunked entry = 19448.91357 MB
On scale calculation = 19448.92139 MB
Before interleave = 19448.92139 MB
After interleave = 19449.42139 MB
After matmul = 19457.54834 MB
Before local copies matmul = 19457.54834 MB
After local copies = 19457.55127 MB
After first SDPA allocated = 19457.03857 MB
After first copy allocated = 19457.03857 MB
On chunked entry = 19457.03857 MB
On scale calculation = 19457.04639 MB
Before interleave = 19457.04639 MB
After interleave = 19457.29639 MB
After matmul = 19457.29736 MB
Before local copies matmul = 19457.29736 MB
After local copies = 19457.29932 MB
fter compute chunk allocated = 19457.03857 MB
Memory after cuda sdpa 19457.04638671875 MB
1
Memory before offload  19457.02490234375 MB
Memory after offload  19457.02490234375 MB
Memory before cuda sdpa 19457.03857421875 MB
On entering CUDA sdpa main function  allocated = 19457.03857 MB
Before first SDPA allocated = 19457.03857 MB
On chunked entry = 19457.03857 MB
On scale calculation = 19457.04639 MB
Before interleave = 19457.04639 MB
After interleave = 19457.54639 MB
After matmul = 19465.67334 MB
Before local copies matmul = 19465.67334 MB
After local copies = 19465.67627 MB
After first SDPA allocated = 19465.16357 MB
After first copy allocated = 19465.16357 MB
On chunked entry = 19465.16357 MB
On scale calculation = 19465.17139 MB
Before interleave = 19465.17139 MB
After interleave = 19465.42139 MB
After matmul = 19465.42236 MB
Before local copies matmul = 19465.42236 MB
After local copies = 19465.42432 MB
fter compute chunk allocated = 19465.16357 MB
Memory after cuda sdpa 19465.17138671875 MB
1
Memory before offload  19465.14990234375 MB
Memory after offload  19465.14990234375 MB
Memory before cuda sdpa 19465.16357421875 MB
On entering CUDA sdpa main function  allocated = 19465.16357 MB
Before first SDPA allocated = 19465.16357 MB
On chunked entry = 19465.16357 MB
On scale calculation = 19465.17139 MB
Before interleave = 19465.17139 MB
After interleave = 19465.67139 MB
After matmul = 19473.79834 MB
Before local copies matmul = 19473.79834 MB
After local copies = 19473.80127 MB
After first SDPA allocated = 19473.28857 MB
After first copy allocated = 19473.28857 MB
On chunked entry = 19473.28857 MB
On scale calculation = 19473.29639 MB
Before interleave = 19473.29639 MB
After interleave = 19473.54639 MB
After matmul = 19473.54736 MB
Before local copies matmul = 19473.54736 MB
After local copies = 19473.54932 MB
fter compute chunk allocated = 19473.28857 MB
Memory after cuda sdpa 19473.29638671875 MB
1
Memory before offload  19473.27490234375 MB
Memory after offload  19473.27490234375 MB
Memory before cuda sdpa 19473.28857421875 MB
On entering CUDA sdpa main function  allocated = 19473.28857 MB
Before first SDPA allocated = 19473.28857 MB
On chunked entry = 19473.28857 MB
On scale calculation = 19473.29639 MB
Before interleave = 19473.29639 MB
After interleave = 19473.79639 MB
After matmul = 19481.92334 MB
Before local copies matmul = 19481.92334 MB
After local copies = 19481.92627 MB
After first SDPA allocated = 19481.41357 MB
After first copy allocated = 19481.41357 MB
On chunked entry = 19481.41357 MB
On scale calculation = 19481.42139 MB
Before interleave = 19481.42139 MB
After interleave = 19481.67139 MB
After matmul = 19481.67236 MB
Before local copies matmul = 19481.67236 MB
After local copies = 19481.67432 MB
fter compute chunk allocated = 19481.41357 MB
Memory after cuda sdpa 19481.42138671875 MB
1
Memory before offload  19481.39990234375 MB
Memory after offload  19481.39990234375 MB
Memory before cuda sdpa 19481.41357421875 MB
On entering CUDA sdpa main function  allocated = 19481.41357 MB
Before first SDPA allocated = 19481.41357 MB
On chunked entry = 19481.41357 MB
On scale calculation = 19481.42139 MB
Before interleave = 19481.42139 MB
After interleave = 19481.92139 MB
After matmul = 19490.04834 MB
Before local copies matmul = 19490.04834 MB
After local copies = 19490.05127 MB
After first SDPA allocated = 19489.53857 MB
After first copy allocated = 19489.53857 MB
On chunked entry = 19489.53857 MB
On scale calculation = 19489.54639 MB
Before interleave = 19489.54639 MB
After interleave = 19489.79639 MB
After matmul = 19489.79736 MB
Before local copies matmul = 19489.79736 MB
After local copies = 19489.79932 MB
fter compute chunk allocated = 19489.53857 MB
Memory after cuda sdpa 19489.54638671875 MB
1
Memory before offload  19489.52490234375 MB
Memory after offload  19489.52490234375 MB
Memory before cuda sdpa 19489.53857421875 MB
On entering CUDA sdpa main function  allocated = 19489.53857 MB
Before first SDPA allocated = 19489.53857 MB
On chunked entry = 19489.53857 MB
On scale calculation = 19489.54639 MB
Before interleave = 19489.54639 MB
After interleave = 19490.04639 MB
After matmul = 19498.17334 MB
Before local copies matmul = 19498.17334 MB
After local copies = 19498.17627 MB
After first SDPA allocated = 19497.66357 MB
After first copy allocated = 19497.66357 MB
On chunked entry = 19497.66357 MB
On scale calculation = 19497.67139 MB
Before interleave = 19497.67139 MB
After interleave = 19497.92139 MB
After matmul = 19497.92236 MB
Before local copies matmul = 19497.92236 MB
After local copies = 19497.92432 MB
fter compute chunk allocated = 19497.66357 MB
Memory after cuda sdpa 19497.67138671875 MB
1
Memory before offload  19497.64990234375 MB
Memory after offload  19497.64990234375 MB
Memory before cuda sdpa 19497.66357421875 MB
On entering CUDA sdpa main function  allocated = 19497.66357 MB
Before first SDPA allocated = 19497.66357 MB
On chunked entry = 19497.66357 MB
On scale calculation = 19497.67139 MB
Before interleave = 19497.67139 MB
After interleave = 19498.17139 MB
After matmul = 19506.29834 MB
Before local copies matmul = 19506.29834 MB
After local copies = 19506.30127 MB
After first SDPA allocated = 19505.78857 MB
After first copy allocated = 19505.78857 MB
On chunked entry = 19505.78857 MB
On scale calculation = 19505.79639 MB
Before interleave = 19505.79639 MB
After interleave = 19506.04639 MB
After matmul = 19506.04736 MB
Before local copies matmul = 19506.04736 MB
After local copies = 19506.04932 MB
fter compute chunk allocated = 19505.78857 MB
Memory after cuda sdpa 19505.79638671875 MB
Decode step 17
1
Memory before offload  19505.775390625 MB
Memory after offload  19505.775390625 MB
Memory before cuda sdpa 19505.7890625 MB
On entering CUDA sdpa main function  allocated = 19505.78906 MB
Before first SDPA allocated = 19505.78906 MB
On chunked entry = 19505.78906 MB
On scale calculation = 19505.79688 MB
Before interleave = 19505.79688 MB
After interleave = 19506.29688 MB
After matmul = 19514.42383 MB
Before local copies matmul = 19514.42383 MB
After local copies = 19514.42676 MB
After first SDPA allocated = 19513.91406 MB
After first copy allocated = 19513.91406 MB
On chunked entry = 19513.91406 MB
On scale calculation = 19513.92188 MB
Before interleave = 19513.92188 MB
After interleave = 19514.18750 MB
After matmul = 19514.18896 MB
Before local copies matmul = 19514.18896 MB
After local copies = 19514.19141 MB
fter compute chunk allocated = 19513.91406 MB
Memory after cuda sdpa 19513.921875 MB
1
Memory before offload  19513.900390625 MB
Memory after offload  19513.900390625 MB
Memory before cuda sdpa 19513.9140625 MB
On entering CUDA sdpa main function  allocated = 19513.91406 MB
Before first SDPA allocated = 19513.91406 MB
On chunked entry = 19513.91406 MB
On scale calculation = 19513.92188 MB
Before interleave = 19513.92188 MB
After interleave = 19514.42188 MB
After matmul = 19522.54883 MB
Before local copies matmul = 19522.54883 MB
After local copies = 19522.55176 MB
After first SDPA allocated = 19522.03906 MB
After first copy allocated = 19522.03906 MB
On chunked entry = 19522.03906 MB
On scale calculation = 19522.04688 MB
Before interleave = 19522.04688 MB
After interleave = 19522.31250 MB
After matmul = 19522.31396 MB
Before local copies matmul = 19522.31396 MB
After local copies = 19522.31641 MB
fter compute chunk allocated = 19522.03906 MB
Memory after cuda sdpa 19522.046875 MB
1
Memory before offload  19522.025390625 MB
Memory after offload  19522.025390625 MB
Memory before cuda sdpa 19522.0390625 MB
On entering CUDA sdpa main function  allocated = 19522.03906 MB
Before first SDPA allocated = 19522.03906 MB
On chunked entry = 19522.03906 MB
On scale calculation = 19522.04688 MB
Before interleave = 19522.04688 MB
After interleave = 19522.54688 MB
After matmul = 19530.67383 MB
Before local copies matmul = 19530.67383 MB
After local copies = 19530.67676 MB
After first SDPA allocated = 19530.16406 MB
After first copy allocated = 19530.16406 MB
On chunked entry = 19530.16406 MB
On scale calculation = 19530.17188 MB
Before interleave = 19530.17188 MB
After interleave = 19530.43750 MB
After matmul = 19530.43896 MB
Before local copies matmul = 19530.43896 MB
After local copies = 19530.44141 MB
fter compute chunk allocated = 19530.16406 MB
Memory after cuda sdpa 19530.171875 MB
1
Memory before offload  19530.150390625 MB
Memory after offload  19530.150390625 MB
Memory before cuda sdpa 19530.1640625 MB
On entering CUDA sdpa main function  allocated = 19530.16406 MB
Before first SDPA allocated = 19530.16406 MB
On chunked entry = 19530.16406 MB
On scale calculation = 19530.17188 MB
Before interleave = 19530.17188 MB
After interleave = 19530.67188 MB
After matmul = 19538.79883 MB
Before local copies matmul = 19538.79883 MB
After local copies = 19538.80176 MB
After first SDPA allocated = 19538.28906 MB
After first copy allocated = 19538.28906 MB
On chunked entry = 19538.28906 MB
On scale calculation = 19538.29688 MB
Before interleave = 19538.29688 MB
After interleave = 19538.56250 MB
After matmul = 19538.56396 MB
Before local copies matmul = 19538.56396 MB
After local copies = 19538.56641 MB
fter compute chunk allocated = 19538.28906 MB
Memory after cuda sdpa 19538.296875 MB
1
Memory before offload  19538.275390625 MB
Memory after offload  19538.275390625 MB
Memory before cuda sdpa 19538.2890625 MB
On entering CUDA sdpa main function  allocated = 19538.28906 MB
Before first SDPA allocated = 19538.28906 MB
On chunked entry = 19538.28906 MB
On scale calculation = 19538.29688 MB
Before interleave = 19538.29688 MB
After interleave = 19538.79688 MB
After matmul = 19546.92383 MB
Before local copies matmul = 19546.92383 MB
After local copies = 19546.92676 MB
After first SDPA allocated = 19546.41406 MB
After first copy allocated = 19546.41406 MB
On chunked entry = 19546.41406 MB
On scale calculation = 19546.42188 MB
Before interleave = 19546.42188 MB
After interleave = 19546.68750 MB
After matmul = 19546.68896 MB
Before local copies matmul = 19546.68896 MB
After local copies = 19546.69141 MB
fter compute chunk allocated = 19546.41406 MB
Memory after cuda sdpa 19546.421875 MB
1
Memory before offload  19546.400390625 MB
Memory after offload  19546.400390625 MB
Memory before cuda sdpa 19546.4140625 MB
On entering CUDA sdpa main function  allocated = 19546.41406 MB
Before first SDPA allocated = 19546.41406 MB
On chunked entry = 19546.41406 MB
On scale calculation = 19546.42188 MB
Before interleave = 19546.42188 MB
After interleave = 19546.92188 MB
After matmul = 19555.04883 MB
Before local copies matmul = 19555.04883 MB
After local copies = 19555.05176 MB
After first SDPA allocated = 19554.53906 MB
After first copy allocated = 19554.53906 MB
On chunked entry = 19554.53906 MB
On scale calculation = 19554.54688 MB
Before interleave = 19554.54688 MB
After interleave = 19554.81250 MB
After matmul = 19554.81396 MB
Before local copies matmul = 19554.81396 MB
After local copies = 19554.81641 MB
fter compute chunk allocated = 19554.53906 MB
Memory after cuda sdpa 19554.546875 MB
1
Memory before offload  19554.525390625 MB
Memory after offload  19554.525390625 MB
Memory before cuda sdpa 19554.5390625 MB
On entering CUDA sdpa main function  allocated = 19554.53906 MB
Before first SDPA allocated = 19554.53906 MB
On chunked entry = 19554.53906 MB
On scale calculation = 19554.54688 MB
Before interleave = 19554.54688 MB
After interleave = 19555.04688 MB
After matmul = 19563.17383 MB
Before local copies matmul = 19563.17383 MB
After local copies = 19563.17676 MB
After first SDPA allocated = 19562.66406 MB
After first copy allocated = 19562.66406 MB
On chunked entry = 19562.66406 MB
On scale calculation = 19562.67188 MB
Before interleave = 19562.67188 MB
After interleave = 19562.93750 MB
After matmul = 19562.93896 MB
Before local copies matmul = 19562.93896 MB
After local copies = 19562.94141 MB
fter compute chunk allocated = 19562.66406 MB
Memory after cuda sdpa 19562.671875 MB
1
Memory before offload  19562.650390625 MB
Memory after offload  19562.650390625 MB
Memory before cuda sdpa 19562.6640625 MB
On entering CUDA sdpa main function  allocated = 19562.66406 MB
Before first SDPA allocated = 19562.66406 MB
On chunked entry = 19562.66406 MB
On scale calculation = 19562.67188 MB
Before interleave = 19562.67188 MB
After interleave = 19563.17188 MB
After matmul = 19571.29883 MB
Before local copies matmul = 19571.29883 MB
After local copies = 19571.30176 MB
After first SDPA allocated = 19570.78906 MB
After first copy allocated = 19570.78906 MB
On chunked entry = 19570.78906 MB
On scale calculation = 19570.79688 MB
Before interleave = 19570.79688 MB
After interleave = 19571.06250 MB
After matmul = 19571.06396 MB
Before local copies matmul = 19571.06396 MB
After local copies = 19571.06641 MB
fter compute chunk allocated = 19570.78906 MB
Memory after cuda sdpa 19570.796875 MB
1
Memory before offload  19570.775390625 MB
Memory after offload  19570.775390625 MB
Memory before cuda sdpa 19570.7890625 MB
On entering CUDA sdpa main function  allocated = 19570.78906 MB
Before first SDPA allocated = 19570.78906 MB
On chunked entry = 19570.78906 MB
On scale calculation = 19570.79688 MB
Before interleave = 19570.79688 MB
After interleave = 19571.29688 MB
After matmul = 19579.42383 MB
Before local copies matmul = 19579.42383 MB
After local copies = 19579.42676 MB
After first SDPA allocated = 19578.91406 MB
After first copy allocated = 19578.91406 MB
On chunked entry = 19578.91406 MB
On scale calculation = 19578.92188 MB
Before interleave = 19578.92188 MB
After interleave = 19579.18750 MB
After matmul = 19579.18896 MB
Before local copies matmul = 19579.18896 MB
After local copies = 19579.19141 MB
fter compute chunk allocated = 19578.91406 MB
Memory after cuda sdpa 19578.921875 MB
1
Memory before offload  19578.900390625 MB
Memory after offload  19578.900390625 MB
Memory before cuda sdpa 19578.9140625 MB
On entering CUDA sdpa main function  allocated = 19578.91406 MB
Before first SDPA allocated = 19578.91406 MB
On chunked entry = 19578.91406 MB
On scale calculation = 19578.92188 MB
Before interleave = 19578.92188 MB
After interleave = 19579.42188 MB
After matmul = 19587.54883 MB
Before local copies matmul = 19587.54883 MB
After local copies = 19587.55176 MB
After first SDPA allocated = 19587.03906 MB
After first copy allocated = 19587.03906 MB
On chunked entry = 19587.03906 MB
On scale calculation = 19587.04688 MB
Before interleave = 19587.04688 MB
After interleave = 19587.31250 MB
After matmul = 19587.31396 MB
Before local copies matmul = 19587.31396 MB
After local copies = 19587.31641 MB
fter compute chunk allocated = 19587.03906 MB
Memory after cuda sdpa 19587.046875 MB
1
Memory before offload  19587.025390625 MB
Memory after offload  19587.025390625 MB
Memory before cuda sdpa 19587.0390625 MB
On entering CUDA sdpa main function  allocated = 19587.03906 MB
Before first SDPA allocated = 19587.03906 MB
On chunked entry = 19587.03906 MB
On scale calculation = 19587.04688 MB
Before interleave = 19587.04688 MB
After interleave = 19587.54688 MB
After matmul = 19595.67383 MB
Before local copies matmul = 19595.67383 MB
After local copies = 19595.67676 MB
After first SDPA allocated = 19595.16406 MB
After first copy allocated = 19595.16406 MB
On chunked entry = 19595.16406 MB
On scale calculation = 19595.17188 MB
Before interleave = 19595.17188 MB
After interleave = 19595.43750 MB
After matmul = 19595.43896 MB
Before local copies matmul = 19595.43896 MB
After local copies = 19595.44141 MB
fter compute chunk allocated = 19595.16406 MB
Memory after cuda sdpa 19595.171875 MB
1
Memory before offload  19595.150390625 MB
Memory after offload  19595.150390625 MB
Memory before cuda sdpa 19595.1640625 MB
On entering CUDA sdpa main function  allocated = 19595.16406 MB
Before first SDPA allocated = 19595.16406 MB
On chunked entry = 19595.16406 MB
On scale calculation = 19595.17188 MB
Before interleave = 19595.17188 MB
After interleave = 19595.67188 MB
After matmul = 19603.79883 MB
Before local copies matmul = 19603.79883 MB
After local copies = 19603.80176 MB
After first SDPA allocated = 19603.28906 MB
After first copy allocated = 19603.28906 MB
On chunked entry = 19603.28906 MB
On scale calculation = 19603.29688 MB
Before interleave = 19603.29688 MB
After interleave = 19603.56250 MB
After matmul = 19603.56396 MB
Before local copies matmul = 19603.56396 MB
After local copies = 19603.56641 MB
fter compute chunk allocated = 19603.28906 MB
Memory after cuda sdpa 19603.296875 MB
1
Memory before offload  19603.275390625 MB
Memory after offload  19603.275390625 MB
Memory before cuda sdpa 19603.2890625 MB
On entering CUDA sdpa main function  allocated = 19603.28906 MB
Before first SDPA allocated = 19603.28906 MB
On chunked entry = 19603.28906 MB
On scale calculation = 19603.29688 MB
Before interleave = 19603.29688 MB
After interleave = 19603.79688 MB
After matmul = 19611.92383 MB
Before local copies matmul = 19611.92383 MB
After local copies = 19611.92676 MB
After first SDPA allocated = 19611.41406 MB
After first copy allocated = 19611.41406 MB
On chunked entry = 19611.41406 MB
On scale calculation = 19611.42188 MB
Before interleave = 19611.42188 MB
After interleave = 19611.68750 MB
After matmul = 19611.68896 MB
Before local copies matmul = 19611.68896 MB
After local copies = 19611.69141 MB
fter compute chunk allocated = 19611.41406 MB
Memory after cuda sdpa 19611.421875 MB
1
Memory before offload  19611.400390625 MB
Memory after offload  19611.400390625 MB
Memory before cuda sdpa 19611.4140625 MB
On entering CUDA sdpa main function  allocated = 19611.41406 MB
Before first SDPA allocated = 19611.41406 MB
On chunked entry = 19611.41406 MB
On scale calculation = 19611.42188 MB
Before interleave = 19611.42188 MB
After interleave = 19611.92188 MB
After matmul = 19620.04883 MB
Before local copies matmul = 19620.04883 MB
After local copies = 19620.05176 MB
After first SDPA allocated = 19619.53906 MB
After first copy allocated = 19619.53906 MB
On chunked entry = 19619.53906 MB
On scale calculation = 19619.54688 MB
Before interleave = 19619.54688 MB
After interleave = 19619.81250 MB
After matmul = 19619.81396 MB
Before local copies matmul = 19619.81396 MB
After local copies = 19619.81641 MB
fter compute chunk allocated = 19619.53906 MB
Memory after cuda sdpa 19619.546875 MB
1
Memory before offload  19619.525390625 MB
Memory after offload  19619.525390625 MB
Memory before cuda sdpa 19619.5390625 MB
On entering CUDA sdpa main function  allocated = 19619.53906 MB
Before first SDPA allocated = 19619.53906 MB
On chunked entry = 19619.53906 MB
On scale calculation = 19619.54688 MB
Before interleave = 19619.54688 MB
After interleave = 19620.04688 MB
After matmul = 19628.17383 MB
Before local copies matmul = 19628.17383 MB
After local copies = 19628.17676 MB
After first SDPA allocated = 19627.66406 MB
After first copy allocated = 19627.66406 MB
On chunked entry = 19627.66406 MB
On scale calculation = 19627.67188 MB
Before interleave = 19627.67188 MB
After interleave = 19627.93750 MB
After matmul = 19627.93896 MB
Before local copies matmul = 19627.93896 MB
After local copies = 19627.94141 MB
fter compute chunk allocated = 19627.66406 MB
Memory after cuda sdpa 19627.671875 MB
1
Memory before offload  19627.650390625 MB
Memory after offload  19627.650390625 MB
Memory before cuda sdpa 19627.6640625 MB
On entering CUDA sdpa main function  allocated = 19627.66406 MB
Before first SDPA allocated = 19627.66406 MB
On chunked entry = 19627.66406 MB
On scale calculation = 19627.67188 MB
Before interleave = 19627.67188 MB
After interleave = 19628.17188 MB
After matmul = 19636.29883 MB
Before local copies matmul = 19636.29883 MB
After local copies = 19636.30176 MB
After first SDPA allocated = 19635.78906 MB
After first copy allocated = 19635.78906 MB
On chunked entry = 19635.78906 MB
On scale calculation = 19635.79688 MB
Before interleave = 19635.79688 MB
After interleave = 19636.06250 MB
After matmul = 19636.06396 MB
Before local copies matmul = 19636.06396 MB
After local copies = 19636.06641 MB
fter compute chunk allocated = 19635.78906 MB
Memory after cuda sdpa 19635.796875 MB
1
Memory before offload  19635.775390625 MB
Memory after offload  19635.775390625 MB
Memory before cuda sdpa 19635.7890625 MB
On entering CUDA sdpa main function  allocated = 19635.78906 MB
Before first SDPA allocated = 19635.78906 MB
On chunked entry = 19635.78906 MB
On scale calculation = 19635.79688 MB
Before interleave = 19635.79688 MB
After interleave = 19636.29688 MB
After matmul = 19644.42383 MB
Before local copies matmul = 19644.42383 MB
After local copies = 19644.42676 MB
After first SDPA allocated = 19643.91406 MB
After first copy allocated = 19643.91406 MB
On chunked entry = 19643.91406 MB
On scale calculation = 19643.92188 MB
Before interleave = 19643.92188 MB
After interleave = 19644.18750 MB
After matmul = 19644.18896 MB
Before local copies matmul = 19644.18896 MB
After local copies = 19644.19141 MB
fter compute chunk allocated = 19643.91406 MB
Memory after cuda sdpa 19643.921875 MB
1
Memory before offload  19643.900390625 MB
Memory after offload  19643.900390625 MB
Memory before cuda sdpa 19643.9140625 MB
On entering CUDA sdpa main function  allocated = 19643.91406 MB
Before first SDPA allocated = 19643.91406 MB
On chunked entry = 19643.91406 MB
On scale calculation = 19643.92188 MB
Before interleave = 19643.92188 MB
After interleave = 19644.42188 MB
After matmul = 19652.54883 MB
Before local copies matmul = 19652.54883 MB
After local copies = 19652.55176 MB
After first SDPA allocated = 19652.03906 MB
After first copy allocated = 19652.03906 MB
On chunked entry = 19652.03906 MB
On scale calculation = 19652.04688 MB
Before interleave = 19652.04688 MB
After interleave = 19652.31250 MB
After matmul = 19652.31396 MB
Before local copies matmul = 19652.31396 MB
After local copies = 19652.31641 MB
fter compute chunk allocated = 19652.03906 MB
Memory after cuda sdpa 19652.046875 MB
1
Memory before offload  19652.025390625 MB
Memory after offload  19652.025390625 MB
Memory before cuda sdpa 19652.0390625 MB
On entering CUDA sdpa main function  allocated = 19652.03906 MB
Before first SDPA allocated = 19652.03906 MB
On chunked entry = 19652.03906 MB
On scale calculation = 19652.04688 MB
Before interleave = 19652.04688 MB
After interleave = 19652.54688 MB
After matmul = 19660.67383 MB
Before local copies matmul = 19660.67383 MB
After local copies = 19660.67676 MB
After first SDPA allocated = 19660.16406 MB
After first copy allocated = 19660.16406 MB
On chunked entry = 19660.16406 MB
On scale calculation = 19660.17188 MB
Before interleave = 19660.17188 MB
After interleave = 19660.43750 MB
After matmul = 19660.43896 MB
Before local copies matmul = 19660.43896 MB
After local copies = 19660.44141 MB
fter compute chunk allocated = 19660.16406 MB
Memory after cuda sdpa 19660.171875 MB
1
Memory before offload  19660.150390625 MB
Memory after offload  19660.150390625 MB
Memory before cuda sdpa 19660.1640625 MB
On entering CUDA sdpa main function  allocated = 19660.16406 MB
Before first SDPA allocated = 19660.16406 MB
On chunked entry = 19660.16406 MB
On scale calculation = 19660.17188 MB
Before interleave = 19660.17188 MB
After interleave = 19660.67188 MB
After matmul = 19668.79883 MB
Before local copies matmul = 19668.79883 MB
After local copies = 19668.80176 MB
After first SDPA allocated = 19668.28906 MB
After first copy allocated = 19668.28906 MB
On chunked entry = 19668.28906 MB
On scale calculation = 19668.29688 MB
Before interleave = 19668.29688 MB
After interleave = 19668.56250 MB
After matmul = 19668.56396 MB
Before local copies matmul = 19668.56396 MB
After local copies = 19668.56641 MB
fter compute chunk allocated = 19668.28906 MB
Memory after cuda sdpa 19668.296875 MB
1
Memory before offload  19668.275390625 MB
Memory after offload  19668.275390625 MB
Memory before cuda sdpa 19668.2890625 MB
On entering CUDA sdpa main function  allocated = 19668.28906 MB
Before first SDPA allocated = 19668.28906 MB
On chunked entry = 19668.28906 MB
On scale calculation = 19668.29688 MB
Before interleave = 19668.29688 MB
After interleave = 19668.79688 MB
After matmul = 19676.92383 MB
Before local copies matmul = 19676.92383 MB
After local copies = 19676.92676 MB
After first SDPA allocated = 19676.41406 MB
After first copy allocated = 19676.41406 MB
On chunked entry = 19676.41406 MB
On scale calculation = 19676.42188 MB
Before interleave = 19676.42188 MB
After interleave = 19676.68750 MB
After matmul = 19676.68896 MB
Before local copies matmul = 19676.68896 MB
After local copies = 19676.69141 MB
fter compute chunk allocated = 19676.41406 MB
Memory after cuda sdpa 19676.421875 MB
1
Memory before offload  19676.400390625 MB
Memory after offload  19676.400390625 MB
Memory before cuda sdpa 19676.4140625 MB
On entering CUDA sdpa main function  allocated = 19676.41406 MB
Before first SDPA allocated = 19676.41406 MB
On chunked entry = 19676.41406 MB
On scale calculation = 19676.42188 MB
Before interleave = 19676.42188 MB
After interleave = 19676.92188 MB
After matmul = 19685.04883 MB
Before local copies matmul = 19685.04883 MB
After local copies = 19685.05176 MB
After first SDPA allocated = 19684.53906 MB
After first copy allocated = 19684.53906 MB
On chunked entry = 19684.53906 MB
On scale calculation = 19684.54688 MB
Before interleave = 19684.54688 MB
After interleave = 19684.81250 MB
After matmul = 19684.81396 MB
Before local copies matmul = 19684.81396 MB
After local copies = 19684.81641 MB
fter compute chunk allocated = 19684.53906 MB
Memory after cuda sdpa 19684.546875 MB
1
Memory before offload  19684.525390625 MB
Memory after offload  19684.525390625 MB
Memory before cuda sdpa 19684.5390625 MB
On entering CUDA sdpa main function  allocated = 19684.53906 MB
Before first SDPA allocated = 19684.53906 MB
On chunked entry = 19684.53906 MB
On scale calculation = 19684.54688 MB
Before interleave = 19684.54688 MB
After interleave = 19685.04688 MB
After matmul = 19693.17383 MB
Before local copies matmul = 19693.17383 MB
After local copies = 19693.17676 MB
After first SDPA allocated = 19692.66406 MB
After first copy allocated = 19692.66406 MB
On chunked entry = 19692.66406 MB
On scale calculation = 19692.67188 MB
Before interleave = 19692.67188 MB
After interleave = 19692.93750 MB
After matmul = 19692.93896 MB
Before local copies matmul = 19692.93896 MB
After local copies = 19692.94141 MB
fter compute chunk allocated = 19692.66406 MB
Memory after cuda sdpa 19692.671875 MB
1
Memory before offload  19692.650390625 MB
Memory after offload  19692.650390625 MB
Memory before cuda sdpa 19692.6640625 MB
On entering CUDA sdpa main function  allocated = 19692.66406 MB
Before first SDPA allocated = 19692.66406 MB
On chunked entry = 19692.66406 MB
On scale calculation = 19692.67188 MB
Before interleave = 19692.67188 MB
After interleave = 19693.17188 MB
After matmul = 19701.29883 MB
Before local copies matmul = 19701.29883 MB
After local copies = 19701.30176 MB
After first SDPA allocated = 19700.78906 MB
After first copy allocated = 19700.78906 MB
On chunked entry = 19700.78906 MB
On scale calculation = 19700.79688 MB
Before interleave = 19700.79688 MB
After interleave = 19701.06250 MB
After matmul = 19701.06396 MB
Before local copies matmul = 19701.06396 MB
After local copies = 19701.06641 MB
fter compute chunk allocated = 19700.78906 MB
Memory after cuda sdpa 19700.796875 MB
1
Memory before offload  19700.775390625 MB
Memory after offload  19700.775390625 MB
Memory before cuda sdpa 19700.7890625 MB
On entering CUDA sdpa main function  allocated = 19700.78906 MB
Before first SDPA allocated = 19700.78906 MB
On chunked entry = 19700.78906 MB
On scale calculation = 19700.79688 MB
Before interleave = 19700.79688 MB
After interleave = 19701.29688 MB
After matmul = 19709.42383 MB
Before local copies matmul = 19709.42383 MB
After local copies = 19709.42676 MB
After first SDPA allocated = 19708.91406 MB
After first copy allocated = 19708.91406 MB
On chunked entry = 19708.91406 MB
On scale calculation = 19708.92188 MB
Before interleave = 19708.92188 MB
After interleave = 19709.18750 MB
After matmul = 19709.18896 MB
Before local copies matmul = 19709.18896 MB
After local copies = 19709.19141 MB
fter compute chunk allocated = 19708.91406 MB
Memory after cuda sdpa 19708.921875 MB
1
Memory before offload  19708.900390625 MB
Memory after offload  19708.900390625 MB
Memory before cuda sdpa 19708.9140625 MB
On entering CUDA sdpa main function  allocated = 19708.91406 MB
Before first SDPA allocated = 19708.91406 MB
On chunked entry = 19708.91406 MB
On scale calculation = 19708.92188 MB
Before interleave = 19708.92188 MB
After interleave = 19709.42188 MB
After matmul = 19717.54883 MB
Before local copies matmul = 19717.54883 MB
After local copies = 19717.55176 MB
After first SDPA allocated = 19717.03906 MB
After first copy allocated = 19717.03906 MB
On chunked entry = 19717.03906 MB
On scale calculation = 19717.04688 MB
Before interleave = 19717.04688 MB
After interleave = 19717.31250 MB
After matmul = 19717.31396 MB
Before local copies matmul = 19717.31396 MB
After local copies = 19717.31641 MB
fter compute chunk allocated = 19717.03906 MB
Memory after cuda sdpa 19717.046875 MB
1
Memory before offload  19717.025390625 MB
Memory after offload  19717.025390625 MB
Memory before cuda sdpa 19717.0390625 MB
On entering CUDA sdpa main function  allocated = 19717.03906 MB
Before first SDPA allocated = 19717.03906 MB
On chunked entry = 19717.03906 MB
On scale calculation = 19717.04688 MB
Before interleave = 19717.04688 MB
After interleave = 19717.54688 MB
After matmul = 19725.67383 MB
Before local copies matmul = 19725.67383 MB
After local copies = 19725.67676 MB
After first SDPA allocated = 19725.16406 MB
After first copy allocated = 19725.16406 MB
On chunked entry = 19725.16406 MB
On scale calculation = 19725.17188 MB
Before interleave = 19725.17188 MB
After interleave = 19725.43750 MB
After matmul = 19725.43896 MB
Before local copies matmul = 19725.43896 MB
After local copies = 19725.44141 MB
fter compute chunk allocated = 19725.16406 MB
Memory after cuda sdpa 19725.171875 MB
1
Memory before offload  19725.150390625 MB
Memory after offload  19725.150390625 MB
Memory before cuda sdpa 19725.1640625 MB
On entering CUDA sdpa main function  allocated = 19725.16406 MB
Before first SDPA allocated = 19725.16406 MB
On chunked entry = 19725.16406 MB
On scale calculation = 19725.17188 MB
Before interleave = 19725.17188 MB
After interleave = 19725.67188 MB
After matmul = 19733.79883 MB
Before local copies matmul = 19733.79883 MB
After local copies = 19733.80176 MB
After first SDPA allocated = 19733.28906 MB
After first copy allocated = 19733.28906 MB
On chunked entry = 19733.28906 MB
On scale calculation = 19733.29688 MB
Before interleave = 19733.29688 MB
After interleave = 19733.56250 MB
After matmul = 19733.56396 MB
Before local copies matmul = 19733.56396 MB
After local copies = 19733.56641 MB
fter compute chunk allocated = 19733.28906 MB
Memory after cuda sdpa 19733.296875 MB
1
Memory before offload  19733.275390625 MB
Memory after offload  19733.275390625 MB
Memory before cuda sdpa 19733.2890625 MB
On entering CUDA sdpa main function  allocated = 19733.28906 MB
Before first SDPA allocated = 19733.28906 MB
On chunked entry = 19733.28906 MB
On scale calculation = 19733.29688 MB
Before interleave = 19733.29688 MB
After interleave = 19733.79688 MB
After matmul = 19741.92383 MB
Before local copies matmul = 19741.92383 MB
After local copies = 19741.92676 MB
After first SDPA allocated = 19741.41406 MB
After first copy allocated = 19741.41406 MB
On chunked entry = 19741.41406 MB
On scale calculation = 19741.42188 MB
Before interleave = 19741.42188 MB
After interleave = 19741.68750 MB
After matmul = 19741.68896 MB
Before local copies matmul = 19741.68896 MB
After local copies = 19741.69141 MB
fter compute chunk allocated = 19741.41406 MB
Memory after cuda sdpa 19741.421875 MB
1
Memory before offload  19741.400390625 MB
Memory after offload  19741.400390625 MB
Memory before cuda sdpa 19741.4140625 MB
On entering CUDA sdpa main function  allocated = 19741.41406 MB
Before first SDPA allocated = 19741.41406 MB
On chunked entry = 19741.41406 MB
On scale calculation = 19741.42188 MB
Before interleave = 19741.42188 MB
After interleave = 19741.92188 MB
After matmul = 19750.04883 MB
Before local copies matmul = 19750.04883 MB
After local copies = 19750.05176 MB
After first SDPA allocated = 19749.53906 MB
After first copy allocated = 19749.53906 MB
On chunked entry = 19749.53906 MB
On scale calculation = 19749.54688 MB
Before interleave = 19749.54688 MB
After interleave = 19749.81250 MB
After matmul = 19749.81396 MB
Before local copies matmul = 19749.81396 MB
After local copies = 19749.81641 MB
fter compute chunk allocated = 19749.53906 MB
Memory after cuda sdpa 19749.546875 MB
1
Memory before offload  19749.525390625 MB
Memory after offload  19749.525390625 MB
Memory before cuda sdpa 19749.5390625 MB
On entering CUDA sdpa main function  allocated = 19749.53906 MB
Before first SDPA allocated = 19749.53906 MB
On chunked entry = 19749.53906 MB
On scale calculation = 19749.54688 MB
Before interleave = 19749.54688 MB
After interleave = 19750.04688 MB
After matmul = 19758.17383 MB
Before local copies matmul = 19758.17383 MB
After local copies = 19758.17676 MB
After first SDPA allocated = 19757.66406 MB
After first copy allocated = 19757.66406 MB
On chunked entry = 19757.66406 MB
On scale calculation = 19757.67188 MB
Before interleave = 19757.67188 MB
After interleave = 19757.93750 MB
After matmul = 19757.93896 MB
Before local copies matmul = 19757.93896 MB
After local copies = 19757.94141 MB
fter compute chunk allocated = 19757.66406 MB
Memory after cuda sdpa 19757.671875 MB
1
Memory before offload  19757.650390625 MB
Memory after offload  19757.650390625 MB
Memory before cuda sdpa 19757.6640625 MB
On entering CUDA sdpa main function  allocated = 19757.66406 MB
Before first SDPA allocated = 19757.66406 MB
On chunked entry = 19757.66406 MB
On scale calculation = 19757.67188 MB
Before interleave = 19757.67188 MB
After interleave = 19758.17188 MB
After matmul = 19766.29883 MB
Before local copies matmul = 19766.29883 MB
After local copies = 19766.30176 MB
After first SDPA allocated = 19765.78906 MB
After first copy allocated = 19765.78906 MB
On chunked entry = 19765.78906 MB
On scale calculation = 19765.79688 MB
Before interleave = 19765.79688 MB
After interleave = 19766.06250 MB
After matmul = 19766.06396 MB
Before local copies matmul = 19766.06396 MB
After local copies = 19766.06641 MB
fter compute chunk allocated = 19765.78906 MB
Memory after cuda sdpa 19765.796875 MB
Decode step 18
1
Memory before offload  19765.77587890625 MB
Memory after offload  19765.77587890625 MB
Memory before cuda sdpa 19765.78955078125 MB
On entering CUDA sdpa main function  allocated = 19765.78955 MB
Before first SDPA allocated = 19765.78955 MB
On chunked entry = 19765.78955 MB
On scale calculation = 19765.79736 MB
Before interleave = 19765.79736 MB
After interleave = 19766.29736 MB
After matmul = 19774.42432 MB
Before local copies matmul = 19774.42432 MB
After local copies = 19774.42725 MB
After first SDPA allocated = 19773.91455 MB
After first copy allocated = 19773.91455 MB
On chunked entry = 19773.91455 MB
On scale calculation = 19773.92236 MB
Before interleave = 19773.92236 MB
After interleave = 19774.20361 MB
After matmul = 19774.20508 MB
Before local copies matmul = 19774.20508 MB
After local copies = 19774.20752 MB
fter compute chunk allocated = 19773.91455 MB
Memory after cuda sdpa 19773.92236328125 MB
1
Memory before offload  19773.90087890625 MB
Memory after offload  19773.90087890625 MB
Memory before cuda sdpa 19773.91455078125 MB
On entering CUDA sdpa main function  allocated = 19773.91455 MB
Before first SDPA allocated = 19773.91455 MB
On chunked entry = 19773.91455 MB
On scale calculation = 19773.92236 MB
Before interleave = 19773.92236 MB
After interleave = 19774.42236 MB
After matmul = 19782.54932 MB
Before local copies matmul = 19782.54932 MB
After local copies = 19782.55225 MB
After first SDPA allocated = 19782.03955 MB
After first copy allocated = 19782.03955 MB
On chunked entry = 19782.03955 MB
On scale calculation = 19782.04736 MB
Before interleave = 19782.04736 MB
After interleave = 19782.32861 MB
After matmul = 19782.33008 MB
Before local copies matmul = 19782.33008 MB
After local copies = 19782.33252 MB
fter compute chunk allocated = 19782.03955 MB
Memory after cuda sdpa 19782.04736328125 MB
1
Memory before offload  19782.02587890625 MB
Memory after offload  19782.02587890625 MB
Memory before cuda sdpa 19782.03955078125 MB
On entering CUDA sdpa main function  allocated = 19782.03955 MB
Before first SDPA allocated = 19782.03955 MB
On chunked entry = 19782.03955 MB
On scale calculation = 19782.04736 MB
Before interleave = 19782.04736 MB
After interleave = 19782.54736 MB
After matmul = 19790.67432 MB
Before local copies matmul = 19790.67432 MB
After local copies = 19790.67725 MB
After first SDPA allocated = 19790.16455 MB
After first copy allocated = 19790.16455 MB
On chunked entry = 19790.16455 MB
On scale calculation = 19790.17236 MB
Before interleave = 19790.17236 MB
After interleave = 19790.45361 MB
After matmul = 19790.45508 MB
Before local copies matmul = 19790.45508 MB
After local copies = 19790.45752 MB
fter compute chunk allocated = 19790.16455 MB
Memory after cuda sdpa 19790.17236328125 MB
1
Memory before offload  19790.15087890625 MB
Memory after offload  19790.15087890625 MB
Memory before cuda sdpa 19790.16455078125 MB
On entering CUDA sdpa main function  allocated = 19790.16455 MB
Before first SDPA allocated = 19790.16455 MB
On chunked entry = 19790.16455 MB
On scale calculation = 19790.17236 MB
Before interleave = 19790.17236 MB
After interleave = 19790.67236 MB
After matmul = 19798.79932 MB
Before local copies matmul = 19798.79932 MB
After local copies = 19798.80225 MB
After first SDPA allocated = 19798.28955 MB
After first copy allocated = 19798.28955 MB
On chunked entry = 19798.28955 MB
On scale calculation = 19798.29736 MB
Before interleave = 19798.29736 MB
After interleave = 19798.57861 MB
After matmul = 19798.58008 MB
Before local copies matmul = 19798.58008 MB
After local copies = 19798.58252 MB
fter compute chunk allocated = 19798.28955 MB
Memory after cuda sdpa 19798.29736328125 MB
1
Memory before offload  19798.27587890625 MB
Memory after offload  19798.27587890625 MB
Memory before cuda sdpa 19798.28955078125 MB
On entering CUDA sdpa main function  allocated = 19798.28955 MB
Before first SDPA allocated = 19798.28955 MB
On chunked entry = 19798.28955 MB
On scale calculation = 19798.29736 MB
Before interleave = 19798.29736 MB
After interleave = 19798.79736 MB
After matmul = 19806.92432 MB
Before local copies matmul = 19806.92432 MB
After local copies = 19806.92725 MB
After first SDPA allocated = 19806.41455 MB
After first copy allocated = 19806.41455 MB
On chunked entry = 19806.41455 MB
On scale calculation = 19806.42236 MB
Before interleave = 19806.42236 MB
After interleave = 19806.70361 MB
After matmul = 19806.70508 MB
Before local copies matmul = 19806.70508 MB
After local copies = 19806.70752 MB
fter compute chunk allocated = 19806.41455 MB
Memory after cuda sdpa 19806.42236328125 MB
1
Memory before offload  19806.40087890625 MB
Memory after offload  19806.40087890625 MB
Memory before cuda sdpa 19806.41455078125 MB
On entering CUDA sdpa main function  allocated = 19806.41455 MB
Before first SDPA allocated = 19806.41455 MB
On chunked entry = 19806.41455 MB
On scale calculation = 19806.42236 MB
Before interleave = 19806.42236 MB
After interleave = 19806.92236 MB
After matmul = 19815.04932 MB
Before local copies matmul = 19815.04932 MB
After local copies = 19815.05225 MB
After first SDPA allocated = 19814.53955 MB
After first copy allocated = 19814.53955 MB
On chunked entry = 19814.53955 MB
On scale calculation = 19814.54736 MB
Before interleave = 19814.54736 MB
After interleave = 19814.82861 MB
After matmul = 19814.83008 MB
Before local copies matmul = 19814.83008 MB
After local copies = 19814.83252 MB
fter compute chunk allocated = 19814.53955 MB
Memory after cuda sdpa 19814.54736328125 MB
1
Memory before offload  19814.52587890625 MB
Memory after offload  19814.52587890625 MB
Memory before cuda sdpa 19814.53955078125 MB
On entering CUDA sdpa main function  allocated = 19814.53955 MB
Before first SDPA allocated = 19814.53955 MB
On chunked entry = 19814.53955 MB
On scale calculation = 19814.54736 MB
Before interleave = 19814.54736 MB
After interleave = 19815.04736 MB
After matmul = 19823.17432 MB
Before local copies matmul = 19823.17432 MB
After local copies = 19823.17725 MB
After first SDPA allocated = 19822.66455 MB
After first copy allocated = 19822.66455 MB
On chunked entry = 19822.66455 MB
On scale calculation = 19822.67236 MB
Before interleave = 19822.67236 MB
After interleave = 19822.95361 MB
After matmul = 19822.95508 MB
Before local copies matmul = 19822.95508 MB
After local copies = 19822.95752 MB
fter compute chunk allocated = 19822.66455 MB
Memory after cuda sdpa 19822.67236328125 MB
1
Memory before offload  19822.65087890625 MB
Memory after offload  19822.65087890625 MB
Memory before cuda sdpa 19822.66455078125 MB
On entering CUDA sdpa main function  allocated = 19822.66455 MB
Before first SDPA allocated = 19822.66455 MB
On chunked entry = 19822.66455 MB
On scale calculation = 19822.67236 MB
Before interleave = 19822.67236 MB
After interleave = 19823.17236 MB
After matmul = 19831.29932 MB
Before local copies matmul = 19831.29932 MB
After local copies = 19831.30225 MB
After first SDPA allocated = 19830.78955 MB
After first copy allocated = 19830.78955 MB
On chunked entry = 19830.78955 MB
On scale calculation = 19830.79736 MB
Before interleave = 19830.79736 MB
After interleave = 19831.07861 MB
After matmul = 19831.08008 MB
Before local copies matmul = 19831.08008 MB
After local copies = 19831.08252 MB
fter compute chunk allocated = 19830.78955 MB
Memory after cuda sdpa 19830.79736328125 MB
1
Memory before offload  19830.77587890625 MB
Memory after offload  19830.77587890625 MB
Memory before cuda sdpa 19830.78955078125 MB
On entering CUDA sdpa main function  allocated = 19830.78955 MB
Before first SDPA allocated = 19830.78955 MB
On chunked entry = 19830.78955 MB
On scale calculation = 19830.79736 MB
Before interleave = 19830.79736 MB
After interleave = 19831.29736 MB
After matmul = 19839.42432 MB
Before local copies matmul = 19839.42432 MB
After local copies = 19839.42725 MB
After first SDPA allocated = 19838.91455 MB
After first copy allocated = 19838.91455 MB
On chunked entry = 19838.91455 MB
On scale calculation = 19838.92236 MB
Before interleave = 19838.92236 MB
After interleave = 19839.20361 MB
After matmul = 19839.20508 MB
Before local copies matmul = 19839.20508 MB
After local copies = 19839.20752 MB
fter compute chunk allocated = 19838.91455 MB
Memory after cuda sdpa 19838.92236328125 MB
1
Memory before offload  19838.90087890625 MB
Memory after offload  19838.90087890625 MB
Memory before cuda sdpa 19838.91455078125 MB
On entering CUDA sdpa main function  allocated = 19838.91455 MB
Before first SDPA allocated = 19838.91455 MB
On chunked entry = 19838.91455 MB
On scale calculation = 19838.92236 MB
Before interleave = 19838.92236 MB
After interleave = 19839.42236 MB
After matmul = 19847.54932 MB
Before local copies matmul = 19847.54932 MB
After local copies = 19847.55225 MB
After first SDPA allocated = 19847.03955 MB
After first copy allocated = 19847.03955 MB
On chunked entry = 19847.03955 MB
On scale calculation = 19847.04736 MB
Before interleave = 19847.04736 MB
After interleave = 19847.32861 MB
After matmul = 19847.33008 MB
Before local copies matmul = 19847.33008 MB
After local copies = 19847.33252 MB
fter compute chunk allocated = 19847.03955 MB
Memory after cuda sdpa 19847.04736328125 MB
1
Memory before offload  19847.02587890625 MB
Memory after offload  19847.02587890625 MB
Memory before cuda sdpa 19847.03955078125 MB
On entering CUDA sdpa main function  allocated = 19847.03955 MB
Before first SDPA allocated = 19847.03955 MB
On chunked entry = 19847.03955 MB
On scale calculation = 19847.04736 MB
Before interleave = 19847.04736 MB
After interleave = 19847.54736 MB
After matmul = 19855.67432 MB
Before local copies matmul = 19855.67432 MB
After local copies = 19855.67725 MB
After first SDPA allocated = 19855.16455 MB
After first copy allocated = 19855.16455 MB
On chunked entry = 19855.16455 MB
On scale calculation = 19855.17236 MB
Before interleave = 19855.17236 MB
After interleave = 19855.45361 MB
After matmul = 19855.45508 MB
Before local copies matmul = 19855.45508 MB
After local copies = 19855.45752 MB
fter compute chunk allocated = 19855.16455 MB
Memory after cuda sdpa 19855.17236328125 MB
1
Memory before offload  19855.15087890625 MB
Memory after offload  19855.15087890625 MB
Memory before cuda sdpa 19855.16455078125 MB
On entering CUDA sdpa main function  allocated = 19855.16455 MB
Before first SDPA allocated = 19855.16455 MB
On chunked entry = 19855.16455 MB
On scale calculation = 19855.17236 MB
Before interleave = 19855.17236 MB
After interleave = 19855.67236 MB
After matmul = 19863.79932 MB
Before local copies matmul = 19863.79932 MB
After local copies = 19863.80225 MB
After first SDPA allocated = 19863.28955 MB
After first copy allocated = 19863.28955 MB
On chunked entry = 19863.28955 MB
On scale calculation = 19863.29736 MB
Before interleave = 19863.29736 MB
After interleave = 19863.57861 MB
After matmul = 19863.58008 MB
Before local copies matmul = 19863.58008 MB
After local copies = 19863.58252 MB
fter compute chunk allocated = 19863.28955 MB
Memory after cuda sdpa 19863.29736328125 MB
1
Memory before offload  19863.27587890625 MB
Memory after offload  19863.27587890625 MB
Memory before cuda sdpa 19863.28955078125 MB
On entering CUDA sdpa main function  allocated = 19863.28955 MB
Before first SDPA allocated = 19863.28955 MB
On chunked entry = 19863.28955 MB
On scale calculation = 19863.29736 MB
Before interleave = 19863.29736 MB
After interleave = 19863.79736 MB
After matmul = 19871.92432 MB
Before local copies matmul = 19871.92432 MB
After local copies = 19871.92725 MB
After first SDPA allocated = 19871.41455 MB
After first copy allocated = 19871.41455 MB
On chunked entry = 19871.41455 MB
On scale calculation = 19871.42236 MB
Before interleave = 19871.42236 MB
After interleave = 19871.70361 MB
After matmul = 19871.70508 MB
Before local copies matmul = 19871.70508 MB
After local copies = 19871.70752 MB
fter compute chunk allocated = 19871.41455 MB
Memory after cuda sdpa 19871.42236328125 MB
1
Memory before offload  19871.40087890625 MB
Memory after offload  19871.40087890625 MB
Memory before cuda sdpa 19871.41455078125 MB
On entering CUDA sdpa main function  allocated = 19871.41455 MB
Before first SDPA allocated = 19871.41455 MB
On chunked entry = 19871.41455 MB
On scale calculation = 19871.42236 MB
Before interleave = 19871.42236 MB
After interleave = 19871.92236 MB
After matmul = 19880.04932 MB
Before local copies matmul = 19880.04932 MB
After local copies = 19880.05225 MB
After first SDPA allocated = 19879.53955 MB
After first copy allocated = 19879.53955 MB
On chunked entry = 19879.53955 MB
On scale calculation = 19879.54736 MB
Before interleave = 19879.54736 MB
After interleave = 19879.82861 MB
After matmul = 19879.83008 MB
Before local copies matmul = 19879.83008 MB
After local copies = 19879.83252 MB
fter compute chunk allocated = 19879.53955 MB
Memory after cuda sdpa 19879.54736328125 MB
1
Memory before offload  19879.52587890625 MB
Memory after offload  19879.52587890625 MB
Memory before cuda sdpa 19879.53955078125 MB
On entering CUDA sdpa main function  allocated = 19879.53955 MB
Before first SDPA allocated = 19879.53955 MB
On chunked entry = 19879.53955 MB
On scale calculation = 19879.54736 MB
Before interleave = 19879.54736 MB
After interleave = 19880.04736 MB
After matmul = 19888.17432 MB
Before local copies matmul = 19888.17432 MB
After local copies = 19888.17725 MB
After first SDPA allocated = 19887.66455 MB
After first copy allocated = 19887.66455 MB
On chunked entry = 19887.66455 MB
On scale calculation = 19887.67236 MB
Before interleave = 19887.67236 MB
After interleave = 19887.95361 MB
After matmul = 19887.95508 MB
Before local copies matmul = 19887.95508 MB
After local copies = 19887.95752 MB
fter compute chunk allocated = 19887.66455 MB
Memory after cuda sdpa 19887.67236328125 MB
1
Memory before offload  19887.65087890625 MB
Memory after offload  19887.65087890625 MB
Memory before cuda sdpa 19887.66455078125 MB
On entering CUDA sdpa main function  allocated = 19887.66455 MB
Before first SDPA allocated = 19887.66455 MB
On chunked entry = 19887.66455 MB
On scale calculation = 19887.67236 MB
Before interleave = 19887.67236 MB
After interleave = 19888.17236 MB
After matmul = 19896.29932 MB
Before local copies matmul = 19896.29932 MB
After local copies = 19896.30225 MB
After first SDPA allocated = 19895.78955 MB
After first copy allocated = 19895.78955 MB
On chunked entry = 19895.78955 MB
On scale calculation = 19895.79736 MB
Before interleave = 19895.79736 MB
After interleave = 19896.07861 MB
After matmul = 19896.08008 MB
Before local copies matmul = 19896.08008 MB
After local copies = 19896.08252 MB
fter compute chunk allocated = 19895.78955 MB
Memory after cuda sdpa 19895.79736328125 MB
1
Memory before offload  19895.77587890625 MB
Memory after offload  19895.77587890625 MB
Memory before cuda sdpa 19895.78955078125 MB
On entering CUDA sdpa main function  allocated = 19895.78955 MB
Before first SDPA allocated = 19895.78955 MB
On chunked entry = 19895.78955 MB
On scale calculation = 19895.79736 MB
Before interleave = 19895.79736 MB
After interleave = 19896.29736 MB
After matmul = 19904.42432 MB
Before local copies matmul = 19904.42432 MB
After local copies = 19904.42725 MB
After first SDPA allocated = 19903.91455 MB
After first copy allocated = 19903.91455 MB
On chunked entry = 19903.91455 MB
On scale calculation = 19903.92236 MB
Before interleave = 19903.92236 MB
After interleave = 19904.20361 MB
After matmul = 19904.20508 MB
Before local copies matmul = 19904.20508 MB
After local copies = 19904.20752 MB
fter compute chunk allocated = 19903.91455 MB
Memory after cuda sdpa 19903.92236328125 MB
1
Memory before offload  19903.90087890625 MB
Memory after offload  19903.90087890625 MB
Memory before cuda sdpa 19903.91455078125 MB
On entering CUDA sdpa main function  allocated = 19903.91455 MB
Before first SDPA allocated = 19903.91455 MB
On chunked entry = 19903.91455 MB
On scale calculation = 19903.92236 MB
Before interleave = 19903.92236 MB
After interleave = 19904.42236 MB
After matmul = 19912.54932 MB
Before local copies matmul = 19912.54932 MB
After local copies = 19912.55225 MB
After first SDPA allocated = 19912.03955 MB
After first copy allocated = 19912.03955 MB
On chunked entry = 19912.03955 MB
On scale calculation = 19912.04736 MB
Before interleave = 19912.04736 MB
After interleave = 19912.32861 MB
After matmul = 19912.33008 MB
Before local copies matmul = 19912.33008 MB
After local copies = 19912.33252 MB
fter compute chunk allocated = 19912.03955 MB
Memory after cuda sdpa 19912.04736328125 MB
1
Memory before offload  19912.02587890625 MB
Memory after offload  19912.02587890625 MB
Memory before cuda sdpa 19912.03955078125 MB
On entering CUDA sdpa main function  allocated = 19912.03955 MB
Before first SDPA allocated = 19912.03955 MB
On chunked entry = 19912.03955 MB
On scale calculation = 19912.04736 MB
Before interleave = 19912.04736 MB
After interleave = 19912.54736 MB
After matmul = 19920.67432 MB
Before local copies matmul = 19920.67432 MB
After local copies = 19920.67725 MB
After first SDPA allocated = 19920.16455 MB
After first copy allocated = 19920.16455 MB
On chunked entry = 19920.16455 MB
On scale calculation = 19920.17236 MB
Before interleave = 19920.17236 MB
After interleave = 19920.45361 MB
After matmul = 19920.45508 MB
Before local copies matmul = 19920.45508 MB
After local copies = 19920.45752 MB
fter compute chunk allocated = 19920.16455 MB
Memory after cuda sdpa 19920.17236328125 MB
1
Memory before offload  19920.15087890625 MB
Memory after offload  19920.15087890625 MB
Memory before cuda sdpa 19920.16455078125 MB
On entering CUDA sdpa main function  allocated = 19920.16455 MB
Before first SDPA allocated = 19920.16455 MB
On chunked entry = 19920.16455 MB
On scale calculation = 19920.17236 MB
Before interleave = 19920.17236 MB
After interleave = 19920.67236 MB
After matmul = 19928.79932 MB
Before local copies matmul = 19928.79932 MB
After local copies = 19928.80225 MB
After first SDPA allocated = 19928.28955 MB
After first copy allocated = 19928.28955 MB
On chunked entry = 19928.28955 MB
On scale calculation = 19928.29736 MB
Before interleave = 19928.29736 MB
After interleave = 19928.57861 MB
After matmul = 19928.58008 MB
Before local copies matmul = 19928.58008 MB
After local copies = 19928.58252 MB
fter compute chunk allocated = 19928.28955 MB
Memory after cuda sdpa 19928.29736328125 MB
1
Memory before offload  19928.27587890625 MB
Memory after offload  19928.27587890625 MB
Memory before cuda sdpa 19928.28955078125 MB
On entering CUDA sdpa main function  allocated = 19928.28955 MB
Before first SDPA allocated = 19928.28955 MB
On chunked entry = 19928.28955 MB
On scale calculation = 19928.29736 MB
Before interleave = 19928.29736 MB
After interleave = 19928.79736 MB
After matmul = 19936.92432 MB
Before local copies matmul = 19936.92432 MB
After local copies = 19936.92725 MB
After first SDPA allocated = 19936.41455 MB
After first copy allocated = 19936.41455 MB
On chunked entry = 19936.41455 MB
On scale calculation = 19936.42236 MB
Before interleave = 19936.42236 MB
After interleave = 19936.70361 MB
After matmul = 19936.70508 MB
Before local copies matmul = 19936.70508 MB
After local copies = 19936.70752 MB
fter compute chunk allocated = 19936.41455 MB
Memory after cuda sdpa 19936.42236328125 MB
1
Memory before offload  19936.40087890625 MB
Memory after offload  19936.40087890625 MB
Memory before cuda sdpa 19936.41455078125 MB
On entering CUDA sdpa main function  allocated = 19936.41455 MB
Before first SDPA allocated = 19936.41455 MB
On chunked entry = 19936.41455 MB
On scale calculation = 19936.42236 MB
Before interleave = 19936.42236 MB
After interleave = 19936.92236 MB
After matmul = 19945.04932 MB
Before local copies matmul = 19945.04932 MB
After local copies = 19945.05225 MB
After first SDPA allocated = 19944.53955 MB
After first copy allocated = 19944.53955 MB
On chunked entry = 19944.53955 MB
On scale calculation = 19944.54736 MB
Before interleave = 19944.54736 MB
After interleave = 19944.82861 MB
After matmul = 19944.83008 MB
Before local copies matmul = 19944.83008 MB
After local copies = 19944.83252 MB
fter compute chunk allocated = 19944.53955 MB
Memory after cuda sdpa 19944.54736328125 MB
1
Memory before offload  19944.52587890625 MB
Memory after offload  19944.52587890625 MB
Memory before cuda sdpa 19944.53955078125 MB
On entering CUDA sdpa main function  allocated = 19944.53955 MB
Before first SDPA allocated = 19944.53955 MB
On chunked entry = 19944.53955 MB
On scale calculation = 19944.54736 MB
Before interleave = 19944.54736 MB
After interleave = 19945.04736 MB
After matmul = 19953.17432 MB
Before local copies matmul = 19953.17432 MB
After local copies = 19953.17725 MB
After first SDPA allocated = 19952.66455 MB
After first copy allocated = 19952.66455 MB
On chunked entry = 19952.66455 MB
On scale calculation = 19952.67236 MB
Before interleave = 19952.67236 MB
After interleave = 19952.95361 MB
After matmul = 19952.95508 MB
Before local copies matmul = 19952.95508 MB
After local copies = 19952.95752 MB
fter compute chunk allocated = 19952.66455 MB
Memory after cuda sdpa 19952.67236328125 MB
1
Memory before offload  19952.65087890625 MB
Memory after offload  19952.65087890625 MB
Memory before cuda sdpa 19952.66455078125 MB
On entering CUDA sdpa main function  allocated = 19952.66455 MB
Before first SDPA allocated = 19952.66455 MB
On chunked entry = 19952.66455 MB
On scale calculation = 19952.67236 MB
Before interleave = 19952.67236 MB
After interleave = 19953.17236 MB
After matmul = 19961.29932 MB
Before local copies matmul = 19961.29932 MB
After local copies = 19961.30225 MB
After first SDPA allocated = 19960.78955 MB
After first copy allocated = 19960.78955 MB
On chunked entry = 19960.78955 MB
On scale calculation = 19960.79736 MB
Before interleave = 19960.79736 MB
After interleave = 19961.07861 MB
After matmul = 19961.08008 MB
Before local copies matmul = 19961.08008 MB
After local copies = 19961.08252 MB
fter compute chunk allocated = 19960.78955 MB
Memory after cuda sdpa 19960.79736328125 MB
1
Memory before offload  19960.77587890625 MB
Memory after offload  19960.77587890625 MB
Memory before cuda sdpa 19960.78955078125 MB
On entering CUDA sdpa main function  allocated = 19960.78955 MB
Before first SDPA allocated = 19960.78955 MB
On chunked entry = 19960.78955 MB
On scale calculation = 19960.79736 MB
Before interleave = 19960.79736 MB
After interleave = 19961.29736 MB
After matmul = 19969.42432 MB
Before local copies matmul = 19969.42432 MB
After local copies = 19969.42725 MB
After first SDPA allocated = 19968.91455 MB
After first copy allocated = 19968.91455 MB
On chunked entry = 19968.91455 MB
On scale calculation = 19968.92236 MB
Before interleave = 19968.92236 MB
After interleave = 19969.20361 MB
After matmul = 19969.20508 MB
Before local copies matmul = 19969.20508 MB
After local copies = 19969.20752 MB
fter compute chunk allocated = 19968.91455 MB
Memory after cuda sdpa 19968.92236328125 MB
1
Memory before offload  19968.90087890625 MB
Memory after offload  19968.90087890625 MB
Memory before cuda sdpa 19968.91455078125 MB
On entering CUDA sdpa main function  allocated = 19968.91455 MB
Before first SDPA allocated = 19968.91455 MB
On chunked entry = 19968.91455 MB
On scale calculation = 19968.92236 MB
Before interleave = 19968.92236 MB
After interleave = 19969.42236 MB
After matmul = 19977.54932 MB
Before local copies matmul = 19977.54932 MB
After local copies = 19977.55225 MB
After first SDPA allocated = 19977.03955 MB
After first copy allocated = 19977.03955 MB
On chunked entry = 19977.03955 MB
On scale calculation = 19977.04736 MB
Before interleave = 19977.04736 MB
After interleave = 19977.32861 MB
After matmul = 19977.33008 MB
Before local copies matmul = 19977.33008 MB
After local copies = 19977.33252 MB
fter compute chunk allocated = 19977.03955 MB
Memory after cuda sdpa 19977.04736328125 MB
1
Memory before offload  19977.02587890625 MB
Memory after offload  19977.02587890625 MB
Memory before cuda sdpa 19977.03955078125 MB
On entering CUDA sdpa main function  allocated = 19977.03955 MB
Before first SDPA allocated = 19977.03955 MB
On chunked entry = 19977.03955 MB
On scale calculation = 19977.04736 MB
Before interleave = 19977.04736 MB
After interleave = 19977.54736 MB
After matmul = 19985.67432 MB
Before local copies matmul = 19985.67432 MB
After local copies = 19985.67725 MB
After first SDPA allocated = 19985.16455 MB
After first copy allocated = 19985.16455 MB
On chunked entry = 19985.16455 MB
On scale calculation = 19985.17236 MB
Before interleave = 19985.17236 MB
After interleave = 19985.45361 MB
After matmul = 19985.45508 MB
Before local copies matmul = 19985.45508 MB
After local copies = 19985.45752 MB
fter compute chunk allocated = 19985.16455 MB
Memory after cuda sdpa 19985.17236328125 MB
1
Memory before offload  19985.15087890625 MB
Memory after offload  19985.15087890625 MB
Memory before cuda sdpa 19985.16455078125 MB
On entering CUDA sdpa main function  allocated = 19985.16455 MB
Before first SDPA allocated = 19985.16455 MB
On chunked entry = 19985.16455 MB
On scale calculation = 19985.17236 MB
Before interleave = 19985.17236 MB
After interleave = 19985.67236 MB
After matmul = 19993.79932 MB
Before local copies matmul = 19993.79932 MB
After local copies = 19993.80225 MB
After first SDPA allocated = 19993.28955 MB
After first copy allocated = 19993.28955 MB
On chunked entry = 19993.28955 MB
On scale calculation = 19993.29736 MB
Before interleave = 19993.29736 MB
After interleave = 19993.57861 MB
After matmul = 19993.58008 MB
Before local copies matmul = 19993.58008 MB
After local copies = 19993.58252 MB
fter compute chunk allocated = 19993.28955 MB
Memory after cuda sdpa 19993.29736328125 MB
1
Memory before offload  19993.27587890625 MB
Memory after offload  19993.27587890625 MB
Memory before cuda sdpa 19993.28955078125 MB
On entering CUDA sdpa main function  allocated = 19993.28955 MB
Before first SDPA allocated = 19993.28955 MB
On chunked entry = 19993.28955 MB
On scale calculation = 19993.29736 MB
Before interleave = 19993.29736 MB
After interleave = 19993.79736 MB
After matmul = 20001.92432 MB
Before local copies matmul = 20001.92432 MB
After local copies = 20001.92725 MB
After first SDPA allocated = 20001.41455 MB
After first copy allocated = 20001.41455 MB
On chunked entry = 20001.41455 MB
On scale calculation = 20001.42236 MB
Before interleave = 20001.42236 MB
After interleave = 20001.70361 MB
After matmul = 20001.70508 MB
Before local copies matmul = 20001.70508 MB
After local copies = 20001.70752 MB
fter compute chunk allocated = 20001.41455 MB
Memory after cuda sdpa 20001.42236328125 MB
1
Memory before offload  20001.40087890625 MB
Memory after offload  20001.40087890625 MB
Memory before cuda sdpa 20001.41455078125 MB
On entering CUDA sdpa main function  allocated = 20001.41455 MB
Before first SDPA allocated = 20001.41455 MB
On chunked entry = 20001.41455 MB
On scale calculation = 20001.42236 MB
Before interleave = 20001.42236 MB
After interleave = 20001.92236 MB
After matmul = 20010.04932 MB
Before local copies matmul = 20010.04932 MB
After local copies = 20010.05225 MB
After first SDPA allocated = 20009.53955 MB
After first copy allocated = 20009.53955 MB
On chunked entry = 20009.53955 MB
On scale calculation = 20009.54736 MB
Before interleave = 20009.54736 MB
After interleave = 20009.82861 MB
After matmul = 20009.83008 MB
Before local copies matmul = 20009.83008 MB
After local copies = 20009.83252 MB
fter compute chunk allocated = 20009.53955 MB
Memory after cuda sdpa 20009.54736328125 MB
1
Memory before offload  20009.52587890625 MB
Memory after offload  20009.52587890625 MB
Memory before cuda sdpa 20009.53955078125 MB
On entering CUDA sdpa main function  allocated = 20009.53955 MB
Before first SDPA allocated = 20009.53955 MB
On chunked entry = 20009.53955 MB
On scale calculation = 20009.54736 MB
Before interleave = 20009.54736 MB
After interleave = 20010.04736 MB
After matmul = 20018.17432 MB
Before local copies matmul = 20018.17432 MB
After local copies = 20018.17725 MB
After first SDPA allocated = 20017.66455 MB
After first copy allocated = 20017.66455 MB
On chunked entry = 20017.66455 MB
On scale calculation = 20017.67236 MB
Before interleave = 20017.67236 MB
After interleave = 20017.95361 MB
After matmul = 20017.95508 MB
Before local copies matmul = 20017.95508 MB
After local copies = 20017.95752 MB
fter compute chunk allocated = 20017.66455 MB
Memory after cuda sdpa 20017.67236328125 MB
1
Memory before offload  20017.65087890625 MB
Memory after offload  20017.65087890625 MB
Memory before cuda sdpa 20017.66455078125 MB
On entering CUDA sdpa main function  allocated = 20017.66455 MB
Before first SDPA allocated = 20017.66455 MB
On chunked entry = 20017.66455 MB
On scale calculation = 20017.67236 MB
Before interleave = 20017.67236 MB
After interleave = 20018.17236 MB
After matmul = 20026.29932 MB
Before local copies matmul = 20026.29932 MB
After local copies = 20026.30225 MB
After first SDPA allocated = 20025.78955 MB
After first copy allocated = 20025.78955 MB
On chunked entry = 20025.78955 MB
On scale calculation = 20025.79736 MB
Before interleave = 20025.79736 MB
After interleave = 20026.07861 MB
After matmul = 20026.08008 MB
Before local copies matmul = 20026.08008 MB
After local copies = 20026.08252 MB
fter compute chunk allocated = 20025.78955 MB
Memory after cuda sdpa 20025.79736328125 MB
Decode step 19
1
Memory before offload  20025.7763671875 MB
Memory after offload  20025.7763671875 MB
Memory before cuda sdpa 20025.7900390625 MB
On entering CUDA sdpa main function  allocated = 20025.79004 MB
Before first SDPA allocated = 20025.79004 MB
On chunked entry = 20025.79004 MB
On scale calculation = 20025.79785 MB
Before interleave = 20025.79785 MB
After interleave = 20026.29785 MB
After matmul = 20034.42480 MB
Before local copies matmul = 20034.42480 MB
After local copies = 20034.42773 MB
After first SDPA allocated = 20033.91504 MB
After first copy allocated = 20033.91504 MB
On chunked entry = 20033.91504 MB
On scale calculation = 20033.92285 MB
Before interleave = 20033.92285 MB
After interleave = 20034.21973 MB
After matmul = 20034.22119 MB
Before local copies matmul = 20034.22119 MB
After local copies = 20034.22363 MB
fter compute chunk allocated = 20033.91504 MB
Memory after cuda sdpa 20033.9228515625 MB
1
Memory before offload  20033.9013671875 MB
Memory after offload  20033.9013671875 MB
Memory before cuda sdpa 20033.9150390625 MB
On entering CUDA sdpa main function  allocated = 20033.91504 MB
Before first SDPA allocated = 20033.91504 MB
On chunked entry = 20033.91504 MB
On scale calculation = 20033.92285 MB
Before interleave = 20033.92285 MB
After interleave = 20034.42285 MB
After matmul = 20042.54980 MB
Before local copies matmul = 20042.54980 MB
After local copies = 20042.55273 MB
After first SDPA allocated = 20042.04004 MB
After first copy allocated = 20042.04004 MB
On chunked entry = 20042.04004 MB
On scale calculation = 20042.04785 MB
Before interleave = 20042.04785 MB
After interleave = 20042.34473 MB
After matmul = 20042.34619 MB
Before local copies matmul = 20042.34619 MB
After local copies = 20042.34863 MB
fter compute chunk allocated = 20042.04004 MB
Memory after cuda sdpa 20042.0478515625 MB
1
Memory before offload  20042.0263671875 MB
Memory after offload  20042.0263671875 MB
Memory before cuda sdpa 20042.0400390625 MB
On entering CUDA sdpa main function  allocated = 20042.04004 MB
Before first SDPA allocated = 20042.04004 MB
On chunked entry = 20042.04004 MB
On scale calculation = 20042.04785 MB
Before interleave = 20042.04785 MB
After interleave = 20042.54785 MB
After matmul = 20050.67480 MB
Before local copies matmul = 20050.67480 MB
After local copies = 20050.67773 MB
After first SDPA allocated = 20050.16504 MB
After first copy allocated = 20050.16504 MB
On chunked entry = 20050.16504 MB
On scale calculation = 20050.17285 MB
Before interleave = 20050.17285 MB
After interleave = 20050.46973 MB
After matmul = 20050.47119 MB
Before local copies matmul = 20050.47119 MB
After local copies = 20050.47363 MB
fter compute chunk allocated = 20050.16504 MB
Memory after cuda sdpa 20050.1728515625 MB
1
Memory before offload  20050.1513671875 MB
Memory after offload  20050.1513671875 MB
Memory before cuda sdpa 20050.1650390625 MB
On entering CUDA sdpa main function  allocated = 20050.16504 MB
Before first SDPA allocated = 20050.16504 MB
On chunked entry = 20050.16504 MB
On scale calculation = 20050.17285 MB
Before interleave = 20050.17285 MB
After interleave = 20050.67285 MB
After matmul = 20058.79980 MB
Before local copies matmul = 20058.79980 MB
After local copies = 20058.80273 MB
After first SDPA allocated = 20058.29004 MB
After first copy allocated = 20058.29004 MB
On chunked entry = 20058.29004 MB
On scale calculation = 20058.29785 MB
Before interleave = 20058.29785 MB
After interleave = 20058.59473 MB
After matmul = 20058.59619 MB
Before local copies matmul = 20058.59619 MB
After local copies = 20058.59863 MB
fter compute chunk allocated = 20058.29004 MB
Memory after cuda sdpa 20058.2978515625 MB
1
Memory before offload  20058.2763671875 MB
Memory after offload  20058.2763671875 MB
Memory before cuda sdpa 20058.2900390625 MB
On entering CUDA sdpa main function  allocated = 20058.29004 MB
Before first SDPA allocated = 20058.29004 MB
On chunked entry = 20058.29004 MB
On scale calculation = 20058.29785 MB
Before interleave = 20058.29785 MB
After interleave = 20058.79785 MB
After matmul = 20066.92480 MB
Before local copies matmul = 20066.92480 MB
After local copies = 20066.92773 MB
After first SDPA allocated = 20066.41504 MB
After first copy allocated = 20066.41504 MB
On chunked entry = 20066.41504 MB
On scale calculation = 20066.42285 MB
Before interleave = 20066.42285 MB
After interleave = 20066.71973 MB
After matmul = 20066.72119 MB
Before local copies matmul = 20066.72119 MB
After local copies = 20066.72363 MB
fter compute chunk allocated = 20066.41504 MB
Memory after cuda sdpa 20066.4228515625 MB
1
Memory before offload  20066.4013671875 MB
Memory after offload  20066.4013671875 MB
Memory before cuda sdpa 20066.4150390625 MB
On entering CUDA sdpa main function  allocated = 20066.41504 MB
Before first SDPA allocated = 20066.41504 MB
On chunked entry = 20066.41504 MB
On scale calculation = 20066.42285 MB
Before interleave = 20066.42285 MB
After interleave = 20066.92285 MB
After matmul = 20075.04980 MB
Before local copies matmul = 20075.04980 MB
After local copies = 20075.05273 MB
After first SDPA allocated = 20074.54004 MB
After first copy allocated = 20074.54004 MB
On chunked entry = 20074.54004 MB
On scale calculation = 20074.54785 MB
Before interleave = 20074.54785 MB
After interleave = 20074.84473 MB
After matmul = 20074.84619 MB
Before local copies matmul = 20074.84619 MB
After local copies = 20074.84863 MB
fter compute chunk allocated = 20074.54004 MB
Memory after cuda sdpa 20074.5478515625 MB
1
Memory before offload  20074.5263671875 MB
Memory after offload  20074.5263671875 MB
Memory before cuda sdpa 20074.5400390625 MB
On entering CUDA sdpa main function  allocated = 20074.54004 MB
Before first SDPA allocated = 20074.54004 MB
On chunked entry = 20074.54004 MB
On scale calculation = 20074.54785 MB
Before interleave = 20074.54785 MB
After interleave = 20075.04785 MB
After matmul = 20083.17480 MB
Before local copies matmul = 20083.17480 MB
After local copies = 20083.17773 MB
After first SDPA allocated = 20082.66504 MB
After first copy allocated = 20082.66504 MB
On chunked entry = 20082.66504 MB
On scale calculation = 20082.67285 MB
Before interleave = 20082.67285 MB
After interleave = 20082.96973 MB
After matmul = 20082.97119 MB
Before local copies matmul = 20082.97119 MB
After local copies = 20082.97363 MB
fter compute chunk allocated = 20082.66504 MB
Memory after cuda sdpa 20082.6728515625 MB
1
Memory before offload  20082.6513671875 MB
Memory after offload  20082.6513671875 MB
Memory before cuda sdpa 20082.6650390625 MB
On entering CUDA sdpa main function  allocated = 20082.66504 MB
Before first SDPA allocated = 20082.66504 MB
On chunked entry = 20082.66504 MB
On scale calculation = 20082.67285 MB
Before interleave = 20082.67285 MB
After interleave = 20083.17285 MB
After matmul = 20091.29980 MB
Before local copies matmul = 20091.29980 MB
After local copies = 20091.30273 MB
After first SDPA allocated = 20090.79004 MB
After first copy allocated = 20090.79004 MB
On chunked entry = 20090.79004 MB
On scale calculation = 20090.79785 MB
Before interleave = 20090.79785 MB
After interleave = 20091.09473 MB
After matmul = 20091.09619 MB
Before local copies matmul = 20091.09619 MB
After local copies = 20091.09863 MB
fter compute chunk allocated = 20090.79004 MB
Memory after cuda sdpa 20090.7978515625 MB
1
Memory before offload  20090.7763671875 MB
Memory after offload  20090.7763671875 MB
Memory before cuda sdpa 20090.7900390625 MB
On entering CUDA sdpa main function  allocated = 20090.79004 MB
Before first SDPA allocated = 20090.79004 MB
On chunked entry = 20090.79004 MB
On scale calculation = 20090.79785 MB
Before interleave = 20090.79785 MB
After interleave = 20091.29785 MB
After matmul = 20099.42480 MB
Before local copies matmul = 20099.42480 MB
After local copies = 20099.42773 MB
After first SDPA allocated = 20098.91504 MB
After first copy allocated = 20098.91504 MB
On chunked entry = 20098.91504 MB
On scale calculation = 20098.92285 MB
Before interleave = 20098.92285 MB
After interleave = 20099.21973 MB
After matmul = 20099.22119 MB
Before local copies matmul = 20099.22119 MB
After local copies = 20099.22363 MB
fter compute chunk allocated = 20098.91504 MB
Memory after cuda sdpa 20098.9228515625 MB
1
Memory before offload  20098.9013671875 MB
Memory after offload  20098.9013671875 MB
Memory before cuda sdpa 20098.9150390625 MB
On entering CUDA sdpa main function  allocated = 20098.91504 MB
Before first SDPA allocated = 20098.91504 MB
On chunked entry = 20098.91504 MB
On scale calculation = 20098.92285 MB
Before interleave = 20098.92285 MB
After interleave = 20099.42285 MB
After matmul = 20107.54980 MB
Before local copies matmul = 20107.54980 MB
After local copies = 20107.55273 MB
After first SDPA allocated = 20107.04004 MB
After first copy allocated = 20107.04004 MB
On chunked entry = 20107.04004 MB
On scale calculation = 20107.04785 MB
Before interleave = 20107.04785 MB
After interleave = 20107.34473 MB
After matmul = 20107.34619 MB
Before local copies matmul = 20107.34619 MB
After local copies = 20107.34863 MB
fter compute chunk allocated = 20107.04004 MB
Memory after cuda sdpa 20107.0478515625 MB
1
Memory before offload  20107.0263671875 MB
Memory after offload  20107.0263671875 MB
Memory before cuda sdpa 20107.0400390625 MB
On entering CUDA sdpa main function  allocated = 20107.04004 MB
Before first SDPA allocated = 20107.04004 MB
On chunked entry = 20107.04004 MB
On scale calculation = 20107.04785 MB
Before interleave = 20107.04785 MB
After interleave = 20107.54785 MB
After matmul = 20115.67480 MB
Before local copies matmul = 20115.67480 MB
After local copies = 20115.67773 MB
After first SDPA allocated = 20115.16504 MB
After first copy allocated = 20115.16504 MB
On chunked entry = 20115.16504 MB
On scale calculation = 20115.17285 MB
Before interleave = 20115.17285 MB
After interleave = 20115.46973 MB
After matmul = 20115.47119 MB
Before local copies matmul = 20115.47119 MB
After local copies = 20115.47363 MB
fter compute chunk allocated = 20115.16504 MB
Memory after cuda sdpa 20115.1728515625 MB
1
Memory before offload  20115.1513671875 MB
Memory after offload  20115.1513671875 MB
Memory before cuda sdpa 20115.1650390625 MB
On entering CUDA sdpa main function  allocated = 20115.16504 MB
Before first SDPA allocated = 20115.16504 MB
On chunked entry = 20115.16504 MB
On scale calculation = 20115.17285 MB
Before interleave = 20115.17285 MB
After interleave = 20115.67285 MB
After matmul = 20123.79980 MB
Before local copies matmul = 20123.79980 MB
After local copies = 20123.80273 MB
After first SDPA allocated = 20123.29004 MB
After first copy allocated = 20123.29004 MB
On chunked entry = 20123.29004 MB
On scale calculation = 20123.29785 MB
Before interleave = 20123.29785 MB
After interleave = 20123.59473 MB
After matmul = 20123.59619 MB
Before local copies matmul = 20123.59619 MB
After local copies = 20123.59863 MB
fter compute chunk allocated = 20123.29004 MB
Memory after cuda sdpa 20123.2978515625 MB
1
Memory before offload  20123.2763671875 MB
Memory after offload  20123.2763671875 MB
Memory before cuda sdpa 20123.2900390625 MB
On entering CUDA sdpa main function  allocated = 20123.29004 MB
Before first SDPA allocated = 20123.29004 MB
On chunked entry = 20123.29004 MB
On scale calculation = 20123.29785 MB
Before interleave = 20123.29785 MB
After interleave = 20123.79785 MB
After matmul = 20131.92480 MB
Before local copies matmul = 20131.92480 MB
After local copies = 20131.92773 MB
After first SDPA allocated = 20131.41504 MB
After first copy allocated = 20131.41504 MB
On chunked entry = 20131.41504 MB
On scale calculation = 20131.42285 MB
Before interleave = 20131.42285 MB
After interleave = 20131.71973 MB
After matmul = 20131.72119 MB
Before local copies matmul = 20131.72119 MB
After local copies = 20131.72363 MB
fter compute chunk allocated = 20131.41504 MB
Memory after cuda sdpa 20131.4228515625 MB
1
Memory before offload  20131.4013671875 MB
Memory after offload  20131.4013671875 MB
Memory before cuda sdpa 20131.4150390625 MB
On entering CUDA sdpa main function  allocated = 20131.41504 MB
Before first SDPA allocated = 20131.41504 MB
On chunked entry = 20131.41504 MB
On scale calculation = 20131.42285 MB
Before interleave = 20131.42285 MB
After interleave = 20131.92285 MB
After matmul = 20140.04980 MB
Before local copies matmul = 20140.04980 MB
After local copies = 20140.05273 MB
After first SDPA allocated = 20139.54004 MB
After first copy allocated = 20139.54004 MB
On chunked entry = 20139.54004 MB
On scale calculation = 20139.54785 MB
Before interleave = 20139.54785 MB
After interleave = 20139.84473 MB
After matmul = 20139.84619 MB
Before local copies matmul = 20139.84619 MB
After local copies = 20139.84863 MB
fter compute chunk allocated = 20139.54004 MB
Memory after cuda sdpa 20139.5478515625 MB
1
Memory before offload  20139.5263671875 MB
Memory after offload  20139.5263671875 MB
Memory before cuda sdpa 20139.5400390625 MB
On entering CUDA sdpa main function  allocated = 20139.54004 MB
Before first SDPA allocated = 20139.54004 MB
On chunked entry = 20139.54004 MB
On scale calculation = 20139.54785 MB
Before interleave = 20139.54785 MB
After interleave = 20140.04785 MB
After matmul = 20148.17480 MB
Before local copies matmul = 20148.17480 MB
After local copies = 20148.17773 MB
After first SDPA allocated = 20147.66504 MB
After first copy allocated = 20147.66504 MB
On chunked entry = 20147.66504 MB
On scale calculation = 20147.67285 MB
Before interleave = 20147.67285 MB
After interleave = 20147.96973 MB
After matmul = 20147.97119 MB
Before local copies matmul = 20147.97119 MB
After local copies = 20147.97363 MB
fter compute chunk allocated = 20147.66504 MB
Memory after cuda sdpa 20147.6728515625 MB
1
Memory before offload  20147.6513671875 MB
Memory after offload  20147.6513671875 MB
Memory before cuda sdpa 20147.6650390625 MB
On entering CUDA sdpa main function  allocated = 20147.66504 MB
Before first SDPA allocated = 20147.66504 MB
On chunked entry = 20147.66504 MB
On scale calculation = 20147.67285 MB
Before interleave = 20147.67285 MB
After interleave = 20148.17285 MB
After matmul = 20156.29980 MB
Before local copies matmul = 20156.29980 MB
After local copies = 20156.30273 MB
After first SDPA allocated = 20155.79004 MB
After first copy allocated = 20155.79004 MB
On chunked entry = 20155.79004 MB
On scale calculation = 20155.79785 MB
Before interleave = 20155.79785 MB
After interleave = 20156.09473 MB
After matmul = 20156.09619 MB
Before local copies matmul = 20156.09619 MB
After local copies = 20156.09863 MB
fter compute chunk allocated = 20155.79004 MB
Memory after cuda sdpa 20155.7978515625 MB
1
Memory before offload  20155.7763671875 MB
Memory after offload  20155.7763671875 MB
Memory before cuda sdpa 20155.7900390625 MB
On entering CUDA sdpa main function  allocated = 20155.79004 MB
Before first SDPA allocated = 20155.79004 MB
On chunked entry = 20155.79004 MB
On scale calculation = 20155.79785 MB
Before interleave = 20155.79785 MB
After interleave = 20156.29785 MB
After matmul = 20164.42480 MB
Before local copies matmul = 20164.42480 MB
After local copies = 20164.42773 MB
After first SDPA allocated = 20163.91504 MB
After first copy allocated = 20163.91504 MB
On chunked entry = 20163.91504 MB
On scale calculation = 20163.92285 MB
Before interleave = 20163.92285 MB
After interleave = 20164.21973 MB
After matmul = 20164.22119 MB
Before local copies matmul = 20164.22119 MB
After local copies = 20164.22363 MB
fter compute chunk allocated = 20163.91504 MB
Memory after cuda sdpa 20163.9228515625 MB
1
Memory before offload  20163.9013671875 MB
Memory after offload  20163.9013671875 MB
Memory before cuda sdpa 20163.9150390625 MB
On entering CUDA sdpa main function  allocated = 20163.91504 MB
Before first SDPA allocated = 20163.91504 MB
On chunked entry = 20163.91504 MB
On scale calculation = 20163.92285 MB
Before interleave = 20163.92285 MB
After interleave = 20164.42285 MB
After matmul = 20172.54980 MB
Before local copies matmul = 20172.54980 MB
After local copies = 20172.55273 MB
After first SDPA allocated = 20172.04004 MB
After first copy allocated = 20172.04004 MB
On chunked entry = 20172.04004 MB
On scale calculation = 20172.04785 MB
Before interleave = 20172.04785 MB
After interleave = 20172.34473 MB
After matmul = 20172.34619 MB
Before local copies matmul = 20172.34619 MB
After local copies = 20172.34863 MB
fter compute chunk allocated = 20172.04004 MB
Memory after cuda sdpa 20172.0478515625 MB
1
Memory before offload  20172.0263671875 MB
Memory after offload  20172.0263671875 MB
Memory before cuda sdpa 20172.0400390625 MB
On entering CUDA sdpa main function  allocated = 20172.04004 MB
Before first SDPA allocated = 20172.04004 MB
On chunked entry = 20172.04004 MB
On scale calculation = 20172.04785 MB
Before interleave = 20172.04785 MB
After interleave = 20172.54785 MB
After matmul = 20180.67480 MB
Before local copies matmul = 20180.67480 MB
After local copies = 20180.67773 MB
After first SDPA allocated = 20180.16504 MB
After first copy allocated = 20180.16504 MB
On chunked entry = 20180.16504 MB
On scale calculation = 20180.17285 MB
Before interleave = 20180.17285 MB
After interleave = 20180.46973 MB
After matmul = 20180.47119 MB
Before local copies matmul = 20180.47119 MB
After local copies = 20180.47363 MB
fter compute chunk allocated = 20180.16504 MB
Memory after cuda sdpa 20180.1728515625 MB
1
Memory before offload  20180.1513671875 MB
Memory after offload  20180.1513671875 MB
Memory before cuda sdpa 20180.1650390625 MB
On entering CUDA sdpa main function  allocated = 20180.16504 MB
Before first SDPA allocated = 20180.16504 MB
On chunked entry = 20180.16504 MB
On scale calculation = 20180.17285 MB
Before interleave = 20180.17285 MB
After interleave = 20180.67285 MB
After matmul = 20188.79980 MB
Before local copies matmul = 20188.79980 MB
After local copies = 20188.80273 MB
After first SDPA allocated = 20188.29004 MB
After first copy allocated = 20188.29004 MB
On chunked entry = 20188.29004 MB
On scale calculation = 20188.29785 MB
Before interleave = 20188.29785 MB
After interleave = 20188.59473 MB
After matmul = 20188.59619 MB
Before local copies matmul = 20188.59619 MB
After local copies = 20188.59863 MB
fter compute chunk allocated = 20188.29004 MB
Memory after cuda sdpa 20188.2978515625 MB
1
Memory before offload  20188.2763671875 MB
Memory after offload  20188.2763671875 MB
Memory before cuda sdpa 20188.2900390625 MB
On entering CUDA sdpa main function  allocated = 20188.29004 MB
Before first SDPA allocated = 20188.29004 MB
On chunked entry = 20188.29004 MB
On scale calculation = 20188.29785 MB
Before interleave = 20188.29785 MB
After interleave = 20188.79785 MB
After matmul = 20196.92480 MB
Before local copies matmul = 20196.92480 MB
After local copies = 20196.92773 MB
After first SDPA allocated = 20196.41504 MB
After first copy allocated = 20196.41504 MB
On chunked entry = 20196.41504 MB
On scale calculation = 20196.42285 MB
Before interleave = 20196.42285 MB
After interleave = 20196.71973 MB
After matmul = 20196.72119 MB
Before local copies matmul = 20196.72119 MB
After local copies = 20196.72363 MB
fter compute chunk allocated = 20196.41504 MB
Memory after cuda sdpa 20196.4228515625 MB
1
Memory before offload  20196.4013671875 MB
Memory after offload  20196.4013671875 MB
Memory before cuda sdpa 20196.4150390625 MB
On entering CUDA sdpa main function  allocated = 20196.41504 MB
Before first SDPA allocated = 20196.41504 MB
On chunked entry = 20196.41504 MB
On scale calculation = 20196.42285 MB
Before interleave = 20196.42285 MB
After interleave = 20196.92285 MB
After matmul = 20205.04980 MB
Before local copies matmul = 20205.04980 MB
After local copies = 20205.05273 MB
After first SDPA allocated = 20204.54004 MB
After first copy allocated = 20204.54004 MB
On chunked entry = 20204.54004 MB
On scale calculation = 20204.54785 MB
Before interleave = 20204.54785 MB
After interleave = 20204.84473 MB
After matmul = 20204.84619 MB
Before local copies matmul = 20204.84619 MB
After local copies = 20204.84863 MB
fter compute chunk allocated = 20204.54004 MB
Memory after cuda sdpa 20204.5478515625 MB
1
Memory before offload  20204.5263671875 MB
Memory after offload  20204.5263671875 MB
Memory before cuda sdpa 20204.5400390625 MB
On entering CUDA sdpa main function  allocated = 20204.54004 MB
Before first SDPA allocated = 20204.54004 MB
On chunked entry = 20204.54004 MB
On scale calculation = 20204.54785 MB
Before interleave = 20204.54785 MB
After interleave = 20205.04785 MB
After matmul = 20213.17480 MB
Before local copies matmul = 20213.17480 MB
After local copies = 20213.17773 MB
After first SDPA allocated = 20212.66504 MB
After first copy allocated = 20212.66504 MB
On chunked entry = 20212.66504 MB
On scale calculation = 20212.67285 MB
Before interleave = 20212.67285 MB
After interleave = 20212.96973 MB
After matmul = 20212.97119 MB
Before local copies matmul = 20212.97119 MB
After local copies = 20212.97363 MB
fter compute chunk allocated = 20212.66504 MB
Memory after cuda sdpa 20212.6728515625 MB
1
Memory before offload  20212.6513671875 MB
Memory after offload  20212.6513671875 MB
Memory before cuda sdpa 20212.6650390625 MB
On entering CUDA sdpa main function  allocated = 20212.66504 MB
Before first SDPA allocated = 20212.66504 MB
On chunked entry = 20212.66504 MB
On scale calculation = 20212.67285 MB
Before interleave = 20212.67285 MB
After interleave = 20213.17285 MB
After matmul = 20221.29980 MB
Before local copies matmul = 20221.29980 MB
After local copies = 20221.30273 MB
After first SDPA allocated = 20220.79004 MB
After first copy allocated = 20220.79004 MB
On chunked entry = 20220.79004 MB
On scale calculation = 20220.79785 MB
Before interleave = 20220.79785 MB
After interleave = 20221.09473 MB
After matmul = 20221.09619 MB
Before local copies matmul = 20221.09619 MB
After local copies = 20221.09863 MB
fter compute chunk allocated = 20220.79004 MB
Memory after cuda sdpa 20220.7978515625 MB
1
Memory before offload  20220.7763671875 MB
Memory after offload  20220.7763671875 MB
Memory before cuda sdpa 20220.7900390625 MB
On entering CUDA sdpa main function  allocated = 20220.79004 MB
Before first SDPA allocated = 20220.79004 MB
On chunked entry = 20220.79004 MB
On scale calculation = 20220.79785 MB
Before interleave = 20220.79785 MB
After interleave = 20221.29785 MB
After matmul = 20229.42480 MB
Before local copies matmul = 20229.42480 MB
After local copies = 20229.42773 MB
After first SDPA allocated = 20228.91504 MB
After first copy allocated = 20228.91504 MB
On chunked entry = 20228.91504 MB
On scale calculation = 20228.92285 MB
Before interleave = 20228.92285 MB
After interleave = 20229.21973 MB
After matmul = 20229.22119 MB
Before local copies matmul = 20229.22119 MB
After local copies = 20229.22363 MB
fter compute chunk allocated = 20228.91504 MB
Memory after cuda sdpa 20228.9228515625 MB
1
Memory before offload  20228.9013671875 MB
Memory after offload  20228.9013671875 MB
Memory before cuda sdpa 20228.9150390625 MB
On entering CUDA sdpa main function  allocated = 20228.91504 MB
Before first SDPA allocated = 20228.91504 MB
On chunked entry = 20228.91504 MB
On scale calculation = 20228.92285 MB
Before interleave = 20228.92285 MB
After interleave = 20229.42285 MB
After matmul = 20237.54980 MB
Before local copies matmul = 20237.54980 MB
After local copies = 20237.55273 MB
After first SDPA allocated = 20237.04004 MB
After first copy allocated = 20237.04004 MB
On chunked entry = 20237.04004 MB
On scale calculation = 20237.04785 MB
Before interleave = 20237.04785 MB
After interleave = 20237.34473 MB
After matmul = 20237.34619 MB
Before local copies matmul = 20237.34619 MB
After local copies = 20237.34863 MB
fter compute chunk allocated = 20237.04004 MB
Memory after cuda sdpa 20237.0478515625 MB
1
Memory before offload  20237.0263671875 MB
Memory after offload  20237.0263671875 MB
Memory before cuda sdpa 20237.0400390625 MB
On entering CUDA sdpa main function  allocated = 20237.04004 MB
Before first SDPA allocated = 20237.04004 MB
On chunked entry = 20237.04004 MB
On scale calculation = 20237.04785 MB
Before interleave = 20237.04785 MB
After interleave = 20237.54785 MB
After matmul = 20245.67480 MB
Before local copies matmul = 20245.67480 MB
After local copies = 20245.67773 MB
After first SDPA allocated = 20245.16504 MB
After first copy allocated = 20245.16504 MB
On chunked entry = 20245.16504 MB
On scale calculation = 20245.17285 MB
Before interleave = 20245.17285 MB
After interleave = 20245.46973 MB
After matmul = 20245.47119 MB
Before local copies matmul = 20245.47119 MB
After local copies = 20245.47363 MB
fter compute chunk allocated = 20245.16504 MB
Memory after cuda sdpa 20245.1728515625 MB
1
Memory before offload  20245.1513671875 MB
Memory after offload  20245.1513671875 MB
Memory before cuda sdpa 20245.1650390625 MB
On entering CUDA sdpa main function  allocated = 20245.16504 MB
Before first SDPA allocated = 20245.16504 MB
On chunked entry = 20245.16504 MB
On scale calculation = 20245.17285 MB
Before interleave = 20245.17285 MB
After interleave = 20245.67285 MB
After matmul = 20253.79980 MB
Before local copies matmul = 20253.79980 MB
After local copies = 20253.80273 MB
After first SDPA allocated = 20253.29004 MB
After first copy allocated = 20253.29004 MB
On chunked entry = 20253.29004 MB
On scale calculation = 20253.29785 MB
Before interleave = 20253.29785 MB
After interleave = 20253.59473 MB
After matmul = 20253.59619 MB
Before local copies matmul = 20253.59619 MB
After local copies = 20253.59863 MB
fter compute chunk allocated = 20253.29004 MB
Memory after cuda sdpa 20253.2978515625 MB
1
Memory before offload  20253.2763671875 MB
Memory after offload  20253.2763671875 MB
Memory before cuda sdpa 20253.2900390625 MB
On entering CUDA sdpa main function  allocated = 20253.29004 MB
Before first SDPA allocated = 20253.29004 MB
On chunked entry = 20253.29004 MB
On scale calculation = 20253.29785 MB
Before interleave = 20253.29785 MB
After interleave = 20253.79785 MB
After matmul = 20261.92480 MB
Before local copies matmul = 20261.92480 MB
After local copies = 20261.92773 MB
After first SDPA allocated = 20261.41504 MB
After first copy allocated = 20261.41504 MB
On chunked entry = 20261.41504 MB
On scale calculation = 20261.42285 MB
Before interleave = 20261.42285 MB
After interleave = 20261.71973 MB
After matmul = 20261.72119 MB
Before local copies matmul = 20261.72119 MB
After local copies = 20261.72363 MB
fter compute chunk allocated = 20261.41504 MB
Memory after cuda sdpa 20261.4228515625 MB
1
Memory before offload  20261.4013671875 MB
Memory after offload  20261.4013671875 MB
Memory before cuda sdpa 20261.4150390625 MB
On entering CUDA sdpa main function  allocated = 20261.41504 MB
Before first SDPA allocated = 20261.41504 MB
On chunked entry = 20261.41504 MB
On scale calculation = 20261.42285 MB
Before interleave = 20261.42285 MB
After interleave = 20261.92285 MB
After matmul = 20270.04980 MB
Before local copies matmul = 20270.04980 MB
After local copies = 20270.05273 MB
After first SDPA allocated = 20269.54004 MB
After first copy allocated = 20269.54004 MB
On chunked entry = 20269.54004 MB
On scale calculation = 20269.54785 MB
Before interleave = 20269.54785 MB
After interleave = 20269.84473 MB
After matmul = 20269.84619 MB
Before local copies matmul = 20269.84619 MB
After local copies = 20269.84863 MB
fter compute chunk allocated = 20269.54004 MB
Memory after cuda sdpa 20269.5478515625 MB
1
Memory before offload  20269.5263671875 MB
Memory after offload  20269.5263671875 MB
Memory before cuda sdpa 20269.5400390625 MB
On entering CUDA sdpa main function  allocated = 20269.54004 MB
Before first SDPA allocated = 20269.54004 MB
On chunked entry = 20269.54004 MB
On scale calculation = 20269.54785 MB
Before interleave = 20269.54785 MB
After interleave = 20270.04785 MB
After matmul = 20278.17480 MB
Before local copies matmul = 20278.17480 MB
After local copies = 20278.17773 MB
After first SDPA allocated = 20277.66504 MB
After first copy allocated = 20277.66504 MB
On chunked entry = 20277.66504 MB
On scale calculation = 20277.67285 MB
Before interleave = 20277.67285 MB
After interleave = 20277.96973 MB
After matmul = 20277.97119 MB
Before local copies matmul = 20277.97119 MB
After local copies = 20277.97363 MB
fter compute chunk allocated = 20277.66504 MB
Memory after cuda sdpa 20277.6728515625 MB
1
Memory before offload  20277.6513671875 MB
Memory after offload  20277.6513671875 MB
Memory before cuda sdpa 20277.6650390625 MB
On entering CUDA sdpa main function  allocated = 20277.66504 MB
Before first SDPA allocated = 20277.66504 MB
On chunked entry = 20277.66504 MB
On scale calculation = 20277.67285 MB
Before interleave = 20277.67285 MB
After interleave = 20278.17285 MB
After matmul = 20286.29980 MB
Before local copies matmul = 20286.29980 MB
After local copies = 20286.30273 MB
After first SDPA allocated = 20285.79004 MB
After first copy allocated = 20285.79004 MB
On chunked entry = 20285.79004 MB
On scale calculation = 20285.79785 MB
Before interleave = 20285.79785 MB
After interleave = 20286.09473 MB
After matmul = 20286.09619 MB
Before local copies matmul = 20286.09619 MB
After local copies = 20286.09863 MB
fter compute chunk allocated = 20285.79004 MB
Memory after cuda sdpa 20285.7978515625 MB
Decode step 20
1
Memory before offload  20285.77685546875 MB
Memory after offload  20285.77685546875 MB
Memory before cuda sdpa 20285.79052734375 MB
On entering CUDA sdpa main function  allocated = 20285.79053 MB
Before first SDPA allocated = 20285.79053 MB
On chunked entry = 20285.79053 MB
On scale calculation = 20285.79834 MB
Before interleave = 20285.79834 MB
After interleave = 20286.29834 MB
After matmul = 20294.42529 MB
Before local copies matmul = 20294.42529 MB
After local copies = 20294.42822 MB
After first SDPA allocated = 20293.91553 MB
After first copy allocated = 20293.91553 MB
On chunked entry = 20293.91553 MB
On scale calculation = 20293.92334 MB
Before interleave = 20293.92334 MB
After interleave = 20294.23584 MB
After matmul = 20294.23730 MB
Before local copies matmul = 20294.23730 MB
After local copies = 20294.23975 MB
fter compute chunk allocated = 20293.91553 MB
Memory after cuda sdpa 20293.92333984375 MB
1
Memory before offload  20293.90185546875 MB
Memory after offload  20293.90185546875 MB
Memory before cuda sdpa 20293.91552734375 MB
On entering CUDA sdpa main function  allocated = 20293.91553 MB
Before first SDPA allocated = 20293.91553 MB
On chunked entry = 20293.91553 MB
On scale calculation = 20293.92334 MB
Before interleave = 20293.92334 MB
After interleave = 20294.42334 MB
After matmul = 20302.55029 MB
Before local copies matmul = 20302.55029 MB
After local copies = 20302.55322 MB
After first SDPA allocated = 20302.04053 MB
After first copy allocated = 20302.04053 MB
On chunked entry = 20302.04053 MB
On scale calculation = 20302.04834 MB
Before interleave = 20302.04834 MB
After interleave = 20302.36084 MB
After matmul = 20302.36230 MB
Before local copies matmul = 20302.36230 MB
After local copies = 20302.36475 MB
fter compute chunk allocated = 20302.04053 MB
Memory after cuda sdpa 20302.04833984375 MB
1
Memory before offload  20302.02685546875 MB
Memory after offload  20302.02685546875 MB
Memory before cuda sdpa 20302.04052734375 MB
On entering CUDA sdpa main function  allocated = 20302.04053 MB
Before first SDPA allocated = 20302.04053 MB
On chunked entry = 20302.04053 MB
On scale calculation = 20302.04834 MB
Before interleave = 20302.04834 MB
After interleave = 20302.54834 MB
After matmul = 20310.67529 MB
Before local copies matmul = 20310.67529 MB
After local copies = 20310.67822 MB
After first SDPA allocated = 20310.16553 MB
After first copy allocated = 20310.16553 MB
On chunked entry = 20310.16553 MB
On scale calculation = 20310.17334 MB
Before interleave = 20310.17334 MB
After interleave = 20310.48584 MB
After matmul = 20310.48730 MB
Before local copies matmul = 20310.48730 MB
After local copies = 20310.48975 MB
fter compute chunk allocated = 20310.16553 MB
Memory after cuda sdpa 20310.17333984375 MB
1
Memory before offload  20310.15185546875 MB
Memory after offload  20310.15185546875 MB
Memory before cuda sdpa 20310.16552734375 MB
On entering CUDA sdpa main function  allocated = 20310.16553 MB
Before first SDPA allocated = 20310.16553 MB
On chunked entry = 20310.16553 MB
On scale calculation = 20310.17334 MB
Before interleave = 20310.17334 MB
After interleave = 20310.67334 MB
After matmul = 20318.80029 MB
Before local copies matmul = 20318.80029 MB
After local copies = 20318.80322 MB
After first SDPA allocated = 20318.29053 MB
After first copy allocated = 20318.29053 MB
On chunked entry = 20318.29053 MB
On scale calculation = 20318.29834 MB
Before interleave = 20318.29834 MB
After interleave = 20318.61084 MB
After matmul = 20318.61230 MB
Before local copies matmul = 20318.61230 MB
After local copies = 20318.61475 MB
fter compute chunk allocated = 20318.29053 MB
Memory after cuda sdpa 20318.29833984375 MB
1
Memory before offload  20318.27685546875 MB
Memory after offload  20318.27685546875 MB
Memory before cuda sdpa 20318.29052734375 MB
On entering CUDA sdpa main function  allocated = 20318.29053 MB
Before first SDPA allocated = 20318.29053 MB
On chunked entry = 20318.29053 MB
On scale calculation = 20318.29834 MB
Before interleave = 20318.29834 MB
After interleave = 20318.79834 MB
After matmul = 20326.92529 MB
Before local copies matmul = 20326.92529 MB
After local copies = 20326.92822 MB
After first SDPA allocated = 20326.41553 MB
After first copy allocated = 20326.41553 MB
On chunked entry = 20326.41553 MB
On scale calculation = 20326.42334 MB
Before interleave = 20326.42334 MB
After interleave = 20326.73584 MB
After matmul = 20326.73730 MB
Before local copies matmul = 20326.73730 MB
After local copies = 20326.73975 MB
fter compute chunk allocated = 20326.41553 MB
Memory after cuda sdpa 20326.42333984375 MB
1
Memory before offload  20326.40185546875 MB
Memory after offload  20326.40185546875 MB
Memory before cuda sdpa 20326.41552734375 MB
On entering CUDA sdpa main function  allocated = 20326.41553 MB
Before first SDPA allocated = 20326.41553 MB
On chunked entry = 20326.41553 MB
On scale calculation = 20326.42334 MB
Before interleave = 20326.42334 MB
After interleave = 20326.92334 MB
After matmul = 20335.05029 MB
Before local copies matmul = 20335.05029 MB
After local copies = 20335.05322 MB
After first SDPA allocated = 20334.54053 MB
After first copy allocated = 20334.54053 MB
On chunked entry = 20334.54053 MB
On scale calculation = 20334.54834 MB
Before interleave = 20334.54834 MB
After interleave = 20334.86084 MB
After matmul = 20334.86230 MB
Before local copies matmul = 20334.86230 MB
After local copies = 20334.86475 MB
fter compute chunk allocated = 20334.54053 MB
Memory after cuda sdpa 20334.54833984375 MB
1
Memory before offload  20334.52685546875 MB
Memory after offload  20334.52685546875 MB
Memory before cuda sdpa 20334.54052734375 MB
On entering CUDA sdpa main function  allocated = 20334.54053 MB
Before first SDPA allocated = 20334.54053 MB
On chunked entry = 20334.54053 MB
On scale calculation = 20334.54834 MB
Before interleave = 20334.54834 MB
After interleave = 20335.04834 MB
After matmul = 20343.17529 MB
Before local copies matmul = 20343.17529 MB
After local copies = 20343.17822 MB
After first SDPA allocated = 20342.66553 MB
After first copy allocated = 20342.66553 MB
On chunked entry = 20342.66553 MB
On scale calculation = 20342.67334 MB
Before interleave = 20342.67334 MB
After interleave = 20342.98584 MB
After matmul = 20342.98730 MB
Before local copies matmul = 20342.98730 MB
After local copies = 20342.98975 MB
fter compute chunk allocated = 20342.66553 MB
Memory after cuda sdpa 20342.67333984375 MB
1
Memory before offload  20342.65185546875 MB
Memory after offload  20342.65185546875 MB
Memory before cuda sdpa 20342.66552734375 MB
On entering CUDA sdpa main function  allocated = 20342.66553 MB
Before first SDPA allocated = 20342.66553 MB
On chunked entry = 20342.66553 MB
On scale calculation = 20342.67334 MB
Before interleave = 20342.67334 MB
After interleave = 20343.17334 MB
After matmul = 20351.30029 MB
Before local copies matmul = 20351.30029 MB
After local copies = 20351.30322 MB
After first SDPA allocated = 20350.79053 MB
After first copy allocated = 20350.79053 MB
On chunked entry = 20350.79053 MB
On scale calculation = 20350.79834 MB
Before interleave = 20350.79834 MB
After interleave = 20351.11084 MB
After matmul = 20351.11230 MB
Before local copies matmul = 20351.11230 MB
After local copies = 20351.11475 MB
fter compute chunk allocated = 20350.79053 MB
Memory after cuda sdpa 20350.79833984375 MB
1
Memory before offload  20350.77685546875 MB
Memory after offload  20350.77685546875 MB
Memory before cuda sdpa 20350.79052734375 MB
On entering CUDA sdpa main function  allocated = 20350.79053 MB
Before first SDPA allocated = 20350.79053 MB
On chunked entry = 20350.79053 MB
On scale calculation = 20350.79834 MB
Before interleave = 20350.79834 MB
After interleave = 20351.29834 MB
After matmul = 20359.42529 MB
Before local copies matmul = 20359.42529 MB
After local copies = 20359.42822 MB
After first SDPA allocated = 20358.91553 MB
After first copy allocated = 20358.91553 MB
On chunked entry = 20358.91553 MB
On scale calculation = 20358.92334 MB
Before interleave = 20358.92334 MB
After interleave = 20359.23584 MB
After matmul = 20359.23730 MB
Before local copies matmul = 20359.23730 MB
After local copies = 20359.23975 MB
fter compute chunk allocated = 20358.91553 MB
Memory after cuda sdpa 20358.92333984375 MB
1
Memory before offload  20358.90185546875 MB
Memory after offload  20358.90185546875 MB
Memory before cuda sdpa 20358.91552734375 MB
On entering CUDA sdpa main function  allocated = 20358.91553 MB
Before first SDPA allocated = 20358.91553 MB
On chunked entry = 20358.91553 MB
On scale calculation = 20358.92334 MB
Before interleave = 20358.92334 MB
After interleave = 20359.42334 MB
After matmul = 20367.55029 MB
Before local copies matmul = 20367.55029 MB
After local copies = 20367.55322 MB
After first SDPA allocated = 20367.04053 MB
After first copy allocated = 20367.04053 MB
On chunked entry = 20367.04053 MB
On scale calculation = 20367.04834 MB
Before interleave = 20367.04834 MB
After interleave = 20367.36084 MB
After matmul = 20367.36230 MB
Before local copies matmul = 20367.36230 MB
After local copies = 20367.36475 MB
fter compute chunk allocated = 20367.04053 MB
Memory after cuda sdpa 20367.04833984375 MB
1
Memory before offload  20367.02685546875 MB
Memory after offload  20367.02685546875 MB
Memory before cuda sdpa 20367.04052734375 MB
On entering CUDA sdpa main function  allocated = 20367.04053 MB
Before first SDPA allocated = 20367.04053 MB
On chunked entry = 20367.04053 MB
On scale calculation = 20367.04834 MB
Before interleave = 20367.04834 MB
After interleave = 20367.54834 MB
After matmul = 20375.67529 MB
Before local copies matmul = 20375.67529 MB
After local copies = 20375.67822 MB
After first SDPA allocated = 20375.16553 MB
After first copy allocated = 20375.16553 MB
On chunked entry = 20375.16553 MB
On scale calculation = 20375.17334 MB
Before interleave = 20375.17334 MB
After interleave = 20375.48584 MB
After matmul = 20375.48730 MB
Before local copies matmul = 20375.48730 MB
After local copies = 20375.48975 MB
fter compute chunk allocated = 20375.16553 MB
Memory after cuda sdpa 20375.17333984375 MB
1
Memory before offload  20375.15185546875 MB
Memory after offload  20375.15185546875 MB
Memory before cuda sdpa 20375.16552734375 MB
On entering CUDA sdpa main function  allocated = 20375.16553 MB
Before first SDPA allocated = 20375.16553 MB
On chunked entry = 20375.16553 MB
On scale calculation = 20375.17334 MB
Before interleave = 20375.17334 MB
After interleave = 20375.67334 MB
After matmul = 20383.80029 MB
Before local copies matmul = 20383.80029 MB
After local copies = 20383.80322 MB
After first SDPA allocated = 20383.29053 MB
After first copy allocated = 20383.29053 MB
On chunked entry = 20383.29053 MB
On scale calculation = 20383.29834 MB
Before interleave = 20383.29834 MB
After interleave = 20383.61084 MB
After matmul = 20383.61230 MB
Before local copies matmul = 20383.61230 MB
After local copies = 20383.61475 MB
fter compute chunk allocated = 20383.29053 MB
Memory after cuda sdpa 20383.29833984375 MB
1
Memory before offload  20383.27685546875 MB
Memory after offload  20383.27685546875 MB
Memory before cuda sdpa 20383.29052734375 MB
On entering CUDA sdpa main function  allocated = 20383.29053 MB
Before first SDPA allocated = 20383.29053 MB
On chunked entry = 20383.29053 MB
On scale calculation = 20383.29834 MB
Before interleave = 20383.29834 MB
After interleave = 20383.79834 MB
After matmul = 20391.92529 MB
Before local copies matmul = 20391.92529 MB
After local copies = 20391.92822 MB
After first SDPA allocated = 20391.41553 MB
After first copy allocated = 20391.41553 MB
On chunked entry = 20391.41553 MB
On scale calculation = 20391.42334 MB
Before interleave = 20391.42334 MB
After interleave = 20391.73584 MB
After matmul = 20391.73730 MB
Before local copies matmul = 20391.73730 MB
After local copies = 20391.73975 MB
fter compute chunk allocated = 20391.41553 MB
Memory after cuda sdpa 20391.42333984375 MB
1
Memory before offload  20391.40185546875 MB
Memory after offload  20391.40185546875 MB
Memory before cuda sdpa 20391.41552734375 MB
On entering CUDA sdpa main function  allocated = 20391.41553 MB
Before first SDPA allocated = 20391.41553 MB
On chunked entry = 20391.41553 MB
On scale calculation = 20391.42334 MB
Before interleave = 20391.42334 MB
After interleave = 20391.92334 MB
After matmul = 20400.05029 MB
Before local copies matmul = 20400.05029 MB
After local copies = 20400.05322 MB
After first SDPA allocated = 20399.54053 MB
After first copy allocated = 20399.54053 MB
On chunked entry = 20399.54053 MB
On scale calculation = 20399.54834 MB
Before interleave = 20399.54834 MB
After interleave = 20399.86084 MB
After matmul = 20399.86230 MB
Before local copies matmul = 20399.86230 MB
After local copies = 20399.86475 MB
fter compute chunk allocated = 20399.54053 MB
Memory after cuda sdpa 20399.54833984375 MB
1
Memory before offload  20399.52685546875 MB
Memory after offload  20399.52685546875 MB
Memory before cuda sdpa 20399.54052734375 MB
On entering CUDA sdpa main function  allocated = 20399.54053 MB
Before first SDPA allocated = 20399.54053 MB
On chunked entry = 20399.54053 MB
On scale calculation = 20399.54834 MB
Before interleave = 20399.54834 MB
After interleave = 20400.04834 MB
After matmul = 20408.17529 MB
Before local copies matmul = 20408.17529 MB
After local copies = 20408.17822 MB
After first SDPA allocated = 20407.66553 MB
After first copy allocated = 20407.66553 MB
On chunked entry = 20407.66553 MB
On scale calculation = 20407.67334 MB
Before interleave = 20407.67334 MB
After interleave = 20407.98584 MB
After matmul = 20407.98730 MB
Before local copies matmul = 20407.98730 MB
After local copies = 20407.98975 MB
fter compute chunk allocated = 20407.66553 MB
Memory after cuda sdpa 20407.67333984375 MB
1
Memory before offload  20407.65185546875 MB
Memory after offload  20407.65185546875 MB
Memory before cuda sdpa 20407.66552734375 MB
On entering CUDA sdpa main function  allocated = 20407.66553 MB
Before first SDPA allocated = 20407.66553 MB
On chunked entry = 20407.66553 MB
On scale calculation = 20407.67334 MB
Before interleave = 20407.67334 MB
After interleave = 20408.17334 MB
After matmul = 20416.30029 MB
Before local copies matmul = 20416.30029 MB
After local copies = 20416.30322 MB
After first SDPA allocated = 20415.79053 MB
After first copy allocated = 20415.79053 MB
On chunked entry = 20415.79053 MB
On scale calculation = 20415.79834 MB
Before interleave = 20415.79834 MB
After interleave = 20416.11084 MB
After matmul = 20416.11230 MB
Before local copies matmul = 20416.11230 MB
After local copies = 20416.11475 MB
fter compute chunk allocated = 20415.79053 MB
Memory after cuda sdpa 20415.79833984375 MB
1
Memory before offload  20415.77685546875 MB
Memory after offload  20415.77685546875 MB
Memory before cuda sdpa 20415.79052734375 MB
On entering CUDA sdpa main function  allocated = 20415.79053 MB
Before first SDPA allocated = 20415.79053 MB
On chunked entry = 20415.79053 MB
On scale calculation = 20415.79834 MB
Before interleave = 20415.79834 MB
After interleave = 20416.29834 MB
After matmul = 20424.42529 MB
Before local copies matmul = 20424.42529 MB
After local copies = 20424.42822 MB
After first SDPA allocated = 20423.91553 MB
After first copy allocated = 20423.91553 MB
On chunked entry = 20423.91553 MB
On scale calculation = 20423.92334 MB
Before interleave = 20423.92334 MB
After interleave = 20424.23584 MB
After matmul = 20424.23730 MB
Before local copies matmul = 20424.23730 MB
After local copies = 20424.23975 MB
fter compute chunk allocated = 20423.91553 MB
Memory after cuda sdpa 20423.92333984375 MB
1
Memory before offload  20423.90185546875 MB
Memory after offload  20423.90185546875 MB
Memory before cuda sdpa 20423.91552734375 MB
On entering CUDA sdpa main function  allocated = 20423.91553 MB
Before first SDPA allocated = 20423.91553 MB
On chunked entry = 20423.91553 MB
On scale calculation = 20423.92334 MB
Before interleave = 20423.92334 MB
After interleave = 20424.42334 MB
After matmul = 20432.55029 MB
Before local copies matmul = 20432.55029 MB
After local copies = 20432.55322 MB
After first SDPA allocated = 20432.04053 MB
After first copy allocated = 20432.04053 MB
On chunked entry = 20432.04053 MB
On scale calculation = 20432.04834 MB
Before interleave = 20432.04834 MB
After interleave = 20432.36084 MB
After matmul = 20432.36230 MB
Before local copies matmul = 20432.36230 MB
After local copies = 20432.36475 MB
fter compute chunk allocated = 20432.04053 MB
Memory after cuda sdpa 20432.04833984375 MB
1
Memory before offload  20432.02685546875 MB
Memory after offload  20432.02685546875 MB
Memory before cuda sdpa 20432.04052734375 MB
On entering CUDA sdpa main function  allocated = 20432.04053 MB
Before first SDPA allocated = 20432.04053 MB
On chunked entry = 20432.04053 MB
On scale calculation = 20432.04834 MB
Before interleave = 20432.04834 MB
After interleave = 20432.54834 MB
After matmul = 20440.67529 MB
Before local copies matmul = 20440.67529 MB
After local copies = 20440.67822 MB
After first SDPA allocated = 20440.16553 MB
After first copy allocated = 20440.16553 MB
On chunked entry = 20440.16553 MB
On scale calculation = 20440.17334 MB
Before interleave = 20440.17334 MB
After interleave = 20440.48584 MB
After matmul = 20440.48730 MB
Before local copies matmul = 20440.48730 MB
After local copies = 20440.48975 MB
fter compute chunk allocated = 20440.16553 MB
Memory after cuda sdpa 20440.17333984375 MB
1
Memory before offload  20440.15185546875 MB
Memory after offload  20440.15185546875 MB
Memory before cuda sdpa 20440.16552734375 MB
On entering CUDA sdpa main function  allocated = 20440.16553 MB
Before first SDPA allocated = 20440.16553 MB
On chunked entry = 20440.16553 MB
On scale calculation = 20440.17334 MB
Before interleave = 20440.17334 MB
After interleave = 20440.67334 MB
After matmul = 20448.80029 MB
Before local copies matmul = 20448.80029 MB
After local copies = 20448.80322 MB
After first SDPA allocated = 20448.29053 MB
After first copy allocated = 20448.29053 MB
On chunked entry = 20448.29053 MB
On scale calculation = 20448.29834 MB
Before interleave = 20448.29834 MB
After interleave = 20448.61084 MB
After matmul = 20448.61230 MB
Before local copies matmul = 20448.61230 MB
After local copies = 20448.61475 MB
fter compute chunk allocated = 20448.29053 MB
Memory after cuda sdpa 20448.29833984375 MB
1
Memory before offload  20448.27685546875 MB
Memory after offload  20448.27685546875 MB
Memory before cuda sdpa 20448.29052734375 MB
On entering CUDA sdpa main function  allocated = 20448.29053 MB
Before first SDPA allocated = 20448.29053 MB
On chunked entry = 20448.29053 MB
On scale calculation = 20448.29834 MB
Before interleave = 20448.29834 MB
After interleave = 20448.79834 MB
After matmul = 20456.92529 MB
Before local copies matmul = 20456.92529 MB
After local copies = 20456.92822 MB
After first SDPA allocated = 20456.41553 MB
After first copy allocated = 20456.41553 MB
On chunked entry = 20456.41553 MB
On scale calculation = 20456.42334 MB
Before interleave = 20456.42334 MB
After interleave = 20456.73584 MB
After matmul = 20456.73730 MB
Before local copies matmul = 20456.73730 MB
After local copies = 20456.73975 MB
fter compute chunk allocated = 20456.41553 MB
Memory after cuda sdpa 20456.42333984375 MB
1
Memory before offload  20456.40185546875 MB
Memory after offload  20456.40185546875 MB
Memory before cuda sdpa 20456.41552734375 MB
On entering CUDA sdpa main function  allocated = 20456.41553 MB
Before first SDPA allocated = 20456.41553 MB
On chunked entry = 20456.41553 MB
On scale calculation = 20456.42334 MB
Before interleave = 20456.42334 MB
After interleave = 20456.92334 MB
After matmul = 20465.05029 MB
Before local copies matmul = 20465.05029 MB
After local copies = 20465.05322 MB
After first SDPA allocated = 20464.54053 MB
After first copy allocated = 20464.54053 MB
On chunked entry = 20464.54053 MB
On scale calculation = 20464.54834 MB
Before interleave = 20464.54834 MB
After interleave = 20464.86084 MB
After matmul = 20464.86230 MB
Before local copies matmul = 20464.86230 MB
After local copies = 20464.86475 MB
fter compute chunk allocated = 20464.54053 MB
Memory after cuda sdpa 20464.54833984375 MB
1
Memory before offload  20464.52685546875 MB
Memory after offload  20464.52685546875 MB
Memory before cuda sdpa 20464.54052734375 MB
On entering CUDA sdpa main function  allocated = 20464.54053 MB
Before first SDPA allocated = 20464.54053 MB
On chunked entry = 20464.54053 MB
On scale calculation = 20464.54834 MB
Before interleave = 20464.54834 MB
After interleave = 20465.04834 MB
After matmul = 20473.17529 MB
Before local copies matmul = 20473.17529 MB
After local copies = 20473.17822 MB
After first SDPA allocated = 20472.66553 MB
After first copy allocated = 20472.66553 MB
On chunked entry = 20472.66553 MB
On scale calculation = 20472.67334 MB
Before interleave = 20472.67334 MB
After interleave = 20472.98584 MB
After matmul = 20472.98730 MB
Before local copies matmul = 20472.98730 MB
After local copies = 20472.98975 MB
fter compute chunk allocated = 20472.66553 MB
Memory after cuda sdpa 20472.67333984375 MB
1
Memory before offload  20472.65185546875 MB
Memory after offload  20472.65185546875 MB
Memory before cuda sdpa 20472.66552734375 MB
On entering CUDA sdpa main function  allocated = 20472.66553 MB
Before first SDPA allocated = 20472.66553 MB
On chunked entry = 20472.66553 MB
On scale calculation = 20472.67334 MB
Before interleave = 20472.67334 MB
After interleave = 20473.17334 MB
After matmul = 20481.30029 MB
Before local copies matmul = 20481.30029 MB
After local copies = 20481.30322 MB
After first SDPA allocated = 20480.79053 MB
After first copy allocated = 20480.79053 MB
On chunked entry = 20480.79053 MB
On scale calculation = 20480.79834 MB
Before interleave = 20480.79834 MB
After interleave = 20481.11084 MB
After matmul = 20481.11230 MB
Before local copies matmul = 20481.11230 MB
After local copies = 20481.11475 MB
fter compute chunk allocated = 20480.79053 MB
Memory after cuda sdpa 20480.79833984375 MB
1
Memory before offload  20480.77685546875 MB
Memory after offload  20480.77685546875 MB
Memory before cuda sdpa 20480.79052734375 MB
On entering CUDA sdpa main function  allocated = 20480.79053 MB
Before first SDPA allocated = 20480.79053 MB
On chunked entry = 20480.79053 MB
On scale calculation = 20480.79834 MB
Before interleave = 20480.79834 MB
After interleave = 20481.29834 MB
After matmul = 20489.42529 MB
Before local copies matmul = 20489.42529 MB
After local copies = 20489.42822 MB
After first SDPA allocated = 20488.91553 MB
After first copy allocated = 20488.91553 MB
On chunked entry = 20488.91553 MB
On scale calculation = 20488.92334 MB
Before interleave = 20488.92334 MB
After interleave = 20489.23584 MB
After matmul = 20489.23730 MB
Before local copies matmul = 20489.23730 MB
After local copies = 20489.23975 MB
fter compute chunk allocated = 20488.91553 MB
Memory after cuda sdpa 20488.92333984375 MB
1
Memory before offload  20488.90185546875 MB
Memory after offload  20488.90185546875 MB
Memory before cuda sdpa 20488.91552734375 MB
On entering CUDA sdpa main function  allocated = 20488.91553 MB
Before first SDPA allocated = 20488.91553 MB
On chunked entry = 20488.91553 MB
On scale calculation = 20488.92334 MB
Before interleave = 20488.92334 MB
After interleave = 20489.42334 MB
After matmul = 20497.55029 MB
Before local copies matmul = 20497.55029 MB
After local copies = 20497.55322 MB
After first SDPA allocated = 20497.04053 MB
After first copy allocated = 20497.04053 MB
On chunked entry = 20497.04053 MB
On scale calculation = 20497.04834 MB
Before interleave = 20497.04834 MB
After interleave = 20497.36084 MB
After matmul = 20497.36230 MB
Before local copies matmul = 20497.36230 MB
After local copies = 20497.36475 MB
fter compute chunk allocated = 20497.04053 MB
Memory after cuda sdpa 20497.04833984375 MB
1
Memory before offload  20497.02685546875 MB
Memory after offload  20497.02685546875 MB
Memory before cuda sdpa 20497.04052734375 MB
On entering CUDA sdpa main function  allocated = 20497.04053 MB
Before first SDPA allocated = 20497.04053 MB
On chunked entry = 20497.04053 MB
On scale calculation = 20497.04834 MB
Before interleave = 20497.04834 MB
After interleave = 20497.54834 MB
After matmul = 20505.67529 MB
Before local copies matmul = 20505.67529 MB
After local copies = 20505.67822 MB
After first SDPA allocated = 20505.16553 MB
After first copy allocated = 20505.16553 MB
On chunked entry = 20505.16553 MB
On scale calculation = 20505.17334 MB
Before interleave = 20505.17334 MB
After interleave = 20505.48584 MB
After matmul = 20505.48730 MB
Before local copies matmul = 20505.48730 MB
After local copies = 20505.48975 MB
fter compute chunk allocated = 20505.16553 MB
Memory after cuda sdpa 20505.17333984375 MB
1
Memory before offload  20505.15185546875 MB
Memory after offload  20505.15185546875 MB
Memory before cuda sdpa 20505.16552734375 MB
On entering CUDA sdpa main function  allocated = 20505.16553 MB
Before first SDPA allocated = 20505.16553 MB
On chunked entry = 20505.16553 MB
On scale calculation = 20505.17334 MB
Before interleave = 20505.17334 MB
After interleave = 20505.67334 MB
After matmul = 20513.80029 MB
Before local copies matmul = 20513.80029 MB
After local copies = 20513.80322 MB
After first SDPA allocated = 20513.29053 MB
After first copy allocated = 20513.29053 MB
On chunked entry = 20513.29053 MB
On scale calculation = 20513.29834 MB
Before interleave = 20513.29834 MB
After interleave = 20513.61084 MB
After matmul = 20513.61230 MB
Before local copies matmul = 20513.61230 MB
After local copies = 20513.61475 MB
fter compute chunk allocated = 20513.29053 MB
Memory after cuda sdpa 20513.29833984375 MB
1
Memory before offload  20513.27685546875 MB
Memory after offload  20513.27685546875 MB
Memory before cuda sdpa 20513.29052734375 MB
On entering CUDA sdpa main function  allocated = 20513.29053 MB
Before first SDPA allocated = 20513.29053 MB
On chunked entry = 20513.29053 MB
On scale calculation = 20513.29834 MB
Before interleave = 20513.29834 MB
After interleave = 20513.79834 MB
After matmul = 20521.92529 MB
Before local copies matmul = 20521.92529 MB
After local copies = 20521.92822 MB
After first SDPA allocated = 20521.41553 MB
After first copy allocated = 20521.41553 MB
On chunked entry = 20521.41553 MB
On scale calculation = 20521.42334 MB
Before interleave = 20521.42334 MB
After interleave = 20521.73584 MB
After matmul = 20521.73730 MB
Before local copies matmul = 20521.73730 MB
After local copies = 20521.73975 MB
fter compute chunk allocated = 20521.41553 MB
Memory after cuda sdpa 20521.42333984375 MB
1
Memory before offload  20521.40185546875 MB
Memory after offload  20521.40185546875 MB
Memory before cuda sdpa 20521.41552734375 MB
On entering CUDA sdpa main function  allocated = 20521.41553 MB
Before first SDPA allocated = 20521.41553 MB
On chunked entry = 20521.41553 MB
On scale calculation = 20521.42334 MB
Before interleave = 20521.42334 MB
After interleave = 20521.92334 MB
After matmul = 20530.05029 MB
Before local copies matmul = 20530.05029 MB
After local copies = 20530.05322 MB
After first SDPA allocated = 20529.54053 MB
After first copy allocated = 20529.54053 MB
On chunked entry = 20529.54053 MB
On scale calculation = 20529.54834 MB
Before interleave = 20529.54834 MB
After interleave = 20529.86084 MB
After matmul = 20529.86230 MB
Before local copies matmul = 20529.86230 MB
After local copies = 20529.86475 MB
fter compute chunk allocated = 20529.54053 MB
Memory after cuda sdpa 20529.54833984375 MB
1
Memory before offload  20529.52685546875 MB
Memory after offload  20529.52685546875 MB
Memory before cuda sdpa 20529.54052734375 MB
On entering CUDA sdpa main function  allocated = 20529.54053 MB
Before first SDPA allocated = 20529.54053 MB
On chunked entry = 20529.54053 MB
On scale calculation = 20529.54834 MB
Before interleave = 20529.54834 MB
After interleave = 20530.04834 MB
After matmul = 20538.17529 MB
Before local copies matmul = 20538.17529 MB
After local copies = 20538.17822 MB
After first SDPA allocated = 20537.66553 MB
After first copy allocated = 20537.66553 MB
On chunked entry = 20537.66553 MB
On scale calculation = 20537.67334 MB
Before interleave = 20537.67334 MB
After interleave = 20537.98584 MB
After matmul = 20537.98730 MB
Before local copies matmul = 20537.98730 MB
After local copies = 20537.98975 MB
fter compute chunk allocated = 20537.66553 MB
Memory after cuda sdpa 20537.67333984375 MB
1
Memory before offload  20537.65185546875 MB
Memory after offload  20537.65185546875 MB
Memory before cuda sdpa 20537.66552734375 MB
On entering CUDA sdpa main function  allocated = 20537.66553 MB
Before first SDPA allocated = 20537.66553 MB
On chunked entry = 20537.66553 MB
On scale calculation = 20537.67334 MB
Before interleave = 20537.67334 MB
After interleave = 20538.17334 MB
After matmul = 20546.30029 MB
Before local copies matmul = 20546.30029 MB
After local copies = 20546.30322 MB
After first SDPA allocated = 20545.79053 MB
After first copy allocated = 20545.79053 MB
On chunked entry = 20545.79053 MB
On scale calculation = 20545.79834 MB
Before interleave = 20545.79834 MB
After interleave = 20546.11084 MB
After matmul = 20546.11230 MB
Before local copies matmul = 20546.11230 MB
After local copies = 20546.11475 MB
fter compute chunk allocated = 20545.79053 MB
Memory after cuda sdpa 20545.79833984375 MB
Decode step 21
1
Memory before offload  20545.77734375 MB
Memory after offload  20545.77734375 MB
Memory before cuda sdpa 20545.791015625 MB
On entering CUDA sdpa main function  allocated = 20545.79102 MB
Before first SDPA allocated = 20545.79102 MB
On chunked entry = 20545.79102 MB
On scale calculation = 20545.79883 MB
Before interleave = 20545.79883 MB
After interleave = 20546.29883 MB
After matmul = 20554.42578 MB
Before local copies matmul = 20554.42578 MB
After local copies = 20554.42871 MB
After first SDPA allocated = 20553.91602 MB
After first copy allocated = 20553.91602 MB
On chunked entry = 20553.91602 MB
On scale calculation = 20553.92383 MB
Before interleave = 20553.92383 MB
After interleave = 20554.25195 MB
After matmul = 20554.25342 MB
Before local copies matmul = 20554.25342 MB
After local copies = 20554.25586 MB
fter compute chunk allocated = 20553.91602 MB
Memory after cuda sdpa 20553.923828125 MB
1
Memory before offload  20553.90234375 MB
Memory after offload  20553.90234375 MB
Memory before cuda sdpa 20553.916015625 MB
On entering CUDA sdpa main function  allocated = 20553.91602 MB
Before first SDPA allocated = 20553.91602 MB
On chunked entry = 20553.91602 MB
On scale calculation = 20553.92383 MB
Before interleave = 20553.92383 MB
After interleave = 20554.42383 MB
After matmul = 20562.55078 MB
Before local copies matmul = 20562.55078 MB
After local copies = 20562.55371 MB
After first SDPA allocated = 20562.04102 MB
After first copy allocated = 20562.04102 MB
On chunked entry = 20562.04102 MB
On scale calculation = 20562.04883 MB
Before interleave = 20562.04883 MB
After interleave = 20562.37695 MB
After matmul = 20562.37842 MB
Before local copies matmul = 20562.37842 MB
After local copies = 20562.38086 MB
fter compute chunk allocated = 20562.04102 MB
Memory after cuda sdpa 20562.048828125 MB
1
Memory before offload  20562.02734375 MB
Memory after offload  20562.02734375 MB
Memory before cuda sdpa 20562.041015625 MB
On entering CUDA sdpa main function  allocated = 20562.04102 MB
Before first SDPA allocated = 20562.04102 MB
On chunked entry = 20562.04102 MB
On scale calculation = 20562.04883 MB
Before interleave = 20562.04883 MB
After interleave = 20562.54883 MB
After matmul = 20570.67578 MB
Before local copies matmul = 20570.67578 MB
After local copies = 20570.67871 MB
After first SDPA allocated = 20570.16602 MB
After first copy allocated = 20570.16602 MB
On chunked entry = 20570.16602 MB
On scale calculation = 20570.17383 MB
Before interleave = 20570.17383 MB
After interleave = 20570.50195 MB
After matmul = 20570.50342 MB
Before local copies matmul = 20570.50342 MB
After local copies = 20570.50586 MB
fter compute chunk allocated = 20570.16602 MB
Memory after cuda sdpa 20570.173828125 MB
1
Memory before offload  20570.15234375 MB
Memory after offload  20570.15234375 MB
Memory before cuda sdpa 20570.166015625 MB
On entering CUDA sdpa main function  allocated = 20570.16602 MB
Before first SDPA allocated = 20570.16602 MB
On chunked entry = 20570.16602 MB
On scale calculation = 20570.17383 MB
Before interleave = 20570.17383 MB
After interleave = 20570.67383 MB
After matmul = 20578.80078 MB
Before local copies matmul = 20578.80078 MB
After local copies = 20578.80371 MB
After first SDPA allocated = 20578.29102 MB
After first copy allocated = 20578.29102 MB
On chunked entry = 20578.29102 MB
On scale calculation = 20578.29883 MB
Before interleave = 20578.29883 MB
After interleave = 20578.62695 MB
After matmul = 20578.62842 MB
Before local copies matmul = 20578.62842 MB
After local copies = 20578.63086 MB
fter compute chunk allocated = 20578.29102 MB
Memory after cuda sdpa 20578.298828125 MB
1
Memory before offload  20578.27734375 MB
Memory after offload  20578.27734375 MB
Memory before cuda sdpa 20578.291015625 MB
On entering CUDA sdpa main function  allocated = 20578.29102 MB
Before first SDPA allocated = 20578.29102 MB
On chunked entry = 20578.29102 MB
On scale calculation = 20578.29883 MB
Before interleave = 20578.29883 MB
After interleave = 20578.79883 MB
After matmul = 20586.92578 MB
Before local copies matmul = 20586.92578 MB
After local copies = 20586.92871 MB
After first SDPA allocated = 20586.41602 MB
After first copy allocated = 20586.41602 MB
On chunked entry = 20586.41602 MB
On scale calculation = 20586.42383 MB
Before interleave = 20586.42383 MB
After interleave = 20586.75195 MB
After matmul = 20586.75342 MB
Before local copies matmul = 20586.75342 MB
After local copies = 20586.75586 MB
fter compute chunk allocated = 20586.41602 MB
Memory after cuda sdpa 20586.423828125 MB
1
Memory before offload  20586.40234375 MB
Memory after offload  20586.40234375 MB
Memory before cuda sdpa 20586.416015625 MB
On entering CUDA sdpa main function  allocated = 20586.41602 MB
Before first SDPA allocated = 20586.41602 MB
On chunked entry = 20586.41602 MB
On scale calculation = 20586.42383 MB
Before interleave = 20586.42383 MB
After interleave = 20586.92383 MB
After matmul = 20595.05078 MB
Before local copies matmul = 20595.05078 MB
After local copies = 20595.05371 MB
After first SDPA allocated = 20594.54102 MB
After first copy allocated = 20594.54102 MB
On chunked entry = 20594.54102 MB
On scale calculation = 20594.54883 MB
Before interleave = 20594.54883 MB
After interleave = 20594.87695 MB
After matmul = 20594.87842 MB
Before local copies matmul = 20594.87842 MB
After local copies = 20594.88086 MB
fter compute chunk allocated = 20594.54102 MB
Memory after cuda sdpa 20594.548828125 MB
1
Memory before offload  20594.52734375 MB
Memory after offload  20594.52734375 MB
Memory before cuda sdpa 20594.541015625 MB
On entering CUDA sdpa main function  allocated = 20594.54102 MB
Before first SDPA allocated = 20594.54102 MB
On chunked entry = 20594.54102 MB
On scale calculation = 20594.54883 MB
Before interleave = 20594.54883 MB
After interleave = 20595.04883 MB
After matmul = 20603.17578 MB
Before local copies matmul = 20603.17578 MB
After local copies = 20603.17871 MB
After first SDPA allocated = 20602.66602 MB
After first copy allocated = 20602.66602 MB
On chunked entry = 20602.66602 MB
On scale calculation = 20602.67383 MB
Before interleave = 20602.67383 MB
After interleave = 20603.00195 MB
After matmul = 20603.00342 MB
Before local copies matmul = 20603.00342 MB
After local copies = 20603.00586 MB
fter compute chunk allocated = 20602.66602 MB
Memory after cuda sdpa 20602.673828125 MB
1
Memory before offload  20602.65234375 MB
Memory after offload  20602.65234375 MB
Memory before cuda sdpa 20602.666015625 MB
On entering CUDA sdpa main function  allocated = 20602.66602 MB
Before first SDPA allocated = 20602.66602 MB
On chunked entry = 20602.66602 MB
On scale calculation = 20602.67383 MB
Before interleave = 20602.67383 MB
After interleave = 20603.17383 MB
After matmul = 20611.30078 MB
Before local copies matmul = 20611.30078 MB
After local copies = 20611.30371 MB
After first SDPA allocated = 20610.79102 MB
After first copy allocated = 20610.79102 MB
On chunked entry = 20610.79102 MB
On scale calculation = 20610.79883 MB
Before interleave = 20610.79883 MB
After interleave = 20611.12695 MB
After matmul = 20611.12842 MB
Before local copies matmul = 20611.12842 MB
After local copies = 20611.13086 MB
fter compute chunk allocated = 20610.79102 MB
Memory after cuda sdpa 20610.798828125 MB
1
Memory before offload  20610.77734375 MB
Memory after offload  20610.77734375 MB
Memory before cuda sdpa 20610.791015625 MB
On entering CUDA sdpa main function  allocated = 20610.79102 MB
Before first SDPA allocated = 20610.79102 MB
On chunked entry = 20610.79102 MB
On scale calculation = 20610.79883 MB
Before interleave = 20610.79883 MB
After interleave = 20611.29883 MB
After matmul = 20619.42578 MB
Before local copies matmul = 20619.42578 MB
After local copies = 20619.42871 MB
After first SDPA allocated = 20618.91602 MB
After first copy allocated = 20618.91602 MB
On chunked entry = 20618.91602 MB
On scale calculation = 20618.92383 MB
Before interleave = 20618.92383 MB
After interleave = 20619.25195 MB
After matmul = 20619.25342 MB
Before local copies matmul = 20619.25342 MB
After local copies = 20619.25586 MB
fter compute chunk allocated = 20618.91602 MB
Memory after cuda sdpa 20618.923828125 MB
1
Memory before offload  20618.90234375 MB
Memory after offload  20618.90234375 MB
Memory before cuda sdpa 20618.916015625 MB
On entering CUDA sdpa main function  allocated = 20618.91602 MB
Before first SDPA allocated = 20618.91602 MB
On chunked entry = 20618.91602 MB
On scale calculation = 20618.92383 MB
Before interleave = 20618.92383 MB
After interleave = 20619.42383 MB
After matmul = 20627.55078 MB
Before local copies matmul = 20627.55078 MB
After local copies = 20627.55371 MB
After first SDPA allocated = 20627.04102 MB
After first copy allocated = 20627.04102 MB
On chunked entry = 20627.04102 MB
On scale calculation = 20627.04883 MB
Before interleave = 20627.04883 MB
After interleave = 20627.37695 MB
After matmul = 20627.37842 MB
Before local copies matmul = 20627.37842 MB
After local copies = 20627.38086 MB
fter compute chunk allocated = 20627.04102 MB
Memory after cuda sdpa 20627.048828125 MB
1
Memory before offload  20627.02734375 MB
Memory after offload  20627.02734375 MB
Memory before cuda sdpa 20627.041015625 MB
On entering CUDA sdpa main function  allocated = 20627.04102 MB
Before first SDPA allocated = 20627.04102 MB
On chunked entry = 20627.04102 MB
On scale calculation = 20627.04883 MB
Before interleave = 20627.04883 MB
After interleave = 20627.54883 MB
After matmul = 20635.67578 MB
Before local copies matmul = 20635.67578 MB
After local copies = 20635.67871 MB
After first SDPA allocated = 20635.16602 MB
After first copy allocated = 20635.16602 MB
On chunked entry = 20635.16602 MB
On scale calculation = 20635.17383 MB
Before interleave = 20635.17383 MB
After interleave = 20635.50195 MB
After matmul = 20635.50342 MB
Before local copies matmul = 20635.50342 MB
After local copies = 20635.50586 MB
fter compute chunk allocated = 20635.16602 MB
Memory after cuda sdpa 20635.173828125 MB
1
Memory before offload  20635.15234375 MB
Memory after offload  20635.15234375 MB
Memory before cuda sdpa 20635.166015625 MB
On entering CUDA sdpa main function  allocated = 20635.16602 MB
Before first SDPA allocated = 20635.16602 MB
On chunked entry = 20635.16602 MB
On scale calculation = 20635.17383 MB
Before interleave = 20635.17383 MB
After interleave = 20635.67383 MB
After matmul = 20643.80078 MB
Before local copies matmul = 20643.80078 MB
After local copies = 20643.80371 MB
After first SDPA allocated = 20643.29102 MB
After first copy allocated = 20643.29102 MB
On chunked entry = 20643.29102 MB
On scale calculation = 20643.29883 MB
Before interleave = 20643.29883 MB
After interleave = 20643.62695 MB
After matmul = 20643.62842 MB
Before local copies matmul = 20643.62842 MB
After local copies = 20643.63086 MB
fter compute chunk allocated = 20643.29102 MB
Memory after cuda sdpa 20643.298828125 MB
1
Memory before offload  20643.27734375 MB
Memory after offload  20643.27734375 MB
Memory before cuda sdpa 20643.291015625 MB
On entering CUDA sdpa main function  allocated = 20643.29102 MB
Before first SDPA allocated = 20643.29102 MB
On chunked entry = 20643.29102 MB
On scale calculation = 20643.29883 MB
Before interleave = 20643.29883 MB
After interleave = 20643.79883 MB
After matmul = 20651.92578 MB
Before local copies matmul = 20651.92578 MB
After local copies = 20651.92871 MB
After first SDPA allocated = 20651.41602 MB
After first copy allocated = 20651.41602 MB
On chunked entry = 20651.41602 MB
On scale calculation = 20651.42383 MB
Before interleave = 20651.42383 MB
After interleave = 20651.75195 MB
After matmul = 20651.75342 MB
Before local copies matmul = 20651.75342 MB
After local copies = 20651.75586 MB
fter compute chunk allocated = 20651.41602 MB
Memory after cuda sdpa 20651.423828125 MB
1
Memory before offload  20651.40234375 MB
Memory after offload  20651.40234375 MB
Memory before cuda sdpa 20651.416015625 MB
On entering CUDA sdpa main function  allocated = 20651.41602 MB
Before first SDPA allocated = 20651.41602 MB
On chunked entry = 20651.41602 MB
On scale calculation = 20651.42383 MB
Before interleave = 20651.42383 MB
After interleave = 20651.92383 MB
After matmul = 20660.05078 MB
Before local copies matmul = 20660.05078 MB
After local copies = 20660.05371 MB
After first SDPA allocated = 20659.54102 MB
After first copy allocated = 20659.54102 MB
On chunked entry = 20659.54102 MB
On scale calculation = 20659.54883 MB
Before interleave = 20659.54883 MB
After interleave = 20659.87695 MB
After matmul = 20659.87842 MB
Before local copies matmul = 20659.87842 MB
After local copies = 20659.88086 MB
fter compute chunk allocated = 20659.54102 MB
Memory after cuda sdpa 20659.548828125 MB
1
Memory before offload  20659.52734375 MB
Memory after offload  20659.52734375 MB
Memory before cuda sdpa 20659.541015625 MB
On entering CUDA sdpa main function  allocated = 20659.54102 MB
Before first SDPA allocated = 20659.54102 MB
On chunked entry = 20659.54102 MB
On scale calculation = 20659.54883 MB
Before interleave = 20659.54883 MB
After interleave = 20660.04883 MB
After matmul = 20668.17578 MB
Before local copies matmul = 20668.17578 MB
After local copies = 20668.17871 MB
After first SDPA allocated = 20667.66602 MB
After first copy allocated = 20667.66602 MB
On chunked entry = 20667.66602 MB
On scale calculation = 20667.67383 MB
Before interleave = 20667.67383 MB
After interleave = 20668.00195 MB
After matmul = 20668.00342 MB
Before local copies matmul = 20668.00342 MB
After local copies = 20668.00586 MB
fter compute chunk allocated = 20667.66602 MB
Memory after cuda sdpa 20667.673828125 MB
1
Memory before offload  20667.65234375 MB
Memory after offload  20667.65234375 MB
Memory before cuda sdpa 20667.666015625 MB
On entering CUDA sdpa main function  allocated = 20667.66602 MB
Before first SDPA allocated = 20667.66602 MB
On chunked entry = 20667.66602 MB
On scale calculation = 20667.67383 MB
Before interleave = 20667.67383 MB
After interleave = 20668.17383 MB
After matmul = 20676.30078 MB
Before local copies matmul = 20676.30078 MB
After local copies = 20676.30371 MB
After first SDPA allocated = 20675.79102 MB
After first copy allocated = 20675.79102 MB
On chunked entry = 20675.79102 MB
On scale calculation = 20675.79883 MB
Before interleave = 20675.79883 MB
After interleave = 20676.12695 MB
After matmul = 20676.12842 MB
Before local copies matmul = 20676.12842 MB
After local copies = 20676.13086 MB
fter compute chunk allocated = 20675.79102 MB
Memory after cuda sdpa 20675.798828125 MB
1
Memory before offload  20675.77734375 MB
Memory after offload  20675.77734375 MB
Memory before cuda sdpa 20675.791015625 MB
On entering CUDA sdpa main function  allocated = 20675.79102 MB
Before first SDPA allocated = 20675.79102 MB
On chunked entry = 20675.79102 MB
On scale calculation = 20675.79883 MB
Before interleave = 20675.79883 MB
After interleave = 20676.29883 MB
After matmul = 20684.42578 MB
Before local copies matmul = 20684.42578 MB
After local copies = 20684.42871 MB
After first SDPA allocated = 20683.91602 MB
After first copy allocated = 20683.91602 MB
On chunked entry = 20683.91602 MB
On scale calculation = 20683.92383 MB
Before interleave = 20683.92383 MB
After interleave = 20684.25195 MB
After matmul = 20684.25342 MB
Before local copies matmul = 20684.25342 MB
After local copies = 20684.25586 MB
fter compute chunk allocated = 20683.91602 MB
Memory after cuda sdpa 20683.923828125 MB
1
Memory before offload  20683.90234375 MB
Memory after offload  20683.90234375 MB
Memory before cuda sdpa 20683.916015625 MB
On entering CUDA sdpa main function  allocated = 20683.91602 MB
Before first SDPA allocated = 20683.91602 MB
On chunked entry = 20683.91602 MB
On scale calculation = 20683.92383 MB
Before interleave = 20683.92383 MB
After interleave = 20684.42383 MB
After matmul = 20692.55078 MB
Before local copies matmul = 20692.55078 MB
After local copies = 20692.55371 MB
After first SDPA allocated = 20692.04102 MB
After first copy allocated = 20692.04102 MB
On chunked entry = 20692.04102 MB
On scale calculation = 20692.04883 MB
Before interleave = 20692.04883 MB
After interleave = 20692.37695 MB
After matmul = 20692.37842 MB
Before local copies matmul = 20692.37842 MB
After local copies = 20692.38086 MB
fter compute chunk allocated = 20692.04102 MB
Memory after cuda sdpa 20692.048828125 MB
1
Memory before offload  20692.02734375 MB
Memory after offload  20692.02734375 MB
Memory before cuda sdpa 20692.041015625 MB
On entering CUDA sdpa main function  allocated = 20692.04102 MB
Before first SDPA allocated = 20692.04102 MB
On chunked entry = 20692.04102 MB
On scale calculation = 20692.04883 MB
Before interleave = 20692.04883 MB
After interleave = 20692.54883 MB
After matmul = 20700.67578 MB
Before local copies matmul = 20700.67578 MB
After local copies = 20700.67871 MB
After first SDPA allocated = 20700.16602 MB
After first copy allocated = 20700.16602 MB
On chunked entry = 20700.16602 MB
On scale calculation = 20700.17383 MB
Before interleave = 20700.17383 MB
After interleave = 20700.50195 MB
After matmul = 20700.50342 MB
Before local copies matmul = 20700.50342 MB
After local copies = 20700.50586 MB
fter compute chunk allocated = 20700.16602 MB
Memory after cuda sdpa 20700.173828125 MB
1
Memory before offload  20700.15234375 MB
Memory after offload  20700.15234375 MB
Memory before cuda sdpa 20700.166015625 MB
On entering CUDA sdpa main function  allocated = 20700.16602 MB
Before first SDPA allocated = 20700.16602 MB
On chunked entry = 20700.16602 MB
On scale calculation = 20700.17383 MB
Before interleave = 20700.17383 MB
After interleave = 20700.67383 MB
After matmul = 20708.80078 MB
Before local copies matmul = 20708.80078 MB
After local copies = 20708.80371 MB
After first SDPA allocated = 20708.29102 MB
After first copy allocated = 20708.29102 MB
On chunked entry = 20708.29102 MB
On scale calculation = 20708.29883 MB
Before interleave = 20708.29883 MB
After interleave = 20708.62695 MB
After matmul = 20708.62842 MB
Before local copies matmul = 20708.62842 MB
After local copies = 20708.63086 MB
fter compute chunk allocated = 20708.29102 MB
Memory after cuda sdpa 20708.298828125 MB
1
Memory before offload  20708.27734375 MB
Memory after offload  20708.27734375 MB
Memory before cuda sdpa 20708.291015625 MB
On entering CUDA sdpa main function  allocated = 20708.29102 MB
Before first SDPA allocated = 20708.29102 MB
On chunked entry = 20708.29102 MB
On scale calculation = 20708.29883 MB
Before interleave = 20708.29883 MB
After interleave = 20708.79883 MB
After matmul = 20716.92578 MB
Before local copies matmul = 20716.92578 MB
After local copies = 20716.92871 MB
After first SDPA allocated = 20716.41602 MB
After first copy allocated = 20716.41602 MB
On chunked entry = 20716.41602 MB
On scale calculation = 20716.42383 MB
Before interleave = 20716.42383 MB
After interleave = 20716.75195 MB
After matmul = 20716.75342 MB
Before local copies matmul = 20716.75342 MB
After local copies = 20716.75586 MB
fter compute chunk allocated = 20716.41602 MB
Memory after cuda sdpa 20716.423828125 MB
1
Memory before offload  20716.40234375 MB
Memory after offload  20716.40234375 MB
Memory before cuda sdpa 20716.416015625 MB
On entering CUDA sdpa main function  allocated = 20716.41602 MB
Before first SDPA allocated = 20716.41602 MB
On chunked entry = 20716.41602 MB
On scale calculation = 20716.42383 MB
Before interleave = 20716.42383 MB
After interleave = 20716.92383 MB
After matmul = 20725.05078 MB
Before local copies matmul = 20725.05078 MB
After local copies = 20725.05371 MB
After first SDPA allocated = 20724.54102 MB
After first copy allocated = 20724.54102 MB
On chunked entry = 20724.54102 MB
On scale calculation = 20724.54883 MB
Before interleave = 20724.54883 MB
After interleave = 20724.87695 MB
After matmul = 20724.87842 MB
Before local copies matmul = 20724.87842 MB
After local copies = 20724.88086 MB
fter compute chunk allocated = 20724.54102 MB
Memory after cuda sdpa 20724.548828125 MB
1
Memory before offload  20724.52734375 MB
Memory after offload  20724.52734375 MB
Memory before cuda sdpa 20724.541015625 MB
On entering CUDA sdpa main function  allocated = 20724.54102 MB
Before first SDPA allocated = 20724.54102 MB
On chunked entry = 20724.54102 MB
On scale calculation = 20724.54883 MB
Before interleave = 20724.54883 MB
After interleave = 20725.04883 MB
After matmul = 20733.17578 MB
Before local copies matmul = 20733.17578 MB
After local copies = 20733.17871 MB
After first SDPA allocated = 20732.66602 MB
After first copy allocated = 20732.66602 MB
On chunked entry = 20732.66602 MB
On scale calculation = 20732.67383 MB
Before interleave = 20732.67383 MB
After interleave = 20733.00195 MB
After matmul = 20733.00342 MB
Before local copies matmul = 20733.00342 MB
After local copies = 20733.00586 MB
fter compute chunk allocated = 20732.66602 MB
Memory after cuda sdpa 20732.673828125 MB
1
Memory before offload  20732.65234375 MB
Memory after offload  20732.65234375 MB
Memory before cuda sdpa 20732.666015625 MB
On entering CUDA sdpa main function  allocated = 20732.66602 MB
Before first SDPA allocated = 20732.66602 MB
On chunked entry = 20732.66602 MB
On scale calculation = 20732.67383 MB
Before interleave = 20732.67383 MB
After interleave = 20733.17383 MB
After matmul = 20741.30078 MB
Before local copies matmul = 20741.30078 MB
After local copies = 20741.30371 MB
After first SDPA allocated = 20740.79102 MB
After first copy allocated = 20740.79102 MB
On chunked entry = 20740.79102 MB
On scale calculation = 20740.79883 MB
Before interleave = 20740.79883 MB
After interleave = 20741.12695 MB
After matmul = 20741.12842 MB
Before local copies matmul = 20741.12842 MB
After local copies = 20741.13086 MB
fter compute chunk allocated = 20740.79102 MB
Memory after cuda sdpa 20740.798828125 MB
1
Memory before offload  20740.77734375 MB
Memory after offload  20740.77734375 MB
Memory before cuda sdpa 20740.791015625 MB
On entering CUDA sdpa main function  allocated = 20740.79102 MB
Before first SDPA allocated = 20740.79102 MB
On chunked entry = 20740.79102 MB
On scale calculation = 20740.79883 MB
Before interleave = 20740.79883 MB
After interleave = 20741.29883 MB
After matmul = 20749.42578 MB
Before local copies matmul = 20749.42578 MB
After local copies = 20749.42871 MB
After first SDPA allocated = 20748.91602 MB
After first copy allocated = 20748.91602 MB
On chunked entry = 20748.91602 MB
On scale calculation = 20748.92383 MB
Before interleave = 20748.92383 MB
After interleave = 20749.25195 MB
After matmul = 20749.25342 MB
Before local copies matmul = 20749.25342 MB
After local copies = 20749.25586 MB
fter compute chunk allocated = 20748.91602 MB
Memory after cuda sdpa 20748.923828125 MB
1
Memory before offload  20748.90234375 MB
Memory after offload  20748.90234375 MB
Memory before cuda sdpa 20748.916015625 MB
On entering CUDA sdpa main function  allocated = 20748.91602 MB
Before first SDPA allocated = 20748.91602 MB
On chunked entry = 20748.91602 MB
On scale calculation = 20748.92383 MB
Before interleave = 20748.92383 MB
After interleave = 20749.42383 MB
After matmul = 20757.55078 MB
Before local copies matmul = 20757.55078 MB
After local copies = 20757.55371 MB
After first SDPA allocated = 20757.04102 MB
After first copy allocated = 20757.04102 MB
On chunked entry = 20757.04102 MB
On scale calculation = 20757.04883 MB
Before interleave = 20757.04883 MB
After interleave = 20757.37695 MB
After matmul = 20757.37842 MB
Before local copies matmul = 20757.37842 MB
After local copies = 20757.38086 MB
fter compute chunk allocated = 20757.04102 MB
Memory after cuda sdpa 20757.048828125 MB
1
Memory before offload  20757.02734375 MB
Memory after offload  20757.02734375 MB
Memory before cuda sdpa 20757.041015625 MB
On entering CUDA sdpa main function  allocated = 20757.04102 MB
Before first SDPA allocated = 20757.04102 MB
On chunked entry = 20757.04102 MB
On scale calculation = 20757.04883 MB
Before interleave = 20757.04883 MB
After interleave = 20757.54883 MB
After matmul = 20765.67578 MB
Before local copies matmul = 20765.67578 MB
After local copies = 20765.67871 MB
After first SDPA allocated = 20765.16602 MB
After first copy allocated = 20765.16602 MB
On chunked entry = 20765.16602 MB
On scale calculation = 20765.17383 MB
Before interleave = 20765.17383 MB
After interleave = 20765.50195 MB
After matmul = 20765.50342 MB
Before local copies matmul = 20765.50342 MB
After local copies = 20765.50586 MB
fter compute chunk allocated = 20765.16602 MB
Memory after cuda sdpa 20765.173828125 MB
1
Memory before offload  20765.15234375 MB
Memory after offload  20765.15234375 MB
Memory before cuda sdpa 20765.166015625 MB
On entering CUDA sdpa main function  allocated = 20765.16602 MB
Before first SDPA allocated = 20765.16602 MB
On chunked entry = 20765.16602 MB
On scale calculation = 20765.17383 MB
Before interleave = 20765.17383 MB
After interleave = 20765.67383 MB
After matmul = 20773.80078 MB
Before local copies matmul = 20773.80078 MB
After local copies = 20773.80371 MB
After first SDPA allocated = 20773.29102 MB
After first copy allocated = 20773.29102 MB
On chunked entry = 20773.29102 MB
On scale calculation = 20773.29883 MB
Before interleave = 20773.29883 MB
After interleave = 20773.62695 MB
After matmul = 20773.62842 MB
Before local copies matmul = 20773.62842 MB
After local copies = 20773.63086 MB
fter compute chunk allocated = 20773.29102 MB
Memory after cuda sdpa 20773.298828125 MB
1
Memory before offload  20773.27734375 MB
Memory after offload  20773.27734375 MB
Memory before cuda sdpa 20773.291015625 MB
On entering CUDA sdpa main function  allocated = 20773.29102 MB
Before first SDPA allocated = 20773.29102 MB
On chunked entry = 20773.29102 MB
On scale calculation = 20773.29883 MB
Before interleave = 20773.29883 MB
After interleave = 20773.79883 MB
After matmul = 20781.92578 MB
Before local copies matmul = 20781.92578 MB
After local copies = 20781.92871 MB
After first SDPA allocated = 20781.41602 MB
After first copy allocated = 20781.41602 MB
On chunked entry = 20781.41602 MB
On scale calculation = 20781.42383 MB
Before interleave = 20781.42383 MB
After interleave = 20781.75195 MB
After matmul = 20781.75342 MB
Before local copies matmul = 20781.75342 MB
After local copies = 20781.75586 MB
fter compute chunk allocated = 20781.41602 MB
Memory after cuda sdpa 20781.423828125 MB
1
Memory before offload  20781.40234375 MB
Memory after offload  20781.40234375 MB
Memory before cuda sdpa 20781.416015625 MB
On entering CUDA sdpa main function  allocated = 20781.41602 MB
Before first SDPA allocated = 20781.41602 MB
On chunked entry = 20781.41602 MB
On scale calculation = 20781.42383 MB
Before interleave = 20781.42383 MB
After interleave = 20781.92383 MB
After matmul = 20790.05078 MB
Before local copies matmul = 20790.05078 MB
After local copies = 20790.05371 MB
After first SDPA allocated = 20789.54102 MB
After first copy allocated = 20789.54102 MB
On chunked entry = 20789.54102 MB
On scale calculation = 20789.54883 MB
Before interleave = 20789.54883 MB
After interleave = 20789.87695 MB
After matmul = 20789.87842 MB
Before local copies matmul = 20789.87842 MB
After local copies = 20789.88086 MB
fter compute chunk allocated = 20789.54102 MB
Memory after cuda sdpa 20789.548828125 MB
1
Memory before offload  20789.52734375 MB
Memory after offload  20789.52734375 MB
Memory before cuda sdpa 20789.541015625 MB
On entering CUDA sdpa main function  allocated = 20789.54102 MB
Before first SDPA allocated = 20789.54102 MB
On chunked entry = 20789.54102 MB
On scale calculation = 20789.54883 MB
Before interleave = 20789.54883 MB
After interleave = 20790.04883 MB
After matmul = 20798.17578 MB
Before local copies matmul = 20798.17578 MB
After local copies = 20798.17871 MB
After first SDPA allocated = 20797.66602 MB
After first copy allocated = 20797.66602 MB
On chunked entry = 20797.66602 MB
On scale calculation = 20797.67383 MB
Before interleave = 20797.67383 MB
After interleave = 20798.00195 MB
After matmul = 20798.00342 MB
Before local copies matmul = 20798.00342 MB
After local copies = 20798.00586 MB
fter compute chunk allocated = 20797.66602 MB
Memory after cuda sdpa 20797.673828125 MB
1
Memory before offload  20797.65234375 MB
Memory after offload  20797.65234375 MB
Memory before cuda sdpa 20797.666015625 MB
On entering CUDA sdpa main function  allocated = 20797.66602 MB
Before first SDPA allocated = 20797.66602 MB
On chunked entry = 20797.66602 MB
On scale calculation = 20797.67383 MB
Before interleave = 20797.67383 MB
After interleave = 20798.17383 MB
After matmul = 20806.30078 MB
Before local copies matmul = 20806.30078 MB
After local copies = 20806.30371 MB
After first SDPA allocated = 20805.79102 MB
After first copy allocated = 20805.79102 MB
On chunked entry = 20805.79102 MB
On scale calculation = 20805.79883 MB
Before interleave = 20805.79883 MB
After interleave = 20806.12695 MB
After matmul = 20806.12842 MB
Before local copies matmul = 20806.12842 MB
After local copies = 20806.13086 MB
fter compute chunk allocated = 20805.79102 MB
Memory after cuda sdpa 20805.798828125 MB
Decode step 22
1
Memory before offload  20805.77783203125 MB
Memory after offload  20805.77783203125 MB
Memory before cuda sdpa 20805.79150390625 MB
On entering CUDA sdpa main function  allocated = 20805.79150 MB
Before first SDPA allocated = 20805.79150 MB
On chunked entry = 20805.79150 MB
On scale calculation = 20805.79932 MB
Before interleave = 20805.79932 MB
After interleave = 20806.29932 MB
After matmul = 20814.42627 MB
Before local copies matmul = 20814.42627 MB
After local copies = 20814.42920 MB
After first SDPA allocated = 20813.91650 MB
After first copy allocated = 20813.91650 MB
On chunked entry = 20813.91650 MB
On scale calculation = 20813.92432 MB
Before interleave = 20813.92432 MB
After interleave = 20814.26807 MB
After matmul = 20814.26953 MB
Before local copies matmul = 20814.26953 MB
After local copies = 20814.27197 MB
fter compute chunk allocated = 20813.91650 MB
Memory after cuda sdpa 20813.92431640625 MB
1
Memory before offload  20813.90283203125 MB
Memory after offload  20813.90283203125 MB
Memory before cuda sdpa 20813.91650390625 MB
On entering CUDA sdpa main function  allocated = 20813.91650 MB
Before first SDPA allocated = 20813.91650 MB
On chunked entry = 20813.91650 MB
On scale calculation = 20813.92432 MB
Before interleave = 20813.92432 MB
After interleave = 20814.42432 MB
After matmul = 20822.55127 MB
Before local copies matmul = 20822.55127 MB
After local copies = 20822.55420 MB
After first SDPA allocated = 20822.04150 MB
After first copy allocated = 20822.04150 MB
On chunked entry = 20822.04150 MB
On scale calculation = 20822.04932 MB
Before interleave = 20822.04932 MB
After interleave = 20822.39307 MB
After matmul = 20822.39453 MB
Before local copies matmul = 20822.39453 MB
After local copies = 20822.39697 MB
fter compute chunk allocated = 20822.04150 MB
Memory after cuda sdpa 20822.04931640625 MB
1
Memory before offload  20822.02783203125 MB
Memory after offload  20822.02783203125 MB
Memory before cuda sdpa 20822.04150390625 MB
On entering CUDA sdpa main function  allocated = 20822.04150 MB
Before first SDPA allocated = 20822.04150 MB
On chunked entry = 20822.04150 MB
On scale calculation = 20822.04932 MB
Before interleave = 20822.04932 MB
After interleave = 20822.54932 MB
After matmul = 20830.67627 MB
Before local copies matmul = 20830.67627 MB
After local copies = 20830.67920 MB
After first SDPA allocated = 20830.16650 MB
After first copy allocated = 20830.16650 MB
On chunked entry = 20830.16650 MB
On scale calculation = 20830.17432 MB
Before interleave = 20830.17432 MB
After interleave = 20830.51807 MB
After matmul = 20830.51953 MB
Before local copies matmul = 20830.51953 MB
After local copies = 20830.52197 MB
fter compute chunk allocated = 20830.16650 MB
Memory after cuda sdpa 20830.17431640625 MB
1
Memory before offload  20830.15283203125 MB
Memory after offload  20830.15283203125 MB
Memory before cuda sdpa 20830.16650390625 MB
On entering CUDA sdpa main function  allocated = 20830.16650 MB
Before first SDPA allocated = 20830.16650 MB
On chunked entry = 20830.16650 MB
On scale calculation = 20830.17432 MB
Before interleave = 20830.17432 MB
After interleave = 20830.67432 MB
After matmul = 20838.80127 MB
Before local copies matmul = 20838.80127 MB
After local copies = 20838.80420 MB
After first SDPA allocated = 20838.29150 MB
After first copy allocated = 20838.29150 MB
On chunked entry = 20838.29150 MB
On scale calculation = 20838.29932 MB
Before interleave = 20838.29932 MB
After interleave = 20838.64307 MB
After matmul = 20838.64453 MB
Before local copies matmul = 20838.64453 MB
After local copies = 20838.64697 MB
fter compute chunk allocated = 20838.29150 MB
Memory after cuda sdpa 20838.29931640625 MB
1
Memory before offload  20838.27783203125 MB
Memory after offload  20838.27783203125 MB
Memory before cuda sdpa 20838.29150390625 MB
On entering CUDA sdpa main function  allocated = 20838.29150 MB
Before first SDPA allocated = 20838.29150 MB
On chunked entry = 20838.29150 MB
On scale calculation = 20838.29932 MB
Before interleave = 20838.29932 MB
After interleave = 20838.79932 MB
After matmul = 20846.92627 MB
Before local copies matmul = 20846.92627 MB
After local copies = 20846.92920 MB
After first SDPA allocated = 20846.41650 MB
After first copy allocated = 20846.41650 MB
On chunked entry = 20846.41650 MB
On scale calculation = 20846.42432 MB
Before interleave = 20846.42432 MB
After interleave = 20846.76807 MB
After matmul = 20846.76953 MB
Before local copies matmul = 20846.76953 MB
After local copies = 20846.77197 MB
fter compute chunk allocated = 20846.41650 MB
Memory after cuda sdpa 20846.42431640625 MB
1
Memory before offload  20846.40283203125 MB
Memory after offload  20846.40283203125 MB
Memory before cuda sdpa 20846.41650390625 MB
On entering CUDA sdpa main function  allocated = 20846.41650 MB
Before first SDPA allocated = 20846.41650 MB
On chunked entry = 20846.41650 MB
On scale calculation = 20846.42432 MB
Before interleave = 20846.42432 MB
After interleave = 20846.92432 MB
After matmul = 20855.05127 MB
Before local copies matmul = 20855.05127 MB
After local copies = 20855.05420 MB
After first SDPA allocated = 20854.54150 MB
After first copy allocated = 20854.54150 MB
On chunked entry = 20854.54150 MB
On scale calculation = 20854.54932 MB
Before interleave = 20854.54932 MB
After interleave = 20854.89307 MB
After matmul = 20854.89453 MB
Before local copies matmul = 20854.89453 MB
After local copies = 20854.89697 MB
fter compute chunk allocated = 20854.54150 MB
Memory after cuda sdpa 20854.54931640625 MB
1
Memory before offload  20854.52783203125 MB
Memory after offload  20854.52783203125 MB
Memory before cuda sdpa 20854.54150390625 MB
On entering CUDA sdpa main function  allocated = 20854.54150 MB
Before first SDPA allocated = 20854.54150 MB
On chunked entry = 20854.54150 MB
On scale calculation = 20854.54932 MB
Before interleave = 20854.54932 MB
After interleave = 20855.04932 MB
After matmul = 20863.17627 MB
Before local copies matmul = 20863.17627 MB
After local copies = 20863.17920 MB
After first SDPA allocated = 20862.66650 MB
After first copy allocated = 20862.66650 MB
On chunked entry = 20862.66650 MB
On scale calculation = 20862.67432 MB
Before interleave = 20862.67432 MB
After interleave = 20863.01807 MB
After matmul = 20863.01953 MB
Before local copies matmul = 20863.01953 MB
After local copies = 20863.02197 MB
fter compute chunk allocated = 20862.66650 MB
Memory after cuda sdpa 20862.67431640625 MB
1
Memory before offload  20862.65283203125 MB
Memory after offload  20862.65283203125 MB
Memory before cuda sdpa 20862.66650390625 MB
On entering CUDA sdpa main function  allocated = 20862.66650 MB
Before first SDPA allocated = 20862.66650 MB
On chunked entry = 20862.66650 MB
On scale calculation = 20862.67432 MB
Before interleave = 20862.67432 MB
After interleave = 20863.17432 MB
After matmul = 20871.30127 MB
Before local copies matmul = 20871.30127 MB
After local copies = 20871.30420 MB
After first SDPA allocated = 20870.79150 MB
After first copy allocated = 20870.79150 MB
On chunked entry = 20870.79150 MB
On scale calculation = 20870.79932 MB
Before interleave = 20870.79932 MB
After interleave = 20871.14307 MB
After matmul = 20871.14453 MB
Before local copies matmul = 20871.14453 MB
After local copies = 20871.14697 MB
fter compute chunk allocated = 20870.79150 MB
Memory after cuda sdpa 20870.79931640625 MB
1
Memory before offload  20870.77783203125 MB
Memory after offload  20870.77783203125 MB
Memory before cuda sdpa 20870.79150390625 MB
On entering CUDA sdpa main function  allocated = 20870.79150 MB
Before first SDPA allocated = 20870.79150 MB
On chunked entry = 20870.79150 MB
On scale calculation = 20870.79932 MB
Before interleave = 20870.79932 MB
After interleave = 20871.29932 MB
After matmul = 20879.42627 MB
Before local copies matmul = 20879.42627 MB
After local copies = 20879.42920 MB
After first SDPA allocated = 20878.91650 MB
After first copy allocated = 20878.91650 MB
On chunked entry = 20878.91650 MB
On scale calculation = 20878.92432 MB
Before interleave = 20878.92432 MB
After interleave = 20879.26807 MB
After matmul = 20879.26953 MB
Before local copies matmul = 20879.26953 MB
After local copies = 20879.27197 MB
fter compute chunk allocated = 20878.91650 MB
Memory after cuda sdpa 20878.92431640625 MB
1
Memory before offload  20878.90283203125 MB
Memory after offload  20878.90283203125 MB
Memory before cuda sdpa 20878.91650390625 MB
On entering CUDA sdpa main function  allocated = 20878.91650 MB
Before first SDPA allocated = 20878.91650 MB
On chunked entry = 20878.91650 MB
On scale calculation = 20878.92432 MB
Before interleave = 20878.92432 MB
After interleave = 20879.42432 MB
After matmul = 20887.55127 MB
Before local copies matmul = 20887.55127 MB
After local copies = 20887.55420 MB
After first SDPA allocated = 20887.04150 MB
After first copy allocated = 20887.04150 MB
On chunked entry = 20887.04150 MB
On scale calculation = 20887.04932 MB
Before interleave = 20887.04932 MB
After interleave = 20887.39307 MB
After matmul = 20887.39453 MB
Before local copies matmul = 20887.39453 MB
After local copies = 20887.39697 MB
fter compute chunk allocated = 20887.04150 MB
Memory after cuda sdpa 20887.04931640625 MB
1
Memory before offload  20887.02783203125 MB
Memory after offload  20887.02783203125 MB
Memory before cuda sdpa 20887.04150390625 MB
On entering CUDA sdpa main function  allocated = 20887.04150 MB
Before first SDPA allocated = 20887.04150 MB
On chunked entry = 20887.04150 MB
On scale calculation = 20887.04932 MB
Before interleave = 20887.04932 MB
After interleave = 20887.54932 MB
After matmul = 20895.67627 MB
Before local copies matmul = 20895.67627 MB
After local copies = 20895.67920 MB
After first SDPA allocated = 20895.16650 MB
After first copy allocated = 20895.16650 MB
On chunked entry = 20895.16650 MB
On scale calculation = 20895.17432 MB
Before interleave = 20895.17432 MB
After interleave = 20895.51807 MB
After matmul = 20895.51953 MB
Before local copies matmul = 20895.51953 MB
After local copies = 20895.52197 MB
fter compute chunk allocated = 20895.16650 MB
Memory after cuda sdpa 20895.17431640625 MB
1
Memory before offload  20895.15283203125 MB
Memory after offload  20895.15283203125 MB
Memory before cuda sdpa 20895.16650390625 MB
On entering CUDA sdpa main function  allocated = 20895.16650 MB
Before first SDPA allocated = 20895.16650 MB
On chunked entry = 20895.16650 MB
On scale calculation = 20895.17432 MB
Before interleave = 20895.17432 MB
After interleave = 20895.67432 MB
After matmul = 20903.80127 MB
Before local copies matmul = 20903.80127 MB
After local copies = 20903.80420 MB
After first SDPA allocated = 20903.29150 MB
After first copy allocated = 20903.29150 MB
On chunked entry = 20903.29150 MB
On scale calculation = 20903.29932 MB
Before interleave = 20903.29932 MB
After interleave = 20903.64307 MB
After matmul = 20903.64453 MB
Before local copies matmul = 20903.64453 MB
After local copies = 20903.64697 MB
fter compute chunk allocated = 20903.29150 MB
Memory after cuda sdpa 20903.29931640625 MB
1
Memory before offload  20903.27783203125 MB
Memory after offload  20903.27783203125 MB
Memory before cuda sdpa 20903.29150390625 MB
On entering CUDA sdpa main function  allocated = 20903.29150 MB
Before first SDPA allocated = 20903.29150 MB
On chunked entry = 20903.29150 MB
On scale calculation = 20903.29932 MB
Before interleave = 20903.29932 MB
After interleave = 20903.79932 MB
After matmul = 20911.92627 MB
Before local copies matmul = 20911.92627 MB
After local copies = 20911.92920 MB
After first SDPA allocated = 20911.41650 MB
After first copy allocated = 20911.41650 MB
On chunked entry = 20911.41650 MB
On scale calculation = 20911.42432 MB
Before interleave = 20911.42432 MB
After interleave = 20911.76807 MB
After matmul = 20911.76953 MB
Before local copies matmul = 20911.76953 MB
After local copies = 20911.77197 MB
fter compute chunk allocated = 20911.41650 MB
Memory after cuda sdpa 20911.42431640625 MB
1
Memory before offload  20911.40283203125 MB
Memory after offload  20911.40283203125 MB
Memory before cuda sdpa 20911.41650390625 MB
On entering CUDA sdpa main function  allocated = 20911.41650 MB
Before first SDPA allocated = 20911.41650 MB
On chunked entry = 20911.41650 MB
On scale calculation = 20911.42432 MB
Before interleave = 20911.42432 MB
After interleave = 20911.92432 MB
After matmul = 20920.05127 MB
Before local copies matmul = 20920.05127 MB
After local copies = 20920.05420 MB
After first SDPA allocated = 20919.54150 MB
After first copy allocated = 20919.54150 MB
On chunked entry = 20919.54150 MB
On scale calculation = 20919.54932 MB
Before interleave = 20919.54932 MB
After interleave = 20919.89307 MB
After matmul = 20919.89453 MB
Before local copies matmul = 20919.89453 MB
After local copies = 20919.89697 MB
fter compute chunk allocated = 20919.54150 MB
Memory after cuda sdpa 20919.54931640625 MB
1
Memory before offload  20919.52783203125 MB
Memory after offload  20919.52783203125 MB
Memory before cuda sdpa 20919.54150390625 MB
On entering CUDA sdpa main function  allocated = 20919.54150 MB
Before first SDPA allocated = 20919.54150 MB
On chunked entry = 20919.54150 MB
On scale calculation = 20919.54932 MB
Before interleave = 20919.54932 MB
After interleave = 20920.04932 MB
After matmul = 20928.17627 MB
Before local copies matmul = 20928.17627 MB
After local copies = 20928.17920 MB
After first SDPA allocated = 20927.66650 MB
After first copy allocated = 20927.66650 MB
On chunked entry = 20927.66650 MB
On scale calculation = 20927.67432 MB
Before interleave = 20927.67432 MB
After interleave = 20928.01807 MB
After matmul = 20928.01953 MB
Before local copies matmul = 20928.01953 MB
After local copies = 20928.02197 MB
fter compute chunk allocated = 20927.66650 MB
Memory after cuda sdpa 20927.67431640625 MB
1
Memory before offload  20927.65283203125 MB
Memory after offload  20927.65283203125 MB
Memory before cuda sdpa 20927.66650390625 MB
On entering CUDA sdpa main function  allocated = 20927.66650 MB
Before first SDPA allocated = 20927.66650 MB
On chunked entry = 20927.66650 MB
On scale calculation = 20927.67432 MB
Before interleave = 20927.67432 MB
After interleave = 20928.17432 MB
After matmul = 20936.30127 MB
Before local copies matmul = 20936.30127 MB
After local copies = 20936.30420 MB
After first SDPA allocated = 20935.79150 MB
After first copy allocated = 20935.79150 MB
On chunked entry = 20935.79150 MB
On scale calculation = 20935.79932 MB
Before interleave = 20935.79932 MB
After interleave = 20936.14307 MB
After matmul = 20936.14453 MB
Before local copies matmul = 20936.14453 MB
After local copies = 20936.14697 MB
fter compute chunk allocated = 20935.79150 MB
Memory after cuda sdpa 20935.79931640625 MB
1
Memory before offload  20935.77783203125 MB
Memory after offload  20935.77783203125 MB
Memory before cuda sdpa 20935.79150390625 MB
On entering CUDA sdpa main function  allocated = 20935.79150 MB
Before first SDPA allocated = 20935.79150 MB
On chunked entry = 20935.79150 MB
On scale calculation = 20935.79932 MB
Before interleave = 20935.79932 MB
After interleave = 20936.29932 MB
After matmul = 20944.42627 MB
Before local copies matmul = 20944.42627 MB
After local copies = 20944.42920 MB
After first SDPA allocated = 20943.91650 MB
After first copy allocated = 20943.91650 MB
On chunked entry = 20943.91650 MB
On scale calculation = 20943.92432 MB
Before interleave = 20943.92432 MB
After interleave = 20944.26807 MB
After matmul = 20944.26953 MB
Before local copies matmul = 20944.26953 MB
After local copies = 20944.27197 MB
fter compute chunk allocated = 20943.91650 MB
Memory after cuda sdpa 20943.92431640625 MB
1
Memory before offload  20943.90283203125 MB
Memory after offload  20943.90283203125 MB
Memory before cuda sdpa 20943.91650390625 MB
On entering CUDA sdpa main function  allocated = 20943.91650 MB
Before first SDPA allocated = 20943.91650 MB
On chunked entry = 20943.91650 MB
On scale calculation = 20943.92432 MB
Before interleave = 20943.92432 MB
After interleave = 20944.42432 MB
After matmul = 20952.55127 MB
Before local copies matmul = 20952.55127 MB
After local copies = 20952.55420 MB
After first SDPA allocated = 20952.04150 MB
After first copy allocated = 20952.04150 MB
On chunked entry = 20952.04150 MB
On scale calculation = 20952.04932 MB
Before interleave = 20952.04932 MB
After interleave = 20952.39307 MB
After matmul = 20952.39453 MB
Before local copies matmul = 20952.39453 MB
After local copies = 20952.39697 MB
fter compute chunk allocated = 20952.04150 MB
Memory after cuda sdpa 20952.04931640625 MB
1
Memory before offload  20952.02783203125 MB
Memory after offload  20952.02783203125 MB
Memory before cuda sdpa 20952.04150390625 MB
On entering CUDA sdpa main function  allocated = 20952.04150 MB
Before first SDPA allocated = 20952.04150 MB
On chunked entry = 20952.04150 MB
On scale calculation = 20952.04932 MB
Before interleave = 20952.04932 MB
After interleave = 20952.54932 MB
After matmul = 20960.67627 MB
Before local copies matmul = 20960.67627 MB
After local copies = 20960.67920 MB
After first SDPA allocated = 20960.16650 MB
After first copy allocated = 20960.16650 MB
On chunked entry = 20960.16650 MB
On scale calculation = 20960.17432 MB
Before interleave = 20960.17432 MB
After interleave = 20960.51807 MB
After matmul = 20960.51953 MB
Before local copies matmul = 20960.51953 MB
After local copies = 20960.52197 MB
fter compute chunk allocated = 20960.16650 MB
Memory after cuda sdpa 20960.17431640625 MB
1
Memory before offload  20960.15283203125 MB
Memory after offload  20960.15283203125 MB
Memory before cuda sdpa 20960.16650390625 MB
On entering CUDA sdpa main function  allocated = 20960.16650 MB
Before first SDPA allocated = 20960.16650 MB
On chunked entry = 20960.16650 MB
On scale calculation = 20960.17432 MB
Before interleave = 20960.17432 MB
After interleave = 20960.67432 MB
After matmul = 20968.80127 MB
Before local copies matmul = 20968.80127 MB
After local copies = 20968.80420 MB
After first SDPA allocated = 20968.29150 MB
After first copy allocated = 20968.29150 MB
On chunked entry = 20968.29150 MB
On scale calculation = 20968.29932 MB
Before interleave = 20968.29932 MB
After interleave = 20968.64307 MB
After matmul = 20968.64453 MB
Before local copies matmul = 20968.64453 MB
After local copies = 20968.64697 MB
fter compute chunk allocated = 20968.29150 MB
Memory after cuda sdpa 20968.29931640625 MB
1
Memory before offload  20968.27783203125 MB
Memory after offload  20968.27783203125 MB
Memory before cuda sdpa 20968.29150390625 MB
On entering CUDA sdpa main function  allocated = 20968.29150 MB
Before first SDPA allocated = 20968.29150 MB
On chunked entry = 20968.29150 MB
On scale calculation = 20968.29932 MB
Before interleave = 20968.29932 MB
After interleave = 20968.79932 MB
After matmul = 20976.92627 MB
Before local copies matmul = 20976.92627 MB
After local copies = 20976.92920 MB
After first SDPA allocated = 20976.41650 MB
After first copy allocated = 20976.41650 MB
On chunked entry = 20976.41650 MB
On scale calculation = 20976.42432 MB
Before interleave = 20976.42432 MB
After interleave = 20976.76807 MB
After matmul = 20976.76953 MB
Before local copies matmul = 20976.76953 MB
After local copies = 20976.77197 MB
fter compute chunk allocated = 20976.41650 MB
Memory after cuda sdpa 20976.42431640625 MB
1
Memory before offload  20976.40283203125 MB
Memory after offload  20976.40283203125 MB
Memory before cuda sdpa 20976.41650390625 MB
On entering CUDA sdpa main function  allocated = 20976.41650 MB
Before first SDPA allocated = 20976.41650 MB
On chunked entry = 20976.41650 MB
On scale calculation = 20976.42432 MB
Before interleave = 20976.42432 MB
After interleave = 20976.92432 MB
After matmul = 20985.05127 MB
Before local copies matmul = 20985.05127 MB
After local copies = 20985.05420 MB
After first SDPA allocated = 20984.54150 MB
After first copy allocated = 20984.54150 MB
On chunked entry = 20984.54150 MB
On scale calculation = 20984.54932 MB
Before interleave = 20984.54932 MB
After interleave = 20984.89307 MB
After matmul = 20984.89453 MB
Before local copies matmul = 20984.89453 MB
After local copies = 20984.89697 MB
fter compute chunk allocated = 20984.54150 MB
Memory after cuda sdpa 20984.54931640625 MB
1
Memory before offload  20984.52783203125 MB
Memory after offload  20984.52783203125 MB
Memory before cuda sdpa 20984.54150390625 MB
On entering CUDA sdpa main function  allocated = 20984.54150 MB
Before first SDPA allocated = 20984.54150 MB
On chunked entry = 20984.54150 MB
On scale calculation = 20984.54932 MB
Before interleave = 20984.54932 MB
After interleave = 20985.04932 MB
After matmul = 20993.17627 MB
Before local copies matmul = 20993.17627 MB
After local copies = 20993.17920 MB
After first SDPA allocated = 20992.66650 MB
After first copy allocated = 20992.66650 MB
On chunked entry = 20992.66650 MB
On scale calculation = 20992.67432 MB
Before interleave = 20992.67432 MB
After interleave = 20993.01807 MB
After matmul = 20993.01953 MB
Before local copies matmul = 20993.01953 MB
After local copies = 20993.02197 MB
fter compute chunk allocated = 20992.66650 MB
Memory after cuda sdpa 20992.67431640625 MB
1
Memory before offload  20992.65283203125 MB
Memory after offload  20992.65283203125 MB
Memory before cuda sdpa 20992.66650390625 MB
On entering CUDA sdpa main function  allocated = 20992.66650 MB
Before first SDPA allocated = 20992.66650 MB
On chunked entry = 20992.66650 MB
On scale calculation = 20992.67432 MB
Before interleave = 20992.67432 MB
After interleave = 20993.17432 MB
After matmul = 21001.30127 MB
Before local copies matmul = 21001.30127 MB
After local copies = 21001.30420 MB
After first SDPA allocated = 21000.79150 MB
After first copy allocated = 21000.79150 MB
On chunked entry = 21000.79150 MB
On scale calculation = 21000.79932 MB
Before interleave = 21000.79932 MB
After interleave = 21001.14307 MB
After matmul = 21001.14453 MB
Before local copies matmul = 21001.14453 MB
After local copies = 21001.14697 MB
fter compute chunk allocated = 21000.79150 MB
Memory after cuda sdpa 21000.79931640625 MB
1
Memory before offload  21000.77783203125 MB
Memory after offload  21000.77783203125 MB
Memory before cuda sdpa 21000.79150390625 MB
On entering CUDA sdpa main function  allocated = 21000.79150 MB
Before first SDPA allocated = 21000.79150 MB
On chunked entry = 21000.79150 MB
On scale calculation = 21000.79932 MB
Before interleave = 21000.79932 MB
After interleave = 21001.29932 MB
After matmul = 21009.42627 MB
Before local copies matmul = 21009.42627 MB
After local copies = 21009.42920 MB
After first SDPA allocated = 21008.91650 MB
After first copy allocated = 21008.91650 MB
On chunked entry = 21008.91650 MB
On scale calculation = 21008.92432 MB
Before interleave = 21008.92432 MB
After interleave = 21009.26807 MB
After matmul = 21009.26953 MB
Before local copies matmul = 21009.26953 MB
After local copies = 21009.27197 MB
fter compute chunk allocated = 21008.91650 MB
Memory after cuda sdpa 21008.92431640625 MB
1
Memory before offload  21008.90283203125 MB
Memory after offload  21008.90283203125 MB
Memory before cuda sdpa 21008.91650390625 MB
On entering CUDA sdpa main function  allocated = 21008.91650 MB
Before first SDPA allocated = 21008.91650 MB
On chunked entry = 21008.91650 MB
On scale calculation = 21008.92432 MB
Before interleave = 21008.92432 MB
After interleave = 21009.42432 MB
After matmul = 21017.55127 MB
Before local copies matmul = 21017.55127 MB
After local copies = 21017.55420 MB
After first SDPA allocated = 21017.04150 MB
After first copy allocated = 21017.04150 MB
On chunked entry = 21017.04150 MB
On scale calculation = 21017.04932 MB
Before interleave = 21017.04932 MB
After interleave = 21017.39307 MB
After matmul = 21017.39453 MB
Before local copies matmul = 21017.39453 MB
After local copies = 21017.39697 MB
fter compute chunk allocated = 21017.04150 MB
Memory after cuda sdpa 21017.04931640625 MB
1
Memory before offload  21017.02783203125 MB
Memory after offload  21017.02783203125 MB
Memory before cuda sdpa 21017.04150390625 MB
On entering CUDA sdpa main function  allocated = 21017.04150 MB
Before first SDPA allocated = 21017.04150 MB
On chunked entry = 21017.04150 MB
On scale calculation = 21017.04932 MB
Before interleave = 21017.04932 MB
After interleave = 21017.54932 MB
After matmul = 21025.67627 MB
Before local copies matmul = 21025.67627 MB
After local copies = 21025.67920 MB
After first SDPA allocated = 21025.16650 MB
After first copy allocated = 21025.16650 MB
On chunked entry = 21025.16650 MB
On scale calculation = 21025.17432 MB
Before interleave = 21025.17432 MB
After interleave = 21025.51807 MB
After matmul = 21025.51953 MB
Before local copies matmul = 21025.51953 MB
After local copies = 21025.52197 MB
fter compute chunk allocated = 21025.16650 MB
Memory after cuda sdpa 21025.17431640625 MB
1
Memory before offload  21025.15283203125 MB
Memory after offload  21025.15283203125 MB
Memory before cuda sdpa 21025.16650390625 MB
On entering CUDA sdpa main function  allocated = 21025.16650 MB
Before first SDPA allocated = 21025.16650 MB
On chunked entry = 21025.16650 MB
On scale calculation = 21025.17432 MB
Before interleave = 21025.17432 MB
After interleave = 21025.67432 MB
After matmul = 21033.80127 MB
Before local copies matmul = 21033.80127 MB
After local copies = 21033.80420 MB
After first SDPA allocated = 21033.29150 MB
After first copy allocated = 21033.29150 MB
On chunked entry = 21033.29150 MB
On scale calculation = 21033.29932 MB
Before interleave = 21033.29932 MB
After interleave = 21033.64307 MB
After matmul = 21033.64453 MB
Before local copies matmul = 21033.64453 MB
After local copies = 21033.64697 MB
fter compute chunk allocated = 21033.29150 MB
Memory after cuda sdpa 21033.29931640625 MB
1
Memory before offload  21033.27783203125 MB
Memory after offload  21033.27783203125 MB
Memory before cuda sdpa 21033.29150390625 MB
On entering CUDA sdpa main function  allocated = 21033.29150 MB
Before first SDPA allocated = 21033.29150 MB
On chunked entry = 21033.29150 MB
On scale calculation = 21033.29932 MB
Before interleave = 21033.29932 MB
After interleave = 21033.79932 MB
After matmul = 21041.92627 MB
Before local copies matmul = 21041.92627 MB
After local copies = 21041.92920 MB
After first SDPA allocated = 21041.41650 MB
After first copy allocated = 21041.41650 MB
On chunked entry = 21041.41650 MB
On scale calculation = 21041.42432 MB
Before interleave = 21041.42432 MB
After interleave = 21041.76807 MB
After matmul = 21041.76953 MB
Before local copies matmul = 21041.76953 MB
After local copies = 21041.77197 MB
fter compute chunk allocated = 21041.41650 MB
Memory after cuda sdpa 21041.42431640625 MB
1
Memory before offload  21041.40283203125 MB
Memory after offload  21041.40283203125 MB
Memory before cuda sdpa 21041.41650390625 MB
On entering CUDA sdpa main function  allocated = 21041.41650 MB
Before first SDPA allocated = 21041.41650 MB
On chunked entry = 21041.41650 MB
On scale calculation = 21041.42432 MB
Before interleave = 21041.42432 MB
After interleave = 21041.92432 MB
After matmul = 21050.05127 MB
Before local copies matmul = 21050.05127 MB
After local copies = 21050.05420 MB
After first SDPA allocated = 21049.54150 MB
After first copy allocated = 21049.54150 MB
On chunked entry = 21049.54150 MB
On scale calculation = 21049.54932 MB
Before interleave = 21049.54932 MB
After interleave = 21049.89307 MB
After matmul = 21049.89453 MB
Before local copies matmul = 21049.89453 MB
After local copies = 21049.89697 MB
fter compute chunk allocated = 21049.54150 MB
Memory after cuda sdpa 21049.54931640625 MB
1
Memory before offload  21049.52783203125 MB
Memory after offload  21049.52783203125 MB
Memory before cuda sdpa 21049.54150390625 MB
On entering CUDA sdpa main function  allocated = 21049.54150 MB
Before first SDPA allocated = 21049.54150 MB
On chunked entry = 21049.54150 MB
On scale calculation = 21049.54932 MB
Before interleave = 21049.54932 MB
After interleave = 21050.04932 MB
After matmul = 21058.17627 MB
Before local copies matmul = 21058.17627 MB
After local copies = 21058.17920 MB
After first SDPA allocated = 21057.66650 MB
After first copy allocated = 21057.66650 MB
On chunked entry = 21057.66650 MB
On scale calculation = 21057.67432 MB
Before interleave = 21057.67432 MB
After interleave = 21058.01807 MB
After matmul = 21058.01953 MB
Before local copies matmul = 21058.01953 MB
After local copies = 21058.02197 MB
fter compute chunk allocated = 21057.66650 MB
Memory after cuda sdpa 21057.67431640625 MB
1
Memory before offload  21057.65283203125 MB
Memory after offload  21057.65283203125 MB
Memory before cuda sdpa 21057.66650390625 MB
On entering CUDA sdpa main function  allocated = 21057.66650 MB
Before first SDPA allocated = 21057.66650 MB
On chunked entry = 21057.66650 MB
On scale calculation = 21057.67432 MB
Before interleave = 21057.67432 MB
After interleave = 21058.17432 MB
After matmul = 21066.30127 MB
Before local copies matmul = 21066.30127 MB
After local copies = 21066.30420 MB
After first SDPA allocated = 21065.79150 MB
After first copy allocated = 21065.79150 MB
On chunked entry = 21065.79150 MB
On scale calculation = 21065.79932 MB
Before interleave = 21065.79932 MB
After interleave = 21066.14307 MB
After matmul = 21066.14453 MB
Before local copies matmul = 21066.14453 MB
After local copies = 21066.14697 MB
fter compute chunk allocated = 21065.79150 MB
Memory after cuda sdpa 21065.79931640625 MB
Decode step 23
1
Memory before offload  21065.7783203125 MB
Memory after offload  21065.7783203125 MB
Memory before cuda sdpa 21065.7919921875 MB
On entering CUDA sdpa main function  allocated = 21065.79199 MB
Before first SDPA allocated = 21065.79199 MB
On chunked entry = 21065.79199 MB
On scale calculation = 21065.79980 MB
Before interleave = 21065.79980 MB
After interleave = 21066.29980 MB
After matmul = 21074.42676 MB
Before local copies matmul = 21074.42676 MB
After local copies = 21074.42969 MB
After first SDPA allocated = 21073.91699 MB
After first copy allocated = 21073.91699 MB
On chunked entry = 21073.91699 MB
On scale calculation = 21073.92480 MB
Before interleave = 21073.92480 MB
After interleave = 21074.28418 MB
After matmul = 21074.28564 MB
Before local copies matmul = 21074.28564 MB
After local copies = 21074.28809 MB
fter compute chunk allocated = 21073.91699 MB
Memory after cuda sdpa 21073.9248046875 MB
1
Memory before offload  21073.9033203125 MB
Memory after offload  21073.9033203125 MB
Memory before cuda sdpa 21073.9169921875 MB
On entering CUDA sdpa main function  allocated = 21073.91699 MB
Before first SDPA allocated = 21073.91699 MB
On chunked entry = 21073.91699 MB
On scale calculation = 21073.92480 MB
Before interleave = 21073.92480 MB
After interleave = 21074.42480 MB
After matmul = 21082.55176 MB
Before local copies matmul = 21082.55176 MB
After local copies = 21082.55469 MB
After first SDPA allocated = 21082.04199 MB
After first copy allocated = 21082.04199 MB
On chunked entry = 21082.04199 MB
On scale calculation = 21082.04980 MB
Before interleave = 21082.04980 MB
After interleave = 21082.40918 MB
After matmul = 21082.41064 MB
Before local copies matmul = 21082.41064 MB
After local copies = 21082.41309 MB
fter compute chunk allocated = 21082.04199 MB
Memory after cuda sdpa 21082.0498046875 MB
1
Memory before offload  21082.0283203125 MB
Memory after offload  21082.0283203125 MB
Memory before cuda sdpa 21082.0419921875 MB
On entering CUDA sdpa main function  allocated = 21082.04199 MB
Before first SDPA allocated = 21082.04199 MB
On chunked entry = 21082.04199 MB
On scale calculation = 21082.04980 MB
Before interleave = 21082.04980 MB
After interleave = 21082.54980 MB
After matmul = 21090.67676 MB
Before local copies matmul = 21090.67676 MB
After local copies = 21090.67969 MB
After first SDPA allocated = 21090.16699 MB
After first copy allocated = 21090.16699 MB
On chunked entry = 21090.16699 MB
On scale calculation = 21090.17480 MB
Before interleave = 21090.17480 MB
After interleave = 21090.53418 MB
After matmul = 21090.53564 MB
Before local copies matmul = 21090.53564 MB
After local copies = 21090.53809 MB
fter compute chunk allocated = 21090.16699 MB
Memory after cuda sdpa 21090.1748046875 MB
1
Memory before offload  21090.1533203125 MB
Memory after offload  21090.1533203125 MB
Memory before cuda sdpa 21090.1669921875 MB
On entering CUDA sdpa main function  allocated = 21090.16699 MB
Before first SDPA allocated = 21090.16699 MB
On chunked entry = 21090.16699 MB
On scale calculation = 21090.17480 MB
Before interleave = 21090.17480 MB
After interleave = 21090.67480 MB
After matmul = 21098.80176 MB
Before local copies matmul = 21098.80176 MB
After local copies = 21098.80469 MB
After first SDPA allocated = 21098.29199 MB
After first copy allocated = 21098.29199 MB
On chunked entry = 21098.29199 MB
On scale calculation = 21098.29980 MB
Before interleave = 21098.29980 MB
After interleave = 21098.65918 MB
After matmul = 21098.66064 MB
Before local copies matmul = 21098.66064 MB
After local copies = 21098.66309 MB
fter compute chunk allocated = 21098.29199 MB
Memory after cuda sdpa 21098.2998046875 MB
1
Memory before offload  21098.2783203125 MB
Memory after offload  21098.2783203125 MB
Memory before cuda sdpa 21098.2919921875 MB
On entering CUDA sdpa main function  allocated = 21098.29199 MB
Before first SDPA allocated = 21098.29199 MB
On chunked entry = 21098.29199 MB
On scale calculation = 21098.29980 MB
Before interleave = 21098.29980 MB
After interleave = 21098.79980 MB
After matmul = 21106.92676 MB
Before local copies matmul = 21106.92676 MB
After local copies = 21106.92969 MB
After first SDPA allocated = 21106.41699 MB
After first copy allocated = 21106.41699 MB
On chunked entry = 21106.41699 MB
On scale calculation = 21106.42480 MB
Before interleave = 21106.42480 MB
After interleave = 21106.78418 MB
After matmul = 21106.78564 MB
Before local copies matmul = 21106.78564 MB
After local copies = 21106.78809 MB
fter compute chunk allocated = 21106.41699 MB
Memory after cuda sdpa 21106.4248046875 MB
1
Memory before offload  21106.4033203125 MB
Memory after offload  21106.4033203125 MB
Memory before cuda sdpa 21106.4169921875 MB
On entering CUDA sdpa main function  allocated = 21106.41699 MB
Before first SDPA allocated = 21106.41699 MB
On chunked entry = 21106.41699 MB
On scale calculation = 21106.42480 MB
Before interleave = 21106.42480 MB
After interleave = 21106.92480 MB
After matmul = 21115.05176 MB
Before local copies matmul = 21115.05176 MB
After local copies = 21115.05469 MB
After first SDPA allocated = 21114.54199 MB
After first copy allocated = 21114.54199 MB
On chunked entry = 21114.54199 MB
On scale calculation = 21114.54980 MB
Before interleave = 21114.54980 MB
After interleave = 21114.90918 MB
After matmul = 21114.91064 MB
Before local copies matmul = 21114.91064 MB
After local copies = 21114.91309 MB
fter compute chunk allocated = 21114.54199 MB
Memory after cuda sdpa 21114.5498046875 MB
1
Memory before offload  21114.5283203125 MB
Memory after offload  21114.5283203125 MB
Memory before cuda sdpa 21114.5419921875 MB
On entering CUDA sdpa main function  allocated = 21114.54199 MB
Before first SDPA allocated = 21114.54199 MB
On chunked entry = 21114.54199 MB
On scale calculation = 21114.54980 MB
Before interleave = 21114.54980 MB
After interleave = 21115.04980 MB
After matmul = 21123.17676 MB
Before local copies matmul = 21123.17676 MB
After local copies = 21123.17969 MB
After first SDPA allocated = 21122.66699 MB
After first copy allocated = 21122.66699 MB
On chunked entry = 21122.66699 MB
On scale calculation = 21122.67480 MB
Before interleave = 21122.67480 MB
After interleave = 21123.03418 MB
After matmul = 21123.03564 MB
Before local copies matmul = 21123.03564 MB
After local copies = 21123.03809 MB
fter compute chunk allocated = 21122.66699 MB
Memory after cuda sdpa 21122.6748046875 MB
1
Memory before offload  21122.6533203125 MB
Memory after offload  21122.6533203125 MB
Memory before cuda sdpa 21122.6669921875 MB
On entering CUDA sdpa main function  allocated = 21122.66699 MB
Before first SDPA allocated = 21122.66699 MB
On chunked entry = 21122.66699 MB
On scale calculation = 21122.67480 MB
Before interleave = 21122.67480 MB
After interleave = 21123.17480 MB
After matmul = 21131.30176 MB
Before local copies matmul = 21131.30176 MB
After local copies = 21131.30469 MB
After first SDPA allocated = 21130.79199 MB
After first copy allocated = 21130.79199 MB
On chunked entry = 21130.79199 MB
On scale calculation = 21130.79980 MB
Before interleave = 21130.79980 MB
After interleave = 21131.15918 MB
After matmul = 21131.16064 MB
Before local copies matmul = 21131.16064 MB
After local copies = 21131.16309 MB
fter compute chunk allocated = 21130.79199 MB
Memory after cuda sdpa 21130.7998046875 MB
1
Memory before offload  21130.7783203125 MB
Memory after offload  21130.7783203125 MB
Memory before cuda sdpa 21130.7919921875 MB
On entering CUDA sdpa main function  allocated = 21130.79199 MB
Before first SDPA allocated = 21130.79199 MB
On chunked entry = 21130.79199 MB
On scale calculation = 21130.79980 MB
Before interleave = 21130.79980 MB
After interleave = 21131.29980 MB
After matmul = 21139.42676 MB
Before local copies matmul = 21139.42676 MB
After local copies = 21139.42969 MB
After first SDPA allocated = 21138.91699 MB
After first copy allocated = 21138.91699 MB
On chunked entry = 21138.91699 MB
On scale calculation = 21138.92480 MB
Before interleave = 21138.92480 MB
After interleave = 21139.28418 MB
After matmul = 21139.28564 MB
Before local copies matmul = 21139.28564 MB
After local copies = 21139.28809 MB
fter compute chunk allocated = 21138.91699 MB
Memory after cuda sdpa 21138.9248046875 MB
1
Memory before offload  21138.9033203125 MB
Memory after offload  21138.9033203125 MB
Memory before cuda sdpa 21138.9169921875 MB
On entering CUDA sdpa main function  allocated = 21138.91699 MB
Before first SDPA allocated = 21138.91699 MB
On chunked entry = 21138.91699 MB
On scale calculation = 21138.92480 MB
Before interleave = 21138.92480 MB
After interleave = 21139.42480 MB
After matmul = 21147.55176 MB
Before local copies matmul = 21147.55176 MB
After local copies = 21147.55469 MB
After first SDPA allocated = 21147.04199 MB
After first copy allocated = 21147.04199 MB
On chunked entry = 21147.04199 MB
On scale calculation = 21147.04980 MB
Before interleave = 21147.04980 MB
After interleave = 21147.40918 MB
After matmul = 21147.41064 MB
Before local copies matmul = 21147.41064 MB
After local copies = 21147.41309 MB
fter compute chunk allocated = 21147.04199 MB
Memory after cuda sdpa 21147.0498046875 MB
1
Memory before offload  21147.0283203125 MB
Memory after offload  21147.0283203125 MB
Memory before cuda sdpa 21147.0419921875 MB
On entering CUDA sdpa main function  allocated = 21147.04199 MB
Before first SDPA allocated = 21147.04199 MB
On chunked entry = 21147.04199 MB
On scale calculation = 21147.04980 MB
Before interleave = 21147.04980 MB
After interleave = 21147.54980 MB
After matmul = 21155.67676 MB
Before local copies matmul = 21155.67676 MB
After local copies = 21155.67969 MB
After first SDPA allocated = 21155.16699 MB
After first copy allocated = 21155.16699 MB
On chunked entry = 21155.16699 MB
On scale calculation = 21155.17480 MB
Before interleave = 21155.17480 MB
After interleave = 21155.53418 MB
After matmul = 21155.53564 MB
Before local copies matmul = 21155.53564 MB
After local copies = 21155.53809 MB
fter compute chunk allocated = 21155.16699 MB
Memory after cuda sdpa 21155.1748046875 MB
1
Memory before offload  21155.1533203125 MB
Memory after offload  21155.1533203125 MB
Memory before cuda sdpa 21155.1669921875 MB
On entering CUDA sdpa main function  allocated = 21155.16699 MB
Before first SDPA allocated = 21155.16699 MB
On chunked entry = 21155.16699 MB
On scale calculation = 21155.17480 MB
Before interleave = 21155.17480 MB
After interleave = 21155.67480 MB
After matmul = 21163.80176 MB
Before local copies matmul = 21163.80176 MB
After local copies = 21163.80469 MB
After first SDPA allocated = 21163.29199 MB
After first copy allocated = 21163.29199 MB
On chunked entry = 21163.29199 MB
On scale calculation = 21163.29980 MB
Before interleave = 21163.29980 MB
After interleave = 21163.65918 MB
After matmul = 21163.66064 MB
Before local copies matmul = 21163.66064 MB
After local copies = 21163.66309 MB
fter compute chunk allocated = 21163.29199 MB
Memory after cuda sdpa 21163.2998046875 MB
1
Memory before offload  21163.2783203125 MB
Memory after offload  21163.2783203125 MB
Memory before cuda sdpa 21163.2919921875 MB
On entering CUDA sdpa main function  allocated = 21163.29199 MB
Before first SDPA allocated = 21163.29199 MB
On chunked entry = 21163.29199 MB
On scale calculation = 21163.29980 MB
Before interleave = 21163.29980 MB
After interleave = 21163.79980 MB
After matmul = 21171.92676 MB
Before local copies matmul = 21171.92676 MB
After local copies = 21171.92969 MB
After first SDPA allocated = 21171.41699 MB
After first copy allocated = 21171.41699 MB
On chunked entry = 21171.41699 MB
On scale calculation = 21171.42480 MB
Before interleave = 21171.42480 MB
After interleave = 21171.78418 MB
After matmul = 21171.78564 MB
Before local copies matmul = 21171.78564 MB
After local copies = 21171.78809 MB
fter compute chunk allocated = 21171.41699 MB
Memory after cuda sdpa 21171.4248046875 MB
1
Memory before offload  21171.4033203125 MB
Memory after offload  21171.4033203125 MB
Memory before cuda sdpa 21171.4169921875 MB
On entering CUDA sdpa main function  allocated = 21171.41699 MB
Before first SDPA allocated = 21171.41699 MB
On chunked entry = 21171.41699 MB
On scale calculation = 21171.42480 MB
Before interleave = 21171.42480 MB
After interleave = 21171.92480 MB
After matmul = 21180.05176 MB
Before local copies matmul = 21180.05176 MB
After local copies = 21180.05469 MB
After first SDPA allocated = 21179.54199 MB
After first copy allocated = 21179.54199 MB
On chunked entry = 21179.54199 MB
On scale calculation = 21179.54980 MB
Before interleave = 21179.54980 MB
After interleave = 21179.90918 MB
After matmul = 21179.91064 MB
Before local copies matmul = 21179.91064 MB
After local copies = 21179.91309 MB
fter compute chunk allocated = 21179.54199 MB
Memory after cuda sdpa 21179.5498046875 MB
1
Memory before offload  21179.5283203125 MB
Memory after offload  21179.5283203125 MB
Memory before cuda sdpa 21179.5419921875 MB
On entering CUDA sdpa main function  allocated = 21179.54199 MB
Before first SDPA allocated = 21179.54199 MB
On chunked entry = 21179.54199 MB
On scale calculation = 21179.54980 MB
Before interleave = 21179.54980 MB
After interleave = 21180.04980 MB
After matmul = 21188.17676 MB
Before local copies matmul = 21188.17676 MB
After local copies = 21188.17969 MB
After first SDPA allocated = 21187.66699 MB
After first copy allocated = 21187.66699 MB
On chunked entry = 21187.66699 MB
On scale calculation = 21187.67480 MB
Before interleave = 21187.67480 MB
After interleave = 21188.03418 MB
After matmul = 21188.03564 MB
Before local copies matmul = 21188.03564 MB
After local copies = 21188.03809 MB
fter compute chunk allocated = 21187.66699 MB
Memory after cuda sdpa 21187.6748046875 MB
1
Memory before offload  21187.6533203125 MB
Memory after offload  21187.6533203125 MB
Memory before cuda sdpa 21187.6669921875 MB
On entering CUDA sdpa main function  allocated = 21187.66699 MB
Before first SDPA allocated = 21187.66699 MB
On chunked entry = 21187.66699 MB
On scale calculation = 21187.67480 MB
Before interleave = 21187.67480 MB
After interleave = 21188.17480 MB
After matmul = 21196.30176 MB
Before local copies matmul = 21196.30176 MB
After local copies = 21196.30469 MB
After first SDPA allocated = 21195.79199 MB
After first copy allocated = 21195.79199 MB
On chunked entry = 21195.79199 MB
On scale calculation = 21195.79980 MB
Before interleave = 21195.79980 MB
After interleave = 21196.15918 MB
After matmul = 21196.16064 MB
Before local copies matmul = 21196.16064 MB
After local copies = 21196.16309 MB
fter compute chunk allocated = 21195.79199 MB
Memory after cuda sdpa 21195.7998046875 MB
1
Memory before offload  21195.7783203125 MB
Memory after offload  21195.7783203125 MB
Memory before cuda sdpa 21195.7919921875 MB
On entering CUDA sdpa main function  allocated = 21195.79199 MB
Before first SDPA allocated = 21195.79199 MB
On chunked entry = 21195.79199 MB
On scale calculation = 21195.79980 MB
Before interleave = 21195.79980 MB
After interleave = 21196.29980 MB
After matmul = 21204.42676 MB
Before local copies matmul = 21204.42676 MB
After local copies = 21204.42969 MB
After first SDPA allocated = 21203.91699 MB
After first copy allocated = 21203.91699 MB
On chunked entry = 21203.91699 MB
On scale calculation = 21203.92480 MB
Before interleave = 21203.92480 MB
After interleave = 21204.28418 MB
After matmul = 21204.28564 MB
Before local copies matmul = 21204.28564 MB
After local copies = 21204.28809 MB
fter compute chunk allocated = 21203.91699 MB
Memory after cuda sdpa 21203.9248046875 MB
1
Memory before offload  21203.9033203125 MB
Memory after offload  21203.9033203125 MB
Memory before cuda sdpa 21203.9169921875 MB
On entering CUDA sdpa main function  allocated = 21203.91699 MB
Before first SDPA allocated = 21203.91699 MB
On chunked entry = 21203.91699 MB
On scale calculation = 21203.92480 MB
Before interleave = 21203.92480 MB
After interleave = 21204.42480 MB
After matmul = 21212.55176 MB
Before local copies matmul = 21212.55176 MB
After local copies = 21212.55469 MB
After first SDPA allocated = 21212.04199 MB
After first copy allocated = 21212.04199 MB
On chunked entry = 21212.04199 MB
On scale calculation = 21212.04980 MB
Before interleave = 21212.04980 MB
After interleave = 21212.40918 MB
After matmul = 21212.41064 MB
Before local copies matmul = 21212.41064 MB
After local copies = 21212.41309 MB
fter compute chunk allocated = 21212.04199 MB
Memory after cuda sdpa 21212.0498046875 MB
1
Memory before offload  21212.0283203125 MB
Memory after offload  21212.0283203125 MB
Memory before cuda sdpa 21212.0419921875 MB
On entering CUDA sdpa main function  allocated = 21212.04199 MB
Before first SDPA allocated = 21212.04199 MB
On chunked entry = 21212.04199 MB
On scale calculation = 21212.04980 MB
Before interleave = 21212.04980 MB
After interleave = 21212.54980 MB
After matmul = 21220.67676 MB
Before local copies matmul = 21220.67676 MB
After local copies = 21220.67969 MB
After first SDPA allocated = 21220.16699 MB
After first copy allocated = 21220.16699 MB
On chunked entry = 21220.16699 MB
On scale calculation = 21220.17480 MB
Before interleave = 21220.17480 MB
After interleave = 21220.53418 MB
After matmul = 21220.53564 MB
Before local copies matmul = 21220.53564 MB
After local copies = 21220.53809 MB
fter compute chunk allocated = 21220.16699 MB
Memory after cuda sdpa 21220.1748046875 MB
1
Memory before offload  21220.1533203125 MB
Memory after offload  21220.1533203125 MB
Memory before cuda sdpa 21220.1669921875 MB
On entering CUDA sdpa main function  allocated = 21220.16699 MB
Before first SDPA allocated = 21220.16699 MB
On chunked entry = 21220.16699 MB
On scale calculation = 21220.17480 MB
Before interleave = 21220.17480 MB
After interleave = 21220.67480 MB
After matmul = 21228.80176 MB
Before local copies matmul = 21228.80176 MB
After local copies = 21228.80469 MB
After first SDPA allocated = 21228.29199 MB
After first copy allocated = 21228.29199 MB
On chunked entry = 21228.29199 MB
On scale calculation = 21228.29980 MB
Before interleave = 21228.29980 MB
After interleave = 21228.65918 MB
After matmul = 21228.66064 MB
Before local copies matmul = 21228.66064 MB
After local copies = 21228.66309 MB
fter compute chunk allocated = 21228.29199 MB
Memory after cuda sdpa 21228.2998046875 MB
1
Memory before offload  21228.2783203125 MB
Memory after offload  21228.2783203125 MB
Memory before cuda sdpa 21228.2919921875 MB
On entering CUDA sdpa main function  allocated = 21228.29199 MB
Before first SDPA allocated = 21228.29199 MB
On chunked entry = 21228.29199 MB
On scale calculation = 21228.29980 MB
Before interleave = 21228.29980 MB
After interleave = 21228.79980 MB
After matmul = 21236.92676 MB
Before local copies matmul = 21236.92676 MB
After local copies = 21236.92969 MB
After first SDPA allocated = 21236.41699 MB
After first copy allocated = 21236.41699 MB
On chunked entry = 21236.41699 MB
On scale calculation = 21236.42480 MB
Before interleave = 21236.42480 MB
After interleave = 21236.78418 MB
After matmul = 21236.78564 MB
Before local copies matmul = 21236.78564 MB
After local copies = 21236.78809 MB
fter compute chunk allocated = 21236.41699 MB
Memory after cuda sdpa 21236.4248046875 MB
1
Memory before offload  21236.4033203125 MB
Memory after offload  21236.4033203125 MB
Memory before cuda sdpa 21236.4169921875 MB
On entering CUDA sdpa main function  allocated = 21236.41699 MB
Before first SDPA allocated = 21236.41699 MB
On chunked entry = 21236.41699 MB
On scale calculation = 21236.42480 MB
Before interleave = 21236.42480 MB
After interleave = 21236.92480 MB
After matmul = 21245.05176 MB
Before local copies matmul = 21245.05176 MB
After local copies = 21245.05469 MB
After first SDPA allocated = 21244.54199 MB
After first copy allocated = 21244.54199 MB
On chunked entry = 21244.54199 MB
On scale calculation = 21244.54980 MB
Before interleave = 21244.54980 MB
After interleave = 21244.90918 MB
After matmul = 21244.91064 MB
Before local copies matmul = 21244.91064 MB
After local copies = 21244.91309 MB
fter compute chunk allocated = 21244.54199 MB
Memory after cuda sdpa 21244.5498046875 MB
1
Memory before offload  21244.5283203125 MB
Memory after offload  21244.5283203125 MB
Memory before cuda sdpa 21244.5419921875 MB
On entering CUDA sdpa main function  allocated = 21244.54199 MB
Before first SDPA allocated = 21244.54199 MB
On chunked entry = 21244.54199 MB
On scale calculation = 21244.54980 MB
Before interleave = 21244.54980 MB
After interleave = 21245.04980 MB
After matmul = 21253.17676 MB
Before local copies matmul = 21253.17676 MB
After local copies = 21253.17969 MB
After first SDPA allocated = 21252.66699 MB
After first copy allocated = 21252.66699 MB
On chunked entry = 21252.66699 MB
On scale calculation = 21252.67480 MB
Before interleave = 21252.67480 MB
After interleave = 21253.03418 MB
After matmul = 21253.03564 MB
Before local copies matmul = 21253.03564 MB
After local copies = 21253.03809 MB
fter compute chunk allocated = 21252.66699 MB
Memory after cuda sdpa 21252.6748046875 MB
1
Memory before offload  21252.6533203125 MB
Memory after offload  21252.6533203125 MB
Memory before cuda sdpa 21252.6669921875 MB
On entering CUDA sdpa main function  allocated = 21252.66699 MB
Before first SDPA allocated = 21252.66699 MB
On chunked entry = 21252.66699 MB
On scale calculation = 21252.67480 MB
Before interleave = 21252.67480 MB
After interleave = 21253.17480 MB
After matmul = 21261.30176 MB
Before local copies matmul = 21261.30176 MB
After local copies = 21261.30469 MB
After first SDPA allocated = 21260.79199 MB
After first copy allocated = 21260.79199 MB
On chunked entry = 21260.79199 MB
On scale calculation = 21260.79980 MB
Before interleave = 21260.79980 MB
After interleave = 21261.15918 MB
After matmul = 21261.16064 MB
Before local copies matmul = 21261.16064 MB
After local copies = 21261.16309 MB
fter compute chunk allocated = 21260.79199 MB
Memory after cuda sdpa 21260.7998046875 MB
1
Memory before offload  21260.7783203125 MB
Memory after offload  21260.7783203125 MB
Memory before cuda sdpa 21260.7919921875 MB
On entering CUDA sdpa main function  allocated = 21260.79199 MB
Before first SDPA allocated = 21260.79199 MB
On chunked entry = 21260.79199 MB
On scale calculation = 21260.79980 MB
Before interleave = 21260.79980 MB
After interleave = 21261.29980 MB
After matmul = 21269.42676 MB
Before local copies matmul = 21269.42676 MB
After local copies = 21269.42969 MB
After first SDPA allocated = 21268.91699 MB
After first copy allocated = 21268.91699 MB
On chunked entry = 21268.91699 MB
On scale calculation = 21268.92480 MB
Before interleave = 21268.92480 MB
After interleave = 21269.28418 MB
After matmul = 21269.28564 MB
Before local copies matmul = 21269.28564 MB
After local copies = 21269.28809 MB
fter compute chunk allocated = 21268.91699 MB
Memory after cuda sdpa 21268.9248046875 MB
1
Memory before offload  21268.9033203125 MB
Memory after offload  21268.9033203125 MB
Memory before cuda sdpa 21268.9169921875 MB
On entering CUDA sdpa main function  allocated = 21268.91699 MB
Before first SDPA allocated = 21268.91699 MB
On chunked entry = 21268.91699 MB
On scale calculation = 21268.92480 MB
Before interleave = 21268.92480 MB
After interleave = 21269.42480 MB
After matmul = 21277.55176 MB
Before local copies matmul = 21277.55176 MB
After local copies = 21277.55469 MB
After first SDPA allocated = 21277.04199 MB
After first copy allocated = 21277.04199 MB
On chunked entry = 21277.04199 MB
On scale calculation = 21277.04980 MB
Before interleave = 21277.04980 MB
After interleave = 21277.40918 MB
After matmul = 21277.41064 MB
Before local copies matmul = 21277.41064 MB
After local copies = 21277.41309 MB
fter compute chunk allocated = 21277.04199 MB
Memory after cuda sdpa 21277.0498046875 MB
1
Memory before offload  21277.0283203125 MB
Memory after offload  21277.0283203125 MB
Memory before cuda sdpa 21277.0419921875 MB
On entering CUDA sdpa main function  allocated = 21277.04199 MB
Before first SDPA allocated = 21277.04199 MB
On chunked entry = 21277.04199 MB
On scale calculation = 21277.04980 MB
Before interleave = 21277.04980 MB
After interleave = 21277.54980 MB
After matmul = 21285.67676 MB
Before local copies matmul = 21285.67676 MB
After local copies = 21285.67969 MB
After first SDPA allocated = 21285.16699 MB
After first copy allocated = 21285.16699 MB
On chunked entry = 21285.16699 MB
On scale calculation = 21285.17480 MB
Before interleave = 21285.17480 MB
After interleave = 21285.53418 MB
After matmul = 21285.53564 MB
Before local copies matmul = 21285.53564 MB
After local copies = 21285.53809 MB
fter compute chunk allocated = 21285.16699 MB
Memory after cuda sdpa 21285.1748046875 MB
1
Memory before offload  21285.1533203125 MB
Memory after offload  21285.1533203125 MB
Memory before cuda sdpa 21285.1669921875 MB
On entering CUDA sdpa main function  allocated = 21285.16699 MB
Before first SDPA allocated = 21285.16699 MB
On chunked entry = 21285.16699 MB
On scale calculation = 21285.17480 MB
Before interleave = 21285.17480 MB
After interleave = 21285.67480 MB
After matmul = 21293.80176 MB
Before local copies matmul = 21293.80176 MB
After local copies = 21293.80469 MB
After first SDPA allocated = 21293.29199 MB
After first copy allocated = 21293.29199 MB
On chunked entry = 21293.29199 MB
On scale calculation = 21293.29980 MB
Before interleave = 21293.29980 MB
After interleave = 21293.65918 MB
After matmul = 21293.66064 MB
Before local copies matmul = 21293.66064 MB
After local copies = 21293.66309 MB
fter compute chunk allocated = 21293.29199 MB
Memory after cuda sdpa 21293.2998046875 MB
1
Memory before offload  21293.2783203125 MB
Memory after offload  21293.2783203125 MB
Memory before cuda sdpa 21293.2919921875 MB
On entering CUDA sdpa main function  allocated = 21293.29199 MB
Before first SDPA allocated = 21293.29199 MB
On chunked entry = 21293.29199 MB
On scale calculation = 21293.29980 MB
Before interleave = 21293.29980 MB
After interleave = 21293.79980 MB
After matmul = 21301.92676 MB
Before local copies matmul = 21301.92676 MB
After local copies = 21301.92969 MB
After first SDPA allocated = 21301.41699 MB
After first copy allocated = 21301.41699 MB
On chunked entry = 21301.41699 MB
On scale calculation = 21301.42480 MB
Before interleave = 21301.42480 MB
After interleave = 21301.78418 MB
After matmul = 21301.78564 MB
Before local copies matmul = 21301.78564 MB
After local copies = 21301.78809 MB
fter compute chunk allocated = 21301.41699 MB
Memory after cuda sdpa 21301.4248046875 MB
1
Memory before offload  21301.4033203125 MB
Memory after offload  21301.4033203125 MB
Memory before cuda sdpa 21301.4169921875 MB
On entering CUDA sdpa main function  allocated = 21301.41699 MB
Before first SDPA allocated = 21301.41699 MB
On chunked entry = 21301.41699 MB
On scale calculation = 21301.42480 MB
Before interleave = 21301.42480 MB
After interleave = 21301.92480 MB
After matmul = 21310.05176 MB
Before local copies matmul = 21310.05176 MB
After local copies = 21310.05469 MB
After first SDPA allocated = 21309.54199 MB
After first copy allocated = 21309.54199 MB
On chunked entry = 21309.54199 MB
On scale calculation = 21309.54980 MB
Before interleave = 21309.54980 MB
After interleave = 21309.90918 MB
After matmul = 21309.91064 MB
Before local copies matmul = 21309.91064 MB
After local copies = 21309.91309 MB
fter compute chunk allocated = 21309.54199 MB
Memory after cuda sdpa 21309.5498046875 MB
1
Memory before offload  21309.5283203125 MB
Memory after offload  21309.5283203125 MB
Memory before cuda sdpa 21309.5419921875 MB
On entering CUDA sdpa main function  allocated = 21309.54199 MB
Before first SDPA allocated = 21309.54199 MB
On chunked entry = 21309.54199 MB
On scale calculation = 21309.54980 MB
Before interleave = 21309.54980 MB
After interleave = 21310.04980 MB
After matmul = 21318.17676 MB
Before local copies matmul = 21318.17676 MB
After local copies = 21318.17969 MB
After first SDPA allocated = 21317.66699 MB
After first copy allocated = 21317.66699 MB
On chunked entry = 21317.66699 MB
On scale calculation = 21317.67480 MB
Before interleave = 21317.67480 MB
After interleave = 21318.03418 MB
After matmul = 21318.03564 MB
Before local copies matmul = 21318.03564 MB
After local copies = 21318.03809 MB
fter compute chunk allocated = 21317.66699 MB
Memory after cuda sdpa 21317.6748046875 MB
1
Memory before offload  21317.6533203125 MB
Memory after offload  21317.6533203125 MB
Memory before cuda sdpa 21317.6669921875 MB
On entering CUDA sdpa main function  allocated = 21317.66699 MB
Before first SDPA allocated = 21317.66699 MB
On chunked entry = 21317.66699 MB
On scale calculation = 21317.67480 MB
Before interleave = 21317.67480 MB
After interleave = 21318.17480 MB
After matmul = 21326.30176 MB
Before local copies matmul = 21326.30176 MB
After local copies = 21326.30469 MB
After first SDPA allocated = 21325.79199 MB
After first copy allocated = 21325.79199 MB
On chunked entry = 21325.79199 MB
On scale calculation = 21325.79980 MB
Before interleave = 21325.79980 MB
After interleave = 21326.15918 MB
After matmul = 21326.16064 MB
Before local copies matmul = 21326.16064 MB
After local copies = 21326.16309 MB
fter compute chunk allocated = 21325.79199 MB
Memory after cuda sdpa 21325.7998046875 MB
Decode step 24
1
Memory before offload  21325.77880859375 MB
Memory after offload  21325.77880859375 MB
Memory before cuda sdpa 21325.79248046875 MB
On entering CUDA sdpa main function  allocated = 21325.79248 MB
Before first SDPA allocated = 21325.79248 MB
On chunked entry = 21325.79248 MB
On scale calculation = 21325.80029 MB
Before interleave = 21325.80029 MB
After interleave = 21326.30029 MB
After matmul = 21334.42725 MB
Before local copies matmul = 21334.42725 MB
After local copies = 21334.43018 MB
After first SDPA allocated = 21333.91748 MB
After first copy allocated = 21333.91748 MB
On chunked entry = 21333.91748 MB
On scale calculation = 21333.92529 MB
Before interleave = 21333.92529 MB
After interleave = 21334.30029 MB
After matmul = 21334.30176 MB
Before local copies matmul = 21334.30176 MB
After local copies = 21334.30420 MB
fter compute chunk allocated = 21333.91748 MB
Memory after cuda sdpa 21333.92529296875 MB
1
Memory before offload  21333.90380859375 MB
Memory after offload  21333.90380859375 MB
Memory before cuda sdpa 21333.91748046875 MB
On entering CUDA sdpa main function  allocated = 21333.91748 MB
Before first SDPA allocated = 21333.91748 MB
On chunked entry = 21333.91748 MB
On scale calculation = 21333.92529 MB
Before interleave = 21333.92529 MB
After interleave = 21334.42529 MB
After matmul = 21342.55225 MB
Before local copies matmul = 21342.55225 MB
After local copies = 21342.55518 MB
After first SDPA allocated = 21342.04248 MB
After first copy allocated = 21342.04248 MB
On chunked entry = 21342.04248 MB
On scale calculation = 21342.05029 MB
Before interleave = 21342.05029 MB
After interleave = 21342.42529 MB
After matmul = 21342.42676 MB
Before local copies matmul = 21342.42676 MB
After local copies = 21342.42920 MB
fter compute chunk allocated = 21342.04248 MB
Memory after cuda sdpa 21342.05029296875 MB
1
Memory before offload  21342.02880859375 MB
Memory after offload  21342.02880859375 MB
Memory before cuda sdpa 21342.04248046875 MB
On entering CUDA sdpa main function  allocated = 21342.04248 MB
Before first SDPA allocated = 21342.04248 MB
On chunked entry = 21342.04248 MB
On scale calculation = 21342.05029 MB
Before interleave = 21342.05029 MB
After interleave = 21342.55029 MB
After matmul = 21350.67725 MB
Before local copies matmul = 21350.67725 MB
After local copies = 21350.68018 MB
After first SDPA allocated = 21350.16748 MB
After first copy allocated = 21350.16748 MB
On chunked entry = 21350.16748 MB
On scale calculation = 21350.17529 MB
Before interleave = 21350.17529 MB
After interleave = 21350.55029 MB
After matmul = 21350.55176 MB
Before local copies matmul = 21350.55176 MB
After local copies = 21350.55420 MB
fter compute chunk allocated = 21350.16748 MB
Memory after cuda sdpa 21350.17529296875 MB
1
Memory before offload  21350.15380859375 MB
Memory after offload  21350.15380859375 MB
Memory before cuda sdpa 21350.16748046875 MB
On entering CUDA sdpa main function  allocated = 21350.16748 MB
Before first SDPA allocated = 21350.16748 MB
On chunked entry = 21350.16748 MB
On scale calculation = 21350.17529 MB
Before interleave = 21350.17529 MB
After interleave = 21350.67529 MB
After matmul = 21358.80225 MB
Before local copies matmul = 21358.80225 MB
After local copies = 21358.80518 MB
After first SDPA allocated = 21358.29248 MB
After first copy allocated = 21358.29248 MB
On chunked entry = 21358.29248 MB
On scale calculation = 21358.30029 MB
Before interleave = 21358.30029 MB
After interleave = 21358.67529 MB
After matmul = 21358.67676 MB
Before local copies matmul = 21358.67676 MB
After local copies = 21358.67920 MB
fter compute chunk allocated = 21358.29248 MB
Memory after cuda sdpa 21358.30029296875 MB
1
Memory before offload  21358.27880859375 MB
Memory after offload  21358.27880859375 MB
Memory before cuda sdpa 21358.29248046875 MB
On entering CUDA sdpa main function  allocated = 21358.29248 MB
Before first SDPA allocated = 21358.29248 MB
On chunked entry = 21358.29248 MB
On scale calculation = 21358.30029 MB
Before interleave = 21358.30029 MB
After interleave = 21358.80029 MB
After matmul = 21366.92725 MB
Before local copies matmul = 21366.92725 MB
After local copies = 21366.93018 MB
After first SDPA allocated = 21366.41748 MB
After first copy allocated = 21366.41748 MB
On chunked entry = 21366.41748 MB
On scale calculation = 21366.42529 MB
Before interleave = 21366.42529 MB
After interleave = 21366.80029 MB
After matmul = 21366.80176 MB
Before local copies matmul = 21366.80176 MB
After local copies = 21366.80420 MB
fter compute chunk allocated = 21366.41748 MB
Memory after cuda sdpa 21366.42529296875 MB
1
Memory before offload  21366.40380859375 MB
Memory after offload  21366.40380859375 MB
Memory before cuda sdpa 21366.41748046875 MB
On entering CUDA sdpa main function  allocated = 21366.41748 MB
Before first SDPA allocated = 21366.41748 MB
On chunked entry = 21366.41748 MB
On scale calculation = 21366.42529 MB
Before interleave = 21366.42529 MB
After interleave = 21366.92529 MB
After matmul = 21375.05225 MB
Before local copies matmul = 21375.05225 MB
After local copies = 21375.05518 MB
After first SDPA allocated = 21374.54248 MB
After first copy allocated = 21374.54248 MB
On chunked entry = 21374.54248 MB
On scale calculation = 21374.55029 MB
Before interleave = 21374.55029 MB
After interleave = 21374.92529 MB
After matmul = 21374.92676 MB
Before local copies matmul = 21374.92676 MB
After local copies = 21374.92920 MB
fter compute chunk allocated = 21374.54248 MB
Memory after cuda sdpa 21374.55029296875 MB
1
Memory before offload  21374.52880859375 MB
Memory after offload  21374.52880859375 MB
Memory before cuda sdpa 21374.54248046875 MB
On entering CUDA sdpa main function  allocated = 21374.54248 MB
Before first SDPA allocated = 21374.54248 MB
On chunked entry = 21374.54248 MB
On scale calculation = 21374.55029 MB
Before interleave = 21374.55029 MB
After interleave = 21375.05029 MB
After matmul = 21383.17725 MB
Before local copies matmul = 21383.17725 MB
After local copies = 21383.18018 MB
After first SDPA allocated = 21382.66748 MB
After first copy allocated = 21382.66748 MB
On chunked entry = 21382.66748 MB
On scale calculation = 21382.67529 MB
Before interleave = 21382.67529 MB
After interleave = 21383.05029 MB
After matmul = 21383.05176 MB
Before local copies matmul = 21383.05176 MB
After local copies = 21383.05420 MB
fter compute chunk allocated = 21382.66748 MB
Memory after cuda sdpa 21382.67529296875 MB
1
Memory before offload  21382.65380859375 MB
Memory after offload  21382.65380859375 MB
Memory before cuda sdpa 21382.66748046875 MB
On entering CUDA sdpa main function  allocated = 21382.66748 MB
Before first SDPA allocated = 21382.66748 MB
On chunked entry = 21382.66748 MB
On scale calculation = 21382.67529 MB
Before interleave = 21382.67529 MB
After interleave = 21383.17529 MB
After matmul = 21391.30225 MB
Before local copies matmul = 21391.30225 MB
After local copies = 21391.30518 MB
After first SDPA allocated = 21390.79248 MB
After first copy allocated = 21390.79248 MB
On chunked entry = 21390.79248 MB
On scale calculation = 21390.80029 MB
Before interleave = 21390.80029 MB
After interleave = 21391.17529 MB
After matmul = 21391.17676 MB
Before local copies matmul = 21391.17676 MB
After local copies = 21391.17920 MB
fter compute chunk allocated = 21390.79248 MB
Memory after cuda sdpa 21390.80029296875 MB
1
Memory before offload  21390.77880859375 MB
Memory after offload  21390.77880859375 MB
Memory before cuda sdpa 21390.79248046875 MB
On entering CUDA sdpa main function  allocated = 21390.79248 MB
Before first SDPA allocated = 21390.79248 MB
On chunked entry = 21390.79248 MB
On scale calculation = 21390.80029 MB
Before interleave = 21390.80029 MB
After interleave = 21391.30029 MB
After matmul = 21399.42725 MB
Before local copies matmul = 21399.42725 MB
After local copies = 21399.43018 MB
After first SDPA allocated = 21398.91748 MB
After first copy allocated = 21398.91748 MB
On chunked entry = 21398.91748 MB
On scale calculation = 21398.92529 MB
Before interleave = 21398.92529 MB
After interleave = 21399.30029 MB
After matmul = 21399.30176 MB
Before local copies matmul = 21399.30176 MB
After local copies = 21399.30420 MB
fter compute chunk allocated = 21398.91748 MB
Memory after cuda sdpa 21398.92529296875 MB
1
Memory before offload  21398.90380859375 MB
Memory after offload  21398.90380859375 MB
Memory before cuda sdpa 21398.91748046875 MB
On entering CUDA sdpa main function  allocated = 21398.91748 MB
Before first SDPA allocated = 21398.91748 MB
On chunked entry = 21398.91748 MB
On scale calculation = 21398.92529 MB
Before interleave = 21398.92529 MB
After interleave = 21399.42529 MB
After matmul = 21407.55225 MB
Before local copies matmul = 21407.55225 MB
After local copies = 21407.55518 MB
After first SDPA allocated = 21407.04248 MB
After first copy allocated = 21407.04248 MB
On chunked entry = 21407.04248 MB
On scale calculation = 21407.05029 MB
Before interleave = 21407.05029 MB
After interleave = 21407.42529 MB
After matmul = 21407.42676 MB
Before local copies matmul = 21407.42676 MB
After local copies = 21407.42920 MB
fter compute chunk allocated = 21407.04248 MB
Memory after cuda sdpa 21407.05029296875 MB
1
Memory before offload  21407.02880859375 MB
Memory after offload  21407.02880859375 MB
Memory before cuda sdpa 21407.04248046875 MB
On entering CUDA sdpa main function  allocated = 21407.04248 MB
Before first SDPA allocated = 21407.04248 MB
On chunked entry = 21407.04248 MB
On scale calculation = 21407.05029 MB
Before interleave = 21407.05029 MB
After interleave = 21407.55029 MB
After matmul = 21415.67725 MB
Before local copies matmul = 21415.67725 MB
After local copies = 21415.68018 MB
After first SDPA allocated = 21415.16748 MB
After first copy allocated = 21415.16748 MB
On chunked entry = 21415.16748 MB
On scale calculation = 21415.17529 MB
Before interleave = 21415.17529 MB
After interleave = 21415.55029 MB
After matmul = 21415.55176 MB
Before local copies matmul = 21415.55176 MB
After local copies = 21415.55420 MB
fter compute chunk allocated = 21415.16748 MB
Memory after cuda sdpa 21415.17529296875 MB
1
Memory before offload  21415.15380859375 MB
Memory after offload  21415.15380859375 MB
Memory before cuda sdpa 21415.16748046875 MB
On entering CUDA sdpa main function  allocated = 21415.16748 MB
Before first SDPA allocated = 21415.16748 MB
On chunked entry = 21415.16748 MB
On scale calculation = 21415.17529 MB
Before interleave = 21415.17529 MB
After interleave = 21415.67529 MB
After matmul = 21423.80225 MB
Before local copies matmul = 21423.80225 MB
After local copies = 21423.80518 MB
After first SDPA allocated = 21423.29248 MB
After first copy allocated = 21423.29248 MB
On chunked entry = 21423.29248 MB
On scale calculation = 21423.30029 MB
Before interleave = 21423.30029 MB
After interleave = 21423.67529 MB
After matmul = 21423.67676 MB
Before local copies matmul = 21423.67676 MB
After local copies = 21423.67920 MB
fter compute chunk allocated = 21423.29248 MB
Memory after cuda sdpa 21423.30029296875 MB
1
Memory before offload  21423.27880859375 MB
Memory after offload  21423.27880859375 MB
Memory before cuda sdpa 21423.29248046875 MB
On entering CUDA sdpa main function  allocated = 21423.29248 MB
Before first SDPA allocated = 21423.29248 MB
On chunked entry = 21423.29248 MB
On scale calculation = 21423.30029 MB
Before interleave = 21423.30029 MB
After interleave = 21423.80029 MB
After matmul = 21431.92725 MB
Before local copies matmul = 21431.92725 MB
After local copies = 21431.93018 MB
After first SDPA allocated = 21431.41748 MB
After first copy allocated = 21431.41748 MB
On chunked entry = 21431.41748 MB
On scale calculation = 21431.42529 MB
Before interleave = 21431.42529 MB
After interleave = 21431.80029 MB
After matmul = 21431.80176 MB
Before local copies matmul = 21431.80176 MB
After local copies = 21431.80420 MB
fter compute chunk allocated = 21431.41748 MB
Memory after cuda sdpa 21431.42529296875 MB
1
Memory before offload  21431.40380859375 MB
Memory after offload  21431.40380859375 MB
Memory before cuda sdpa 21431.41748046875 MB
On entering CUDA sdpa main function  allocated = 21431.41748 MB
Before first SDPA allocated = 21431.41748 MB
On chunked entry = 21431.41748 MB
On scale calculation = 21431.42529 MB
Before interleave = 21431.42529 MB
After interleave = 21431.92529 MB
After matmul = 21440.05225 MB
Before local copies matmul = 21440.05225 MB
After local copies = 21440.05518 MB
After first SDPA allocated = 21439.54248 MB
After first copy allocated = 21439.54248 MB
On chunked entry = 21439.54248 MB
On scale calculation = 21439.55029 MB
Before interleave = 21439.55029 MB
After interleave = 21439.92529 MB
After matmul = 21439.92676 MB
Before local copies matmul = 21439.92676 MB
After local copies = 21439.92920 MB
fter compute chunk allocated = 21439.54248 MB
Memory after cuda sdpa 21439.55029296875 MB
1
Memory before offload  21439.52880859375 MB
Memory after offload  21439.52880859375 MB
Memory before cuda sdpa 21439.54248046875 MB
On entering CUDA sdpa main function  allocated = 21439.54248 MB
Before first SDPA allocated = 21439.54248 MB
On chunked entry = 21439.54248 MB
On scale calculation = 21439.55029 MB
Before interleave = 21439.55029 MB
After interleave = 21440.05029 MB
After matmul = 21448.17725 MB
Before local copies matmul = 21448.17725 MB
After local copies = 21448.18018 MB
After first SDPA allocated = 21447.66748 MB
After first copy allocated = 21447.66748 MB
On chunked entry = 21447.66748 MB
On scale calculation = 21447.67529 MB
Before interleave = 21447.67529 MB
After interleave = 21448.05029 MB
After matmul = 21448.05176 MB
Before local copies matmul = 21448.05176 MB
After local copies = 21448.05420 MB
fter compute chunk allocated = 21447.66748 MB
Memory after cuda sdpa 21447.67529296875 MB
1
Memory before offload  21447.65380859375 MB
Memory after offload  21447.65380859375 MB
Memory before cuda sdpa 21447.66748046875 MB
On entering CUDA sdpa main function  allocated = 21447.66748 MB
Before first SDPA allocated = 21447.66748 MB
On chunked entry = 21447.66748 MB
On scale calculation = 21447.67529 MB
Before interleave = 21447.67529 MB
After interleave = 21448.17529 MB
After matmul = 21456.30225 MB
Before local copies matmul = 21456.30225 MB
After local copies = 21456.30518 MB
After first SDPA allocated = 21455.79248 MB
After first copy allocated = 21455.79248 MB
On chunked entry = 21455.79248 MB
On scale calculation = 21455.80029 MB
Before interleave = 21455.80029 MB
After interleave = 21456.17529 MB
After matmul = 21456.17676 MB
Before local copies matmul = 21456.17676 MB
After local copies = 21456.17920 MB
fter compute chunk allocated = 21455.79248 MB
Memory after cuda sdpa 21455.80029296875 MB
1
Memory before offload  21455.77880859375 MB
Memory after offload  21455.77880859375 MB
Memory before cuda sdpa 21455.79248046875 MB
On entering CUDA sdpa main function  allocated = 21455.79248 MB
Before first SDPA allocated = 21455.79248 MB
On chunked entry = 21455.79248 MB
On scale calculation = 21455.80029 MB
Before interleave = 21455.80029 MB
After interleave = 21456.30029 MB
After matmul = 21464.42725 MB
Before local copies matmul = 21464.42725 MB
After local copies = 21464.43018 MB
After first SDPA allocated = 21463.91748 MB
After first copy allocated = 21463.91748 MB
On chunked entry = 21463.91748 MB
On scale calculation = 21463.92529 MB
Before interleave = 21463.92529 MB
After interleave = 21464.30029 MB
After matmul = 21464.30176 MB
Before local copies matmul = 21464.30176 MB
After local copies = 21464.30420 MB
fter compute chunk allocated = 21463.91748 MB
Memory after cuda sdpa 21463.92529296875 MB
1
Memory before offload  21463.90380859375 MB
Memory after offload  21463.90380859375 MB
Memory before cuda sdpa 21463.91748046875 MB
On entering CUDA sdpa main function  allocated = 21463.91748 MB
Before first SDPA allocated = 21463.91748 MB
On chunked entry = 21463.91748 MB
On scale calculation = 21463.92529 MB
Before interleave = 21463.92529 MB
After interleave = 21464.42529 MB
After matmul = 21472.55225 MB
Before local copies matmul = 21472.55225 MB
After local copies = 21472.55518 MB
After first SDPA allocated = 21472.04248 MB
After first copy allocated = 21472.04248 MB
On chunked entry = 21472.04248 MB
On scale calculation = 21472.05029 MB
Before interleave = 21472.05029 MB
After interleave = 21472.42529 MB
After matmul = 21472.42676 MB
Before local copies matmul = 21472.42676 MB
After local copies = 21472.42920 MB
fter compute chunk allocated = 21472.04248 MB
Memory after cuda sdpa 21472.05029296875 MB
1
Memory before offload  21472.02880859375 MB
Memory after offload  21472.02880859375 MB
Memory before cuda sdpa 21472.04248046875 MB
On entering CUDA sdpa main function  allocated = 21472.04248 MB
Before first SDPA allocated = 21472.04248 MB
On chunked entry = 21472.04248 MB
On scale calculation = 21472.05029 MB
Before interleave = 21472.05029 MB
After interleave = 21472.55029 MB
After matmul = 21480.67725 MB
Before local copies matmul = 21480.67725 MB
After local copies = 21480.68018 MB
After first SDPA allocated = 21480.16748 MB
After first copy allocated = 21480.16748 MB
On chunked entry = 21480.16748 MB
On scale calculation = 21480.17529 MB
Before interleave = 21480.17529 MB
After interleave = 21480.55029 MB
After matmul = 21480.55176 MB
Before local copies matmul = 21480.55176 MB
After local copies = 21480.55420 MB
fter compute chunk allocated = 21480.16748 MB
Memory after cuda sdpa 21480.17529296875 MB
1
Memory before offload  21480.15380859375 MB
Memory after offload  21480.15380859375 MB
Memory before cuda sdpa 21480.16748046875 MB
On entering CUDA sdpa main function  allocated = 21480.16748 MB
Before first SDPA allocated = 21480.16748 MB
On chunked entry = 21480.16748 MB
On scale calculation = 21480.17529 MB
Before interleave = 21480.17529 MB
After interleave = 21480.67529 MB
After matmul = 21488.80225 MB
Before local copies matmul = 21488.80225 MB
After local copies = 21488.80518 MB
After first SDPA allocated = 21488.29248 MB
After first copy allocated = 21488.29248 MB
On chunked entry = 21488.29248 MB
On scale calculation = 21488.30029 MB
Before interleave = 21488.30029 MB
After interleave = 21488.67529 MB
After matmul = 21488.67676 MB
Before local copies matmul = 21488.67676 MB
After local copies = 21488.67920 MB
fter compute chunk allocated = 21488.29248 MB
Memory after cuda sdpa 21488.30029296875 MB
1
Memory before offload  21488.27880859375 MB
Memory after offload  21488.27880859375 MB
Memory before cuda sdpa 21488.29248046875 MB
On entering CUDA sdpa main function  allocated = 21488.29248 MB
Before first SDPA allocated = 21488.29248 MB
On chunked entry = 21488.29248 MB
On scale calculation = 21488.30029 MB
Before interleave = 21488.30029 MB
After interleave = 21488.80029 MB
After matmul = 21496.92725 MB
Before local copies matmul = 21496.92725 MB
After local copies = 21496.93018 MB
After first SDPA allocated = 21496.41748 MB
After first copy allocated = 21496.41748 MB
On chunked entry = 21496.41748 MB
On scale calculation = 21496.42529 MB
Before interleave = 21496.42529 MB
After interleave = 21496.80029 MB
After matmul = 21496.80176 MB
Before local copies matmul = 21496.80176 MB
After local copies = 21496.80420 MB
fter compute chunk allocated = 21496.41748 MB
Memory after cuda sdpa 21496.42529296875 MB
1
Memory before offload  21496.40380859375 MB
Memory after offload  21496.40380859375 MB
Memory before cuda sdpa 21496.41748046875 MB
On entering CUDA sdpa main function  allocated = 21496.41748 MB
Before first SDPA allocated = 21496.41748 MB
On chunked entry = 21496.41748 MB
On scale calculation = 21496.42529 MB
Before interleave = 21496.42529 MB
After interleave = 21496.92529 MB
After matmul = 21505.05225 MB
Before local copies matmul = 21505.05225 MB
After local copies = 21505.05518 MB
After first SDPA allocated = 21504.54248 MB
After first copy allocated = 21504.54248 MB
On chunked entry = 21504.54248 MB
On scale calculation = 21504.55029 MB
Before interleave = 21504.55029 MB
After interleave = 21504.92529 MB
After matmul = 21504.92676 MB
Before local copies matmul = 21504.92676 MB
After local copies = 21504.92920 MB
fter compute chunk allocated = 21504.54248 MB
Memory after cuda sdpa 21504.55029296875 MB
1
Memory before offload  21504.52880859375 MB
Memory after offload  21504.52880859375 MB
Memory before cuda sdpa 21504.54248046875 MB
On entering CUDA sdpa main function  allocated = 21504.54248 MB
Before first SDPA allocated = 21504.54248 MB
On chunked entry = 21504.54248 MB
On scale calculation = 21504.55029 MB
Before interleave = 21504.55029 MB
After interleave = 21505.05029 MB
After matmul = 21513.17725 MB
Before local copies matmul = 21513.17725 MB
After local copies = 21513.18018 MB
After first SDPA allocated = 21512.66748 MB
After first copy allocated = 21512.66748 MB
On chunked entry = 21512.66748 MB
On scale calculation = 21512.67529 MB
Before interleave = 21512.67529 MB
After interleave = 21513.05029 MB
After matmul = 21513.05176 MB
Before local copies matmul = 21513.05176 MB
After local copies = 21513.05420 MB
fter compute chunk allocated = 21512.66748 MB
Memory after cuda sdpa 21512.67529296875 MB
1
Memory before offload  21512.65380859375 MB
Memory after offload  21512.65380859375 MB
Memory before cuda sdpa 21512.66748046875 MB
On entering CUDA sdpa main function  allocated = 21512.66748 MB
Before first SDPA allocated = 21512.66748 MB
On chunked entry = 21512.66748 MB
On scale calculation = 21512.67529 MB
Before interleave = 21512.67529 MB
After interleave = 21513.17529 MB
After matmul = 21521.30225 MB
Before local copies matmul = 21521.30225 MB
After local copies = 21521.30518 MB
After first SDPA allocated = 21520.79248 MB
After first copy allocated = 21520.79248 MB
On chunked entry = 21520.79248 MB
On scale calculation = 21520.80029 MB
Before interleave = 21520.80029 MB
After interleave = 21521.17529 MB
After matmul = 21521.17676 MB
Before local copies matmul = 21521.17676 MB
After local copies = 21521.17920 MB
fter compute chunk allocated = 21520.79248 MB
Memory after cuda sdpa 21520.80029296875 MB
1
Memory before offload  21520.77880859375 MB
Memory after offload  21520.77880859375 MB
Memory before cuda sdpa 21520.79248046875 MB
On entering CUDA sdpa main function  allocated = 21520.79248 MB
Before first SDPA allocated = 21520.79248 MB
On chunked entry = 21520.79248 MB
On scale calculation = 21520.80029 MB
Before interleave = 21520.80029 MB
After interleave = 21521.30029 MB
After matmul = 21529.42725 MB
Before local copies matmul = 21529.42725 MB
After local copies = 21529.43018 MB
After first SDPA allocated = 21528.91748 MB
After first copy allocated = 21528.91748 MB
On chunked entry = 21528.91748 MB
On scale calculation = 21528.92529 MB
Before interleave = 21528.92529 MB
After interleave = 21529.30029 MB
After matmul = 21529.30176 MB
Before local copies matmul = 21529.30176 MB
After local copies = 21529.30420 MB
fter compute chunk allocated = 21528.91748 MB
Memory after cuda sdpa 21528.92529296875 MB
1
Memory before offload  21528.90380859375 MB
Memory after offload  21528.90380859375 MB
Memory before cuda sdpa 21528.91748046875 MB
On entering CUDA sdpa main function  allocated = 21528.91748 MB
Before first SDPA allocated = 21528.91748 MB
On chunked entry = 21528.91748 MB
On scale calculation = 21528.92529 MB
Before interleave = 21528.92529 MB
After interleave = 21529.42529 MB
After matmul = 21537.55225 MB
Before local copies matmul = 21537.55225 MB
After local copies = 21537.55518 MB
After first SDPA allocated = 21537.04248 MB
After first copy allocated = 21537.04248 MB
On chunked entry = 21537.04248 MB
On scale calculation = 21537.05029 MB
Before interleave = 21537.05029 MB
After interleave = 21537.42529 MB
After matmul = 21537.42676 MB
Before local copies matmul = 21537.42676 MB
After local copies = 21537.42920 MB
fter compute chunk allocated = 21537.04248 MB
Memory after cuda sdpa 21537.05029296875 MB
1
Memory before offload  21537.02880859375 MB
Memory after offload  21537.02880859375 MB
Memory before cuda sdpa 21537.04248046875 MB
On entering CUDA sdpa main function  allocated = 21537.04248 MB
Before first SDPA allocated = 21537.04248 MB
On chunked entry = 21537.04248 MB
On scale calculation = 21537.05029 MB
Before interleave = 21537.05029 MB
After interleave = 21537.55029 MB
After matmul = 21545.67725 MB
Before local copies matmul = 21545.67725 MB
After local copies = 21545.68018 MB
After first SDPA allocated = 21545.16748 MB
After first copy allocated = 21545.16748 MB
On chunked entry = 21545.16748 MB
On scale calculation = 21545.17529 MB
Before interleave = 21545.17529 MB
After interleave = 21545.55029 MB
After matmul = 21545.55176 MB
Before local copies matmul = 21545.55176 MB
After local copies = 21545.55420 MB
fter compute chunk allocated = 21545.16748 MB
Memory after cuda sdpa 21545.17529296875 MB
1
Memory before offload  21545.15380859375 MB
Memory after offload  21545.15380859375 MB
Memory before cuda sdpa 21545.16748046875 MB
On entering CUDA sdpa main function  allocated = 21545.16748 MB
Before first SDPA allocated = 21545.16748 MB
On chunked entry = 21545.16748 MB
On scale calculation = 21545.17529 MB
Before interleave = 21545.17529 MB
After interleave = 21545.67529 MB
After matmul = 21553.80225 MB
Before local copies matmul = 21553.80225 MB
After local copies = 21553.80518 MB
After first SDPA allocated = 21553.29248 MB
After first copy allocated = 21553.29248 MB
On chunked entry = 21553.29248 MB
On scale calculation = 21553.30029 MB
Before interleave = 21553.30029 MB
After interleave = 21553.67529 MB
After matmul = 21553.67676 MB
Before local copies matmul = 21553.67676 MB
After local copies = 21553.67920 MB
fter compute chunk allocated = 21553.29248 MB
Memory after cuda sdpa 21553.30029296875 MB
1
Memory before offload  21553.27880859375 MB
Memory after offload  21553.27880859375 MB
Memory before cuda sdpa 21553.29248046875 MB
On entering CUDA sdpa main function  allocated = 21553.29248 MB
Before first SDPA allocated = 21553.29248 MB
On chunked entry = 21553.29248 MB
On scale calculation = 21553.30029 MB
Before interleave = 21553.30029 MB
After interleave = 21553.80029 MB
After matmul = 21561.92725 MB
Before local copies matmul = 21561.92725 MB
After local copies = 21561.93018 MB
After first SDPA allocated = 21561.41748 MB
After first copy allocated = 21561.41748 MB
On chunked entry = 21561.41748 MB
On scale calculation = 21561.42529 MB
Before interleave = 21561.42529 MB
After interleave = 21561.80029 MB
After matmul = 21561.80176 MB
Before local copies matmul = 21561.80176 MB
After local copies = 21561.80420 MB
fter compute chunk allocated = 21561.41748 MB
Memory after cuda sdpa 21561.42529296875 MB
1
Memory before offload  21561.40380859375 MB
Memory after offload  21561.40380859375 MB
Memory before cuda sdpa 21561.41748046875 MB
On entering CUDA sdpa main function  allocated = 21561.41748 MB
Before first SDPA allocated = 21561.41748 MB
On chunked entry = 21561.41748 MB
On scale calculation = 21561.42529 MB
Before interleave = 21561.42529 MB
After interleave = 21561.92529 MB
After matmul = 21570.05225 MB
Before local copies matmul = 21570.05225 MB
After local copies = 21570.05518 MB
After first SDPA allocated = 21569.54248 MB
After first copy allocated = 21569.54248 MB
On chunked entry = 21569.54248 MB
On scale calculation = 21569.55029 MB
Before interleave = 21569.55029 MB
After interleave = 21569.92529 MB
After matmul = 21569.92676 MB
Before local copies matmul = 21569.92676 MB
After local copies = 21569.92920 MB
fter compute chunk allocated = 21569.54248 MB
Memory after cuda sdpa 21569.55029296875 MB
1
Memory before offload  21569.52880859375 MB
Memory after offload  21569.52880859375 MB
Memory before cuda sdpa 21569.54248046875 MB
On entering CUDA sdpa main function  allocated = 21569.54248 MB
Before first SDPA allocated = 21569.54248 MB
On chunked entry = 21569.54248 MB
On scale calculation = 21569.55029 MB
Before interleave = 21569.55029 MB
After interleave = 21570.05029 MB
After matmul = 21578.17725 MB
Before local copies matmul = 21578.17725 MB
After local copies = 21578.18018 MB
After first SDPA allocated = 21577.66748 MB
After first copy allocated = 21577.66748 MB
On chunked entry = 21577.66748 MB
On scale calculation = 21577.67529 MB
Before interleave = 21577.67529 MB
After interleave = 21578.05029 MB
After matmul = 21578.05176 MB
Before local copies matmul = 21578.05176 MB
After local copies = 21578.05420 MB
fter compute chunk allocated = 21577.66748 MB
Memory after cuda sdpa 21577.67529296875 MB
1
Memory before offload  21577.65380859375 MB
Memory after offload  21577.65380859375 MB
Memory before cuda sdpa 21577.66748046875 MB
On entering CUDA sdpa main function  allocated = 21577.66748 MB
Before first SDPA allocated = 21577.66748 MB
On chunked entry = 21577.66748 MB
On scale calculation = 21577.67529 MB
Before interleave = 21577.67529 MB
After interleave = 21578.17529 MB
After matmul = 21586.30225 MB
Before local copies matmul = 21586.30225 MB
After local copies = 21586.30518 MB
After first SDPA allocated = 21585.79248 MB
After first copy allocated = 21585.79248 MB
On chunked entry = 21585.79248 MB
On scale calculation = 21585.80029 MB
Before interleave = 21585.80029 MB
After interleave = 21586.17529 MB
After matmul = 21586.17676 MB
Before local copies matmul = 21586.17676 MB
After local copies = 21586.17920 MB
fter compute chunk allocated = 21585.79248 MB
Memory after cuda sdpa 21585.80029296875 MB
Decode step 25
1
Memory before offload  21585.779296875 MB
Memory after offload  21585.779296875 MB
Memory before cuda sdpa 21585.79296875 MB
On entering CUDA sdpa main function  allocated = 21585.79297 MB
Before first SDPA allocated = 21585.79297 MB
On chunked entry = 21585.79297 MB
On scale calculation = 21585.80078 MB
Before interleave = 21585.80078 MB
After interleave = 21586.30078 MB
After matmul = 21594.42773 MB
Before local copies matmul = 21594.42773 MB
After local copies = 21594.43066 MB
After first SDPA allocated = 21593.91797 MB
After first copy allocated = 21593.91797 MB
On chunked entry = 21593.91797 MB
On scale calculation = 21593.92578 MB
Before interleave = 21593.92578 MB
After interleave = 21594.31641 MB
After matmul = 21594.31836 MB
Before local copies matmul = 21594.31836 MB
After local copies = 21594.32129 MB
fter compute chunk allocated = 21593.91797 MB
Memory after cuda sdpa 21593.92578125 MB
1
Memory before offload  21593.904296875 MB
Memory after offload  21593.904296875 MB
Memory before cuda sdpa 21593.91796875 MB
On entering CUDA sdpa main function  allocated = 21593.91797 MB
Before first SDPA allocated = 21593.91797 MB
On chunked entry = 21593.91797 MB
On scale calculation = 21593.92578 MB
Before interleave = 21593.92578 MB
After interleave = 21594.42578 MB
After matmul = 21602.55273 MB
Before local copies matmul = 21602.55273 MB
After local copies = 21602.55566 MB
After first SDPA allocated = 21602.04297 MB
After first copy allocated = 21602.04297 MB
On chunked entry = 21602.04297 MB
On scale calculation = 21602.05078 MB
Before interleave = 21602.05078 MB
After interleave = 21602.44141 MB
After matmul = 21602.44336 MB
Before local copies matmul = 21602.44336 MB
After local copies = 21602.44629 MB
fter compute chunk allocated = 21602.04297 MB
Memory after cuda sdpa 21602.05078125 MB
1
Memory before offload  21602.029296875 MB
Memory after offload  21602.029296875 MB
Memory before cuda sdpa 21602.04296875 MB
On entering CUDA sdpa main function  allocated = 21602.04297 MB
Before first SDPA allocated = 21602.04297 MB
On chunked entry = 21602.04297 MB
On scale calculation = 21602.05078 MB
Before interleave = 21602.05078 MB
After interleave = 21602.55078 MB
After matmul = 21610.67773 MB
Before local copies matmul = 21610.67773 MB
After local copies = 21610.68066 MB
After first SDPA allocated = 21610.16797 MB
After first copy allocated = 21610.16797 MB
On chunked entry = 21610.16797 MB
On scale calculation = 21610.17578 MB
Before interleave = 21610.17578 MB
After interleave = 21610.56641 MB
After matmul = 21610.56836 MB
Before local copies matmul = 21610.56836 MB
After local copies = 21610.57129 MB
fter compute chunk allocated = 21610.16797 MB
Memory after cuda sdpa 21610.17578125 MB
1
Memory before offload  21610.154296875 MB
Memory after offload  21610.154296875 MB
Memory before cuda sdpa 21610.16796875 MB
On entering CUDA sdpa main function  allocated = 21610.16797 MB
Before first SDPA allocated = 21610.16797 MB
On chunked entry = 21610.16797 MB
On scale calculation = 21610.17578 MB
Before interleave = 21610.17578 MB
After interleave = 21610.67578 MB
After matmul = 21618.80273 MB
Before local copies matmul = 21618.80273 MB
After local copies = 21618.80566 MB
After first SDPA allocated = 21618.29297 MB
After first copy allocated = 21618.29297 MB
On chunked entry = 21618.29297 MB
On scale calculation = 21618.30078 MB
Before interleave = 21618.30078 MB
After interleave = 21618.69141 MB
After matmul = 21618.69336 MB
Before local copies matmul = 21618.69336 MB
After local copies = 21618.69629 MB
fter compute chunk allocated = 21618.29297 MB
Memory after cuda sdpa 21618.30078125 MB
1
Memory before offload  21618.279296875 MB
Memory after offload  21618.279296875 MB
Memory before cuda sdpa 21618.29296875 MB
On entering CUDA sdpa main function  allocated = 21618.29297 MB
Before first SDPA allocated = 21618.29297 MB
On chunked entry = 21618.29297 MB
On scale calculation = 21618.30078 MB
Before interleave = 21618.30078 MB
After interleave = 21618.80078 MB
After matmul = 21626.92773 MB
Before local copies matmul = 21626.92773 MB
After local copies = 21626.93066 MB
After first SDPA allocated = 21626.41797 MB
After first copy allocated = 21626.41797 MB
On chunked entry = 21626.41797 MB
On scale calculation = 21626.42578 MB
Before interleave = 21626.42578 MB
After interleave = 21626.81641 MB
After matmul = 21626.81836 MB
Before local copies matmul = 21626.81836 MB
After local copies = 21626.82129 MB
fter compute chunk allocated = 21626.41797 MB
Memory after cuda sdpa 21626.42578125 MB
1
Memory before offload  21626.404296875 MB
Memory after offload  21626.404296875 MB
Memory before cuda sdpa 21626.41796875 MB
On entering CUDA sdpa main function  allocated = 21626.41797 MB
Before first SDPA allocated = 21626.41797 MB
On chunked entry = 21626.41797 MB
On scale calculation = 21626.42578 MB
Before interleave = 21626.42578 MB
After interleave = 21626.92578 MB
After matmul = 21635.05273 MB
Before local copies matmul = 21635.05273 MB
After local copies = 21635.05566 MB
After first SDPA allocated = 21634.54297 MB
After first copy allocated = 21634.54297 MB
On chunked entry = 21634.54297 MB
On scale calculation = 21634.55078 MB
Before interleave = 21634.55078 MB
After interleave = 21634.94141 MB
After matmul = 21634.94336 MB
Before local copies matmul = 21634.94336 MB
After local copies = 21634.94629 MB
fter compute chunk allocated = 21634.54297 MB
Memory after cuda sdpa 21634.55078125 MB
1
Memory before offload  21634.529296875 MB
Memory after offload  21634.529296875 MB
Memory before cuda sdpa 21634.54296875 MB
On entering CUDA sdpa main function  allocated = 21634.54297 MB
Before first SDPA allocated = 21634.54297 MB
On chunked entry = 21634.54297 MB
On scale calculation = 21634.55078 MB
Before interleave = 21634.55078 MB
After interleave = 21635.05078 MB
After matmul = 21643.17773 MB
Before local copies matmul = 21643.17773 MB
After local copies = 21643.18066 MB
After first SDPA allocated = 21642.66797 MB
After first copy allocated = 21642.66797 MB
On chunked entry = 21642.66797 MB
On scale calculation = 21642.67578 MB
Before interleave = 21642.67578 MB
After interleave = 21643.06641 MB
After matmul = 21643.06836 MB
Before local copies matmul = 21643.06836 MB
After local copies = 21643.07129 MB
fter compute chunk allocated = 21642.66797 MB
Memory after cuda sdpa 21642.67578125 MB
1
Memory before offload  21642.654296875 MB
Memory after offload  21642.654296875 MB
Memory before cuda sdpa 21642.66796875 MB
On entering CUDA sdpa main function  allocated = 21642.66797 MB
Before first SDPA allocated = 21642.66797 MB
On chunked entry = 21642.66797 MB
On scale calculation = 21642.67578 MB
Before interleave = 21642.67578 MB
After interleave = 21643.17578 MB
After matmul = 21651.30273 MB
Before local copies matmul = 21651.30273 MB
After local copies = 21651.30566 MB
After first SDPA allocated = 21650.79297 MB
After first copy allocated = 21650.79297 MB
On chunked entry = 21650.79297 MB
On scale calculation = 21650.80078 MB
Before interleave = 21650.80078 MB
After interleave = 21651.19141 MB
After matmul = 21651.19336 MB
Before local copies matmul = 21651.19336 MB
After local copies = 21651.19629 MB
fter compute chunk allocated = 21650.79297 MB
Memory after cuda sdpa 21650.80078125 MB
1
Memory before offload  21650.779296875 MB
Memory after offload  21650.779296875 MB
Memory before cuda sdpa 21650.79296875 MB
On entering CUDA sdpa main function  allocated = 21650.79297 MB
Before first SDPA allocated = 21650.79297 MB
On chunked entry = 21650.79297 MB
On scale calculation = 21650.80078 MB
Before interleave = 21650.80078 MB
After interleave = 21651.30078 MB
After matmul = 21659.42773 MB
Before local copies matmul = 21659.42773 MB
After local copies = 21659.43066 MB
After first SDPA allocated = 21658.91797 MB
After first copy allocated = 21658.91797 MB
On chunked entry = 21658.91797 MB
On scale calculation = 21658.92578 MB
Before interleave = 21658.92578 MB
After interleave = 21659.31641 MB
After matmul = 21659.31836 MB
Before local copies matmul = 21659.31836 MB
After local copies = 21659.32129 MB
fter compute chunk allocated = 21658.91797 MB
Memory after cuda sdpa 21658.92578125 MB
1
Memory before offload  21658.904296875 MB
Memory after offload  21658.904296875 MB
Memory before cuda sdpa 21658.91796875 MB
On entering CUDA sdpa main function  allocated = 21658.91797 MB
Before first SDPA allocated = 21658.91797 MB
On chunked entry = 21658.91797 MB
On scale calculation = 21658.92578 MB
Before interleave = 21658.92578 MB
After interleave = 21659.42578 MB
After matmul = 21667.55273 MB
Before local copies matmul = 21667.55273 MB
After local copies = 21667.55566 MB
After first SDPA allocated = 21667.04297 MB
After first copy allocated = 21667.04297 MB
On chunked entry = 21667.04297 MB
On scale calculation = 21667.05078 MB
Before interleave = 21667.05078 MB
After interleave = 21667.44141 MB
After matmul = 21667.44336 MB
Before local copies matmul = 21667.44336 MB
After local copies = 21667.44629 MB
fter compute chunk allocated = 21667.04297 MB
Memory after cuda sdpa 21667.05078125 MB
1
Memory before offload  21667.029296875 MB
Memory after offload  21667.029296875 MB
Memory before cuda sdpa 21667.04296875 MB
On entering CUDA sdpa main function  allocated = 21667.04297 MB
Before first SDPA allocated = 21667.04297 MB
On chunked entry = 21667.04297 MB
On scale calculation = 21667.05078 MB
Before interleave = 21667.05078 MB
After interleave = 21667.55078 MB
After matmul = 21675.67773 MB
Before local copies matmul = 21675.67773 MB
After local copies = 21675.68066 MB
After first SDPA allocated = 21675.16797 MB
After first copy allocated = 21675.16797 MB
On chunked entry = 21675.16797 MB
On scale calculation = 21675.17578 MB
Before interleave = 21675.17578 MB
After interleave = 21675.56641 MB
After matmul = 21675.56836 MB
Before local copies matmul = 21675.56836 MB
After local copies = 21675.57129 MB
fter compute chunk allocated = 21675.16797 MB
Memory after cuda sdpa 21675.17578125 MB
1
Memory before offload  21675.154296875 MB
Memory after offload  21675.154296875 MB
Memory before cuda sdpa 21675.16796875 MB
On entering CUDA sdpa main function  allocated = 21675.16797 MB
Before first SDPA allocated = 21675.16797 MB
On chunked entry = 21675.16797 MB
On scale calculation = 21675.17578 MB
Before interleave = 21675.17578 MB
After interleave = 21675.67578 MB
After matmul = 21683.80273 MB
Before local copies matmul = 21683.80273 MB
After local copies = 21683.80566 MB
After first SDPA allocated = 21683.29297 MB
After first copy allocated = 21683.29297 MB
On chunked entry = 21683.29297 MB
On scale calculation = 21683.30078 MB
Before interleave = 21683.30078 MB
After interleave = 21683.69141 MB
After matmul = 21683.69336 MB
Before local copies matmul = 21683.69336 MB
After local copies = 21683.69629 MB
fter compute chunk allocated = 21683.29297 MB
Memory after cuda sdpa 21683.30078125 MB
1
Memory before offload  21683.279296875 MB
Memory after offload  21683.279296875 MB
Memory before cuda sdpa 21683.29296875 MB
On entering CUDA sdpa main function  allocated = 21683.29297 MB
Before first SDPA allocated = 21683.29297 MB
On chunked entry = 21683.29297 MB
On scale calculation = 21683.30078 MB
Before interleave = 21683.30078 MB
After interleave = 21683.80078 MB
After matmul = 21691.92773 MB
Before local copies matmul = 21691.92773 MB
After local copies = 21691.93066 MB
After first SDPA allocated = 21691.41797 MB
After first copy allocated = 21691.41797 MB
On chunked entry = 21691.41797 MB
On scale calculation = 21691.42578 MB
Before interleave = 21691.42578 MB
After interleave = 21691.81641 MB
After matmul = 21691.81836 MB
Before local copies matmul = 21691.81836 MB
After local copies = 21691.82129 MB
fter compute chunk allocated = 21691.41797 MB
Memory after cuda sdpa 21691.42578125 MB
1
Memory before offload  21691.404296875 MB
Memory after offload  21691.404296875 MB
Memory before cuda sdpa 21691.41796875 MB
On entering CUDA sdpa main function  allocated = 21691.41797 MB
Before first SDPA allocated = 21691.41797 MB
On chunked entry = 21691.41797 MB
On scale calculation = 21691.42578 MB
Before interleave = 21691.42578 MB
After interleave = 21691.92578 MB
After matmul = 21700.05273 MB
Before local copies matmul = 21700.05273 MB
After local copies = 21700.05566 MB
After first SDPA allocated = 21699.54297 MB
After first copy allocated = 21699.54297 MB
On chunked entry = 21699.54297 MB
On scale calculation = 21699.55078 MB
Before interleave = 21699.55078 MB
After interleave = 21699.94141 MB
After matmul = 21699.94336 MB
Before local copies matmul = 21699.94336 MB
After local copies = 21699.94629 MB
fter compute chunk allocated = 21699.54297 MB
Memory after cuda sdpa 21699.55078125 MB
1
Memory before offload  21699.529296875 MB
Memory after offload  21699.529296875 MB
Memory before cuda sdpa 21699.54296875 MB
On entering CUDA sdpa main function  allocated = 21699.54297 MB
Before first SDPA allocated = 21699.54297 MB
On chunked entry = 21699.54297 MB
On scale calculation = 21699.55078 MB
Before interleave = 21699.55078 MB
After interleave = 21700.05078 MB
After matmul = 21708.17773 MB
Before local copies matmul = 21708.17773 MB
After local copies = 21708.18066 MB
After first SDPA allocated = 21707.66797 MB
After first copy allocated = 21707.66797 MB
On chunked entry = 21707.66797 MB
On scale calculation = 21707.67578 MB
Before interleave = 21707.67578 MB
After interleave = 21708.06641 MB
After matmul = 21708.06836 MB
Before local copies matmul = 21708.06836 MB
After local copies = 21708.07129 MB
fter compute chunk allocated = 21707.66797 MB
Memory after cuda sdpa 21707.67578125 MB
1
Memory before offload  21707.654296875 MB
Memory after offload  21707.654296875 MB
Memory before cuda sdpa 21707.66796875 MB
On entering CUDA sdpa main function  allocated = 21707.66797 MB
Before first SDPA allocated = 21707.66797 MB
On chunked entry = 21707.66797 MB
On scale calculation = 21707.67578 MB
Before interleave = 21707.67578 MB
After interleave = 21708.17578 MB
After matmul = 21716.30273 MB
Before local copies matmul = 21716.30273 MB
After local copies = 21716.30566 MB
After first SDPA allocated = 21715.79297 MB
After first copy allocated = 21715.79297 MB
On chunked entry = 21715.79297 MB
On scale calculation = 21715.80078 MB
Before interleave = 21715.80078 MB
After interleave = 21716.19141 MB
After matmul = 21716.19336 MB
Before local copies matmul = 21716.19336 MB
After local copies = 21716.19629 MB
fter compute chunk allocated = 21715.79297 MB
Memory after cuda sdpa 21715.80078125 MB
1
Memory before offload  21715.779296875 MB
Memory after offload  21715.779296875 MB
Memory before cuda sdpa 21715.79296875 MB
On entering CUDA sdpa main function  allocated = 21715.79297 MB
Before first SDPA allocated = 21715.79297 MB
On chunked entry = 21715.79297 MB
On scale calculation = 21715.80078 MB
Before interleave = 21715.80078 MB
After interleave = 21716.30078 MB
After matmul = 21724.42773 MB
Before local copies matmul = 21724.42773 MB
After local copies = 21724.43066 MB
After first SDPA allocated = 21723.91797 MB
After first copy allocated = 21723.91797 MB
On chunked entry = 21723.91797 MB
On scale calculation = 21723.92578 MB
Before interleave = 21723.92578 MB
After interleave = 21724.31641 MB
After matmul = 21724.31836 MB
Before local copies matmul = 21724.31836 MB
After local copies = 21724.32129 MB
fter compute chunk allocated = 21723.91797 MB
Memory after cuda sdpa 21723.92578125 MB
1
Memory before offload  21723.904296875 MB
Memory after offload  21723.904296875 MB
Memory before cuda sdpa 21723.91796875 MB
On entering CUDA sdpa main function  allocated = 21723.91797 MB
Before first SDPA allocated = 21723.91797 MB
On chunked entry = 21723.91797 MB
On scale calculation = 21723.92578 MB
Before interleave = 21723.92578 MB
After interleave = 21724.42578 MB
After matmul = 21732.55273 MB
Before local copies matmul = 21732.55273 MB
After local copies = 21732.55566 MB
After first SDPA allocated = 21732.04297 MB
After first copy allocated = 21732.04297 MB
On chunked entry = 21732.04297 MB
On scale calculation = 21732.05078 MB
Before interleave = 21732.05078 MB
After interleave = 21732.44141 MB
After matmul = 21732.44336 MB
Before local copies matmul = 21732.44336 MB
After local copies = 21732.44629 MB
fter compute chunk allocated = 21732.04297 MB
Memory after cuda sdpa 21732.05078125 MB
1
Memory before offload  21732.029296875 MB
Memory after offload  21732.029296875 MB
Memory before cuda sdpa 21732.04296875 MB
On entering CUDA sdpa main function  allocated = 21732.04297 MB
Before first SDPA allocated = 21732.04297 MB
On chunked entry = 21732.04297 MB
On scale calculation = 21732.05078 MB
Before interleave = 21732.05078 MB
After interleave = 21732.55078 MB
After matmul = 21740.67773 MB
Before local copies matmul = 21740.67773 MB
After local copies = 21740.68066 MB
After first SDPA allocated = 21740.16797 MB
After first copy allocated = 21740.16797 MB
On chunked entry = 21740.16797 MB
On scale calculation = 21740.17578 MB
Before interleave = 21740.17578 MB
After interleave = 21740.56641 MB
After matmul = 21740.56836 MB
Before local copies matmul = 21740.56836 MB
After local copies = 21740.57129 MB
fter compute chunk allocated = 21740.16797 MB
Memory after cuda sdpa 21740.17578125 MB
1
Memory before offload  21740.154296875 MB
Memory after offload  21740.154296875 MB
Memory before cuda sdpa 21740.16796875 MB
On entering CUDA sdpa main function  allocated = 21740.16797 MB
Before first SDPA allocated = 21740.16797 MB
On chunked entry = 21740.16797 MB
On scale calculation = 21740.17578 MB
Before interleave = 21740.17578 MB
After interleave = 21740.67578 MB
After matmul = 21748.80273 MB
Before local copies matmul = 21748.80273 MB
After local copies = 21748.80566 MB
After first SDPA allocated = 21748.29297 MB
After first copy allocated = 21748.29297 MB
On chunked entry = 21748.29297 MB
On scale calculation = 21748.30078 MB
Before interleave = 21748.30078 MB
After interleave = 21748.69141 MB
After matmul = 21748.69336 MB
Before local copies matmul = 21748.69336 MB
After local copies = 21748.69629 MB
fter compute chunk allocated = 21748.29297 MB
Memory after cuda sdpa 21748.30078125 MB
1
Memory before offload  21748.279296875 MB
Memory after offload  21748.279296875 MB
Memory before cuda sdpa 21748.29296875 MB
On entering CUDA sdpa main function  allocated = 21748.29297 MB
Before first SDPA allocated = 21748.29297 MB
On chunked entry = 21748.29297 MB
On scale calculation = 21748.30078 MB
Before interleave = 21748.30078 MB
After interleave = 21748.80078 MB
After matmul = 21756.92773 MB
Before local copies matmul = 21756.92773 MB
After local copies = 21756.93066 MB
After first SDPA allocated = 21756.41797 MB
After first copy allocated = 21756.41797 MB
On chunked entry = 21756.41797 MB
On scale calculation = 21756.42578 MB
Before interleave = 21756.42578 MB
After interleave = 21756.81641 MB
After matmul = 21756.81836 MB
Before local copies matmul = 21756.81836 MB
After local copies = 21756.82129 MB
fter compute chunk allocated = 21756.41797 MB
Memory after cuda sdpa 21756.42578125 MB
1
Memory before offload  21756.404296875 MB
Memory after offload  21756.404296875 MB
Memory before cuda sdpa 21756.41796875 MB
On entering CUDA sdpa main function  allocated = 21756.41797 MB
Before first SDPA allocated = 21756.41797 MB
On chunked entry = 21756.41797 MB
On scale calculation = 21756.42578 MB
Before interleave = 21756.42578 MB
After interleave = 21756.92578 MB
After matmul = 21765.05273 MB
Before local copies matmul = 21765.05273 MB
After local copies = 21765.05566 MB
After first SDPA allocated = 21764.54297 MB
After first copy allocated = 21764.54297 MB
On chunked entry = 21764.54297 MB
On scale calculation = 21764.55078 MB
Before interleave = 21764.55078 MB
After interleave = 21764.94141 MB
After matmul = 21764.94336 MB
Before local copies matmul = 21764.94336 MB
After local copies = 21764.94629 MB
fter compute chunk allocated = 21764.54297 MB
Memory after cuda sdpa 21764.55078125 MB
1
Memory before offload  21764.529296875 MB
Memory after offload  21764.529296875 MB
Memory before cuda sdpa 21764.54296875 MB
On entering CUDA sdpa main function  allocated = 21764.54297 MB
Before first SDPA allocated = 21764.54297 MB
On chunked entry = 21764.54297 MB
On scale calculation = 21764.55078 MB
Before interleave = 21764.55078 MB
After interleave = 21765.05078 MB
After matmul = 21773.17773 MB
Before local copies matmul = 21773.17773 MB
After local copies = 21773.18066 MB
After first SDPA allocated = 21772.66797 MB
After first copy allocated = 21772.66797 MB
On chunked entry = 21772.66797 MB
On scale calculation = 21772.67578 MB
Before interleave = 21772.67578 MB
After interleave = 21773.06641 MB
After matmul = 21773.06836 MB
Before local copies matmul = 21773.06836 MB
After local copies = 21773.07129 MB
fter compute chunk allocated = 21772.66797 MB
Memory after cuda sdpa 21772.67578125 MB
1
Memory before offload  21772.654296875 MB
Memory after offload  21772.654296875 MB
Memory before cuda sdpa 21772.66796875 MB
On entering CUDA sdpa main function  allocated = 21772.66797 MB
Before first SDPA allocated = 21772.66797 MB
On chunked entry = 21772.66797 MB
On scale calculation = 21772.67578 MB
Before interleave = 21772.67578 MB
After interleave = 21773.17578 MB
After matmul = 21781.30273 MB
Before local copies matmul = 21781.30273 MB
After local copies = 21781.30566 MB
After first SDPA allocated = 21780.79297 MB
After first copy allocated = 21780.79297 MB
On chunked entry = 21780.79297 MB
On scale calculation = 21780.80078 MB
Before interleave = 21780.80078 MB
After interleave = 21781.19141 MB
After matmul = 21781.19336 MB
Before local copies matmul = 21781.19336 MB
After local copies = 21781.19629 MB
fter compute chunk allocated = 21780.79297 MB
Memory after cuda sdpa 21780.80078125 MB
1
Memory before offload  21780.779296875 MB
Memory after offload  21780.779296875 MB
Memory before cuda sdpa 21780.79296875 MB
On entering CUDA sdpa main function  allocated = 21780.79297 MB
Before first SDPA allocated = 21780.79297 MB
On chunked entry = 21780.79297 MB
On scale calculation = 21780.80078 MB
Before interleave = 21780.80078 MB
After interleave = 21781.30078 MB
After matmul = 21789.42773 MB
Before local copies matmul = 21789.42773 MB
After local copies = 21789.43066 MB
After first SDPA allocated = 21788.91797 MB
After first copy allocated = 21788.91797 MB
On chunked entry = 21788.91797 MB
On scale calculation = 21788.92578 MB
Before interleave = 21788.92578 MB
After interleave = 21789.31641 MB
After matmul = 21789.31836 MB
Before local copies matmul = 21789.31836 MB
After local copies = 21789.32129 MB
fter compute chunk allocated = 21788.91797 MB
Memory after cuda sdpa 21788.92578125 MB
1
Memory before offload  21788.904296875 MB
Memory after offload  21788.904296875 MB
Memory before cuda sdpa 21788.91796875 MB
On entering CUDA sdpa main function  allocated = 21788.91797 MB
Before first SDPA allocated = 21788.91797 MB
On chunked entry = 21788.91797 MB
On scale calculation = 21788.92578 MB
Before interleave = 21788.92578 MB
After interleave = 21789.42578 MB
After matmul = 21797.55273 MB
Before local copies matmul = 21797.55273 MB
After local copies = 21797.55566 MB
After first SDPA allocated = 21797.04297 MB
After first copy allocated = 21797.04297 MB
On chunked entry = 21797.04297 MB
On scale calculation = 21797.05078 MB
Before interleave = 21797.05078 MB
After interleave = 21797.44141 MB
After matmul = 21797.44336 MB
Before local copies matmul = 21797.44336 MB
After local copies = 21797.44629 MB
fter compute chunk allocated = 21797.04297 MB
Memory after cuda sdpa 21797.05078125 MB
1
Memory before offload  21797.029296875 MB
Memory after offload  21797.029296875 MB
Memory before cuda sdpa 21797.04296875 MB
On entering CUDA sdpa main function  allocated = 21797.04297 MB
Before first SDPA allocated = 21797.04297 MB
On chunked entry = 21797.04297 MB
On scale calculation = 21797.05078 MB
Before interleave = 21797.05078 MB
After interleave = 21797.55078 MB
After matmul = 21805.67773 MB
Before local copies matmul = 21805.67773 MB
After local copies = 21805.68066 MB
After first SDPA allocated = 21805.16797 MB
After first copy allocated = 21805.16797 MB
On chunked entry = 21805.16797 MB
On scale calculation = 21805.17578 MB
Before interleave = 21805.17578 MB
After interleave = 21805.56641 MB
After matmul = 21805.56836 MB
Before local copies matmul = 21805.56836 MB
After local copies = 21805.57129 MB
fter compute chunk allocated = 21805.16797 MB
Memory after cuda sdpa 21805.17578125 MB
1
Memory before offload  21805.154296875 MB
Memory after offload  21805.154296875 MB
Memory before cuda sdpa 21805.16796875 MB
On entering CUDA sdpa main function  allocated = 21805.16797 MB
Before first SDPA allocated = 21805.16797 MB
On chunked entry = 21805.16797 MB
On scale calculation = 21805.17578 MB
Before interleave = 21805.17578 MB
After interleave = 21805.67578 MB
After matmul = 21813.80273 MB
Before local copies matmul = 21813.80273 MB
After local copies = 21813.80566 MB
After first SDPA allocated = 21813.29297 MB
After first copy allocated = 21813.29297 MB
On chunked entry = 21813.29297 MB
On scale calculation = 21813.30078 MB
Before interleave = 21813.30078 MB
After interleave = 21813.69141 MB
After matmul = 21813.69336 MB
Before local copies matmul = 21813.69336 MB
After local copies = 21813.69629 MB
fter compute chunk allocated = 21813.29297 MB
Memory after cuda sdpa 21813.30078125 MB
1
Memory before offload  21813.279296875 MB
Memory after offload  21813.279296875 MB
Memory before cuda sdpa 21813.29296875 MB
On entering CUDA sdpa main function  allocated = 21813.29297 MB
Before first SDPA allocated = 21813.29297 MB
On chunked entry = 21813.29297 MB
On scale calculation = 21813.30078 MB
Before interleave = 21813.30078 MB
After interleave = 21813.80078 MB
After matmul = 21821.92773 MB
Before local copies matmul = 21821.92773 MB
After local copies = 21821.93066 MB
After first SDPA allocated = 21821.41797 MB
After first copy allocated = 21821.41797 MB
On chunked entry = 21821.41797 MB
On scale calculation = 21821.42578 MB
Before interleave = 21821.42578 MB
After interleave = 21821.81641 MB
After matmul = 21821.81836 MB
Before local copies matmul = 21821.81836 MB
After local copies = 21821.82129 MB
fter compute chunk allocated = 21821.41797 MB
Memory after cuda sdpa 21821.42578125 MB
1
Memory before offload  21821.404296875 MB
Memory after offload  21821.404296875 MB
Memory before cuda sdpa 21821.41796875 MB
On entering CUDA sdpa main function  allocated = 21821.41797 MB
Before first SDPA allocated = 21821.41797 MB
On chunked entry = 21821.41797 MB
On scale calculation = 21821.42578 MB
Before interleave = 21821.42578 MB
After interleave = 21821.92578 MB
After matmul = 21830.05273 MB
Before local copies matmul = 21830.05273 MB
After local copies = 21830.05566 MB
After first SDPA allocated = 21829.54297 MB
After first copy allocated = 21829.54297 MB
On chunked entry = 21829.54297 MB
On scale calculation = 21829.55078 MB
Before interleave = 21829.55078 MB
After interleave = 21829.94141 MB
After matmul = 21829.94336 MB
Before local copies matmul = 21829.94336 MB
After local copies = 21829.94629 MB
fter compute chunk allocated = 21829.54297 MB
Memory after cuda sdpa 21829.55078125 MB
1
Memory before offload  21829.529296875 MB
Memory after offload  21829.529296875 MB
Memory before cuda sdpa 21829.54296875 MB
On entering CUDA sdpa main function  allocated = 21829.54297 MB
Before first SDPA allocated = 21829.54297 MB
On chunked entry = 21829.54297 MB
On scale calculation = 21829.55078 MB
Before interleave = 21829.55078 MB
After interleave = 21830.05078 MB
After matmul = 21838.17773 MB
Before local copies matmul = 21838.17773 MB
After local copies = 21838.18066 MB
After first SDPA allocated = 21837.66797 MB
After first copy allocated = 21837.66797 MB
On chunked entry = 21837.66797 MB
On scale calculation = 21837.67578 MB
Before interleave = 21837.67578 MB
After interleave = 21838.06641 MB
After matmul = 21838.06836 MB
Before local copies matmul = 21838.06836 MB
After local copies = 21838.07129 MB
fter compute chunk allocated = 21837.66797 MB
Memory after cuda sdpa 21837.67578125 MB
1
Memory before offload  21837.654296875 MB
Memory after offload  21837.654296875 MB
Memory before cuda sdpa 21837.66796875 MB
On entering CUDA sdpa main function  allocated = 21837.66797 MB
Before first SDPA allocated = 21837.66797 MB
On chunked entry = 21837.66797 MB
On scale calculation = 21837.67578 MB
Before interleave = 21837.67578 MB
After interleave = 21838.17578 MB
After matmul = 21846.30273 MB
Before local copies matmul = 21846.30273 MB
After local copies = 21846.30566 MB
After first SDPA allocated = 21845.79297 MB
After first copy allocated = 21845.79297 MB
On chunked entry = 21845.79297 MB
On scale calculation = 21845.80078 MB
Before interleave = 21845.80078 MB
After interleave = 21846.19141 MB
After matmul = 21846.19336 MB
Before local copies matmul = 21846.19336 MB
After local copies = 21846.19629 MB
fter compute chunk allocated = 21845.79297 MB
Memory after cuda sdpa 21845.80078125 MB
Decode step 26
1
Memory before offload  21845.77978515625 MB
Memory after offload  21845.77978515625 MB
Memory before cuda sdpa 21845.79345703125 MB
On entering CUDA sdpa main function  allocated = 21845.79346 MB
Before first SDPA allocated = 21845.79346 MB
On chunked entry = 21845.79346 MB
On scale calculation = 21845.80127 MB
Before interleave = 21845.80127 MB
After interleave = 21846.30127 MB
After matmul = 21854.42822 MB
Before local copies matmul = 21854.42822 MB
After local copies = 21854.43115 MB
After first SDPA allocated = 21853.91846 MB
After first copy allocated = 21853.91846 MB
On chunked entry = 21853.91846 MB
On scale calculation = 21853.92627 MB
Before interleave = 21853.92627 MB
After interleave = 21854.33252 MB
After matmul = 21854.33447 MB
Before local copies matmul = 21854.33447 MB
After local copies = 21854.33740 MB
fter compute chunk allocated = 21853.91846 MB
Memory after cuda sdpa 21853.92626953125 MB
1
Memory before offload  21853.90478515625 MB
Memory after offload  21853.90478515625 MB
Memory before cuda sdpa 21853.91845703125 MB
On entering CUDA sdpa main function  allocated = 21853.91846 MB
Before first SDPA allocated = 21853.91846 MB
On chunked entry = 21853.91846 MB
On scale calculation = 21853.92627 MB
Before interleave = 21853.92627 MB
After interleave = 21854.42627 MB
After matmul = 21862.55322 MB
Before local copies matmul = 21862.55322 MB
After local copies = 21862.55615 MB
After first SDPA allocated = 21862.04346 MB
After first copy allocated = 21862.04346 MB
On chunked entry = 21862.04346 MB
On scale calculation = 21862.05127 MB
Before interleave = 21862.05127 MB
After interleave = 21862.45752 MB
After matmul = 21862.45947 MB
Before local copies matmul = 21862.45947 MB
After local copies = 21862.46240 MB
fter compute chunk allocated = 21862.04346 MB
Memory after cuda sdpa 21862.05126953125 MB
1
Memory before offload  21862.02978515625 MB
Memory after offload  21862.02978515625 MB
Memory before cuda sdpa 21862.04345703125 MB
On entering CUDA sdpa main function  allocated = 21862.04346 MB
Before first SDPA allocated = 21862.04346 MB
On chunked entry = 21862.04346 MB
On scale calculation = 21862.05127 MB
Before interleave = 21862.05127 MB
After interleave = 21862.55127 MB
After matmul = 21870.67822 MB
Before local copies matmul = 21870.67822 MB
After local copies = 21870.68115 MB
After first SDPA allocated = 21870.16846 MB
After first copy allocated = 21870.16846 MB
On chunked entry = 21870.16846 MB
On scale calculation = 21870.17627 MB
Before interleave = 21870.17627 MB
After interleave = 21870.58252 MB
After matmul = 21870.58447 MB
Before local copies matmul = 21870.58447 MB
After local copies = 21870.58740 MB
fter compute chunk allocated = 21870.16846 MB
Memory after cuda sdpa 21870.17626953125 MB
1
Memory before offload  21870.15478515625 MB
Memory after offload  21870.15478515625 MB
Memory before cuda sdpa 21870.16845703125 MB
On entering CUDA sdpa main function  allocated = 21870.16846 MB
Before first SDPA allocated = 21870.16846 MB
On chunked entry = 21870.16846 MB
On scale calculation = 21870.17627 MB
Before interleave = 21870.17627 MB
After interleave = 21870.67627 MB
After matmul = 21878.80322 MB
Before local copies matmul = 21878.80322 MB
After local copies = 21878.80615 MB
After first SDPA allocated = 21878.29346 MB
After first copy allocated = 21878.29346 MB
On chunked entry = 21878.29346 MB
On scale calculation = 21878.30127 MB
Before interleave = 21878.30127 MB
After interleave = 21878.70752 MB
After matmul = 21878.70947 MB
Before local copies matmul = 21878.70947 MB
After local copies = 21878.71240 MB
fter compute chunk allocated = 21878.29346 MB
Memory after cuda sdpa 21878.30126953125 MB
1
Memory before offload  21878.27978515625 MB
Memory after offload  21878.27978515625 MB
Memory before cuda sdpa 21878.29345703125 MB
On entering CUDA sdpa main function  allocated = 21878.29346 MB
Before first SDPA allocated = 21878.29346 MB
On chunked entry = 21878.29346 MB
On scale calculation = 21878.30127 MB
Before interleave = 21878.30127 MB
After interleave = 21878.80127 MB
After matmul = 21886.92822 MB
Before local copies matmul = 21886.92822 MB
After local copies = 21886.93115 MB
After first SDPA allocated = 21886.41846 MB
After first copy allocated = 21886.41846 MB
On chunked entry = 21886.41846 MB
On scale calculation = 21886.42627 MB
Before interleave = 21886.42627 MB
After interleave = 21886.83252 MB
After matmul = 21886.83447 MB
Before local copies matmul = 21886.83447 MB
After local copies = 21886.83740 MB
fter compute chunk allocated = 21886.41846 MB
Memory after cuda sdpa 21886.42626953125 MB
1
Memory before offload  21886.40478515625 MB
Memory after offload  21886.40478515625 MB
Memory before cuda sdpa 21886.41845703125 MB
On entering CUDA sdpa main function  allocated = 21886.41846 MB
Before first SDPA allocated = 21886.41846 MB
On chunked entry = 21886.41846 MB
On scale calculation = 21886.42627 MB
Before interleave = 21886.42627 MB
After interleave = 21886.92627 MB
After matmul = 21895.05322 MB
Before local copies matmul = 21895.05322 MB
After local copies = 21895.05615 MB
After first SDPA allocated = 21894.54346 MB
After first copy allocated = 21894.54346 MB
On chunked entry = 21894.54346 MB
On scale calculation = 21894.55127 MB
Before interleave = 21894.55127 MB
After interleave = 21894.95752 MB
After matmul = 21894.95947 MB
Before local copies matmul = 21894.95947 MB
After local copies = 21894.96240 MB
fter compute chunk allocated = 21894.54346 MB
Memory after cuda sdpa 21894.55126953125 MB
1
Memory before offload  21894.52978515625 MB
Memory after offload  21894.52978515625 MB
Memory before cuda sdpa 21894.54345703125 MB
On entering CUDA sdpa main function  allocated = 21894.54346 MB
Before first SDPA allocated = 21894.54346 MB
On chunked entry = 21894.54346 MB
On scale calculation = 21894.55127 MB
Before interleave = 21894.55127 MB
After interleave = 21895.05127 MB
After matmul = 21903.17822 MB
Before local copies matmul = 21903.17822 MB
After local copies = 21903.18115 MB
After first SDPA allocated = 21902.66846 MB
After first copy allocated = 21902.66846 MB
On chunked entry = 21902.66846 MB
On scale calculation = 21902.67627 MB
Before interleave = 21902.67627 MB
After interleave = 21903.08252 MB
After matmul = 21903.08447 MB
Before local copies matmul = 21903.08447 MB
After local copies = 21903.08740 MB
fter compute chunk allocated = 21902.66846 MB
Memory after cuda sdpa 21902.67626953125 MB
1
Memory before offload  21902.65478515625 MB
Memory after offload  21902.65478515625 MB
Memory before cuda sdpa 21902.66845703125 MB
On entering CUDA sdpa main function  allocated = 21902.66846 MB
Before first SDPA allocated = 21902.66846 MB
On chunked entry = 21902.66846 MB
On scale calculation = 21902.67627 MB
Before interleave = 21902.67627 MB
After interleave = 21903.17627 MB
After matmul = 21911.30322 MB
Before local copies matmul = 21911.30322 MB
After local copies = 21911.30615 MB
After first SDPA allocated = 21910.79346 MB
After first copy allocated = 21910.79346 MB
On chunked entry = 21910.79346 MB
On scale calculation = 21910.80127 MB
Before interleave = 21910.80127 MB
After interleave = 21911.20752 MB
After matmul = 21911.20947 MB
Before local copies matmul = 21911.20947 MB
After local copies = 21911.21240 MB
fter compute chunk allocated = 21910.79346 MB
Memory after cuda sdpa 21910.80126953125 MB
1
Memory before offload  21910.77978515625 MB
Memory after offload  21910.77978515625 MB
Memory before cuda sdpa 21910.79345703125 MB
On entering CUDA sdpa main function  allocated = 21910.79346 MB
Before first SDPA allocated = 21910.79346 MB
On chunked entry = 21910.79346 MB
On scale calculation = 21910.80127 MB
Before interleave = 21910.80127 MB
After interleave = 21911.30127 MB
After matmul = 21919.42822 MB
Before local copies matmul = 21919.42822 MB
After local copies = 21919.43115 MB
After first SDPA allocated = 21918.91846 MB
After first copy allocated = 21918.91846 MB
On chunked entry = 21918.91846 MB
On scale calculation = 21918.92627 MB
Before interleave = 21918.92627 MB
After interleave = 21919.33252 MB
After matmul = 21919.33447 MB
Before local copies matmul = 21919.33447 MB
After local copies = 21919.33740 MB
fter compute chunk allocated = 21918.91846 MB
Memory after cuda sdpa 21918.92626953125 MB
1
Memory before offload  21918.90478515625 MB
Memory after offload  21918.90478515625 MB
Memory before cuda sdpa 21918.91845703125 MB
On entering CUDA sdpa main function  allocated = 21918.91846 MB
Before first SDPA allocated = 21918.91846 MB
On chunked entry = 21918.91846 MB
On scale calculation = 21918.92627 MB
Before interleave = 21918.92627 MB
After interleave = 21919.42627 MB
After matmul = 21927.55322 MB
Before local copies matmul = 21927.55322 MB
After local copies = 21927.55615 MB
After first SDPA allocated = 21927.04346 MB
After first copy allocated = 21927.04346 MB
On chunked entry = 21927.04346 MB
On scale calculation = 21927.05127 MB
Before interleave = 21927.05127 MB
After interleave = 21927.45752 MB
After matmul = 21927.45947 MB
Before local copies matmul = 21927.45947 MB
After local copies = 21927.46240 MB
fter compute chunk allocated = 21927.04346 MB
Memory after cuda sdpa 21927.05126953125 MB
1
Memory before offload  21927.02978515625 MB
Memory after offload  21927.02978515625 MB
Memory before cuda sdpa 21927.04345703125 MB
On entering CUDA sdpa main function  allocated = 21927.04346 MB
Before first SDPA allocated = 21927.04346 MB
On chunked entry = 21927.04346 MB
On scale calculation = 21927.05127 MB
Before interleave = 21927.05127 MB
After interleave = 21927.55127 MB
After matmul = 21935.67822 MB
Before local copies matmul = 21935.67822 MB
After local copies = 21935.68115 MB
After first SDPA allocated = 21935.16846 MB
After first copy allocated = 21935.16846 MB
On chunked entry = 21935.16846 MB
On scale calculation = 21935.17627 MB
Before interleave = 21935.17627 MB
After interleave = 21935.58252 MB
After matmul = 21935.58447 MB
Before local copies matmul = 21935.58447 MB
After local copies = 21935.58740 MB
fter compute chunk allocated = 21935.16846 MB
Memory after cuda sdpa 21935.17626953125 MB
1
Memory before offload  21935.15478515625 MB
Memory after offload  21935.15478515625 MB
Memory before cuda sdpa 21935.16845703125 MB
On entering CUDA sdpa main function  allocated = 21935.16846 MB
Before first SDPA allocated = 21935.16846 MB
On chunked entry = 21935.16846 MB
On scale calculation = 21935.17627 MB
Before interleave = 21935.17627 MB
After interleave = 21935.67627 MB
After matmul = 21943.80322 MB
Before local copies matmul = 21943.80322 MB
After local copies = 21943.80615 MB
After first SDPA allocated = 21943.29346 MB
After first copy allocated = 21943.29346 MB
On chunked entry = 21943.29346 MB
On scale calculation = 21943.30127 MB
Before interleave = 21943.30127 MB
After interleave = 21943.70752 MB
After matmul = 21943.70947 MB
Before local copies matmul = 21943.70947 MB
After local copies = 21943.71240 MB
fter compute chunk allocated = 21943.29346 MB
Memory after cuda sdpa 21943.30126953125 MB
1
Memory before offload  21943.27978515625 MB
Memory after offload  21943.27978515625 MB
Memory before cuda sdpa 21943.29345703125 MB
On entering CUDA sdpa main function  allocated = 21943.29346 MB
Before first SDPA allocated = 21943.29346 MB
On chunked entry = 21943.29346 MB
On scale calculation = 21943.30127 MB
Before interleave = 21943.30127 MB
After interleave = 21943.80127 MB
After matmul = 21951.92822 MB
Before local copies matmul = 21951.92822 MB
After local copies = 21951.93115 MB
After first SDPA allocated = 21951.41846 MB
After first copy allocated = 21951.41846 MB
On chunked entry = 21951.41846 MB
On scale calculation = 21951.42627 MB
Before interleave = 21951.42627 MB
After interleave = 21951.83252 MB
After matmul = 21951.83447 MB
Before local copies matmul = 21951.83447 MB
After local copies = 21951.83740 MB
fter compute chunk allocated = 21951.41846 MB
Memory after cuda sdpa 21951.42626953125 MB
1
Memory before offload  21951.40478515625 MB
Memory after offload  21951.40478515625 MB
Memory before cuda sdpa 21951.41845703125 MB
On entering CUDA sdpa main function  allocated = 21951.41846 MB
Before first SDPA allocated = 21951.41846 MB
On chunked entry = 21951.41846 MB
On scale calculation = 21951.42627 MB
Before interleave = 21951.42627 MB
After interleave = 21951.92627 MB
After matmul = 21960.05322 MB
Before local copies matmul = 21960.05322 MB
After local copies = 21960.05615 MB
After first SDPA allocated = 21959.54346 MB
After first copy allocated = 21959.54346 MB
On chunked entry = 21959.54346 MB
On scale calculation = 21959.55127 MB
Before interleave = 21959.55127 MB
After interleave = 21959.95752 MB
After matmul = 21959.95947 MB
Before local copies matmul = 21959.95947 MB
After local copies = 21959.96240 MB
fter compute chunk allocated = 21959.54346 MB
Memory after cuda sdpa 21959.55126953125 MB
1
Memory before offload  21959.52978515625 MB
Memory after offload  21959.52978515625 MB
Memory before cuda sdpa 21959.54345703125 MB
On entering CUDA sdpa main function  allocated = 21959.54346 MB
Before first SDPA allocated = 21959.54346 MB
On chunked entry = 21959.54346 MB
On scale calculation = 21959.55127 MB
Before interleave = 21959.55127 MB
After interleave = 21960.05127 MB
After matmul = 21968.17822 MB
Before local copies matmul = 21968.17822 MB
After local copies = 21968.18115 MB
After first SDPA allocated = 21967.66846 MB
After first copy allocated = 21967.66846 MB
On chunked entry = 21967.66846 MB
On scale calculation = 21967.67627 MB
Before interleave = 21967.67627 MB
After interleave = 21968.08252 MB
After matmul = 21968.08447 MB
Before local copies matmul = 21968.08447 MB
After local copies = 21968.08740 MB
fter compute chunk allocated = 21967.66846 MB
Memory after cuda sdpa 21967.67626953125 MB
1
Memory before offload  21967.65478515625 MB
Memory after offload  21967.65478515625 MB
Memory before cuda sdpa 21967.66845703125 MB
On entering CUDA sdpa main function  allocated = 21967.66846 MB
Before first SDPA allocated = 21967.66846 MB
On chunked entry = 21967.66846 MB
On scale calculation = 21967.67627 MB
Before interleave = 21967.67627 MB
After interleave = 21968.17627 MB
After matmul = 21976.30322 MB
Before local copies matmul = 21976.30322 MB
After local copies = 21976.30615 MB
After first SDPA allocated = 21975.79346 MB
After first copy allocated = 21975.79346 MB
On chunked entry = 21975.79346 MB
On scale calculation = 21975.80127 MB
Before interleave = 21975.80127 MB
After interleave = 21976.20752 MB
After matmul = 21976.20947 MB
Before local copies matmul = 21976.20947 MB
After local copies = 21976.21240 MB
fter compute chunk allocated = 21975.79346 MB
Memory after cuda sdpa 21975.80126953125 MB
1
Memory before offload  21975.77978515625 MB
Memory after offload  21975.77978515625 MB
Memory before cuda sdpa 21975.79345703125 MB
On entering CUDA sdpa main function  allocated = 21975.79346 MB
Before first SDPA allocated = 21975.79346 MB
On chunked entry = 21975.79346 MB
On scale calculation = 21975.80127 MB
Before interleave = 21975.80127 MB
After interleave = 21976.30127 MB
After matmul = 21984.42822 MB
Before local copies matmul = 21984.42822 MB
After local copies = 21984.43115 MB
After first SDPA allocated = 21983.91846 MB
After first copy allocated = 21983.91846 MB
On chunked entry = 21983.91846 MB
On scale calculation = 21983.92627 MB
Before interleave = 21983.92627 MB
After interleave = 21984.33252 MB
After matmul = 21984.33447 MB
Before local copies matmul = 21984.33447 MB
After local copies = 21984.33740 MB
fter compute chunk allocated = 21983.91846 MB
Memory after cuda sdpa 21983.92626953125 MB
1
Memory before offload  21983.90478515625 MB
Memory after offload  21983.90478515625 MB
Memory before cuda sdpa 21983.91845703125 MB
On entering CUDA sdpa main function  allocated = 21983.91846 MB
Before first SDPA allocated = 21983.91846 MB
On chunked entry = 21983.91846 MB
On scale calculation = 21983.92627 MB
Before interleave = 21983.92627 MB
After interleave = 21984.42627 MB
After matmul = 21992.55322 MB
Before local copies matmul = 21992.55322 MB
After local copies = 21992.55615 MB
After first SDPA allocated = 21992.04346 MB
After first copy allocated = 21992.04346 MB
On chunked entry = 21992.04346 MB
On scale calculation = 21992.05127 MB
Before interleave = 21992.05127 MB
After interleave = 21992.45752 MB
After matmul = 21992.45947 MB
Before local copies matmul = 21992.45947 MB
After local copies = 21992.46240 MB
fter compute chunk allocated = 21992.04346 MB
Memory after cuda sdpa 21992.05126953125 MB
1
Memory before offload  21992.02978515625 MB
Memory after offload  21992.02978515625 MB
Memory before cuda sdpa 21992.04345703125 MB
On entering CUDA sdpa main function  allocated = 21992.04346 MB
Before first SDPA allocated = 21992.04346 MB
On chunked entry = 21992.04346 MB
On scale calculation = 21992.05127 MB
Before interleave = 21992.05127 MB
After interleave = 21992.55127 MB
After matmul = 22000.67822 MB
Before local copies matmul = 22000.67822 MB
After local copies = 22000.68115 MB
After first SDPA allocated = 22000.16846 MB
After first copy allocated = 22000.16846 MB
On chunked entry = 22000.16846 MB
On scale calculation = 22000.17627 MB
Before interleave = 22000.17627 MB
After interleave = 22000.58252 MB
After matmul = 22000.58447 MB
Before local copies matmul = 22000.58447 MB
After local copies = 22000.58740 MB
fter compute chunk allocated = 22000.16846 MB
Memory after cuda sdpa 22000.17626953125 MB
1
Memory before offload  22000.15478515625 MB
Memory after offload  22000.15478515625 MB
Memory before cuda sdpa 22000.16845703125 MB
On entering CUDA sdpa main function  allocated = 22000.16846 MB
Before first SDPA allocated = 22000.16846 MB
On chunked entry = 22000.16846 MB
On scale calculation = 22000.17627 MB
Before interleave = 22000.17627 MB
After interleave = 22000.67627 MB
After matmul = 22008.80322 MB
Before local copies matmul = 22008.80322 MB
After local copies = 22008.80615 MB
After first SDPA allocated = 22008.29346 MB
After first copy allocated = 22008.29346 MB
On chunked entry = 22008.29346 MB
On scale calculation = 22008.30127 MB
Before interleave = 22008.30127 MB
After interleave = 22008.70752 MB
After matmul = 22008.70947 MB
Before local copies matmul = 22008.70947 MB
After local copies = 22008.71240 MB
fter compute chunk allocated = 22008.29346 MB
Memory after cuda sdpa 22008.30126953125 MB
1
Memory before offload  22008.27978515625 MB
Memory after offload  22008.27978515625 MB
Memory before cuda sdpa 22008.29345703125 MB
On entering CUDA sdpa main function  allocated = 22008.29346 MB
Before first SDPA allocated = 22008.29346 MB
On chunked entry = 22008.29346 MB
On scale calculation = 22008.30127 MB
Before interleave = 22008.30127 MB
After interleave = 22008.80127 MB
After matmul = 22016.92822 MB
Before local copies matmul = 22016.92822 MB
After local copies = 22016.93115 MB
After first SDPA allocated = 22016.41846 MB
After first copy allocated = 22016.41846 MB
On chunked entry = 22016.41846 MB
On scale calculation = 22016.42627 MB
Before interleave = 22016.42627 MB
After interleave = 22016.83252 MB
After matmul = 22016.83447 MB
Before local copies matmul = 22016.83447 MB
After local copies = 22016.83740 MB
fter compute chunk allocated = 22016.41846 MB
Memory after cuda sdpa 22016.42626953125 MB
1
Memory before offload  22016.40478515625 MB
Memory after offload  22016.40478515625 MB
Memory before cuda sdpa 22016.41845703125 MB
On entering CUDA sdpa main function  allocated = 22016.41846 MB
Before first SDPA allocated = 22016.41846 MB
On chunked entry = 22016.41846 MB
On scale calculation = 22016.42627 MB
Before interleave = 22016.42627 MB
After interleave = 22016.92627 MB
After matmul = 22025.05322 MB
Before local copies matmul = 22025.05322 MB
After local copies = 22025.05615 MB
After first SDPA allocated = 22024.54346 MB
After first copy allocated = 22024.54346 MB
On chunked entry = 22024.54346 MB
On scale calculation = 22024.55127 MB
Before interleave = 22024.55127 MB
After interleave = 22024.95752 MB
After matmul = 22024.95947 MB
Before local copies matmul = 22024.95947 MB
After local copies = 22024.96240 MB
fter compute chunk allocated = 22024.54346 MB
Memory after cuda sdpa 22024.55126953125 MB
1
Memory before offload  22024.52978515625 MB
Memory after offload  22024.52978515625 MB
Memory before cuda sdpa 22024.54345703125 MB
On entering CUDA sdpa main function  allocated = 22024.54346 MB
Before first SDPA allocated = 22024.54346 MB
On chunked entry = 22024.54346 MB
On scale calculation = 22024.55127 MB
Before interleave = 22024.55127 MB
After interleave = 22025.05127 MB
After matmul = 22033.17822 MB
Before local copies matmul = 22033.17822 MB
After local copies = 22033.18115 MB
After first SDPA allocated = 22032.66846 MB
After first copy allocated = 22032.66846 MB
On chunked entry = 22032.66846 MB
On scale calculation = 22032.67627 MB
Before interleave = 22032.67627 MB
After interleave = 22033.08252 MB
After matmul = 22033.08447 MB
Before local copies matmul = 22033.08447 MB
After local copies = 22033.08740 MB
fter compute chunk allocated = 22032.66846 MB
Memory after cuda sdpa 22032.67626953125 MB
1
Memory before offload  22032.65478515625 MB
Memory after offload  22032.65478515625 MB
Memory before cuda sdpa 22032.66845703125 MB
On entering CUDA sdpa main function  allocated = 22032.66846 MB
Before first SDPA allocated = 22032.66846 MB
On chunked entry = 22032.66846 MB
On scale calculation = 22032.67627 MB
Before interleave = 22032.67627 MB
After interleave = 22033.17627 MB
After matmul = 22041.30322 MB
Before local copies matmul = 22041.30322 MB
After local copies = 22041.30615 MB
After first SDPA allocated = 22040.79346 MB
After first copy allocated = 22040.79346 MB
On chunked entry = 22040.79346 MB
On scale calculation = 22040.80127 MB
Before interleave = 22040.80127 MB
After interleave = 22041.20752 MB
After matmul = 22041.20947 MB
Before local copies matmul = 22041.20947 MB
After local copies = 22041.21240 MB
fter compute chunk allocated = 22040.79346 MB
Memory after cuda sdpa 22040.80126953125 MB
1
Memory before offload  22040.77978515625 MB
Memory after offload  22040.77978515625 MB
Memory before cuda sdpa 22040.79345703125 MB
On entering CUDA sdpa main function  allocated = 22040.79346 MB
Before first SDPA allocated = 22040.79346 MB
On chunked entry = 22040.79346 MB
On scale calculation = 22040.80127 MB
Before interleave = 22040.80127 MB
After interleave = 22041.30127 MB
After matmul = 22049.42822 MB
Before local copies matmul = 22049.42822 MB
After local copies = 22049.43115 MB
After first SDPA allocated = 22048.91846 MB
After first copy allocated = 22048.91846 MB
On chunked entry = 22048.91846 MB
On scale calculation = 22048.92627 MB
Before interleave = 22048.92627 MB
After interleave = 22049.33252 MB
After matmul = 22049.33447 MB
Before local copies matmul = 22049.33447 MB
After local copies = 22049.33740 MB
fter compute chunk allocated = 22048.91846 MB
Memory after cuda sdpa 22048.92626953125 MB
1
Memory before offload  22048.90478515625 MB
Memory after offload  22048.90478515625 MB
Memory before cuda sdpa 22048.91845703125 MB
On entering CUDA sdpa main function  allocated = 22048.91846 MB
Before first SDPA allocated = 22048.91846 MB
On chunked entry = 22048.91846 MB
On scale calculation = 22048.92627 MB
Before interleave = 22048.92627 MB
After interleave = 22049.42627 MB
After matmul = 22057.55322 MB
Before local copies matmul = 22057.55322 MB
After local copies = 22057.55615 MB
After first SDPA allocated = 22057.04346 MB
After first copy allocated = 22057.04346 MB
On chunked entry = 22057.04346 MB
On scale calculation = 22057.05127 MB
Before interleave = 22057.05127 MB
After interleave = 22057.45752 MB
After matmul = 22057.45947 MB
Before local copies matmul = 22057.45947 MB
After local copies = 22057.46240 MB
fter compute chunk allocated = 22057.04346 MB
Memory after cuda sdpa 22057.05126953125 MB
1
Memory before offload  22057.02978515625 MB
Memory after offload  22057.02978515625 MB
Memory before cuda sdpa 22057.04345703125 MB
On entering CUDA sdpa main function  allocated = 22057.04346 MB
Before first SDPA allocated = 22057.04346 MB
On chunked entry = 22057.04346 MB
On scale calculation = 22057.05127 MB
Before interleave = 22057.05127 MB
After interleave = 22057.55127 MB
After matmul = 22065.67822 MB
Before local copies matmul = 22065.67822 MB
After local copies = 22065.68115 MB
After first SDPA allocated = 22065.16846 MB
After first copy allocated = 22065.16846 MB
On chunked entry = 22065.16846 MB
On scale calculation = 22065.17627 MB
Before interleave = 22065.17627 MB
After interleave = 22065.58252 MB
After matmul = 22065.58447 MB
Before local copies matmul = 22065.58447 MB
After local copies = 22065.58740 MB
fter compute chunk allocated = 22065.16846 MB
Memory after cuda sdpa 22065.17626953125 MB
1
Memory before offload  22065.15478515625 MB
Memory after offload  22065.15478515625 MB
Memory before cuda sdpa 22065.16845703125 MB
On entering CUDA sdpa main function  allocated = 22065.16846 MB
Before first SDPA allocated = 22065.16846 MB
On chunked entry = 22065.16846 MB
On scale calculation = 22065.17627 MB
Before interleave = 22065.17627 MB
After interleave = 22065.67627 MB
After matmul = 22073.80322 MB
Before local copies matmul = 22073.80322 MB
After local copies = 22073.80615 MB
After first SDPA allocated = 22073.29346 MB
After first copy allocated = 22073.29346 MB
On chunked entry = 22073.29346 MB
On scale calculation = 22073.30127 MB
Before interleave = 22073.30127 MB
After interleave = 22073.70752 MB
After matmul = 22073.70947 MB
Before local copies matmul = 22073.70947 MB
After local copies = 22073.71240 MB
fter compute chunk allocated = 22073.29346 MB
Memory after cuda sdpa 22073.30126953125 MB
1
Memory before offload  22073.27978515625 MB
Memory after offload  22073.27978515625 MB
Memory before cuda sdpa 22073.29345703125 MB
On entering CUDA sdpa main function  allocated = 22073.29346 MB
Before first SDPA allocated = 22073.29346 MB
On chunked entry = 22073.29346 MB
On scale calculation = 22073.30127 MB
Before interleave = 22073.30127 MB
After interleave = 22073.80127 MB
After matmul = 22081.92822 MB
Before local copies matmul = 22081.92822 MB
After local copies = 22081.93115 MB
After first SDPA allocated = 22081.41846 MB
After first copy allocated = 22081.41846 MB
On chunked entry = 22081.41846 MB
On scale calculation = 22081.42627 MB
Before interleave = 22081.42627 MB
After interleave = 22081.83252 MB
After matmul = 22081.83447 MB
Before local copies matmul = 22081.83447 MB
After local copies = 22081.83740 MB
fter compute chunk allocated = 22081.41846 MB
Memory after cuda sdpa 22081.42626953125 MB
1
Memory before offload  22081.40478515625 MB
Memory after offload  22081.40478515625 MB
Memory before cuda sdpa 22081.41845703125 MB
On entering CUDA sdpa main function  allocated = 22081.41846 MB
Before first SDPA allocated = 22081.41846 MB
On chunked entry = 22081.41846 MB
On scale calculation = 22081.42627 MB
Before interleave = 22081.42627 MB
After interleave = 22081.92627 MB
After matmul = 22090.05322 MB
Before local copies matmul = 22090.05322 MB
After local copies = 22090.05615 MB
After first SDPA allocated = 22089.54346 MB
After first copy allocated = 22089.54346 MB
On chunked entry = 22089.54346 MB
On scale calculation = 22089.55127 MB
Before interleave = 22089.55127 MB
After interleave = 22089.95752 MB
After matmul = 22089.95947 MB
Before local copies matmul = 22089.95947 MB
After local copies = 22089.96240 MB
fter compute chunk allocated = 22089.54346 MB
Memory after cuda sdpa 22089.55126953125 MB
1
Memory before offload  22089.52978515625 MB
Memory after offload  22089.52978515625 MB
Memory before cuda sdpa 22089.54345703125 MB
On entering CUDA sdpa main function  allocated = 22089.54346 MB
Before first SDPA allocated = 22089.54346 MB
On chunked entry = 22089.54346 MB
On scale calculation = 22089.55127 MB
Before interleave = 22089.55127 MB
After interleave = 22090.05127 MB
After matmul = 22098.17822 MB
Before local copies matmul = 22098.17822 MB
After local copies = 22098.18115 MB
After first SDPA allocated = 22097.66846 MB
After first copy allocated = 22097.66846 MB
On chunked entry = 22097.66846 MB
On scale calculation = 22097.67627 MB
Before interleave = 22097.67627 MB
After interleave = 22098.08252 MB
After matmul = 22098.08447 MB
Before local copies matmul = 22098.08447 MB
After local copies = 22098.08740 MB
fter compute chunk allocated = 22097.66846 MB
Memory after cuda sdpa 22097.67626953125 MB
1
Memory before offload  22097.65478515625 MB
Memory after offload  22097.65478515625 MB
Memory before cuda sdpa 22097.66845703125 MB
On entering CUDA sdpa main function  allocated = 22097.66846 MB
Before first SDPA allocated = 22097.66846 MB
On chunked entry = 22097.66846 MB
On scale calculation = 22097.67627 MB
Before interleave = 22097.67627 MB
After interleave = 22098.17627 MB
After matmul = 22106.30322 MB
Before local copies matmul = 22106.30322 MB
After local copies = 22106.30615 MB
After first SDPA allocated = 22105.79346 MB
After first copy allocated = 22105.79346 MB
On chunked entry = 22105.79346 MB
On scale calculation = 22105.80127 MB
Before interleave = 22105.80127 MB
After interleave = 22106.20752 MB
After matmul = 22106.20947 MB
Before local copies matmul = 22106.20947 MB
After local copies = 22106.21240 MB
fter compute chunk allocated = 22105.79346 MB
Memory after cuda sdpa 22105.80126953125 MB
Decode step 27
1
Memory before offload  22105.7802734375 MB
Memory after offload  22105.7802734375 MB
Memory before cuda sdpa 22105.7939453125 MB
On entering CUDA sdpa main function  allocated = 22105.79395 MB
Before first SDPA allocated = 22105.79395 MB
On chunked entry = 22105.79395 MB
On scale calculation = 22105.80176 MB
Before interleave = 22105.80176 MB
After interleave = 22106.30176 MB
After matmul = 22114.42871 MB
Before local copies matmul = 22114.42871 MB
After local copies = 22114.43164 MB
After first SDPA allocated = 22113.91895 MB
After first copy allocated = 22113.91895 MB
On chunked entry = 22113.91895 MB
On scale calculation = 22113.92676 MB
Before interleave = 22113.92676 MB
After interleave = 22114.34863 MB
After matmul = 22114.35059 MB
Before local copies matmul = 22114.35059 MB
After local copies = 22114.35352 MB
fter compute chunk allocated = 22113.91895 MB
Memory after cuda sdpa 22113.9267578125 MB
1
Memory before offload  22113.9052734375 MB
Memory after offload  22113.9052734375 MB
Memory before cuda sdpa 22113.9189453125 MB
On entering CUDA sdpa main function  allocated = 22113.91895 MB
Before first SDPA allocated = 22113.91895 MB
On chunked entry = 22113.91895 MB
On scale calculation = 22113.92676 MB
Before interleave = 22113.92676 MB
After interleave = 22114.42676 MB
After matmul = 22122.55371 MB
Before local copies matmul = 22122.55371 MB
After local copies = 22122.55664 MB
After first SDPA allocated = 22122.04395 MB
After first copy allocated = 22122.04395 MB
On chunked entry = 22122.04395 MB
On scale calculation = 22122.05176 MB
Before interleave = 22122.05176 MB
After interleave = 22122.47363 MB
After matmul = 22122.47559 MB
Before local copies matmul = 22122.47559 MB
After local copies = 22122.47852 MB
fter compute chunk allocated = 22122.04395 MB
Memory after cuda sdpa 22122.0517578125 MB
1
Memory before offload  22122.0302734375 MB
Memory after offload  22122.0302734375 MB
Memory before cuda sdpa 22122.0439453125 MB
On entering CUDA sdpa main function  allocated = 22122.04395 MB
Before first SDPA allocated = 22122.04395 MB
On chunked entry = 22122.04395 MB
On scale calculation = 22122.05176 MB
Before interleave = 22122.05176 MB
After interleave = 22122.55176 MB
After matmul = 22130.67871 MB
Before local copies matmul = 22130.67871 MB
After local copies = 22130.68164 MB
After first SDPA allocated = 22130.16895 MB
After first copy allocated = 22130.16895 MB
On chunked entry = 22130.16895 MB
On scale calculation = 22130.17676 MB
Before interleave = 22130.17676 MB
After interleave = 22130.59863 MB
After matmul = 22130.60059 MB
Before local copies matmul = 22130.60059 MB
After local copies = 22130.60352 MB
fter compute chunk allocated = 22130.16895 MB
Memory after cuda sdpa 22130.1767578125 MB
1
Memory before offload  22130.1552734375 MB
Memory after offload  22130.1552734375 MB
Memory before cuda sdpa 22130.1689453125 MB
On entering CUDA sdpa main function  allocated = 22130.16895 MB
Before first SDPA allocated = 22130.16895 MB
On chunked entry = 22130.16895 MB
On scale calculation = 22130.17676 MB
Before interleave = 22130.17676 MB
After interleave = 22130.67676 MB
After matmul = 22138.80371 MB
Before local copies matmul = 22138.80371 MB
After local copies = 22138.80664 MB
After first SDPA allocated = 22138.29395 MB
After first copy allocated = 22138.29395 MB
On chunked entry = 22138.29395 MB
On scale calculation = 22138.30176 MB
Before interleave = 22138.30176 MB
After interleave = 22138.72363 MB
After matmul = 22138.72559 MB
Before local copies matmul = 22138.72559 MB
After local copies = 22138.72852 MB
fter compute chunk allocated = 22138.29395 MB
Memory after cuda sdpa 22138.3017578125 MB
1
Memory before offload  22138.2802734375 MB
Memory after offload  22138.2802734375 MB
Memory before cuda sdpa 22138.2939453125 MB
On entering CUDA sdpa main function  allocated = 22138.29395 MB
Before first SDPA allocated = 22138.29395 MB
On chunked entry = 22138.29395 MB
On scale calculation = 22138.30176 MB
Before interleave = 22138.30176 MB
After interleave = 22138.80176 MB
After matmul = 22146.92871 MB
Before local copies matmul = 22146.92871 MB
After local copies = 22146.93164 MB
After first SDPA allocated = 22146.41895 MB
After first copy allocated = 22146.41895 MB
On chunked entry = 22146.41895 MB
On scale calculation = 22146.42676 MB
Before interleave = 22146.42676 MB
After interleave = 22146.84863 MB
After matmul = 22146.85059 MB
Before local copies matmul = 22146.85059 MB
After local copies = 22146.85352 MB
fter compute chunk allocated = 22146.41895 MB
Memory after cuda sdpa 22146.4267578125 MB
1
Memory before offload  22146.4052734375 MB
Memory after offload  22146.4052734375 MB
Memory before cuda sdpa 22146.4189453125 MB
On entering CUDA sdpa main function  allocated = 22146.41895 MB
Before first SDPA allocated = 22146.41895 MB
On chunked entry = 22146.41895 MB
On scale calculation = 22146.42676 MB
Before interleave = 22146.42676 MB
After interleave = 22146.92676 MB
After matmul = 22155.05371 MB
Before local copies matmul = 22155.05371 MB
After local copies = 22155.05664 MB
After first SDPA allocated = 22154.54395 MB
After first copy allocated = 22154.54395 MB
On chunked entry = 22154.54395 MB
On scale calculation = 22154.55176 MB
Before interleave = 22154.55176 MB
After interleave = 22154.97363 MB
After matmul = 22154.97559 MB
Before local copies matmul = 22154.97559 MB
After local copies = 22154.97852 MB
fter compute chunk allocated = 22154.54395 MB
Memory after cuda sdpa 22154.5517578125 MB
1
Memory before offload  22154.5302734375 MB
Memory after offload  22154.5302734375 MB
Memory before cuda sdpa 22154.5439453125 MB
On entering CUDA sdpa main function  allocated = 22154.54395 MB
Before first SDPA allocated = 22154.54395 MB
On chunked entry = 22154.54395 MB
On scale calculation = 22154.55176 MB
Before interleave = 22154.55176 MB
After interleave = 22155.05176 MB
After matmul = 22163.17871 MB
Before local copies matmul = 22163.17871 MB
After local copies = 22163.18164 MB
After first SDPA allocated = 22162.66895 MB
After first copy allocated = 22162.66895 MB
On chunked entry = 22162.66895 MB
On scale calculation = 22162.67676 MB
Before interleave = 22162.67676 MB
After interleave = 22163.09863 MB
After matmul = 22163.10059 MB
Before local copies matmul = 22163.10059 MB
After local copies = 22163.10352 MB
fter compute chunk allocated = 22162.66895 MB
Memory after cuda sdpa 22162.6767578125 MB
1
Memory before offload  22162.6552734375 MB
Memory after offload  22162.6552734375 MB
Memory before cuda sdpa 22162.6689453125 MB
On entering CUDA sdpa main function  allocated = 22162.66895 MB
Before first SDPA allocated = 22162.66895 MB
On chunked entry = 22162.66895 MB
On scale calculation = 22162.67676 MB
Before interleave = 22162.67676 MB
After interleave = 22163.17676 MB
After matmul = 22171.30371 MB
Before local copies matmul = 22171.30371 MB
After local copies = 22171.30664 MB
After first SDPA allocated = 22170.79395 MB
After first copy allocated = 22170.79395 MB
On chunked entry = 22170.79395 MB
On scale calculation = 22170.80176 MB
Before interleave = 22170.80176 MB
After interleave = 22171.22363 MB
After matmul = 22171.22559 MB
Before local copies matmul = 22171.22559 MB
After local copies = 22171.22852 MB
fter compute chunk allocated = 22170.79395 MB
Memory after cuda sdpa 22170.8017578125 MB
1
Memory before offload  22170.7802734375 MB
Memory after offload  22170.7802734375 MB
Memory before cuda sdpa 22170.7939453125 MB
On entering CUDA sdpa main function  allocated = 22170.79395 MB
Before first SDPA allocated = 22170.79395 MB
On chunked entry = 22170.79395 MB
On scale calculation = 22170.80176 MB
Before interleave = 22170.80176 MB
After interleave = 22171.30176 MB
After matmul = 22179.42871 MB
Before local copies matmul = 22179.42871 MB
After local copies = 22179.43164 MB
After first SDPA allocated = 22178.91895 MB
After first copy allocated = 22178.91895 MB
On chunked entry = 22178.91895 MB
On scale calculation = 22178.92676 MB
Before interleave = 22178.92676 MB
After interleave = 22179.34863 MB
After matmul = 22179.35059 MB
Before local copies matmul = 22179.35059 MB
After local copies = 22179.35352 MB
fter compute chunk allocated = 22178.91895 MB
Memory after cuda sdpa 22178.9267578125 MB
1
Memory before offload  22178.9052734375 MB
Memory after offload  22178.9052734375 MB
Memory before cuda sdpa 22178.9189453125 MB
On entering CUDA sdpa main function  allocated = 22178.91895 MB
Before first SDPA allocated = 22178.91895 MB
On chunked entry = 22178.91895 MB
On scale calculation = 22178.92676 MB
Before interleave = 22178.92676 MB
After interleave = 22179.42676 MB
After matmul = 22187.55371 MB
Before local copies matmul = 22187.55371 MB
After local copies = 22187.55664 MB
After first SDPA allocated = 22187.04395 MB
After first copy allocated = 22187.04395 MB
On chunked entry = 22187.04395 MB
On scale calculation = 22187.05176 MB
Before interleave = 22187.05176 MB
After interleave = 22187.47363 MB
After matmul = 22187.47559 MB
Before local copies matmul = 22187.47559 MB
After local copies = 22187.47852 MB
fter compute chunk allocated = 22187.04395 MB
Memory after cuda sdpa 22187.0517578125 MB
1
Memory before offload  22187.0302734375 MB
Memory after offload  22187.0302734375 MB
Memory before cuda sdpa 22187.0439453125 MB
On entering CUDA sdpa main function  allocated = 22187.04395 MB
Before first SDPA allocated = 22187.04395 MB
On chunked entry = 22187.04395 MB
On scale calculation = 22187.05176 MB
Before interleave = 22187.05176 MB
After interleave = 22187.55176 MB
After matmul = 22195.67871 MB
Before local copies matmul = 22195.67871 MB
After local copies = 22195.68164 MB
After first SDPA allocated = 22195.16895 MB
After first copy allocated = 22195.16895 MB
On chunked entry = 22195.16895 MB
On scale calculation = 22195.17676 MB
Before interleave = 22195.17676 MB
After interleave = 22195.59863 MB
After matmul = 22195.60059 MB
Before local copies matmul = 22195.60059 MB
After local copies = 22195.60352 MB
fter compute chunk allocated = 22195.16895 MB
Memory after cuda sdpa 22195.1767578125 MB
1
Memory before offload  22195.1552734375 MB
Memory after offload  22195.1552734375 MB
Memory before cuda sdpa 22195.1689453125 MB
On entering CUDA sdpa main function  allocated = 22195.16895 MB
Before first SDPA allocated = 22195.16895 MB
On chunked entry = 22195.16895 MB
On scale calculation = 22195.17676 MB
Before interleave = 22195.17676 MB
After interleave = 22195.67676 MB
After matmul = 22203.80371 MB
Before local copies matmul = 22203.80371 MB
After local copies = 22203.80664 MB
After first SDPA allocated = 22203.29395 MB
After first copy allocated = 22203.29395 MB
On chunked entry = 22203.29395 MB
On scale calculation = 22203.30176 MB
Before interleave = 22203.30176 MB
After interleave = 22203.72363 MB
After matmul = 22203.72559 MB
Before local copies matmul = 22203.72559 MB
After local copies = 22203.72852 MB
fter compute chunk allocated = 22203.29395 MB
Memory after cuda sdpa 22203.3017578125 MB
1
Memory before offload  22203.2802734375 MB
Memory after offload  22203.2802734375 MB
Memory before cuda sdpa 22203.2939453125 MB
On entering CUDA sdpa main function  allocated = 22203.29395 MB
Before first SDPA allocated = 22203.29395 MB
On chunked entry = 22203.29395 MB
On scale calculation = 22203.30176 MB
Before interleave = 22203.30176 MB
After interleave = 22203.80176 MB
After matmul = 22211.92871 MB
Before local copies matmul = 22211.92871 MB
After local copies = 22211.93164 MB
After first SDPA allocated = 22211.41895 MB
After first copy allocated = 22211.41895 MB
On chunked entry = 22211.41895 MB
On scale calculation = 22211.42676 MB
Before interleave = 22211.42676 MB
After interleave = 22211.84863 MB
After matmul = 22211.85059 MB
Before local copies matmul = 22211.85059 MB
After local copies = 22211.85352 MB
fter compute chunk allocated = 22211.41895 MB
Memory after cuda sdpa 22211.4267578125 MB
1
Memory before offload  22211.4052734375 MB
Memory after offload  22211.4052734375 MB
Memory before cuda sdpa 22211.4189453125 MB
On entering CUDA sdpa main function  allocated = 22211.41895 MB
Before first SDPA allocated = 22211.41895 MB
On chunked entry = 22211.41895 MB
On scale calculation = 22211.42676 MB
Before interleave = 22211.42676 MB
After interleave = 22211.92676 MB
After matmul = 22220.05371 MB
Before local copies matmul = 22220.05371 MB
After local copies = 22220.05664 MB
After first SDPA allocated = 22219.54395 MB
After first copy allocated = 22219.54395 MB
On chunked entry = 22219.54395 MB
On scale calculation = 22219.55176 MB
Before interleave = 22219.55176 MB
After interleave = 22219.97363 MB
After matmul = 22219.97559 MB
Before local copies matmul = 22219.97559 MB
After local copies = 22219.97852 MB
fter compute chunk allocated = 22219.54395 MB
Memory after cuda sdpa 22219.5517578125 MB
1
Memory before offload  22219.5302734375 MB
Memory after offload  22219.5302734375 MB
Memory before cuda sdpa 22219.5439453125 MB
On entering CUDA sdpa main function  allocated = 22219.54395 MB
Before first SDPA allocated = 22219.54395 MB
On chunked entry = 22219.54395 MB
On scale calculation = 22219.55176 MB
Before interleave = 22219.55176 MB
After interleave = 22220.05176 MB
After matmul = 22228.17871 MB
Before local copies matmul = 22228.17871 MB
After local copies = 22228.18164 MB
After first SDPA allocated = 22227.66895 MB
After first copy allocated = 22227.66895 MB
On chunked entry = 22227.66895 MB
On scale calculation = 22227.67676 MB
Before interleave = 22227.67676 MB
After interleave = 22228.09863 MB
After matmul = 22228.10059 MB
Before local copies matmul = 22228.10059 MB
After local copies = 22228.10352 MB
fter compute chunk allocated = 22227.66895 MB
Memory after cuda sdpa 22227.6767578125 MB
1
Memory before offload  22227.6552734375 MB
Memory after offload  22227.6552734375 MB
Memory before cuda sdpa 22227.6689453125 MB
On entering CUDA sdpa main function  allocated = 22227.66895 MB
Before first SDPA allocated = 22227.66895 MB
On chunked entry = 22227.66895 MB
On scale calculation = 22227.67676 MB
Before interleave = 22227.67676 MB
After interleave = 22228.17676 MB
After matmul = 22236.30371 MB
Before local copies matmul = 22236.30371 MB
After local copies = 22236.30664 MB
After first SDPA allocated = 22235.79395 MB
After first copy allocated = 22235.79395 MB
On chunked entry = 22235.79395 MB
On scale calculation = 22235.80176 MB
Before interleave = 22235.80176 MB
After interleave = 22236.22363 MB
After matmul = 22236.22559 MB
Before local copies matmul = 22236.22559 MB
After local copies = 22236.22852 MB
fter compute chunk allocated = 22235.79395 MB
Memory after cuda sdpa 22235.8017578125 MB
1
Memory before offload  22235.7802734375 MB
Memory after offload  22235.7802734375 MB
Memory before cuda sdpa 22235.7939453125 MB
On entering CUDA sdpa main function  allocated = 22235.79395 MB
Before first SDPA allocated = 22235.79395 MB
On chunked entry = 22235.79395 MB
On scale calculation = 22235.80176 MB
Before interleave = 22235.80176 MB
After interleave = 22236.30176 MB
After matmul = 22244.42871 MB
Before local copies matmul = 22244.42871 MB
After local copies = 22244.43164 MB
After first SDPA allocated = 22243.91895 MB
After first copy allocated = 22243.91895 MB
On chunked entry = 22243.91895 MB
On scale calculation = 22243.92676 MB
Before interleave = 22243.92676 MB
After interleave = 22244.34863 MB
After matmul = 22244.35059 MB
Before local copies matmul = 22244.35059 MB
After local copies = 22244.35352 MB
fter compute chunk allocated = 22243.91895 MB
Memory after cuda sdpa 22243.9267578125 MB
1
Memory before offload  22243.9052734375 MB
Memory after offload  22243.9052734375 MB
Memory before cuda sdpa 22243.9189453125 MB
On entering CUDA sdpa main function  allocated = 22243.91895 MB
Before first SDPA allocated = 22243.91895 MB
On chunked entry = 22243.91895 MB
On scale calculation = 22243.92676 MB
Before interleave = 22243.92676 MB
After interleave = 22244.42676 MB
After matmul = 22252.55371 MB
Before local copies matmul = 22252.55371 MB
After local copies = 22252.55664 MB
After first SDPA allocated = 22252.04395 MB
After first copy allocated = 22252.04395 MB
On chunked entry = 22252.04395 MB
On scale calculation = 22252.05176 MB
Before interleave = 22252.05176 MB
After interleave = 22252.47363 MB
After matmul = 22252.47559 MB
Before local copies matmul = 22252.47559 MB
After local copies = 22252.47852 MB
fter compute chunk allocated = 22252.04395 MB
Memory after cuda sdpa 22252.0517578125 MB
1
Memory before offload  22252.0302734375 MB
Memory after offload  22252.0302734375 MB
Memory before cuda sdpa 22252.0439453125 MB
On entering CUDA sdpa main function  allocated = 22252.04395 MB
Before first SDPA allocated = 22252.04395 MB
On chunked entry = 22252.04395 MB
On scale calculation = 22252.05176 MB
Before interleave = 22252.05176 MB
After interleave = 22252.55176 MB
After matmul = 22260.67871 MB
Before local copies matmul = 22260.67871 MB
After local copies = 22260.68164 MB
After first SDPA allocated = 22260.16895 MB
After first copy allocated = 22260.16895 MB
On chunked entry = 22260.16895 MB
On scale calculation = 22260.17676 MB
Before interleave = 22260.17676 MB
After interleave = 22260.59863 MB
After matmul = 22260.60059 MB
Before local copies matmul = 22260.60059 MB
After local copies = 22260.60352 MB
fter compute chunk allocated = 22260.16895 MB
Memory after cuda sdpa 22260.1767578125 MB
1
Memory before offload  22260.1552734375 MB
Memory after offload  22260.1552734375 MB
Memory before cuda sdpa 22260.1689453125 MB
On entering CUDA sdpa main function  allocated = 22260.16895 MB
Before first SDPA allocated = 22260.16895 MB
On chunked entry = 22260.16895 MB
On scale calculation = 22260.17676 MB
Before interleave = 22260.17676 MB
After interleave = 22260.67676 MB
After matmul = 22268.80371 MB
Before local copies matmul = 22268.80371 MB
After local copies = 22268.80664 MB
After first SDPA allocated = 22268.29395 MB
After first copy allocated = 22268.29395 MB
On chunked entry = 22268.29395 MB
On scale calculation = 22268.30176 MB
Before interleave = 22268.30176 MB
After interleave = 22268.72363 MB
After matmul = 22268.72559 MB
Before local copies matmul = 22268.72559 MB
After local copies = 22268.72852 MB
fter compute chunk allocated = 22268.29395 MB
Memory after cuda sdpa 22268.3017578125 MB
1
Memory before offload  22268.2802734375 MB
Memory after offload  22268.2802734375 MB
Memory before cuda sdpa 22268.2939453125 MB
On entering CUDA sdpa main function  allocated = 22268.29395 MB
Before first SDPA allocated = 22268.29395 MB
On chunked entry = 22268.29395 MB
On scale calculation = 22268.30176 MB
Before interleave = 22268.30176 MB
After interleave = 22268.80176 MB
After matmul = 22276.92871 MB
Before local copies matmul = 22276.92871 MB
After local copies = 22276.93164 MB
After first SDPA allocated = 22276.41895 MB
After first copy allocated = 22276.41895 MB
On chunked entry = 22276.41895 MB
On scale calculation = 22276.42676 MB
Before interleave = 22276.42676 MB
After interleave = 22276.84863 MB
After matmul = 22276.85059 MB
Before local copies matmul = 22276.85059 MB
After local copies = 22276.85352 MB
fter compute chunk allocated = 22276.41895 MB
Memory after cuda sdpa 22276.4267578125 MB
1
Memory before offload  22276.4052734375 MB
Memory after offload  22276.4052734375 MB
Memory before cuda sdpa 22276.4189453125 MB
On entering CUDA sdpa main function  allocated = 22276.41895 MB
Before first SDPA allocated = 22276.41895 MB
On chunked entry = 22276.41895 MB
On scale calculation = 22276.42676 MB
Before interleave = 22276.42676 MB
After interleave = 22276.92676 MB
After matmul = 22285.05371 MB
Before local copies matmul = 22285.05371 MB
After local copies = 22285.05664 MB
After first SDPA allocated = 22284.54395 MB
After first copy allocated = 22284.54395 MB
On chunked entry = 22284.54395 MB
On scale calculation = 22284.55176 MB
Before interleave = 22284.55176 MB
After interleave = 22284.97363 MB
After matmul = 22284.97559 MB
Before local copies matmul = 22284.97559 MB
After local copies = 22284.97852 MB
fter compute chunk allocated = 22284.54395 MB
Memory after cuda sdpa 22284.5517578125 MB
1
Memory before offload  22284.5302734375 MB
Memory after offload  22284.5302734375 MB
Memory before cuda sdpa 22284.5439453125 MB
On entering CUDA sdpa main function  allocated = 22284.54395 MB
Before first SDPA allocated = 22284.54395 MB
On chunked entry = 22284.54395 MB
On scale calculation = 22284.55176 MB
Before interleave = 22284.55176 MB
After interleave = 22285.05176 MB
After matmul = 22293.17871 MB
Before local copies matmul = 22293.17871 MB
After local copies = 22293.18164 MB
After first SDPA allocated = 22292.66895 MB
After first copy allocated = 22292.66895 MB
On chunked entry = 22292.66895 MB
On scale calculation = 22292.67676 MB
Before interleave = 22292.67676 MB
After interleave = 22293.09863 MB
After matmul = 22293.10059 MB
Before local copies matmul = 22293.10059 MB
After local copies = 22293.10352 MB
fter compute chunk allocated = 22292.66895 MB
Memory after cuda sdpa 22292.6767578125 MB
1
Memory before offload  22292.6552734375 MB
Memory after offload  22292.6552734375 MB
Memory before cuda sdpa 22292.6689453125 MB
On entering CUDA sdpa main function  allocated = 22292.66895 MB
Before first SDPA allocated = 22292.66895 MB
On chunked entry = 22292.66895 MB
On scale calculation = 22292.67676 MB
Before interleave = 22292.67676 MB
After interleave = 22293.17676 MB
After matmul = 22301.30371 MB
Before local copies matmul = 22301.30371 MB
After local copies = 22301.30664 MB
After first SDPA allocated = 22300.79395 MB
After first copy allocated = 22300.79395 MB
On chunked entry = 22300.79395 MB
On scale calculation = 22300.80176 MB
Before interleave = 22300.80176 MB
After interleave = 22301.22363 MB
After matmul = 22301.22559 MB
Before local copies matmul = 22301.22559 MB
After local copies = 22301.22852 MB
fter compute chunk allocated = 22300.79395 MB
Memory after cuda sdpa 22300.8017578125 MB
1
Memory before offload  22300.7802734375 MB
Memory after offload  22300.7802734375 MB
Memory before cuda sdpa 22300.7939453125 MB
On entering CUDA sdpa main function  allocated = 22300.79395 MB
Before first SDPA allocated = 22300.79395 MB
On chunked entry = 22300.79395 MB
On scale calculation = 22300.80176 MB
Before interleave = 22300.80176 MB
After interleave = 22301.30176 MB
After matmul = 22309.42871 MB
Before local copies matmul = 22309.42871 MB
After local copies = 22309.43164 MB
After first SDPA allocated = 22308.91895 MB
After first copy allocated = 22308.91895 MB
On chunked entry = 22308.91895 MB
On scale calculation = 22308.92676 MB
Before interleave = 22308.92676 MB
After interleave = 22309.34863 MB
After matmul = 22309.35059 MB
Before local copies matmul = 22309.35059 MB
After local copies = 22309.35352 MB
fter compute chunk allocated = 22308.91895 MB
Memory after cuda sdpa 22308.9267578125 MB
1
Memory before offload  22308.9052734375 MB
Memory after offload  22308.9052734375 MB
Memory before cuda sdpa 22308.9189453125 MB
On entering CUDA sdpa main function  allocated = 22308.91895 MB
Before first SDPA allocated = 22308.91895 MB
On chunked entry = 22308.91895 MB
On scale calculation = 22308.92676 MB
Before interleave = 22308.92676 MB
After interleave = 22309.42676 MB
After matmul = 22317.55371 MB
Before local copies matmul = 22317.55371 MB
After local copies = 22317.55664 MB
After first SDPA allocated = 22317.04395 MB
After first copy allocated = 22317.04395 MB
On chunked entry = 22317.04395 MB
On scale calculation = 22317.05176 MB
Before interleave = 22317.05176 MB
After interleave = 22317.47363 MB
After matmul = 22317.47559 MB
Before local copies matmul = 22317.47559 MB
After local copies = 22317.47852 MB
fter compute chunk allocated = 22317.04395 MB
Memory after cuda sdpa 22317.0517578125 MB
1
Memory before offload  22317.0302734375 MB
Memory after offload  22317.0302734375 MB
Memory before cuda sdpa 22317.0439453125 MB
On entering CUDA sdpa main function  allocated = 22317.04395 MB
Before first SDPA allocated = 22317.04395 MB
On chunked entry = 22317.04395 MB
On scale calculation = 22317.05176 MB
Before interleave = 22317.05176 MB
After interleave = 22317.55176 MB
After matmul = 22325.67871 MB
Before local copies matmul = 22325.67871 MB
After local copies = 22325.68164 MB
After first SDPA allocated = 22325.16895 MB
After first copy allocated = 22325.16895 MB
On chunked entry = 22325.16895 MB
On scale calculation = 22325.17676 MB
Before interleave = 22325.17676 MB
After interleave = 22325.59863 MB
After matmul = 22325.60059 MB
Before local copies matmul = 22325.60059 MB
After local copies = 22325.60352 MB
fter compute chunk allocated = 22325.16895 MB
Memory after cuda sdpa 22325.1767578125 MB
1
Memory before offload  22325.1552734375 MB
Memory after offload  22325.1552734375 MB
Memory before cuda sdpa 22325.1689453125 MB
On entering CUDA sdpa main function  allocated = 22325.16895 MB
Before first SDPA allocated = 22325.16895 MB
On chunked entry = 22325.16895 MB
On scale calculation = 22325.17676 MB
Before interleave = 22325.17676 MB
After interleave = 22325.67676 MB
After matmul = 22333.80371 MB
Before local copies matmul = 22333.80371 MB
After local copies = 22333.80664 MB
After first SDPA allocated = 22333.29395 MB
After first copy allocated = 22333.29395 MB
On chunked entry = 22333.29395 MB
On scale calculation = 22333.30176 MB
Before interleave = 22333.30176 MB
After interleave = 22333.72363 MB
After matmul = 22333.72559 MB
Before local copies matmul = 22333.72559 MB
After local copies = 22333.72852 MB
fter compute chunk allocated = 22333.29395 MB
Memory after cuda sdpa 22333.3017578125 MB
1
Memory before offload  22333.2802734375 MB
Memory after offload  22333.2802734375 MB
Memory before cuda sdpa 22333.2939453125 MB
On entering CUDA sdpa main function  allocated = 22333.29395 MB
Before first SDPA allocated = 22333.29395 MB
On chunked entry = 22333.29395 MB
On scale calculation = 22333.30176 MB
Before interleave = 22333.30176 MB
After interleave = 22333.80176 MB
After matmul = 22341.92871 MB
Before local copies matmul = 22341.92871 MB
After local copies = 22341.93164 MB
After first SDPA allocated = 22341.41895 MB
After first copy allocated = 22341.41895 MB
On chunked entry = 22341.41895 MB
On scale calculation = 22341.42676 MB
Before interleave = 22341.42676 MB
After interleave = 22341.84863 MB
After matmul = 22341.85059 MB
Before local copies matmul = 22341.85059 MB
After local copies = 22341.85352 MB
fter compute chunk allocated = 22341.41895 MB
Memory after cuda sdpa 22341.4267578125 MB
1
Memory before offload  22341.4052734375 MB
Memory after offload  22341.4052734375 MB
Memory before cuda sdpa 22341.4189453125 MB
On entering CUDA sdpa main function  allocated = 22341.41895 MB
Before first SDPA allocated = 22341.41895 MB
On chunked entry = 22341.41895 MB
On scale calculation = 22341.42676 MB
Before interleave = 22341.42676 MB
After interleave = 22341.92676 MB
After matmul = 22350.05371 MB
Before local copies matmul = 22350.05371 MB
After local copies = 22350.05664 MB
After first SDPA allocated = 22349.54395 MB
After first copy allocated = 22349.54395 MB
On chunked entry = 22349.54395 MB
On scale calculation = 22349.55176 MB
Before interleave = 22349.55176 MB
After interleave = 22349.97363 MB
After matmul = 22349.97559 MB
Before local copies matmul = 22349.97559 MB
After local copies = 22349.97852 MB
fter compute chunk allocated = 22349.54395 MB
Memory after cuda sdpa 22349.5517578125 MB
1
Memory before offload  22349.5302734375 MB
Memory after offload  22349.5302734375 MB
Memory before cuda sdpa 22349.5439453125 MB
On entering CUDA sdpa main function  allocated = 22349.54395 MB
Before first SDPA allocated = 22349.54395 MB
On chunked entry = 22349.54395 MB
On scale calculation = 22349.55176 MB
Before interleave = 22349.55176 MB
After interleave = 22350.05176 MB
After matmul = 22358.17871 MB
Before local copies matmul = 22358.17871 MB
After local copies = 22358.18164 MB
After first SDPA allocated = 22357.66895 MB
After first copy allocated = 22357.66895 MB
On chunked entry = 22357.66895 MB
On scale calculation = 22357.67676 MB
Before interleave = 22357.67676 MB
After interleave = 22358.09863 MB
After matmul = 22358.10059 MB
Before local copies matmul = 22358.10059 MB
After local copies = 22358.10352 MB
fter compute chunk allocated = 22357.66895 MB
Memory after cuda sdpa 22357.6767578125 MB
1
Memory before offload  22357.6552734375 MB
Memory after offload  22357.6552734375 MB
Memory before cuda sdpa 22357.6689453125 MB
On entering CUDA sdpa main function  allocated = 22357.66895 MB
Before first SDPA allocated = 22357.66895 MB
On chunked entry = 22357.66895 MB
On scale calculation = 22357.67676 MB
Before interleave = 22357.67676 MB
After interleave = 22358.17676 MB
After matmul = 22366.30371 MB
Before local copies matmul = 22366.30371 MB
After local copies = 22366.30664 MB
After first SDPA allocated = 22365.79395 MB
After first copy allocated = 22365.79395 MB
On chunked entry = 22365.79395 MB
On scale calculation = 22365.80176 MB
Before interleave = 22365.80176 MB
After interleave = 22366.22363 MB
After matmul = 22366.22559 MB
Before local copies matmul = 22366.22559 MB
After local copies = 22366.22852 MB
fter compute chunk allocated = 22365.79395 MB
Memory after cuda sdpa 22365.8017578125 MB
Decode step 28
1
Memory before offload  22365.78076171875 MB
Memory after offload  22365.78076171875 MB
Memory before cuda sdpa 22365.79443359375 MB
On entering CUDA sdpa main function  allocated = 22365.79443 MB
Before first SDPA allocated = 22365.79443 MB
On chunked entry = 22365.79443 MB
On scale calculation = 22365.80225 MB
Before interleave = 22365.80225 MB
After interleave = 22366.30225 MB
After matmul = 22374.42920 MB
Before local copies matmul = 22374.42920 MB
After local copies = 22374.43213 MB
After first SDPA allocated = 22373.91943 MB
After first copy allocated = 22373.91943 MB
On chunked entry = 22373.91943 MB
On scale calculation = 22373.92725 MB
Before interleave = 22373.92725 MB
After interleave = 22374.36475 MB
After matmul = 22374.36670 MB
Before local copies matmul = 22374.36670 MB
After local copies = 22374.36963 MB
fter compute chunk allocated = 22373.91943 MB
Memory after cuda sdpa 22373.92724609375 MB
1
Memory before offload  22373.90576171875 MB
Memory after offload  22373.90576171875 MB
Memory before cuda sdpa 22373.91943359375 MB
On entering CUDA sdpa main function  allocated = 22373.91943 MB
Before first SDPA allocated = 22373.91943 MB
On chunked entry = 22373.91943 MB
On scale calculation = 22373.92725 MB
Before interleave = 22373.92725 MB
After interleave = 22374.42725 MB
After matmul = 22382.55420 MB
Before local copies matmul = 22382.55420 MB
After local copies = 22382.55713 MB
After first SDPA allocated = 22382.04443 MB
After first copy allocated = 22382.04443 MB
On chunked entry = 22382.04443 MB
On scale calculation = 22382.05225 MB
Before interleave = 22382.05225 MB
After interleave = 22382.48975 MB
After matmul = 22382.49170 MB
Before local copies matmul = 22382.49170 MB
After local copies = 22382.49463 MB
fter compute chunk allocated = 22382.04443 MB
Memory after cuda sdpa 22382.05224609375 MB
1
Memory before offload  22382.03076171875 MB
Memory after offload  22382.03076171875 MB
Memory before cuda sdpa 22382.04443359375 MB
On entering CUDA sdpa main function  allocated = 22382.04443 MB
Before first SDPA allocated = 22382.04443 MB
On chunked entry = 22382.04443 MB
On scale calculation = 22382.05225 MB
Before interleave = 22382.05225 MB
After interleave = 22382.55225 MB
After matmul = 22390.67920 MB
Before local copies matmul = 22390.67920 MB
After local copies = 22390.68213 MB
After first SDPA allocated = 22390.16943 MB
After first copy allocated = 22390.16943 MB
On chunked entry = 22390.16943 MB
On scale calculation = 22390.17725 MB
Before interleave = 22390.17725 MB
After interleave = 22390.61475 MB
After matmul = 22390.61670 MB
Before local copies matmul = 22390.61670 MB
After local copies = 22390.61963 MB
fter compute chunk allocated = 22390.16943 MB
Memory after cuda sdpa 22390.17724609375 MB
1
Memory before offload  22390.15576171875 MB
Memory after offload  22390.15576171875 MB
Memory before cuda sdpa 22390.16943359375 MB
On entering CUDA sdpa main function  allocated = 22390.16943 MB
Before first SDPA allocated = 22390.16943 MB
On chunked entry = 22390.16943 MB
On scale calculation = 22390.17725 MB
Before interleave = 22390.17725 MB
After interleave = 22390.67725 MB
After matmul = 22398.80420 MB
Before local copies matmul = 22398.80420 MB
After local copies = 22398.80713 MB
After first SDPA allocated = 22398.29443 MB
After first copy allocated = 22398.29443 MB
On chunked entry = 22398.29443 MB
On scale calculation = 22398.30225 MB
Before interleave = 22398.30225 MB
After interleave = 22398.73975 MB
After matmul = 22398.74170 MB
Before local copies matmul = 22398.74170 MB
After local copies = 22398.74463 MB
fter compute chunk allocated = 22398.29443 MB
Memory after cuda sdpa 22398.30224609375 MB
1
Memory before offload  22398.28076171875 MB
Memory after offload  22398.28076171875 MB
Memory before cuda sdpa 22398.29443359375 MB
On entering CUDA sdpa main function  allocated = 22398.29443 MB
Before first SDPA allocated = 22398.29443 MB
On chunked entry = 22398.29443 MB
On scale calculation = 22398.30225 MB
Before interleave = 22398.30225 MB
After interleave = 22398.80225 MB
After matmul = 22406.92920 MB
Before local copies matmul = 22406.92920 MB
After local copies = 22406.93213 MB
After first SDPA allocated = 22406.41943 MB
After first copy allocated = 22406.41943 MB
On chunked entry = 22406.41943 MB
On scale calculation = 22406.42725 MB
Before interleave = 22406.42725 MB
After interleave = 22406.86475 MB
After matmul = 22406.86670 MB
Before local copies matmul = 22406.86670 MB
After local copies = 22406.86963 MB
fter compute chunk allocated = 22406.41943 MB
Memory after cuda sdpa 22406.42724609375 MB
1
Memory before offload  22406.40576171875 MB
Memory after offload  22406.40576171875 MB
Memory before cuda sdpa 22406.41943359375 MB
On entering CUDA sdpa main function  allocated = 22406.41943 MB
Before first SDPA allocated = 22406.41943 MB
On chunked entry = 22406.41943 MB
On scale calculation = 22406.42725 MB
Before interleave = 22406.42725 MB
After interleave = 22406.92725 MB
After matmul = 22415.05420 MB
Before local copies matmul = 22415.05420 MB
After local copies = 22415.05713 MB
After first SDPA allocated = 22414.54443 MB
After first copy allocated = 22414.54443 MB
On chunked entry = 22414.54443 MB
On scale calculation = 22414.55225 MB
Before interleave = 22414.55225 MB
After interleave = 22414.98975 MB
After matmul = 22414.99170 MB
Before local copies matmul = 22414.99170 MB
After local copies = 22414.99463 MB
fter compute chunk allocated = 22414.54443 MB
Memory after cuda sdpa 22414.55224609375 MB
1
Memory before offload  22414.53076171875 MB
Memory after offload  22414.53076171875 MB
Memory before cuda sdpa 22414.54443359375 MB
On entering CUDA sdpa main function  allocated = 22414.54443 MB
Before first SDPA allocated = 22414.54443 MB
On chunked entry = 22414.54443 MB
On scale calculation = 22414.55225 MB
Before interleave = 22414.55225 MB
After interleave = 22415.05225 MB
After matmul = 22423.17920 MB
Before local copies matmul = 22423.17920 MB
After local copies = 22423.18213 MB
After first SDPA allocated = 22422.66943 MB
After first copy allocated = 22422.66943 MB
On chunked entry = 22422.66943 MB
On scale calculation = 22422.67725 MB
Before interleave = 22422.67725 MB
After interleave = 22423.11475 MB
After matmul = 22423.11670 MB
Before local copies matmul = 22423.11670 MB
After local copies = 22423.11963 MB
fter compute chunk allocated = 22422.66943 MB
Memory after cuda sdpa 22422.67724609375 MB
1
Memory before offload  22422.65576171875 MB
Memory after offload  22422.65576171875 MB
Memory before cuda sdpa 22422.66943359375 MB
On entering CUDA sdpa main function  allocated = 22422.66943 MB
Before first SDPA allocated = 22422.66943 MB
On chunked entry = 22422.66943 MB
On scale calculation = 22422.67725 MB
Before interleave = 22422.67725 MB
After interleave = 22423.17725 MB
After matmul = 22431.30420 MB
Before local copies matmul = 22431.30420 MB
After local copies = 22431.30713 MB
After first SDPA allocated = 22430.79443 MB
After first copy allocated = 22430.79443 MB
On chunked entry = 22430.79443 MB
On scale calculation = 22430.80225 MB
Before interleave = 22430.80225 MB
After interleave = 22431.23975 MB
After matmul = 22431.24170 MB
Before local copies matmul = 22431.24170 MB
After local copies = 22431.24463 MB
fter compute chunk allocated = 22430.79443 MB
Memory after cuda sdpa 22430.80224609375 MB
1
Memory before offload  22430.78076171875 MB
Memory after offload  22430.78076171875 MB
Memory before cuda sdpa 22430.79443359375 MB
On entering CUDA sdpa main function  allocated = 22430.79443 MB
Before first SDPA allocated = 22430.79443 MB
On chunked entry = 22430.79443 MB
On scale calculation = 22430.80225 MB
Before interleave = 22430.80225 MB
After interleave = 22431.30225 MB
After matmul = 22439.42920 MB
Before local copies matmul = 22439.42920 MB
After local copies = 22439.43213 MB
After first SDPA allocated = 22438.91943 MB
After first copy allocated = 22438.91943 MB
On chunked entry = 22438.91943 MB
On scale calculation = 22438.92725 MB
Before interleave = 22438.92725 MB
After interleave = 22439.36475 MB
After matmul = 22439.36670 MB
Before local copies matmul = 22439.36670 MB
After local copies = 22439.36963 MB
fter compute chunk allocated = 22438.91943 MB
Memory after cuda sdpa 22438.92724609375 MB
1
Memory before offload  22438.90576171875 MB
Memory after offload  22438.90576171875 MB
Memory before cuda sdpa 22438.91943359375 MB
On entering CUDA sdpa main function  allocated = 22438.91943 MB
Before first SDPA allocated = 22438.91943 MB
On chunked entry = 22438.91943 MB
On scale calculation = 22438.92725 MB
Before interleave = 22438.92725 MB
After interleave = 22439.42725 MB
After matmul = 22447.55420 MB
Before local copies matmul = 22447.55420 MB
After local copies = 22447.55713 MB
After first SDPA allocated = 22447.04443 MB
After first copy allocated = 22447.04443 MB
On chunked entry = 22447.04443 MB
On scale calculation = 22447.05225 MB
Before interleave = 22447.05225 MB
After interleave = 22447.48975 MB
After matmul = 22447.49170 MB
Before local copies matmul = 22447.49170 MB
After local copies = 22447.49463 MB
fter compute chunk allocated = 22447.04443 MB
Memory after cuda sdpa 22447.05224609375 MB
1
Memory before offload  22447.03076171875 MB
Memory after offload  22447.03076171875 MB
Memory before cuda sdpa 22447.04443359375 MB
On entering CUDA sdpa main function  allocated = 22447.04443 MB
Before first SDPA allocated = 22447.04443 MB
On chunked entry = 22447.04443 MB
On scale calculation = 22447.05225 MB
Before interleave = 22447.05225 MB
After interleave = 22447.55225 MB
After matmul = 22455.67920 MB
Before local copies matmul = 22455.67920 MB
After local copies = 22455.68213 MB
After first SDPA allocated = 22455.16943 MB
After first copy allocated = 22455.16943 MB
On chunked entry = 22455.16943 MB
On scale calculation = 22455.17725 MB
Before interleave = 22455.17725 MB
After interleave = 22455.61475 MB
After matmul = 22455.61670 MB
Before local copies matmul = 22455.61670 MB
After local copies = 22455.61963 MB
fter compute chunk allocated = 22455.16943 MB
Memory after cuda sdpa 22455.17724609375 MB
1
Memory before offload  22455.15576171875 MB
Memory after offload  22455.15576171875 MB
Memory before cuda sdpa 22455.16943359375 MB
On entering CUDA sdpa main function  allocated = 22455.16943 MB
Before first SDPA allocated = 22455.16943 MB
On chunked entry = 22455.16943 MB
On scale calculation = 22455.17725 MB
Before interleave = 22455.17725 MB
After interleave = 22455.67725 MB
After matmul = 22463.80420 MB
Before local copies matmul = 22463.80420 MB
After local copies = 22463.80713 MB
After first SDPA allocated = 22463.29443 MB
After first copy allocated = 22463.29443 MB
On chunked entry = 22463.29443 MB
On scale calculation = 22463.30225 MB
Before interleave = 22463.30225 MB
After interleave = 22463.73975 MB
After matmul = 22463.74170 MB
Before local copies matmul = 22463.74170 MB
After local copies = 22463.74463 MB
fter compute chunk allocated = 22463.29443 MB
Memory after cuda sdpa 22463.30224609375 MB
1
Memory before offload  22463.28076171875 MB
Memory after offload  22463.28076171875 MB
Memory before cuda sdpa 22463.29443359375 MB
On entering CUDA sdpa main function  allocated = 22463.29443 MB
Before first SDPA allocated = 22463.29443 MB
On chunked entry = 22463.29443 MB
On scale calculation = 22463.30225 MB
Before interleave = 22463.30225 MB
After interleave = 22463.80225 MB
After matmul = 22471.92920 MB
Before local copies matmul = 22471.92920 MB
After local copies = 22471.93213 MB
After first SDPA allocated = 22471.41943 MB
After first copy allocated = 22471.41943 MB
On chunked entry = 22471.41943 MB
On scale calculation = 22471.42725 MB
Before interleave = 22471.42725 MB
After interleave = 22471.86475 MB
After matmul = 22471.86670 MB
Before local copies matmul = 22471.86670 MB
After local copies = 22471.86963 MB
fter compute chunk allocated = 22471.41943 MB
Memory after cuda sdpa 22471.42724609375 MB
1
Memory before offload  22471.40576171875 MB
Memory after offload  22471.40576171875 MB
Memory before cuda sdpa 22471.41943359375 MB
On entering CUDA sdpa main function  allocated = 22471.41943 MB
Before first SDPA allocated = 22471.41943 MB
On chunked entry = 22471.41943 MB
On scale calculation = 22471.42725 MB
Before interleave = 22471.42725 MB
After interleave = 22471.92725 MB
After matmul = 22480.05420 MB
Before local copies matmul = 22480.05420 MB
After local copies = 22480.05713 MB
After first SDPA allocated = 22479.54443 MB
After first copy allocated = 22479.54443 MB
On chunked entry = 22479.54443 MB
On scale calculation = 22479.55225 MB
Before interleave = 22479.55225 MB
After interleave = 22479.98975 MB
After matmul = 22479.99170 MB
Before local copies matmul = 22479.99170 MB
After local copies = 22479.99463 MB
fter compute chunk allocated = 22479.54443 MB
Memory after cuda sdpa 22479.55224609375 MB
1
Memory before offload  22479.53076171875 MB
Memory after offload  22479.53076171875 MB
Memory before cuda sdpa 22479.54443359375 MB
On entering CUDA sdpa main function  allocated = 22479.54443 MB
Before first SDPA allocated = 22479.54443 MB
On chunked entry = 22479.54443 MB
On scale calculation = 22479.55225 MB
Before interleave = 22479.55225 MB
After interleave = 22480.05225 MB
After matmul = 22488.17920 MB
Before local copies matmul = 22488.17920 MB
After local copies = 22488.18213 MB
After first SDPA allocated = 22487.66943 MB
After first copy allocated = 22487.66943 MB
On chunked entry = 22487.66943 MB
On scale calculation = 22487.67725 MB
Before interleave = 22487.67725 MB
After interleave = 22488.11475 MB
After matmul = 22488.11670 MB
Before local copies matmul = 22488.11670 MB
After local copies = 22488.11963 MB
fter compute chunk allocated = 22487.66943 MB
Memory after cuda sdpa 22487.67724609375 MB
1
Memory before offload  22487.65576171875 MB
Memory after offload  22487.65576171875 MB
Memory before cuda sdpa 22487.66943359375 MB
On entering CUDA sdpa main function  allocated = 22487.66943 MB
Before first SDPA allocated = 22487.66943 MB
On chunked entry = 22487.66943 MB
On scale calculation = 22487.67725 MB
Before interleave = 22487.67725 MB
After interleave = 22488.17725 MB
After matmul = 22496.30420 MB
Before local copies matmul = 22496.30420 MB
After local copies = 22496.30713 MB
After first SDPA allocated = 22495.79443 MB
After first copy allocated = 22495.79443 MB
On chunked entry = 22495.79443 MB
On scale calculation = 22495.80225 MB
Before interleave = 22495.80225 MB
After interleave = 22496.23975 MB
After matmul = 22496.24170 MB
Before local copies matmul = 22496.24170 MB
After local copies = 22496.24463 MB
fter compute chunk allocated = 22495.79443 MB
Memory after cuda sdpa 22495.80224609375 MB
1
Memory before offload  22495.78076171875 MB
Memory after offload  22495.78076171875 MB
Memory before cuda sdpa 22495.79443359375 MB
On entering CUDA sdpa main function  allocated = 22495.79443 MB
Before first SDPA allocated = 22495.79443 MB
On chunked entry = 22495.79443 MB
On scale calculation = 22495.80225 MB
Before interleave = 22495.80225 MB
After interleave = 22496.30225 MB
After matmul = 22504.42920 MB
Before local copies matmul = 22504.42920 MB
After local copies = 22504.43213 MB
After first SDPA allocated = 22503.91943 MB
After first copy allocated = 22503.91943 MB
On chunked entry = 22503.91943 MB
On scale calculation = 22503.92725 MB
Before interleave = 22503.92725 MB
After interleave = 22504.36475 MB
After matmul = 22504.36670 MB
Before local copies matmul = 22504.36670 MB
After local copies = 22504.36963 MB
fter compute chunk allocated = 22503.91943 MB
Memory after cuda sdpa 22503.92724609375 MB
1
Memory before offload  22503.90576171875 MB
Memory after offload  22503.90576171875 MB
Memory before cuda sdpa 22503.91943359375 MB
On entering CUDA sdpa main function  allocated = 22503.91943 MB
Before first SDPA allocated = 22503.91943 MB
On chunked entry = 22503.91943 MB
On scale calculation = 22503.92725 MB
Before interleave = 22503.92725 MB
After interleave = 22504.42725 MB
After matmul = 22512.55420 MB
Before local copies matmul = 22512.55420 MB
After local copies = 22512.55713 MB
After first SDPA allocated = 22512.04443 MB
After first copy allocated = 22512.04443 MB
On chunked entry = 22512.04443 MB
On scale calculation = 22512.05225 MB
Before interleave = 22512.05225 MB
After interleave = 22512.48975 MB
After matmul = 22512.49170 MB
Before local copies matmul = 22512.49170 MB
After local copies = 22512.49463 MB
fter compute chunk allocated = 22512.04443 MB
Memory after cuda sdpa 22512.05224609375 MB
1
Memory before offload  22512.03076171875 MB
Memory after offload  22512.03076171875 MB
Memory before cuda sdpa 22512.04443359375 MB
On entering CUDA sdpa main function  allocated = 22512.04443 MB
Before first SDPA allocated = 22512.04443 MB
On chunked entry = 22512.04443 MB
On scale calculation = 22512.05225 MB
Before interleave = 22512.05225 MB
After interleave = 22512.55225 MB
After matmul = 22520.67920 MB
Before local copies matmul = 22520.67920 MB
After local copies = 22520.68213 MB
After first SDPA allocated = 22520.16943 MB
After first copy allocated = 22520.16943 MB
On chunked entry = 22520.16943 MB
On scale calculation = 22520.17725 MB
Before interleave = 22520.17725 MB
After interleave = 22520.61475 MB
After matmul = 22520.61670 MB
Before local copies matmul = 22520.61670 MB
After local copies = 22520.61963 MB
fter compute chunk allocated = 22520.16943 MB
Memory after cuda sdpa 22520.17724609375 MB
1
Memory before offload  22520.15576171875 MB
Memory after offload  22520.15576171875 MB
Memory before cuda sdpa 22520.16943359375 MB
On entering CUDA sdpa main function  allocated = 22520.16943 MB
Before first SDPA allocated = 22520.16943 MB
On chunked entry = 22520.16943 MB
On scale calculation = 22520.17725 MB
Before interleave = 22520.17725 MB
After interleave = 22520.67725 MB
After matmul = 22528.80420 MB
Before local copies matmul = 22528.80420 MB
After local copies = 22528.80713 MB
After first SDPA allocated = 22528.29443 MB
After first copy allocated = 22528.29443 MB
On chunked entry = 22528.29443 MB
On scale calculation = 22528.30225 MB
Before interleave = 22528.30225 MB
After interleave = 22528.73975 MB
After matmul = 22528.74170 MB
Before local copies matmul = 22528.74170 MB
After local copies = 22528.74463 MB
fter compute chunk allocated = 22528.29443 MB
Memory after cuda sdpa 22528.30224609375 MB
1
Memory before offload  22528.28076171875 MB
Memory after offload  22528.28076171875 MB
Memory before cuda sdpa 22528.29443359375 MB
On entering CUDA sdpa main function  allocated = 22528.29443 MB
Before first SDPA allocated = 22528.29443 MB
On chunked entry = 22528.29443 MB
On scale calculation = 22528.30225 MB
Before interleave = 22528.30225 MB
After interleave = 22528.80225 MB
After matmul = 22536.92920 MB
Before local copies matmul = 22536.92920 MB
After local copies = 22536.93213 MB
After first SDPA allocated = 22536.41943 MB
After first copy allocated = 22536.41943 MB
On chunked entry = 22536.41943 MB
On scale calculation = 22536.42725 MB
Before interleave = 22536.42725 MB
After interleave = 22536.86475 MB
After matmul = 22536.86670 MB
Before local copies matmul = 22536.86670 MB
After local copies = 22536.86963 MB
fter compute chunk allocated = 22536.41943 MB
Memory after cuda sdpa 22536.42724609375 MB
1
Memory before offload  22536.40576171875 MB
Memory after offload  22536.40576171875 MB
Memory before cuda sdpa 22536.41943359375 MB
On entering CUDA sdpa main function  allocated = 22536.41943 MB
Before first SDPA allocated = 22536.41943 MB
On chunked entry = 22536.41943 MB
On scale calculation = 22536.42725 MB
Before interleave = 22536.42725 MB
After interleave = 22536.92725 MB
After matmul = 22545.05420 MB
Before local copies matmul = 22545.05420 MB
After local copies = 22545.05713 MB
After first SDPA allocated = 22544.54443 MB
After first copy allocated = 22544.54443 MB
On chunked entry = 22544.54443 MB
On scale calculation = 22544.55225 MB
Before interleave = 22544.55225 MB
After interleave = 22544.98975 MB
After matmul = 22544.99170 MB
Before local copies matmul = 22544.99170 MB
After local copies = 22544.99463 MB
fter compute chunk allocated = 22544.54443 MB
Memory after cuda sdpa 22544.55224609375 MB
1
Memory before offload  22544.53076171875 MB
Memory after offload  22544.53076171875 MB
Memory before cuda sdpa 22544.54443359375 MB
On entering CUDA sdpa main function  allocated = 22544.54443 MB
Before first SDPA allocated = 22544.54443 MB
On chunked entry = 22544.54443 MB
On scale calculation = 22544.55225 MB
Before interleave = 22544.55225 MB
After interleave = 22545.05225 MB
After matmul = 22553.17920 MB
Before local copies matmul = 22553.17920 MB
After local copies = 22553.18213 MB
After first SDPA allocated = 22552.66943 MB
After first copy allocated = 22552.66943 MB
On chunked entry = 22552.66943 MB
On scale calculation = 22552.67725 MB
Before interleave = 22552.67725 MB
After interleave = 22553.11475 MB
After matmul = 22553.11670 MB
Before local copies matmul = 22553.11670 MB
After local copies = 22553.11963 MB
fter compute chunk allocated = 22552.66943 MB
Memory after cuda sdpa 22552.67724609375 MB
1
Memory before offload  22552.65576171875 MB
Memory after offload  22552.65576171875 MB
Memory before cuda sdpa 22552.66943359375 MB
On entering CUDA sdpa main function  allocated = 22552.66943 MB
Before first SDPA allocated = 22552.66943 MB
On chunked entry = 22552.66943 MB
On scale calculation = 22552.67725 MB
Before interleave = 22552.67725 MB
After interleave = 22553.17725 MB
After matmul = 22561.30420 MB
Before local copies matmul = 22561.30420 MB
After local copies = 22561.30713 MB
After first SDPA allocated = 22560.79443 MB
After first copy allocated = 22560.79443 MB
On chunked entry = 22560.79443 MB
On scale calculation = 22560.80225 MB
Before interleave = 22560.80225 MB
After interleave = 22561.23975 MB
After matmul = 22561.24170 MB
Before local copies matmul = 22561.24170 MB
After local copies = 22561.24463 MB
fter compute chunk allocated = 22560.79443 MB
Memory after cuda sdpa 22560.80224609375 MB
1
Memory before offload  22560.78076171875 MB
Memory after offload  22560.78076171875 MB
Memory before cuda sdpa 22560.79443359375 MB
On entering CUDA sdpa main function  allocated = 22560.79443 MB
Before first SDPA allocated = 22560.79443 MB
On chunked entry = 22560.79443 MB
On scale calculation = 22560.80225 MB
Before interleave = 22560.80225 MB
After interleave = 22561.30225 MB
After matmul = 22569.42920 MB
Before local copies matmul = 22569.42920 MB
After local copies = 22569.43213 MB
After first SDPA allocated = 22568.91943 MB
After first copy allocated = 22568.91943 MB
On chunked entry = 22568.91943 MB
On scale calculation = 22568.92725 MB
Before interleave = 22568.92725 MB
After interleave = 22569.36475 MB
After matmul = 22569.36670 MB
Before local copies matmul = 22569.36670 MB
After local copies = 22569.36963 MB
fter compute chunk allocated = 22568.91943 MB
Memory after cuda sdpa 22568.92724609375 MB
1
Memory before offload  22568.90576171875 MB
Memory after offload  22568.90576171875 MB
Memory before cuda sdpa 22568.91943359375 MB
On entering CUDA sdpa main function  allocated = 22568.91943 MB
Before first SDPA allocated = 22568.91943 MB
On chunked entry = 22568.91943 MB
On scale calculation = 22568.92725 MB
Before interleave = 22568.92725 MB
After interleave = 22569.42725 MB
After matmul = 22577.55420 MB
Before local copies matmul = 22577.55420 MB
After local copies = 22577.55713 MB
After first SDPA allocated = 22577.04443 MB
After first copy allocated = 22577.04443 MB
On chunked entry = 22577.04443 MB
On scale calculation = 22577.05225 MB
Before interleave = 22577.05225 MB
After interleave = 22577.48975 MB
After matmul = 22577.49170 MB
Before local copies matmul = 22577.49170 MB
After local copies = 22577.49463 MB
fter compute chunk allocated = 22577.04443 MB
Memory after cuda sdpa 22577.05224609375 MB
1
Memory before offload  22577.03076171875 MB
Memory after offload  22577.03076171875 MB
Memory before cuda sdpa 22577.04443359375 MB
On entering CUDA sdpa main function  allocated = 22577.04443 MB
Before first SDPA allocated = 22577.04443 MB
On chunked entry = 22577.04443 MB
On scale calculation = 22577.05225 MB
Before interleave = 22577.05225 MB
After interleave = 22577.55225 MB
After matmul = 22585.67920 MB
Before local copies matmul = 22585.67920 MB
After local copies = 22585.68213 MB
After first SDPA allocated = 22585.16943 MB
After first copy allocated = 22585.16943 MB
On chunked entry = 22585.16943 MB
On scale calculation = 22585.17725 MB
Before interleave = 22585.17725 MB
After interleave = 22585.61475 MB
After matmul = 22585.61670 MB
Before local copies matmul = 22585.61670 MB
After local copies = 22585.61963 MB
fter compute chunk allocated = 22585.16943 MB
Memory after cuda sdpa 22585.17724609375 MB
1
Memory before offload  22585.15576171875 MB
Memory after offload  22585.15576171875 MB
Memory before cuda sdpa 22585.16943359375 MB
On entering CUDA sdpa main function  allocated = 22585.16943 MB
Before first SDPA allocated = 22585.16943 MB
On chunked entry = 22585.16943 MB
On scale calculation = 22585.17725 MB
Before interleave = 22585.17725 MB
After interleave = 22585.67725 MB
After matmul = 22593.80420 MB
Before local copies matmul = 22593.80420 MB
After local copies = 22593.80713 MB
After first SDPA allocated = 22593.29443 MB
After first copy allocated = 22593.29443 MB
On chunked entry = 22593.29443 MB
On scale calculation = 22593.30225 MB
Before interleave = 22593.30225 MB
After interleave = 22593.73975 MB
After matmul = 22593.74170 MB
Before local copies matmul = 22593.74170 MB
After local copies = 22593.74463 MB
fter compute chunk allocated = 22593.29443 MB
Memory after cuda sdpa 22593.30224609375 MB
1
Memory before offload  22593.28076171875 MB
Memory after offload  22593.28076171875 MB
Memory before cuda sdpa 22593.29443359375 MB
On entering CUDA sdpa main function  allocated = 22593.29443 MB
Before first SDPA allocated = 22593.29443 MB
On chunked entry = 22593.29443 MB
On scale calculation = 22593.30225 MB
Before interleave = 22593.30225 MB
After interleave = 22593.80225 MB
After matmul = 22601.92920 MB
Before local copies matmul = 22601.92920 MB
After local copies = 22601.93213 MB
After first SDPA allocated = 22601.41943 MB
After first copy allocated = 22601.41943 MB
On chunked entry = 22601.41943 MB
On scale calculation = 22601.42725 MB
Before interleave = 22601.42725 MB
After interleave = 22601.86475 MB
After matmul = 22601.86670 MB
Before local copies matmul = 22601.86670 MB
After local copies = 22601.86963 MB
fter compute chunk allocated = 22601.41943 MB
Memory after cuda sdpa 22601.42724609375 MB
1
Memory before offload  22601.40576171875 MB
Memory after offload  22601.40576171875 MB
Memory before cuda sdpa 22601.41943359375 MB
On entering CUDA sdpa main function  allocated = 22601.41943 MB
Before first SDPA allocated = 22601.41943 MB
On chunked entry = 22601.41943 MB
On scale calculation = 22601.42725 MB
Before interleave = 22601.42725 MB
After interleave = 22601.92725 MB
After matmul = 22610.05420 MB
Before local copies matmul = 22610.05420 MB
After local copies = 22610.05713 MB
After first SDPA allocated = 22609.54443 MB
After first copy allocated = 22609.54443 MB
On chunked entry = 22609.54443 MB
On scale calculation = 22609.55225 MB
Before interleave = 22609.55225 MB
After interleave = 22609.98975 MB
After matmul = 22609.99170 MB
Before local copies matmul = 22609.99170 MB
After local copies = 22609.99463 MB
fter compute chunk allocated = 22609.54443 MB
Memory after cuda sdpa 22609.55224609375 MB
1
Memory before offload  22609.53076171875 MB
Memory after offload  22609.53076171875 MB
Memory before cuda sdpa 22609.54443359375 MB
On entering CUDA sdpa main function  allocated = 22609.54443 MB
Before first SDPA allocated = 22609.54443 MB
On chunked entry = 22609.54443 MB
On scale calculation = 22609.55225 MB
Before interleave = 22609.55225 MB
After interleave = 22610.05225 MB
After matmul = 22618.17920 MB
Before local copies matmul = 22618.17920 MB
After local copies = 22618.18213 MB
After first SDPA allocated = 22617.66943 MB
After first copy allocated = 22617.66943 MB
On chunked entry = 22617.66943 MB
On scale calculation = 22617.67725 MB
Before interleave = 22617.67725 MB
After interleave = 22618.11475 MB
After matmul = 22618.11670 MB
Before local copies matmul = 22618.11670 MB
After local copies = 22618.11963 MB
fter compute chunk allocated = 22617.66943 MB
Memory after cuda sdpa 22617.67724609375 MB
1
Memory before offload  22617.65576171875 MB
Memory after offload  22617.65576171875 MB
Memory before cuda sdpa 22617.66943359375 MB
On entering CUDA sdpa main function  allocated = 22617.66943 MB
Before first SDPA allocated = 22617.66943 MB
On chunked entry = 22617.66943 MB
On scale calculation = 22617.67725 MB
Before interleave = 22617.67725 MB
After interleave = 22618.17725 MB
After matmul = 22626.30420 MB
Before local copies matmul = 22626.30420 MB
After local copies = 22626.30713 MB
After first SDPA allocated = 22625.79443 MB
After first copy allocated = 22625.79443 MB
On chunked entry = 22625.79443 MB
On scale calculation = 22625.80225 MB
Before interleave = 22625.80225 MB
After interleave = 22626.23975 MB
After matmul = 22626.24170 MB
Before local copies matmul = 22626.24170 MB
After local copies = 22626.24463 MB
fter compute chunk allocated = 22625.79443 MB
Memory after cuda sdpa 22625.80224609375 MB
Decode step 29
1
Memory before offload  22625.78125 MB
Memory after offload  22625.78125 MB
Memory before cuda sdpa 22625.794921875 MB
On entering CUDA sdpa main function  allocated = 22625.79492 MB
Before first SDPA allocated = 22625.79492 MB
On chunked entry = 22625.79492 MB
On scale calculation = 22625.80273 MB
Before interleave = 22625.80273 MB
After interleave = 22626.30273 MB
After matmul = 22634.42969 MB
Before local copies matmul = 22634.42969 MB
After local copies = 22634.43262 MB
After first SDPA allocated = 22633.91992 MB
After first copy allocated = 22633.91992 MB
On chunked entry = 22633.91992 MB
On scale calculation = 22633.92773 MB
Before interleave = 22633.92773 MB
After interleave = 22634.38086 MB
After matmul = 22634.38281 MB
Before local copies matmul = 22634.38281 MB
After local copies = 22634.38574 MB
fter compute chunk allocated = 22633.91992 MB
Memory after cuda sdpa 22633.927734375 MB
1
Memory before offload  22633.90625 MB
Memory after offload  22633.90625 MB
Memory before cuda sdpa 22633.919921875 MB
On entering CUDA sdpa main function  allocated = 22633.91992 MB
Before first SDPA allocated = 22633.91992 MB
On chunked entry = 22633.91992 MB
On scale calculation = 22633.92773 MB
Before interleave = 22633.92773 MB
After interleave = 22634.42773 MB
After matmul = 22642.55469 MB
Before local copies matmul = 22642.55469 MB
After local copies = 22642.55762 MB
After first SDPA allocated = 22642.04492 MB
After first copy allocated = 22642.04492 MB
On chunked entry = 22642.04492 MB
On scale calculation = 22642.05273 MB
Before interleave = 22642.05273 MB
After interleave = 22642.50586 MB
After matmul = 22642.50781 MB
Before local copies matmul = 22642.50781 MB
After local copies = 22642.51074 MB
fter compute chunk allocated = 22642.04492 MB
Memory after cuda sdpa 22642.052734375 MB
1
Memory before offload  22642.03125 MB
Memory after offload  22642.03125 MB
Memory before cuda sdpa 22642.044921875 MB
On entering CUDA sdpa main function  allocated = 22642.04492 MB
Before first SDPA allocated = 22642.04492 MB
On chunked entry = 22642.04492 MB
On scale calculation = 22642.05273 MB
Before interleave = 22642.05273 MB
After interleave = 22642.55273 MB
After matmul = 22650.67969 MB
Before local copies matmul = 22650.67969 MB
After local copies = 22650.68262 MB
After first SDPA allocated = 22650.16992 MB
After first copy allocated = 22650.16992 MB
On chunked entry = 22650.16992 MB
On scale calculation = 22650.17773 MB
Before interleave = 22650.17773 MB
After interleave = 22650.63086 MB
After matmul = 22650.63281 MB
Before local copies matmul = 22650.63281 MB
After local copies = 22650.63574 MB
fter compute chunk allocated = 22650.16992 MB
Memory after cuda sdpa 22650.177734375 MB
1
Memory before offload  22650.15625 MB
Memory after offload  22650.15625 MB
Memory before cuda sdpa 22650.169921875 MB
On entering CUDA sdpa main function  allocated = 22650.16992 MB
Before first SDPA allocated = 22650.16992 MB
On chunked entry = 22650.16992 MB
On scale calculation = 22650.17773 MB
Before interleave = 22650.17773 MB
After interleave = 22650.67773 MB
After matmul = 22658.80469 MB
Before local copies matmul = 22658.80469 MB
After local copies = 22658.80762 MB
After first SDPA allocated = 22658.29492 MB
After first copy allocated = 22658.29492 MB
On chunked entry = 22658.29492 MB
On scale calculation = 22658.30273 MB
Before interleave = 22658.30273 MB
After interleave = 22658.75586 MB
After matmul = 22658.75781 MB
Before local copies matmul = 22658.75781 MB
After local copies = 22658.76074 MB
fter compute chunk allocated = 22658.29492 MB
Memory after cuda sdpa 22658.302734375 MB
1
Memory before offload  22658.28125 MB
Memory after offload  22658.28125 MB
Memory before cuda sdpa 22658.294921875 MB
On entering CUDA sdpa main function  allocated = 22658.29492 MB
Before first SDPA allocated = 22658.29492 MB
On chunked entry = 22658.29492 MB
On scale calculation = 22658.30273 MB
Before interleave = 22658.30273 MB
After interleave = 22658.80273 MB
After matmul = 22666.92969 MB
Before local copies matmul = 22666.92969 MB
After local copies = 22666.93262 MB
After first SDPA allocated = 22666.41992 MB
After first copy allocated = 22666.41992 MB
On chunked entry = 22666.41992 MB
On scale calculation = 22666.42773 MB
Before interleave = 22666.42773 MB
After interleave = 22666.88086 MB
After matmul = 22666.88281 MB
Before local copies matmul = 22666.88281 MB
After local copies = 22666.88574 MB
fter compute chunk allocated = 22666.41992 MB
Memory after cuda sdpa 22666.427734375 MB
1
Memory before offload  22666.40625 MB
Memory after offload  22666.40625 MB
Memory before cuda sdpa 22666.419921875 MB
On entering CUDA sdpa main function  allocated = 22666.41992 MB
Before first SDPA allocated = 22666.41992 MB
On chunked entry = 22666.41992 MB
On scale calculation = 22666.42773 MB
Before interleave = 22666.42773 MB
After interleave = 22666.92773 MB
After matmul = 22675.05469 MB
Before local copies matmul = 22675.05469 MB
After local copies = 22675.05762 MB
After first SDPA allocated = 22674.54492 MB
After first copy allocated = 22674.54492 MB
On chunked entry = 22674.54492 MB
On scale calculation = 22674.55273 MB
Before interleave = 22674.55273 MB
After interleave = 22675.00586 MB
After matmul = 22675.00781 MB
Before local copies matmul = 22675.00781 MB
After local copies = 22675.01074 MB
fter compute chunk allocated = 22674.54492 MB
Memory after cuda sdpa 22674.552734375 MB
1
Memory before offload  22674.53125 MB
Memory after offload  22674.53125 MB
Memory before cuda sdpa 22674.544921875 MB
On entering CUDA sdpa main function  allocated = 22674.54492 MB
Before first SDPA allocated = 22674.54492 MB
On chunked entry = 22674.54492 MB
On scale calculation = 22674.55273 MB
Before interleave = 22674.55273 MB
After interleave = 22675.05273 MB
After matmul = 22683.17969 MB
Before local copies matmul = 22683.17969 MB
After local copies = 22683.18262 MB
After first SDPA allocated = 22682.66992 MB
After first copy allocated = 22682.66992 MB
On chunked entry = 22682.66992 MB
On scale calculation = 22682.67773 MB
Before interleave = 22682.67773 MB
After interleave = 22683.13086 MB
After matmul = 22683.13281 MB
Before local copies matmul = 22683.13281 MB
After local copies = 22683.13574 MB
fter compute chunk allocated = 22682.66992 MB
Memory after cuda sdpa 22682.677734375 MB
1
Memory before offload  22682.65625 MB
Memory after offload  22682.65625 MB
Memory before cuda sdpa 22682.669921875 MB
On entering CUDA sdpa main function  allocated = 22682.66992 MB
Before first SDPA allocated = 22682.66992 MB
On chunked entry = 22682.66992 MB
On scale calculation = 22682.67773 MB
Before interleave = 22682.67773 MB
After interleave = 22683.17773 MB
After matmul = 22691.30469 MB
Before local copies matmul = 22691.30469 MB
After local copies = 22691.30762 MB
After first SDPA allocated = 22690.79492 MB
After first copy allocated = 22690.79492 MB
On chunked entry = 22690.79492 MB
On scale calculation = 22690.80273 MB
Before interleave = 22690.80273 MB
After interleave = 22691.25586 MB
After matmul = 22691.25781 MB
Before local copies matmul = 22691.25781 MB
After local copies = 22691.26074 MB
fter compute chunk allocated = 22690.79492 MB
Memory after cuda sdpa 22690.802734375 MB
1
Memory before offload  22690.78125 MB
Memory after offload  22690.78125 MB
Memory before cuda sdpa 22690.794921875 MB
On entering CUDA sdpa main function  allocated = 22690.79492 MB
Before first SDPA allocated = 22690.79492 MB
On chunked entry = 22690.79492 MB
On scale calculation = 22690.80273 MB
Before interleave = 22690.80273 MB
After interleave = 22691.30273 MB
After matmul = 22699.42969 MB
Before local copies matmul = 22699.42969 MB
After local copies = 22699.43262 MB
After first SDPA allocated = 22698.91992 MB
After first copy allocated = 22698.91992 MB
On chunked entry = 22698.91992 MB
On scale calculation = 22698.92773 MB
Before interleave = 22698.92773 MB
After interleave = 22699.38086 MB
After matmul = 22699.38281 MB
Before local copies matmul = 22699.38281 MB
After local copies = 22699.38574 MB
fter compute chunk allocated = 22698.91992 MB
Memory after cuda sdpa 22698.927734375 MB
1
Memory before offload  22698.90625 MB
Memory after offload  22698.90625 MB
Memory before cuda sdpa 22698.919921875 MB
On entering CUDA sdpa main function  allocated = 22698.91992 MB
Before first SDPA allocated = 22698.91992 MB
On chunked entry = 22698.91992 MB
On scale calculation = 22698.92773 MB
Before interleave = 22698.92773 MB
After interleave = 22699.42773 MB
After matmul = 22707.55469 MB
Before local copies matmul = 22707.55469 MB
After local copies = 22707.55762 MB
After first SDPA allocated = 22707.04492 MB
After first copy allocated = 22707.04492 MB
On chunked entry = 22707.04492 MB
On scale calculation = 22707.05273 MB
Before interleave = 22707.05273 MB
After interleave = 22707.50586 MB
After matmul = 22707.50781 MB
Before local copies matmul = 22707.50781 MB
After local copies = 22707.51074 MB
fter compute chunk allocated = 22707.04492 MB
Memory after cuda sdpa 22707.052734375 MB
1
Memory before offload  22707.03125 MB
Memory after offload  22707.03125 MB
Memory before cuda sdpa 22707.044921875 MB
On entering CUDA sdpa main function  allocated = 22707.04492 MB
Before first SDPA allocated = 22707.04492 MB
On chunked entry = 22707.04492 MB
On scale calculation = 22707.05273 MB
Before interleave = 22707.05273 MB
After interleave = 22707.55273 MB
After matmul = 22715.67969 MB
Before local copies matmul = 22715.67969 MB
After local copies = 22715.68262 MB
After first SDPA allocated = 22715.16992 MB
After first copy allocated = 22715.16992 MB
On chunked entry = 22715.16992 MB
On scale calculation = 22715.17773 MB
Before interleave = 22715.17773 MB
After interleave = 22715.63086 MB
After matmul = 22715.63281 MB
Before local copies matmul = 22715.63281 MB
After local copies = 22715.63574 MB
fter compute chunk allocated = 22715.16992 MB
Memory after cuda sdpa 22715.177734375 MB
1
Memory before offload  22715.15625 MB
Memory after offload  22715.15625 MB
Memory before cuda sdpa 22715.169921875 MB
On entering CUDA sdpa main function  allocated = 22715.16992 MB
Before first SDPA allocated = 22715.16992 MB
On chunked entry = 22715.16992 MB
On scale calculation = 22715.17773 MB
Before interleave = 22715.17773 MB
After interleave = 22715.67773 MB
After matmul = 22723.80469 MB
Before local copies matmul = 22723.80469 MB
After local copies = 22723.80762 MB
After first SDPA allocated = 22723.29492 MB
After first copy allocated = 22723.29492 MB
On chunked entry = 22723.29492 MB
On scale calculation = 22723.30273 MB
Before interleave = 22723.30273 MB
After interleave = 22723.75586 MB
After matmul = 22723.75781 MB
Before local copies matmul = 22723.75781 MB
After local copies = 22723.76074 MB
fter compute chunk allocated = 22723.29492 MB
Memory after cuda sdpa 22723.302734375 MB
1
Memory before offload  22723.28125 MB
Memory after offload  22723.28125 MB
Memory before cuda sdpa 22723.294921875 MB
On entering CUDA sdpa main function  allocated = 22723.29492 MB
Before first SDPA allocated = 22723.29492 MB
On chunked entry = 22723.29492 MB
On scale calculation = 22723.30273 MB
Before interleave = 22723.30273 MB
After interleave = 22723.80273 MB
After matmul = 22731.92969 MB
Before local copies matmul = 22731.92969 MB
After local copies = 22731.93262 MB
After first SDPA allocated = 22731.41992 MB
After first copy allocated = 22731.41992 MB
On chunked entry = 22731.41992 MB
On scale calculation = 22731.42773 MB
Before interleave = 22731.42773 MB
After interleave = 22731.88086 MB
After matmul = 22731.88281 MB
Before local copies matmul = 22731.88281 MB
After local copies = 22731.88574 MB
fter compute chunk allocated = 22731.41992 MB
Memory after cuda sdpa 22731.427734375 MB
1
Memory before offload  22731.40625 MB
Memory after offload  22731.40625 MB
Memory before cuda sdpa 22731.419921875 MB
On entering CUDA sdpa main function  allocated = 22731.41992 MB
Before first SDPA allocated = 22731.41992 MB
On chunked entry = 22731.41992 MB
On scale calculation = 22731.42773 MB
Before interleave = 22731.42773 MB
After interleave = 22731.92773 MB
After matmul = 22740.05469 MB
Before local copies matmul = 22740.05469 MB
After local copies = 22740.05762 MB
After first SDPA allocated = 22739.54492 MB
After first copy allocated = 22739.54492 MB
On chunked entry = 22739.54492 MB
On scale calculation = 22739.55273 MB
Before interleave = 22739.55273 MB
After interleave = 22740.00586 MB
After matmul = 22740.00781 MB
Before local copies matmul = 22740.00781 MB
After local copies = 22740.01074 MB
fter compute chunk allocated = 22739.54492 MB
Memory after cuda sdpa 22739.552734375 MB
1
Memory before offload  22739.53125 MB
Memory after offload  22739.53125 MB
Memory before cuda sdpa 22739.544921875 MB
On entering CUDA sdpa main function  allocated = 22739.54492 MB
Before first SDPA allocated = 22739.54492 MB
On chunked entry = 22739.54492 MB
On scale calculation = 22739.55273 MB
Before interleave = 22739.55273 MB
After interleave = 22740.05273 MB
After matmul = 22748.17969 MB
Before local copies matmul = 22748.17969 MB
After local copies = 22748.18262 MB
After first SDPA allocated = 22747.66992 MB
After first copy allocated = 22747.66992 MB
On chunked entry = 22747.66992 MB
On scale calculation = 22747.67773 MB
Before interleave = 22747.67773 MB
After interleave = 22748.13086 MB
After matmul = 22748.13281 MB
Before local copies matmul = 22748.13281 MB
After local copies = 22748.13574 MB
fter compute chunk allocated = 22747.66992 MB
Memory after cuda sdpa 22747.677734375 MB
1
Memory before offload  22747.65625 MB
Memory after offload  22747.65625 MB
Memory before cuda sdpa 22747.669921875 MB
On entering CUDA sdpa main function  allocated = 22747.66992 MB
Before first SDPA allocated = 22747.66992 MB
On chunked entry = 22747.66992 MB
On scale calculation = 22747.67773 MB
Before interleave = 22747.67773 MB
After interleave = 22748.17773 MB
After matmul = 22756.30469 MB
Before local copies matmul = 22756.30469 MB
After local copies = 22756.30762 MB
After first SDPA allocated = 22755.79492 MB
After first copy allocated = 22755.79492 MB
On chunked entry = 22755.79492 MB
On scale calculation = 22755.80273 MB
Before interleave = 22755.80273 MB
After interleave = 22756.25586 MB
After matmul = 22756.25781 MB
Before local copies matmul = 22756.25781 MB
After local copies = 22756.26074 MB
fter compute chunk allocated = 22755.79492 MB
Memory after cuda sdpa 22755.802734375 MB
1
Memory before offload  22755.78125 MB
Memory after offload  22755.78125 MB
Memory before cuda sdpa 22755.794921875 MB
On entering CUDA sdpa main function  allocated = 22755.79492 MB
Before first SDPA allocated = 22755.79492 MB
On chunked entry = 22755.79492 MB
On scale calculation = 22755.80273 MB
Before interleave = 22755.80273 MB
After interleave = 22756.30273 MB
After matmul = 22764.42969 MB
Before local copies matmul = 22764.42969 MB
After local copies = 22764.43262 MB
After first SDPA allocated = 22763.91992 MB
After first copy allocated = 22763.91992 MB
On chunked entry = 22763.91992 MB
On scale calculation = 22763.92773 MB
Before interleave = 22763.92773 MB
After interleave = 22764.38086 MB
After matmul = 22764.38281 MB
Before local copies matmul = 22764.38281 MB
After local copies = 22764.38574 MB
fter compute chunk allocated = 22763.91992 MB
Memory after cuda sdpa 22763.927734375 MB
1
Memory before offload  22763.90625 MB
Memory after offload  22763.90625 MB
Memory before cuda sdpa 22763.919921875 MB
On entering CUDA sdpa main function  allocated = 22763.91992 MB
Before first SDPA allocated = 22763.91992 MB
On chunked entry = 22763.91992 MB
On scale calculation = 22763.92773 MB
Before interleave = 22763.92773 MB
After interleave = 22764.42773 MB
After matmul = 22772.55469 MB
Before local copies matmul = 22772.55469 MB
After local copies = 22772.55762 MB
After first SDPA allocated = 22772.04492 MB
After first copy allocated = 22772.04492 MB
On chunked entry = 22772.04492 MB
On scale calculation = 22772.05273 MB
Before interleave = 22772.05273 MB
After interleave = 22772.50586 MB
After matmul = 22772.50781 MB
Before local copies matmul = 22772.50781 MB
After local copies = 22772.51074 MB
fter compute chunk allocated = 22772.04492 MB
Memory after cuda sdpa 22772.052734375 MB
1
Memory before offload  22772.03125 MB
Memory after offload  22772.03125 MB
Memory before cuda sdpa 22772.044921875 MB
On entering CUDA sdpa main function  allocated = 22772.04492 MB
Before first SDPA allocated = 22772.04492 MB
On chunked entry = 22772.04492 MB
On scale calculation = 22772.05273 MB
Before interleave = 22772.05273 MB
After interleave = 22772.55273 MB
After matmul = 22780.67969 MB
Before local copies matmul = 22780.67969 MB
After local copies = 22780.68262 MB
After first SDPA allocated = 22780.16992 MB
After first copy allocated = 22780.16992 MB
On chunked entry = 22780.16992 MB
On scale calculation = 22780.17773 MB
Before interleave = 22780.17773 MB
After interleave = 22780.63086 MB
After matmul = 22780.63281 MB
Before local copies matmul = 22780.63281 MB
After local copies = 22780.63574 MB
fter compute chunk allocated = 22780.16992 MB
Memory after cuda sdpa 22780.177734375 MB
1
Memory before offload  22780.15625 MB
Memory after offload  22780.15625 MB
Memory before cuda sdpa 22780.169921875 MB
On entering CUDA sdpa main function  allocated = 22780.16992 MB
Before first SDPA allocated = 22780.16992 MB
On chunked entry = 22780.16992 MB
On scale calculation = 22780.17773 MB
Before interleave = 22780.17773 MB
After interleave = 22780.67773 MB
After matmul = 22788.80469 MB
Before local copies matmul = 22788.80469 MB
After local copies = 22788.80762 MB
After first SDPA allocated = 22788.29492 MB
After first copy allocated = 22788.29492 MB
On chunked entry = 22788.29492 MB
On scale calculation = 22788.30273 MB
Before interleave = 22788.30273 MB
After interleave = 22788.75586 MB
After matmul = 22788.75781 MB
Before local copies matmul = 22788.75781 MB
After local copies = 22788.76074 MB
fter compute chunk allocated = 22788.29492 MB
Memory after cuda sdpa 22788.302734375 MB
1
Memory before offload  22788.28125 MB
Memory after offload  22788.28125 MB
Memory before cuda sdpa 22788.294921875 MB
On entering CUDA sdpa main function  allocated = 22788.29492 MB
Before first SDPA allocated = 22788.29492 MB
On chunked entry = 22788.29492 MB
On scale calculation = 22788.30273 MB
Before interleave = 22788.30273 MB
After interleave = 22788.80273 MB
After matmul = 22796.92969 MB
Before local copies matmul = 22796.92969 MB
After local copies = 22796.93262 MB
After first SDPA allocated = 22796.41992 MB
After first copy allocated = 22796.41992 MB
On chunked entry = 22796.41992 MB
On scale calculation = 22796.42773 MB
Before interleave = 22796.42773 MB
After interleave = 22796.88086 MB
After matmul = 22796.88281 MB
Before local copies matmul = 22796.88281 MB
After local copies = 22796.88574 MB
fter compute chunk allocated = 22796.41992 MB
Memory after cuda sdpa 22796.427734375 MB
1
Memory before offload  22796.40625 MB
Memory after offload  22796.40625 MB
Memory before cuda sdpa 22796.419921875 MB
On entering CUDA sdpa main function  allocated = 22796.41992 MB
Before first SDPA allocated = 22796.41992 MB
On chunked entry = 22796.41992 MB
On scale calculation = 22796.42773 MB
Before interleave = 22796.42773 MB
After interleave = 22796.92773 MB
After matmul = 22805.05469 MB
Before local copies matmul = 22805.05469 MB
After local copies = 22805.05762 MB
After first SDPA allocated = 22804.54492 MB
After first copy allocated = 22804.54492 MB
On chunked entry = 22804.54492 MB
On scale calculation = 22804.55273 MB
Before interleave = 22804.55273 MB
After interleave = 22805.00586 MB
After matmul = 22805.00781 MB
Before local copies matmul = 22805.00781 MB
After local copies = 22805.01074 MB
fter compute chunk allocated = 22804.54492 MB
Memory after cuda sdpa 22804.552734375 MB
1
Memory before offload  22804.53125 MB
Memory after offload  22804.53125 MB
Memory before cuda sdpa 22804.544921875 MB
On entering CUDA sdpa main function  allocated = 22804.54492 MB
Before first SDPA allocated = 22804.54492 MB
On chunked entry = 22804.54492 MB
On scale calculation = 22804.55273 MB
Before interleave = 22804.55273 MB
After interleave = 22805.05273 MB
After matmul = 22813.17969 MB
Before local copies matmul = 22813.17969 MB
After local copies = 22813.18262 MB
After first SDPA allocated = 22812.66992 MB
After first copy allocated = 22812.66992 MB
On chunked entry = 22812.66992 MB
On scale calculation = 22812.67773 MB
Before interleave = 22812.67773 MB
After interleave = 22813.13086 MB
After matmul = 22813.13281 MB
Before local copies matmul = 22813.13281 MB
After local copies = 22813.13574 MB
fter compute chunk allocated = 22812.66992 MB
Memory after cuda sdpa 22812.677734375 MB
1
Memory before offload  22812.65625 MB
Memory after offload  22812.65625 MB
Memory before cuda sdpa 22812.669921875 MB
On entering CUDA sdpa main function  allocated = 22812.66992 MB
Before first SDPA allocated = 22812.66992 MB
On chunked entry = 22812.66992 MB
On scale calculation = 22812.67773 MB
Before interleave = 22812.67773 MB
After interleave = 22813.17773 MB
After matmul = 22821.30469 MB
Before local copies matmul = 22821.30469 MB
After local copies = 22821.30762 MB
After first SDPA allocated = 22820.79492 MB
After first copy allocated = 22820.79492 MB
On chunked entry = 22820.79492 MB
On scale calculation = 22820.80273 MB
Before interleave = 22820.80273 MB
After interleave = 22821.25586 MB
After matmul = 22821.25781 MB
Before local copies matmul = 22821.25781 MB
After local copies = 22821.26074 MB
fter compute chunk allocated = 22820.79492 MB
Memory after cuda sdpa 22820.802734375 MB
1
Memory before offload  22820.78125 MB
Memory after offload  22820.78125 MB
Memory before cuda sdpa 22820.794921875 MB
On entering CUDA sdpa main function  allocated = 22820.79492 MB
Before first SDPA allocated = 22820.79492 MB
On chunked entry = 22820.79492 MB
On scale calculation = 22820.80273 MB
Before interleave = 22820.80273 MB
After interleave = 22821.30273 MB
After matmul = 22829.42969 MB
Before local copies matmul = 22829.42969 MB
After local copies = 22829.43262 MB
After first SDPA allocated = 22828.91992 MB
After first copy allocated = 22828.91992 MB
On chunked entry = 22828.91992 MB
On scale calculation = 22828.92773 MB
Before interleave = 22828.92773 MB
After interleave = 22829.38086 MB
After matmul = 22829.38281 MB
Before local copies matmul = 22829.38281 MB
After local copies = 22829.38574 MB
fter compute chunk allocated = 22828.91992 MB
Memory after cuda sdpa 22828.927734375 MB
1
Memory before offload  22828.90625 MB
Memory after offload  22828.90625 MB
Memory before cuda sdpa 22828.919921875 MB
On entering CUDA sdpa main function  allocated = 22828.91992 MB
Before first SDPA allocated = 22828.91992 MB
On chunked entry = 22828.91992 MB
On scale calculation = 22828.92773 MB
Before interleave = 22828.92773 MB
After interleave = 22829.42773 MB
After matmul = 22837.55469 MB
Before local copies matmul = 22837.55469 MB
After local copies = 22837.55762 MB
After first SDPA allocated = 22837.04492 MB
After first copy allocated = 22837.04492 MB
On chunked entry = 22837.04492 MB
On scale calculation = 22837.05273 MB
Before interleave = 22837.05273 MB
After interleave = 22837.50586 MB
After matmul = 22837.50781 MB
Before local copies matmul = 22837.50781 MB
After local copies = 22837.51074 MB
fter compute chunk allocated = 22837.04492 MB
Memory after cuda sdpa 22837.052734375 MB
1
Memory before offload  22837.03125 MB
Memory after offload  22837.03125 MB
Memory before cuda sdpa 22837.044921875 MB
On entering CUDA sdpa main function  allocated = 22837.04492 MB
Before first SDPA allocated = 22837.04492 MB
On chunked entry = 22837.04492 MB
On scale calculation = 22837.05273 MB
Before interleave = 22837.05273 MB
After interleave = 22837.55273 MB
After matmul = 22845.67969 MB
Before local copies matmul = 22845.67969 MB
After local copies = 22845.68262 MB
After first SDPA allocated = 22845.16992 MB
After first copy allocated = 22845.16992 MB
On chunked entry = 22845.16992 MB
On scale calculation = 22845.17773 MB
Before interleave = 22845.17773 MB
After interleave = 22845.63086 MB
After matmul = 22845.63281 MB
Before local copies matmul = 22845.63281 MB
After local copies = 22845.63574 MB
fter compute chunk allocated = 22845.16992 MB
Memory after cuda sdpa 22845.177734375 MB
1
Memory before offload  22845.15625 MB
Memory after offload  22845.15625 MB
Memory before cuda sdpa 22845.169921875 MB
On entering CUDA sdpa main function  allocated = 22845.16992 MB
Before first SDPA allocated = 22845.16992 MB
On chunked entry = 22845.16992 MB
On scale calculation = 22845.17773 MB
Before interleave = 22845.17773 MB
After interleave = 22845.67773 MB
After matmul = 22853.80469 MB
Before local copies matmul = 22853.80469 MB
After local copies = 22853.80762 MB
After first SDPA allocated = 22853.29492 MB
After first copy allocated = 22853.29492 MB
On chunked entry = 22853.29492 MB
On scale calculation = 22853.30273 MB
Before interleave = 22853.30273 MB
After interleave = 22853.75586 MB
After matmul = 22853.75781 MB
Before local copies matmul = 22853.75781 MB
After local copies = 22853.76074 MB
fter compute chunk allocated = 22853.29492 MB
Memory after cuda sdpa 22853.302734375 MB
1
Memory before offload  22853.28125 MB
Memory after offload  22853.28125 MB
Memory before cuda sdpa 22853.294921875 MB
On entering CUDA sdpa main function  allocated = 22853.29492 MB
Before first SDPA allocated = 22853.29492 MB
On chunked entry = 22853.29492 MB
On scale calculation = 22853.30273 MB
Before interleave = 22853.30273 MB
After interleave = 22853.80273 MB
After matmul = 22861.92969 MB
Before local copies matmul = 22861.92969 MB
After local copies = 22861.93262 MB
After first SDPA allocated = 22861.41992 MB
After first copy allocated = 22861.41992 MB
On chunked entry = 22861.41992 MB
On scale calculation = 22861.42773 MB
Before interleave = 22861.42773 MB
After interleave = 22861.88086 MB
After matmul = 22861.88281 MB
Before local copies matmul = 22861.88281 MB
After local copies = 22861.88574 MB
fter compute chunk allocated = 22861.41992 MB
Memory after cuda sdpa 22861.427734375 MB
1
Memory before offload  22861.40625 MB
Memory after offload  22861.40625 MB
Memory before cuda sdpa 22861.419921875 MB
On entering CUDA sdpa main function  allocated = 22861.41992 MB
Before first SDPA allocated = 22861.41992 MB
On chunked entry = 22861.41992 MB
On scale calculation = 22861.42773 MB
Before interleave = 22861.42773 MB
After interleave = 22861.92773 MB
After matmul = 22870.05469 MB
Before local copies matmul = 22870.05469 MB
After local copies = 22870.05762 MB
After first SDPA allocated = 22869.54492 MB
After first copy allocated = 22869.54492 MB
On chunked entry = 22869.54492 MB
On scale calculation = 22869.55273 MB
Before interleave = 22869.55273 MB
After interleave = 22870.00586 MB
After matmul = 22870.00781 MB
Before local copies matmul = 22870.00781 MB
After local copies = 22870.01074 MB
fter compute chunk allocated = 22869.54492 MB
Memory after cuda sdpa 22869.552734375 MB
1
Memory before offload  22869.53125 MB
Memory after offload  22869.53125 MB
Memory before cuda sdpa 22869.544921875 MB
On entering CUDA sdpa main function  allocated = 22869.54492 MB
Before first SDPA allocated = 22869.54492 MB
On chunked entry = 22869.54492 MB
On scale calculation = 22869.55273 MB
Before interleave = 22869.55273 MB
After interleave = 22870.05273 MB
After matmul = 22878.17969 MB
Before local copies matmul = 22878.17969 MB
After local copies = 22878.18262 MB
After first SDPA allocated = 22877.66992 MB
After first copy allocated = 22877.66992 MB
On chunked entry = 22877.66992 MB
On scale calculation = 22877.67773 MB
Before interleave = 22877.67773 MB
After interleave = 22878.13086 MB
After matmul = 22878.13281 MB
Before local copies matmul = 22878.13281 MB
After local copies = 22878.13574 MB
fter compute chunk allocated = 22877.66992 MB
Memory after cuda sdpa 22877.677734375 MB
1
Memory before offload  22877.65625 MB
Memory after offload  22877.65625 MB
Memory before cuda sdpa 22877.669921875 MB
On entering CUDA sdpa main function  allocated = 22877.66992 MB
Before first SDPA allocated = 22877.66992 MB
On chunked entry = 22877.66992 MB
On scale calculation = 22877.67773 MB
Before interleave = 22877.67773 MB
After interleave = 22878.17773 MB
After matmul = 22886.30469 MB
Before local copies matmul = 22886.30469 MB
After local copies = 22886.30762 MB
After first SDPA allocated = 22885.79492 MB
After first copy allocated = 22885.79492 MB
On chunked entry = 22885.79492 MB
On scale calculation = 22885.80273 MB
Before interleave = 22885.80273 MB
After interleave = 22886.25586 MB
After matmul = 22886.25781 MB
Before local copies matmul = 22886.25781 MB
After local copies = 22886.26074 MB
fter compute chunk allocated = 22885.79492 MB
Memory after cuda sdpa 22885.802734375 MB
Decode step 30
1
Memory before offload  22885.78173828125 MB
Memory after offload  22885.78173828125 MB
Memory before cuda sdpa 22885.79541015625 MB
On entering CUDA sdpa main function  allocated = 22885.79541 MB
Before first SDPA allocated = 22885.79541 MB
On chunked entry = 22885.79541 MB
On scale calculation = 22885.80322 MB
Before interleave = 22885.80322 MB
After interleave = 22886.30322 MB
After matmul = 22894.43018 MB
Before local copies matmul = 22894.43018 MB
After local copies = 22894.43311 MB
After first SDPA allocated = 22893.92041 MB
After first copy allocated = 22893.92041 MB
On chunked entry = 22893.92041 MB
On scale calculation = 22893.92822 MB
Before interleave = 22893.92822 MB
After interleave = 22894.39697 MB
After matmul = 22894.39893 MB
Before local copies matmul = 22894.39893 MB
After local copies = 22894.40186 MB
fter compute chunk allocated = 22893.92041 MB
Memory after cuda sdpa 22893.92822265625 MB
1
Memory before offload  22893.90673828125 MB
Memory after offload  22893.90673828125 MB
Memory before cuda sdpa 22893.92041015625 MB
On entering CUDA sdpa main function  allocated = 22893.92041 MB
Before first SDPA allocated = 22893.92041 MB
On chunked entry = 22893.92041 MB
On scale calculation = 22893.92822 MB
Before interleave = 22893.92822 MB
After interleave = 22894.42822 MB
After matmul = 22902.55518 MB
Before local copies matmul = 22902.55518 MB
After local copies = 22902.55811 MB
After first SDPA allocated = 22902.04541 MB
After first copy allocated = 22902.04541 MB
On chunked entry = 22902.04541 MB
On scale calculation = 22902.05322 MB
Before interleave = 22902.05322 MB
After interleave = 22902.52197 MB
After matmul = 22902.52393 MB
Before local copies matmul = 22902.52393 MB
After local copies = 22902.52686 MB
fter compute chunk allocated = 22902.04541 MB
Memory after cuda sdpa 22902.05322265625 MB
1
Memory before offload  22902.03173828125 MB
Memory after offload  22902.03173828125 MB
Memory before cuda sdpa 22902.04541015625 MB
On entering CUDA sdpa main function  allocated = 22902.04541 MB
Before first SDPA allocated = 22902.04541 MB
On chunked entry = 22902.04541 MB
On scale calculation = 22902.05322 MB
Before interleave = 22902.05322 MB
After interleave = 22902.55322 MB
After matmul = 22910.68018 MB
Before local copies matmul = 22910.68018 MB
After local copies = 22910.68311 MB
After first SDPA allocated = 22910.17041 MB
After first copy allocated = 22910.17041 MB
On chunked entry = 22910.17041 MB
On scale calculation = 22910.17822 MB
Before interleave = 22910.17822 MB
After interleave = 22910.64697 MB
After matmul = 22910.64893 MB
Before local copies matmul = 22910.64893 MB
After local copies = 22910.65186 MB
fter compute chunk allocated = 22910.17041 MB
Memory after cuda sdpa 22910.17822265625 MB
1
Memory before offload  22910.15673828125 MB
Memory after offload  22910.15673828125 MB
Memory before cuda sdpa 22910.17041015625 MB
On entering CUDA sdpa main function  allocated = 22910.17041 MB
Before first SDPA allocated = 22910.17041 MB
On chunked entry = 22910.17041 MB
On scale calculation = 22910.17822 MB
Before interleave = 22910.17822 MB
After interleave = 22910.67822 MB
After matmul = 22918.80518 MB
Before local copies matmul = 22918.80518 MB
After local copies = 22918.80811 MB
After first SDPA allocated = 22918.29541 MB
After first copy allocated = 22918.29541 MB
On chunked entry = 22918.29541 MB
On scale calculation = 22918.30322 MB
Before interleave = 22918.30322 MB
After interleave = 22918.77197 MB
After matmul = 22918.77393 MB
Before local copies matmul = 22918.77393 MB
After local copies = 22918.77686 MB
fter compute chunk allocated = 22918.29541 MB
Memory after cuda sdpa 22918.30322265625 MB
1
Memory before offload  22918.28173828125 MB
Memory after offload  22918.28173828125 MB
Memory before cuda sdpa 22918.29541015625 MB
On entering CUDA sdpa main function  allocated = 22918.29541 MB
Before first SDPA allocated = 22918.29541 MB
On chunked entry = 22918.29541 MB
On scale calculation = 22918.30322 MB
Before interleave = 22918.30322 MB
After interleave = 22918.80322 MB
After matmul = 22926.93018 MB
Before local copies matmul = 22926.93018 MB
After local copies = 22926.93311 MB
After first SDPA allocated = 22926.42041 MB
After first copy allocated = 22926.42041 MB
On chunked entry = 22926.42041 MB
On scale calculation = 22926.42822 MB
Before interleave = 22926.42822 MB
After interleave = 22926.89697 MB
After matmul = 22926.89893 MB
Before local copies matmul = 22926.89893 MB
After local copies = 22926.90186 MB
fter compute chunk allocated = 22926.42041 MB
Memory after cuda sdpa 22926.42822265625 MB
1
Memory before offload  22926.40673828125 MB
Memory after offload  22926.40673828125 MB
Memory before cuda sdpa 22926.42041015625 MB
On entering CUDA sdpa main function  allocated = 22926.42041 MB
Before first SDPA allocated = 22926.42041 MB
On chunked entry = 22926.42041 MB
On scale calculation = 22926.42822 MB
Before interleave = 22926.42822 MB
After interleave = 22926.92822 MB
After matmul = 22935.05518 MB
Before local copies matmul = 22935.05518 MB
After local copies = 22935.05811 MB
After first SDPA allocated = 22934.54541 MB
After first copy allocated = 22934.54541 MB
On chunked entry = 22934.54541 MB
On scale calculation = 22934.55322 MB
Before interleave = 22934.55322 MB
After interleave = 22935.02197 MB
After matmul = 22935.02393 MB
Before local copies matmul = 22935.02393 MB
After local copies = 22935.02686 MB
fter compute chunk allocated = 22934.54541 MB
Memory after cuda sdpa 22934.55322265625 MB
1
Memory before offload  22934.53173828125 MB
Memory after offload  22934.53173828125 MB
Memory before cuda sdpa 22934.54541015625 MB
On entering CUDA sdpa main function  allocated = 22934.54541 MB
Before first SDPA allocated = 22934.54541 MB
On chunked entry = 22934.54541 MB
On scale calculation = 22934.55322 MB
Before interleave = 22934.55322 MB
After interleave = 22935.05322 MB
After matmul = 22943.18018 MB
Before local copies matmul = 22943.18018 MB
After local copies = 22943.18311 MB
After first SDPA allocated = 22942.67041 MB
After first copy allocated = 22942.67041 MB
On chunked entry = 22942.67041 MB
On scale calculation = 22942.67822 MB
Before interleave = 22942.67822 MB
After interleave = 22943.14697 MB
After matmul = 22943.14893 MB
Before local copies matmul = 22943.14893 MB
After local copies = 22943.15186 MB
fter compute chunk allocated = 22942.67041 MB
Memory after cuda sdpa 22942.67822265625 MB
1
Memory before offload  22942.65673828125 MB
Memory after offload  22942.65673828125 MB
Memory before cuda sdpa 22942.67041015625 MB
On entering CUDA sdpa main function  allocated = 22942.67041 MB
Before first SDPA allocated = 22942.67041 MB
On chunked entry = 22942.67041 MB
On scale calculation = 22942.67822 MB
Before interleave = 22942.67822 MB
After interleave = 22943.17822 MB
After matmul = 22951.30518 MB
Before local copies matmul = 22951.30518 MB
After local copies = 22951.30811 MB
After first SDPA allocated = 22950.79541 MB
After first copy allocated = 22950.79541 MB
On chunked entry = 22950.79541 MB
On scale calculation = 22950.80322 MB
Before interleave = 22950.80322 MB
After interleave = 22951.27197 MB
After matmul = 22951.27393 MB
Before local copies matmul = 22951.27393 MB
After local copies = 22951.27686 MB
fter compute chunk allocated = 22950.79541 MB
Memory after cuda sdpa 22950.80322265625 MB
1
Memory before offload  22950.78173828125 MB
Memory after offload  22950.78173828125 MB
Memory before cuda sdpa 22950.79541015625 MB
On entering CUDA sdpa main function  allocated = 22950.79541 MB
Before first SDPA allocated = 22950.79541 MB
On chunked entry = 22950.79541 MB
On scale calculation = 22950.80322 MB
Before interleave = 22950.80322 MB
After interleave = 22951.30322 MB
After matmul = 22959.43018 MB
Before local copies matmul = 22959.43018 MB
After local copies = 22959.43311 MB
After first SDPA allocated = 22958.92041 MB
After first copy allocated = 22958.92041 MB
On chunked entry = 22958.92041 MB
On scale calculation = 22958.92822 MB
Before interleave = 22958.92822 MB
After interleave = 22959.39697 MB
After matmul = 22959.39893 MB
Before local copies matmul = 22959.39893 MB
After local copies = 22959.40186 MB
fter compute chunk allocated = 22958.92041 MB
Memory after cuda sdpa 22958.92822265625 MB
1
Memory before offload  22958.90673828125 MB
Memory after offload  22958.90673828125 MB
Memory before cuda sdpa 22958.92041015625 MB
On entering CUDA sdpa main function  allocated = 22958.92041 MB
Before first SDPA allocated = 22958.92041 MB
On chunked entry = 22958.92041 MB
On scale calculation = 22958.92822 MB
Before interleave = 22958.92822 MB
After interleave = 22959.42822 MB
After matmul = 22967.55518 MB
Before local copies matmul = 22967.55518 MB
After local copies = 22967.55811 MB
After first SDPA allocated = 22967.04541 MB
After first copy allocated = 22967.04541 MB
On chunked entry = 22967.04541 MB
On scale calculation = 22967.05322 MB
Before interleave = 22967.05322 MB
After interleave = 22967.52197 MB
After matmul = 22967.52393 MB
Before local copies matmul = 22967.52393 MB
After local copies = 22967.52686 MB
fter compute chunk allocated = 22967.04541 MB
Memory after cuda sdpa 22967.05322265625 MB
1
Memory before offload  22967.03173828125 MB
Memory after offload  22967.03173828125 MB
Memory before cuda sdpa 22967.04541015625 MB
On entering CUDA sdpa main function  allocated = 22967.04541 MB
Before first SDPA allocated = 22967.04541 MB
On chunked entry = 22967.04541 MB
On scale calculation = 22967.05322 MB
Before interleave = 22967.05322 MB
After interleave = 22967.55322 MB
After matmul = 22975.68018 MB
Before local copies matmul = 22975.68018 MB
After local copies = 22975.68311 MB
After first SDPA allocated = 22975.17041 MB
After first copy allocated = 22975.17041 MB
On chunked entry = 22975.17041 MB
On scale calculation = 22975.17822 MB
Before interleave = 22975.17822 MB
After interleave = 22975.64697 MB
After matmul = 22975.64893 MB
Before local copies matmul = 22975.64893 MB
After local copies = 22975.65186 MB
fter compute chunk allocated = 22975.17041 MB
Memory after cuda sdpa 22975.17822265625 MB
1
Memory before offload  22975.15673828125 MB
Memory after offload  22975.15673828125 MB
Memory before cuda sdpa 22975.17041015625 MB
On entering CUDA sdpa main function  allocated = 22975.17041 MB
Before first SDPA allocated = 22975.17041 MB
On chunked entry = 22975.17041 MB
On scale calculation = 22975.17822 MB
Before interleave = 22975.17822 MB
After interleave = 22975.67822 MB
After matmul = 22983.80518 MB
Before local copies matmul = 22983.80518 MB
After local copies = 22983.80811 MB
After first SDPA allocated = 22983.29541 MB
After first copy allocated = 22983.29541 MB
On chunked entry = 22983.29541 MB
On scale calculation = 22983.30322 MB
Before interleave = 22983.30322 MB
After interleave = 22983.77197 MB
After matmul = 22983.77393 MB
Before local copies matmul = 22983.77393 MB
After local copies = 22983.77686 MB
fter compute chunk allocated = 22983.29541 MB
Memory after cuda sdpa 22983.30322265625 MB
1
Memory before offload  22983.28173828125 MB
Memory after offload  22983.28173828125 MB
Memory before cuda sdpa 22983.29541015625 MB
On entering CUDA sdpa main function  allocated = 22983.29541 MB
Before first SDPA allocated = 22983.29541 MB
On chunked entry = 22983.29541 MB
On scale calculation = 22983.30322 MB
Before interleave = 22983.30322 MB
After interleave = 22983.80322 MB
After matmul = 22991.93018 MB
Before local copies matmul = 22991.93018 MB
After local copies = 22991.93311 MB
After first SDPA allocated = 22991.42041 MB
After first copy allocated = 22991.42041 MB
On chunked entry = 22991.42041 MB
On scale calculation = 22991.42822 MB
Before interleave = 22991.42822 MB
After interleave = 22991.89697 MB
After matmul = 22991.89893 MB
Before local copies matmul = 22991.89893 MB
After local copies = 22991.90186 MB
fter compute chunk allocated = 22991.42041 MB
Memory after cuda sdpa 22991.42822265625 MB
1
Memory before offload  22991.40673828125 MB
Memory after offload  22991.40673828125 MB
Memory before cuda sdpa 22991.42041015625 MB
On entering CUDA sdpa main function  allocated = 22991.42041 MB
Before first SDPA allocated = 22991.42041 MB
On chunked entry = 22991.42041 MB
On scale calculation = 22991.42822 MB
Before interleave = 22991.42822 MB
After interleave = 22991.92822 MB
After matmul = 23000.05518 MB
Before local copies matmul = 23000.05518 MB
After local copies = 23000.05811 MB
After first SDPA allocated = 22999.54541 MB
After first copy allocated = 22999.54541 MB
On chunked entry = 22999.54541 MB
On scale calculation = 22999.55322 MB
Before interleave = 22999.55322 MB
After interleave = 23000.02197 MB
After matmul = 23000.02393 MB
Before local copies matmul = 23000.02393 MB
After local copies = 23000.02686 MB
fter compute chunk allocated = 22999.54541 MB
Memory after cuda sdpa 22999.55322265625 MB
1
Memory before offload  22999.53173828125 MB
Memory after offload  22999.53173828125 MB
Memory before cuda sdpa 22999.54541015625 MB
On entering CUDA sdpa main function  allocated = 22999.54541 MB
Before first SDPA allocated = 22999.54541 MB
On chunked entry = 22999.54541 MB
On scale calculation = 22999.55322 MB
Before interleave = 22999.55322 MB
After interleave = 23000.05322 MB
After matmul = 23008.18018 MB
Before local copies matmul = 23008.18018 MB
After local copies = 23008.18311 MB
After first SDPA allocated = 23007.67041 MB
After first copy allocated = 23007.67041 MB
On chunked entry = 23007.67041 MB
On scale calculation = 23007.67822 MB
Before interleave = 23007.67822 MB
After interleave = 23008.14697 MB
After matmul = 23008.14893 MB
Before local copies matmul = 23008.14893 MB
After local copies = 23008.15186 MB
fter compute chunk allocated = 23007.67041 MB
Memory after cuda sdpa 23007.67822265625 MB
1
Memory before offload  23007.65673828125 MB
Memory after offload  23007.65673828125 MB
Memory before cuda sdpa 23007.67041015625 MB
On entering CUDA sdpa main function  allocated = 23007.67041 MB
Before first SDPA allocated = 23007.67041 MB
On chunked entry = 23007.67041 MB
On scale calculation = 23007.67822 MB
Before interleave = 23007.67822 MB
After interleave = 23008.17822 MB
After matmul = 23016.30518 MB
Before local copies matmul = 23016.30518 MB
After local copies = 23016.30811 MB
After first SDPA allocated = 23015.79541 MB
After first copy allocated = 23015.79541 MB
On chunked entry = 23015.79541 MB
On scale calculation = 23015.80322 MB
Before interleave = 23015.80322 MB
After interleave = 23016.27197 MB
After matmul = 23016.27393 MB
Before local copies matmul = 23016.27393 MB
After local copies = 23016.27686 MB
fter compute chunk allocated = 23015.79541 MB
Memory after cuda sdpa 23015.80322265625 MB
1
Memory before offload  23015.78173828125 MB
Memory after offload  23015.78173828125 MB
Memory before cuda sdpa 23015.79541015625 MB
On entering CUDA sdpa main function  allocated = 23015.79541 MB
Before first SDPA allocated = 23015.79541 MB
On chunked entry = 23015.79541 MB
On scale calculation = 23015.80322 MB
Before interleave = 23015.80322 MB
After interleave = 23016.30322 MB
After matmul = 23024.43018 MB
Before local copies matmul = 23024.43018 MB
After local copies = 23024.43311 MB
After first SDPA allocated = 23023.92041 MB
After first copy allocated = 23023.92041 MB
On chunked entry = 23023.92041 MB
On scale calculation = 23023.92822 MB
Before interleave = 23023.92822 MB
After interleave = 23024.39697 MB
After matmul = 23024.39893 MB
Before local copies matmul = 23024.39893 MB
After local copies = 23024.40186 MB
fter compute chunk allocated = 23023.92041 MB
Memory after cuda sdpa 23023.92822265625 MB
1
Memory before offload  23023.90673828125 MB
Memory after offload  23023.90673828125 MB
Memory before cuda sdpa 23023.92041015625 MB
On entering CUDA sdpa main function  allocated = 23023.92041 MB
Before first SDPA allocated = 23023.92041 MB
On chunked entry = 23023.92041 MB
On scale calculation = 23023.92822 MB
Before interleave = 23023.92822 MB
After interleave = 23024.42822 MB
After matmul = 23032.55518 MB
Before local copies matmul = 23032.55518 MB
After local copies = 23032.55811 MB
After first SDPA allocated = 23032.04541 MB
After first copy allocated = 23032.04541 MB
On chunked entry = 23032.04541 MB
On scale calculation = 23032.05322 MB
Before interleave = 23032.05322 MB
After interleave = 23032.52197 MB
After matmul = 23032.52393 MB
Before local copies matmul = 23032.52393 MB
After local copies = 23032.52686 MB
fter compute chunk allocated = 23032.04541 MB
Memory after cuda sdpa 23032.05322265625 MB
1
Memory before offload  23032.03173828125 MB
Memory after offload  23032.03173828125 MB
Memory before cuda sdpa 23032.04541015625 MB
On entering CUDA sdpa main function  allocated = 23032.04541 MB
Before first SDPA allocated = 23032.04541 MB
On chunked entry = 23032.04541 MB
On scale calculation = 23032.05322 MB
Before interleave = 23032.05322 MB
After interleave = 23032.55322 MB
After matmul = 23040.68018 MB
Before local copies matmul = 23040.68018 MB
After local copies = 23040.68311 MB
After first SDPA allocated = 23040.17041 MB
After first copy allocated = 23040.17041 MB
On chunked entry = 23040.17041 MB
On scale calculation = 23040.17822 MB
Before interleave = 23040.17822 MB
After interleave = 23040.64697 MB
After matmul = 23040.64893 MB
Before local copies matmul = 23040.64893 MB
After local copies = 23040.65186 MB
fter compute chunk allocated = 23040.17041 MB
Memory after cuda sdpa 23040.17822265625 MB
1
Memory before offload  23040.15673828125 MB
Memory after offload  23040.15673828125 MB
Memory before cuda sdpa 23040.17041015625 MB
On entering CUDA sdpa main function  allocated = 23040.17041 MB
Before first SDPA allocated = 23040.17041 MB
On chunked entry = 23040.17041 MB
On scale calculation = 23040.17822 MB
Before interleave = 23040.17822 MB
After interleave = 23040.67822 MB
After matmul = 23048.80518 MB
Before local copies matmul = 23048.80518 MB
After local copies = 23048.80811 MB
After first SDPA allocated = 23048.29541 MB
After first copy allocated = 23048.29541 MB
On chunked entry = 23048.29541 MB
On scale calculation = 23048.30322 MB
Before interleave = 23048.30322 MB
After interleave = 23048.77197 MB
After matmul = 23048.77393 MB
Before local copies matmul = 23048.77393 MB
After local copies = 23048.77686 MB
fter compute chunk allocated = 23048.29541 MB
Memory after cuda sdpa 23048.30322265625 MB
1
Memory before offload  23048.28173828125 MB
Memory after offload  23048.28173828125 MB
Memory before cuda sdpa 23048.29541015625 MB
On entering CUDA sdpa main function  allocated = 23048.29541 MB
Before first SDPA allocated = 23048.29541 MB
On chunked entry = 23048.29541 MB
On scale calculation = 23048.30322 MB
Before interleave = 23048.30322 MB
After interleave = 23048.80322 MB
After matmul = 23056.93018 MB
Before local copies matmul = 23056.93018 MB
After local copies = 23056.93311 MB
After first SDPA allocated = 23056.42041 MB
After first copy allocated = 23056.42041 MB
On chunked entry = 23056.42041 MB
On scale calculation = 23056.42822 MB
Before interleave = 23056.42822 MB
After interleave = 23056.89697 MB
After matmul = 23056.89893 MB
Before local copies matmul = 23056.89893 MB
After local copies = 23056.90186 MB
fter compute chunk allocated = 23056.42041 MB
Memory after cuda sdpa 23056.42822265625 MB
1
Memory before offload  23056.40673828125 MB
Memory after offload  23056.40673828125 MB
Memory before cuda sdpa 23056.42041015625 MB
On entering CUDA sdpa main function  allocated = 23056.42041 MB
Before first SDPA allocated = 23056.42041 MB
On chunked entry = 23056.42041 MB
On scale calculation = 23056.42822 MB
Before interleave = 23056.42822 MB
After interleave = 23056.92822 MB
After matmul = 23065.05518 MB
Before local copies matmul = 23065.05518 MB
After local copies = 23065.05811 MB
After first SDPA allocated = 23064.54541 MB
After first copy allocated = 23064.54541 MB
On chunked entry = 23064.54541 MB
On scale calculation = 23064.55322 MB
Before interleave = 23064.55322 MB
After interleave = 23065.02197 MB
After matmul = 23065.02393 MB
Before local copies matmul = 23065.02393 MB
After local copies = 23065.02686 MB
fter compute chunk allocated = 23064.54541 MB
Memory after cuda sdpa 23064.55322265625 MB
1
Memory before offload  23064.53173828125 MB
Memory after offload  23064.53173828125 MB
Memory before cuda sdpa 23064.54541015625 MB
On entering CUDA sdpa main function  allocated = 23064.54541 MB
Before first SDPA allocated = 23064.54541 MB
On chunked entry = 23064.54541 MB
On scale calculation = 23064.55322 MB
Before interleave = 23064.55322 MB
After interleave = 23065.05322 MB
After matmul = 23073.18018 MB
Before local copies matmul = 23073.18018 MB
After local copies = 23073.18311 MB
After first SDPA allocated = 23072.67041 MB
After first copy allocated = 23072.67041 MB
On chunked entry = 23072.67041 MB
On scale calculation = 23072.67822 MB
Before interleave = 23072.67822 MB
After interleave = 23073.14697 MB
After matmul = 23073.14893 MB
Before local copies matmul = 23073.14893 MB
After local copies = 23073.15186 MB
fter compute chunk allocated = 23072.67041 MB
Memory after cuda sdpa 23072.67822265625 MB
1
Memory before offload  23072.65673828125 MB
Memory after offload  23072.65673828125 MB
Memory before cuda sdpa 23072.67041015625 MB
On entering CUDA sdpa main function  allocated = 23072.67041 MB
Before first SDPA allocated = 23072.67041 MB
On chunked entry = 23072.67041 MB
On scale calculation = 23072.67822 MB
Before interleave = 23072.67822 MB
After interleave = 23073.17822 MB
After matmul = 23081.30518 MB
Before local copies matmul = 23081.30518 MB
After local copies = 23081.30811 MB
After first SDPA allocated = 23080.79541 MB
After first copy allocated = 23080.79541 MB
On chunked entry = 23080.79541 MB
On scale calculation = 23080.80322 MB
Before interleave = 23080.80322 MB
After interleave = 23081.27197 MB
After matmul = 23081.27393 MB
Before local copies matmul = 23081.27393 MB
After local copies = 23081.27686 MB
fter compute chunk allocated = 23080.79541 MB
Memory after cuda sdpa 23080.80322265625 MB
1
Memory before offload  23080.78173828125 MB
Memory after offload  23080.78173828125 MB
Memory before cuda sdpa 23080.79541015625 MB
On entering CUDA sdpa main function  allocated = 23080.79541 MB
Before first SDPA allocated = 23080.79541 MB
On chunked entry = 23080.79541 MB
On scale calculation = 23080.80322 MB
Before interleave = 23080.80322 MB
After interleave = 23081.30322 MB
After matmul = 23089.43018 MB
Before local copies matmul = 23089.43018 MB
After local copies = 23089.43311 MB
After first SDPA allocated = 23088.92041 MB
After first copy allocated = 23088.92041 MB
On chunked entry = 23088.92041 MB
On scale calculation = 23088.92822 MB
Before interleave = 23088.92822 MB
After interleave = 23089.39697 MB
After matmul = 23089.39893 MB
Before local copies matmul = 23089.39893 MB
After local copies = 23089.40186 MB
fter compute chunk allocated = 23088.92041 MB
Memory after cuda sdpa 23088.92822265625 MB
1
Memory before offload  23088.90673828125 MB
Memory after offload  23088.90673828125 MB
Memory before cuda sdpa 23088.92041015625 MB
On entering CUDA sdpa main function  allocated = 23088.92041 MB
Before first SDPA allocated = 23088.92041 MB
On chunked entry = 23088.92041 MB
On scale calculation = 23088.92822 MB
Before interleave = 23088.92822 MB
After interleave = 23089.42822 MB
After matmul = 23097.55518 MB
Before local copies matmul = 23097.55518 MB
After local copies = 23097.55811 MB
After first SDPA allocated = 23097.04541 MB
After first copy allocated = 23097.04541 MB
On chunked entry = 23097.04541 MB
On scale calculation = 23097.05322 MB
Before interleave = 23097.05322 MB
After interleave = 23097.52197 MB
After matmul = 23097.52393 MB
Before local copies matmul = 23097.52393 MB
After local copies = 23097.52686 MB
fter compute chunk allocated = 23097.04541 MB
Memory after cuda sdpa 23097.05322265625 MB
1
Memory before offload  23097.03173828125 MB
Memory after offload  23097.03173828125 MB
Memory before cuda sdpa 23097.04541015625 MB
On entering CUDA sdpa main function  allocated = 23097.04541 MB
Before first SDPA allocated = 23097.04541 MB
On chunked entry = 23097.04541 MB
On scale calculation = 23097.05322 MB
Before interleave = 23097.05322 MB
After interleave = 23097.55322 MB
After matmul = 23105.68018 MB
Before local copies matmul = 23105.68018 MB
After local copies = 23105.68311 MB
After first SDPA allocated = 23105.17041 MB
After first copy allocated = 23105.17041 MB
On chunked entry = 23105.17041 MB
On scale calculation = 23105.17822 MB
Before interleave = 23105.17822 MB
After interleave = 23105.64697 MB
After matmul = 23105.64893 MB
Before local copies matmul = 23105.64893 MB
After local copies = 23105.65186 MB
fter compute chunk allocated = 23105.17041 MB
Memory after cuda sdpa 23105.17822265625 MB
1
Memory before offload  23105.15673828125 MB
Memory after offload  23105.15673828125 MB
Memory before cuda sdpa 23105.17041015625 MB
On entering CUDA sdpa main function  allocated = 23105.17041 MB
Before first SDPA allocated = 23105.17041 MB
On chunked entry = 23105.17041 MB
On scale calculation = 23105.17822 MB
Before interleave = 23105.17822 MB
After interleave = 23105.67822 MB
After matmul = 23113.80518 MB
Before local copies matmul = 23113.80518 MB
After local copies = 23113.80811 MB
After first SDPA allocated = 23113.29541 MB
After first copy allocated = 23113.29541 MB
On chunked entry = 23113.29541 MB
On scale calculation = 23113.30322 MB
Before interleave = 23113.30322 MB
After interleave = 23113.77197 MB
After matmul = 23113.77393 MB
Before local copies matmul = 23113.77393 MB
After local copies = 23113.77686 MB
fter compute chunk allocated = 23113.29541 MB
Memory after cuda sdpa 23113.30322265625 MB
1
Memory before offload  23113.28173828125 MB
Memory after offload  23113.28173828125 MB
Memory before cuda sdpa 23113.29541015625 MB
On entering CUDA sdpa main function  allocated = 23113.29541 MB
Before first SDPA allocated = 23113.29541 MB
On chunked entry = 23113.29541 MB
On scale calculation = 23113.30322 MB
Before interleave = 23113.30322 MB
After interleave = 23113.80322 MB
After matmul = 23121.93018 MB
Before local copies matmul = 23121.93018 MB
After local copies = 23121.93311 MB
After first SDPA allocated = 23121.42041 MB
After first copy allocated = 23121.42041 MB
On chunked entry = 23121.42041 MB
On scale calculation = 23121.42822 MB
Before interleave = 23121.42822 MB
After interleave = 23121.89697 MB
After matmul = 23121.89893 MB
Before local copies matmul = 23121.89893 MB
After local copies = 23121.90186 MB
fter compute chunk allocated = 23121.42041 MB
Memory after cuda sdpa 23121.42822265625 MB
1
Memory before offload  23121.40673828125 MB
Memory after offload  23121.40673828125 MB
Memory before cuda sdpa 23121.42041015625 MB
On entering CUDA sdpa main function  allocated = 23121.42041 MB
Before first SDPA allocated = 23121.42041 MB
On chunked entry = 23121.42041 MB
On scale calculation = 23121.42822 MB
Before interleave = 23121.42822 MB
After interleave = 23121.92822 MB
After matmul = 23130.05518 MB
Before local copies matmul = 23130.05518 MB
After local copies = 23130.05811 MB
After first SDPA allocated = 23129.54541 MB
After first copy allocated = 23129.54541 MB
On chunked entry = 23129.54541 MB
On scale calculation = 23129.55322 MB
Before interleave = 23129.55322 MB
After interleave = 23130.02197 MB
After matmul = 23130.02393 MB
Before local copies matmul = 23130.02393 MB
After local copies = 23130.02686 MB
fter compute chunk allocated = 23129.54541 MB
Memory after cuda sdpa 23129.55322265625 MB
1
Memory before offload  23129.53173828125 MB
Memory after offload  23129.53173828125 MB
Memory before cuda sdpa 23129.54541015625 MB
On entering CUDA sdpa main function  allocated = 23129.54541 MB
Before first SDPA allocated = 23129.54541 MB
On chunked entry = 23129.54541 MB
On scale calculation = 23129.55322 MB
Before interleave = 23129.55322 MB
After interleave = 23130.05322 MB
After matmul = 23138.18018 MB
Before local copies matmul = 23138.18018 MB
After local copies = 23138.18311 MB
After first SDPA allocated = 23137.67041 MB
After first copy allocated = 23137.67041 MB
On chunked entry = 23137.67041 MB
On scale calculation = 23137.67822 MB
Before interleave = 23137.67822 MB
After interleave = 23138.14697 MB
After matmul = 23138.14893 MB
Before local copies matmul = 23138.14893 MB
After local copies = 23138.15186 MB
fter compute chunk allocated = 23137.67041 MB
Memory after cuda sdpa 23137.67822265625 MB
1
Memory before offload  23137.65673828125 MB
Memory after offload  23137.65673828125 MB
Memory before cuda sdpa 23137.67041015625 MB
On entering CUDA sdpa main function  allocated = 23137.67041 MB
Before first SDPA allocated = 23137.67041 MB
On chunked entry = 23137.67041 MB
On scale calculation = 23137.67822 MB
Before interleave = 23137.67822 MB
After interleave = 23138.17822 MB
After matmul = 23146.30518 MB
Before local copies matmul = 23146.30518 MB
After local copies = 23146.30811 MB
After first SDPA allocated = 23145.79541 MB
After first copy allocated = 23145.79541 MB
On chunked entry = 23145.79541 MB
On scale calculation = 23145.80322 MB
Before interleave = 23145.80322 MB
After interleave = 23146.27197 MB
After matmul = 23146.27393 MB
Before local copies matmul = 23146.27393 MB
After local copies = 23146.27686 MB
fter compute chunk allocated = 23145.79541 MB
Memory after cuda sdpa 23145.80322265625 MB
Decode step 31
1
Memory before offload  23145.7822265625 MB
Memory after offload  23145.7822265625 MB
Memory before cuda sdpa 23145.7958984375 MB
On entering CUDA sdpa main function  allocated = 23145.79590 MB
Before first SDPA allocated = 23145.79590 MB
On chunked entry = 23145.79590 MB
On scale calculation = 23145.80371 MB
Before interleave = 23145.80371 MB
After interleave = 23146.30371 MB
After matmul = 23154.43066 MB
Before local copies matmul = 23154.43066 MB
After local copies = 23154.43359 MB
After first SDPA allocated = 23153.92090 MB
After first copy allocated = 23153.92090 MB
On chunked entry = 23153.92090 MB
On scale calculation = 23153.92871 MB
Before interleave = 23153.92871 MB
After interleave = 23154.41309 MB
After matmul = 23154.41504 MB
Before local copies matmul = 23154.41504 MB
After local copies = 23154.41797 MB
fter compute chunk allocated = 23153.92090 MB
Memory after cuda sdpa 23153.9287109375 MB
1
Memory before offload  23153.9072265625 MB
Memory after offload  23153.9072265625 MB
Memory before cuda sdpa 23153.9208984375 MB
On entering CUDA sdpa main function  allocated = 23153.92090 MB
Before first SDPA allocated = 23153.92090 MB
On chunked entry = 23153.92090 MB
On scale calculation = 23153.92871 MB
Before interleave = 23153.92871 MB
After interleave = 23154.42871 MB
After matmul = 23162.55566 MB
Before local copies matmul = 23162.55566 MB
After local copies = 23162.55859 MB
After first SDPA allocated = 23162.04590 MB
After first copy allocated = 23162.04590 MB
On chunked entry = 23162.04590 MB
On scale calculation = 23162.05371 MB
Before interleave = 23162.05371 MB
After interleave = 23162.53809 MB
After matmul = 23162.54004 MB
Before local copies matmul = 23162.54004 MB
After local copies = 23162.54297 MB
fter compute chunk allocated = 23162.04590 MB
Memory after cuda sdpa 23162.0537109375 MB
1
Memory before offload  23162.0322265625 MB
Memory after offload  23162.0322265625 MB
Memory before cuda sdpa 23162.0458984375 MB
On entering CUDA sdpa main function  allocated = 23162.04590 MB
Before first SDPA allocated = 23162.04590 MB
On chunked entry = 23162.04590 MB
On scale calculation = 23162.05371 MB
Before interleave = 23162.05371 MB
After interleave = 23162.55371 MB
After matmul = 23170.68066 MB
Before local copies matmul = 23170.68066 MB
After local copies = 23170.68359 MB
After first SDPA allocated = 23170.17090 MB
After first copy allocated = 23170.17090 MB
On chunked entry = 23170.17090 MB
On scale calculation = 23170.17871 MB
Before interleave = 23170.17871 MB
After interleave = 23170.66309 MB
After matmul = 23170.66504 MB
Before local copies matmul = 23170.66504 MB
After local copies = 23170.66797 MB
fter compute chunk allocated = 23170.17090 MB
Memory after cuda sdpa 23170.1787109375 MB
1
Memory before offload  23170.1572265625 MB
Memory after offload  23170.1572265625 MB
Memory before cuda sdpa 23170.1708984375 MB
On entering CUDA sdpa main function  allocated = 23170.17090 MB
Before first SDPA allocated = 23170.17090 MB
On chunked entry = 23170.17090 MB
On scale calculation = 23170.17871 MB
Before interleave = 23170.17871 MB
After interleave = 23170.67871 MB
After matmul = 23178.80566 MB
Before local copies matmul = 23178.80566 MB
After local copies = 23178.80859 MB
After first SDPA allocated = 23178.29590 MB
After first copy allocated = 23178.29590 MB
On chunked entry = 23178.29590 MB
On scale calculation = 23178.30371 MB
Before interleave = 23178.30371 MB
After interleave = 23178.78809 MB
After matmul = 23178.79004 MB
Before local copies matmul = 23178.79004 MB
After local copies = 23178.79297 MB
fter compute chunk allocated = 23178.29590 MB
Memory after cuda sdpa 23178.3037109375 MB
1
Memory before offload  23178.2822265625 MB
Memory after offload  23178.2822265625 MB
Memory before cuda sdpa 23178.2958984375 MB
On entering CUDA sdpa main function  allocated = 23178.29590 MB
Before first SDPA allocated = 23178.29590 MB
On chunked entry = 23178.29590 MB
On scale calculation = 23178.30371 MB
Before interleave = 23178.30371 MB
After interleave = 23178.80371 MB
After matmul = 23186.93066 MB
Before local copies matmul = 23186.93066 MB
After local copies = 23186.93359 MB
After first SDPA allocated = 23186.42090 MB
After first copy allocated = 23186.42090 MB
On chunked entry = 23186.42090 MB
On scale calculation = 23186.42871 MB
Before interleave = 23186.42871 MB
After interleave = 23186.91309 MB
After matmul = 23186.91504 MB
Before local copies matmul = 23186.91504 MB
After local copies = 23186.91797 MB
fter compute chunk allocated = 23186.42090 MB
Memory after cuda sdpa 23186.4287109375 MB
1
Memory before offload  23186.4072265625 MB
Memory after offload  23186.4072265625 MB
Memory before cuda sdpa 23186.4208984375 MB
On entering CUDA sdpa main function  allocated = 23186.42090 MB
Before first SDPA allocated = 23186.42090 MB
On chunked entry = 23186.42090 MB
On scale calculation = 23186.42871 MB
Before interleave = 23186.42871 MB
After interleave = 23186.92871 MB
After matmul = 23195.05566 MB
Before local copies matmul = 23195.05566 MB
After local copies = 23195.05859 MB
After first SDPA allocated = 23194.54590 MB
After first copy allocated = 23194.54590 MB
On chunked entry = 23194.54590 MB
On scale calculation = 23194.55371 MB
Before interleave = 23194.55371 MB
After interleave = 23195.03809 MB
After matmul = 23195.04004 MB
Before local copies matmul = 23195.04004 MB
After local copies = 23195.04297 MB
fter compute chunk allocated = 23194.54590 MB
Memory after cuda sdpa 23194.5537109375 MB
1
Memory before offload  23194.5322265625 MB
Memory after offload  23194.5322265625 MB
Memory before cuda sdpa 23194.5458984375 MB
On entering CUDA sdpa main function  allocated = 23194.54590 MB
Before first SDPA allocated = 23194.54590 MB
On chunked entry = 23194.54590 MB
On scale calculation = 23194.55371 MB
Before interleave = 23194.55371 MB
After interleave = 23195.05371 MB
After matmul = 23203.18066 MB
Before local copies matmul = 23203.18066 MB
After local copies = 23203.18359 MB
After first SDPA allocated = 23202.67090 MB
After first copy allocated = 23202.67090 MB
On chunked entry = 23202.67090 MB
On scale calculation = 23202.67871 MB
Before interleave = 23202.67871 MB
After interleave = 23203.16309 MB
After matmul = 23203.16504 MB
Before local copies matmul = 23203.16504 MB
After local copies = 23203.16797 MB
fter compute chunk allocated = 23202.67090 MB
Memory after cuda sdpa 23202.6787109375 MB
1
Memory before offload  23202.6572265625 MB
Memory after offload  23202.6572265625 MB
Memory before cuda sdpa 23202.6708984375 MB
On entering CUDA sdpa main function  allocated = 23202.67090 MB
Before first SDPA allocated = 23202.67090 MB
On chunked entry = 23202.67090 MB
On scale calculation = 23202.67871 MB
Before interleave = 23202.67871 MB
After interleave = 23203.17871 MB
After matmul = 23211.30566 MB
Before local copies matmul = 23211.30566 MB
After local copies = 23211.30859 MB
After first SDPA allocated = 23210.79590 MB
After first copy allocated = 23210.79590 MB
On chunked entry = 23210.79590 MB
On scale calculation = 23210.80371 MB
Before interleave = 23210.80371 MB
After interleave = 23211.28809 MB
After matmul = 23211.29004 MB
Before local copies matmul = 23211.29004 MB
After local copies = 23211.29297 MB
fter compute chunk allocated = 23210.79590 MB
Memory after cuda sdpa 23210.8037109375 MB
1
Memory before offload  23210.7822265625 MB
Memory after offload  23210.7822265625 MB
Memory before cuda sdpa 23210.7958984375 MB
On entering CUDA sdpa main function  allocated = 23210.79590 MB
Before first SDPA allocated = 23210.79590 MB
On chunked entry = 23210.79590 MB
On scale calculation = 23210.80371 MB
Before interleave = 23210.80371 MB
After interleave = 23211.30371 MB
After matmul = 23219.43066 MB
Before local copies matmul = 23219.43066 MB
After local copies = 23219.43359 MB
After first SDPA allocated = 23218.92090 MB
After first copy allocated = 23218.92090 MB
On chunked entry = 23218.92090 MB
On scale calculation = 23218.92871 MB
Before interleave = 23218.92871 MB
After interleave = 23219.41309 MB
After matmul = 23219.41504 MB
Before local copies matmul = 23219.41504 MB
After local copies = 23219.41797 MB
fter compute chunk allocated = 23218.92090 MB
Memory after cuda sdpa 23218.9287109375 MB
1
Memory before offload  23218.9072265625 MB
Memory after offload  23218.9072265625 MB
Memory before cuda sdpa 23218.9208984375 MB
On entering CUDA sdpa main function  allocated = 23218.92090 MB
Before first SDPA allocated = 23218.92090 MB
On chunked entry = 23218.92090 MB
On scale calculation = 23218.92871 MB
Before interleave = 23218.92871 MB
After interleave = 23219.42871 MB
After matmul = 23227.55566 MB
Before local copies matmul = 23227.55566 MB
After local copies = 23227.55859 MB
After first SDPA allocated = 23227.04590 MB
After first copy allocated = 23227.04590 MB
On chunked entry = 23227.04590 MB
On scale calculation = 23227.05371 MB
Before interleave = 23227.05371 MB
After interleave = 23227.53809 MB
After matmul = 23227.54004 MB
Before local copies matmul = 23227.54004 MB
After local copies = 23227.54297 MB
fter compute chunk allocated = 23227.04590 MB
Memory after cuda sdpa 23227.0537109375 MB
1
Memory before offload  23227.0322265625 MB
Memory after offload  23227.0322265625 MB
Memory before cuda sdpa 23227.0458984375 MB
On entering CUDA sdpa main function  allocated = 23227.04590 MB
Before first SDPA allocated = 23227.04590 MB
On chunked entry = 23227.04590 MB
On scale calculation = 23227.05371 MB
Before interleave = 23227.05371 MB
After interleave = 23227.55371 MB
After matmul = 23235.68066 MB
Before local copies matmul = 23235.68066 MB
After local copies = 23235.68359 MB
After first SDPA allocated = 23235.17090 MB
After first copy allocated = 23235.17090 MB
On chunked entry = 23235.17090 MB
On scale calculation = 23235.17871 MB
Before interleave = 23235.17871 MB
After interleave = 23235.66309 MB
After matmul = 23235.66504 MB
Before local copies matmul = 23235.66504 MB
After local copies = 23235.66797 MB
fter compute chunk allocated = 23235.17090 MB
Memory after cuda sdpa 23235.1787109375 MB
1
Memory before offload  23235.1572265625 MB
Memory after offload  23235.1572265625 MB
Memory before cuda sdpa 23235.1708984375 MB
On entering CUDA sdpa main function  allocated = 23235.17090 MB
Before first SDPA allocated = 23235.17090 MB
On chunked entry = 23235.17090 MB
On scale calculation = 23235.17871 MB
Before interleave = 23235.17871 MB
After interleave = 23235.67871 MB
After matmul = 23243.80566 MB
Before local copies matmul = 23243.80566 MB
After local copies = 23243.80859 MB
After first SDPA allocated = 23243.29590 MB
After first copy allocated = 23243.29590 MB
On chunked entry = 23243.29590 MB
On scale calculation = 23243.30371 MB
Before interleave = 23243.30371 MB
After interleave = 23243.78809 MB
After matmul = 23243.79004 MB
Before local copies matmul = 23243.79004 MB
After local copies = 23243.79297 MB
fter compute chunk allocated = 23243.29590 MB
Memory after cuda sdpa 23243.3037109375 MB
1
Memory before offload  23243.2822265625 MB
Memory after offload  23243.2822265625 MB
Memory before cuda sdpa 23243.2958984375 MB
On entering CUDA sdpa main function  allocated = 23243.29590 MB
Before first SDPA allocated = 23243.29590 MB
On chunked entry = 23243.29590 MB
On scale calculation = 23243.30371 MB
Before interleave = 23243.30371 MB
After interleave = 23243.80371 MB
After matmul = 23251.93066 MB
Before local copies matmul = 23251.93066 MB
After local copies = 23251.93359 MB
After first SDPA allocated = 23251.42090 MB
After first copy allocated = 23251.42090 MB
On chunked entry = 23251.42090 MB
On scale calculation = 23251.42871 MB
Before interleave = 23251.42871 MB
After interleave = 23251.91309 MB
After matmul = 23251.91504 MB
Before local copies matmul = 23251.91504 MB
After local copies = 23251.91797 MB
fter compute chunk allocated = 23251.42090 MB
Memory after cuda sdpa 23251.4287109375 MB
1
Memory before offload  23251.4072265625 MB
Memory after offload  23251.4072265625 MB
Memory before cuda sdpa 23251.4208984375 MB
On entering CUDA sdpa main function  allocated = 23251.42090 MB
Before first SDPA allocated = 23251.42090 MB
On chunked entry = 23251.42090 MB
On scale calculation = 23251.42871 MB
Before interleave = 23251.42871 MB
After interleave = 23251.92871 MB
After matmul = 23260.05566 MB
Before local copies matmul = 23260.05566 MB
After local copies = 23260.05859 MB
After first SDPA allocated = 23259.54590 MB
After first copy allocated = 23259.54590 MB
On chunked entry = 23259.54590 MB
On scale calculation = 23259.55371 MB
Before interleave = 23259.55371 MB
After interleave = 23260.03809 MB
After matmul = 23260.04004 MB
Before local copies matmul = 23260.04004 MB
After local copies = 23260.04297 MB
fter compute chunk allocated = 23259.54590 MB
Memory after cuda sdpa 23259.5537109375 MB
1
Memory before offload  23259.5322265625 MB
Memory after offload  23259.5322265625 MB
Memory before cuda sdpa 23259.5458984375 MB
On entering CUDA sdpa main function  allocated = 23259.54590 MB
Before first SDPA allocated = 23259.54590 MB
On chunked entry = 23259.54590 MB
On scale calculation = 23259.55371 MB
Before interleave = 23259.55371 MB
After interleave = 23260.05371 MB
After matmul = 23268.18066 MB
Before local copies matmul = 23268.18066 MB
After local copies = 23268.18359 MB
After first SDPA allocated = 23267.67090 MB
After first copy allocated = 23267.67090 MB
On chunked entry = 23267.67090 MB
On scale calculation = 23267.67871 MB
Before interleave = 23267.67871 MB
After interleave = 23268.16309 MB
After matmul = 23268.16504 MB
Before local copies matmul = 23268.16504 MB
After local copies = 23268.16797 MB
fter compute chunk allocated = 23267.67090 MB
Memory after cuda sdpa 23267.6787109375 MB
1
Memory before offload  23267.6572265625 MB
Memory after offload  23267.6572265625 MB
Memory before cuda sdpa 23267.6708984375 MB
On entering CUDA sdpa main function  allocated = 23267.67090 MB
Before first SDPA allocated = 23267.67090 MB
On chunked entry = 23267.67090 MB
On scale calculation = 23267.67871 MB
Before interleave = 23267.67871 MB
After interleave = 23268.17871 MB
After matmul = 23276.30566 MB
Before local copies matmul = 23276.30566 MB
After local copies = 23276.30859 MB
After first SDPA allocated = 23275.79590 MB
After first copy allocated = 23275.79590 MB
On chunked entry = 23275.79590 MB
On scale calculation = 23275.80371 MB
Before interleave = 23275.80371 MB
After interleave = 23276.28809 MB
After matmul = 23276.29004 MB
Before local copies matmul = 23276.29004 MB
After local copies = 23276.29297 MB
fter compute chunk allocated = 23275.79590 MB
Memory after cuda sdpa 23275.8037109375 MB
1
Memory before offload  23275.7822265625 MB
Memory after offload  23275.7822265625 MB
Memory before cuda sdpa 23275.7958984375 MB
On entering CUDA sdpa main function  allocated = 23275.79590 MB
Before first SDPA allocated = 23275.79590 MB
On chunked entry = 23275.79590 MB
On scale calculation = 23275.80371 MB
Before interleave = 23275.80371 MB
After interleave = 23276.30371 MB
After matmul = 23284.43066 MB
Before local copies matmul = 23284.43066 MB
After local copies = 23284.43359 MB
After first SDPA allocated = 23283.92090 MB
After first copy allocated = 23283.92090 MB
On chunked entry = 23283.92090 MB
On scale calculation = 23283.92871 MB
Before interleave = 23283.92871 MB
After interleave = 23284.41309 MB
After matmul = 23284.41504 MB
Before local copies matmul = 23284.41504 MB
After local copies = 23284.41797 MB
fter compute chunk allocated = 23283.92090 MB
Memory after cuda sdpa 23283.9287109375 MB
1
Memory before offload  23283.9072265625 MB
Memory after offload  23283.9072265625 MB
Memory before cuda sdpa 23283.9208984375 MB
On entering CUDA sdpa main function  allocated = 23283.92090 MB
Before first SDPA allocated = 23283.92090 MB
On chunked entry = 23283.92090 MB
On scale calculation = 23283.92871 MB
Before interleave = 23283.92871 MB
After interleave = 23284.42871 MB
After matmul = 23292.55566 MB
Before local copies matmul = 23292.55566 MB
After local copies = 23292.55859 MB
After first SDPA allocated = 23292.04590 MB
After first copy allocated = 23292.04590 MB
On chunked entry = 23292.04590 MB
On scale calculation = 23292.05371 MB
Before interleave = 23292.05371 MB
After interleave = 23292.53809 MB
After matmul = 23292.54004 MB
Before local copies matmul = 23292.54004 MB
After local copies = 23292.54297 MB
fter compute chunk allocated = 23292.04590 MB
Memory after cuda sdpa 23292.0537109375 MB
1
Memory before offload  23292.0322265625 MB
Memory after offload  23292.0322265625 MB
Memory before cuda sdpa 23292.0458984375 MB
On entering CUDA sdpa main function  allocated = 23292.04590 MB
Before first SDPA allocated = 23292.04590 MB
On chunked entry = 23292.04590 MB
On scale calculation = 23292.05371 MB
Before interleave = 23292.05371 MB
After interleave = 23292.55371 MB
After matmul = 23300.68066 MB
Before local copies matmul = 23300.68066 MB
After local copies = 23300.68359 MB
After first SDPA allocated = 23300.17090 MB
After first copy allocated = 23300.17090 MB
On chunked entry = 23300.17090 MB
On scale calculation = 23300.17871 MB
Before interleave = 23300.17871 MB
After interleave = 23300.66309 MB
After matmul = 23300.66504 MB
Before local copies matmul = 23300.66504 MB
After local copies = 23300.66797 MB
fter compute chunk allocated = 23300.17090 MB
Memory after cuda sdpa 23300.1787109375 MB
1
Memory before offload  23300.1572265625 MB
Memory after offload  23300.1572265625 MB
Memory before cuda sdpa 23300.1708984375 MB
On entering CUDA sdpa main function  allocated = 23300.17090 MB
Before first SDPA allocated = 23300.17090 MB
On chunked entry = 23300.17090 MB
On scale calculation = 23300.17871 MB
Before interleave = 23300.17871 MB
After interleave = 23300.67871 MB
After matmul = 23308.80566 MB
Before local copies matmul = 23308.80566 MB
After local copies = 23308.80859 MB
After first SDPA allocated = 23308.29590 MB
After first copy allocated = 23308.29590 MB
On chunked entry = 23308.29590 MB
On scale calculation = 23308.30371 MB
Before interleave = 23308.30371 MB
After interleave = 23308.78809 MB
After matmul = 23308.79004 MB
Before local copies matmul = 23308.79004 MB
After local copies = 23308.79297 MB
fter compute chunk allocated = 23308.29590 MB
Memory after cuda sdpa 23308.3037109375 MB
1
Memory before offload  23308.2822265625 MB
Memory after offload  23308.2822265625 MB
Memory before cuda sdpa 23308.2958984375 MB
On entering CUDA sdpa main function  allocated = 23308.29590 MB
Before first SDPA allocated = 23308.29590 MB
On chunked entry = 23308.29590 MB
On scale calculation = 23308.30371 MB
Before interleave = 23308.30371 MB
After interleave = 23308.80371 MB
After matmul = 23316.93066 MB
Before local copies matmul = 23316.93066 MB
After local copies = 23316.93359 MB
After first SDPA allocated = 23316.42090 MB
After first copy allocated = 23316.42090 MB
On chunked entry = 23316.42090 MB
On scale calculation = 23316.42871 MB
Before interleave = 23316.42871 MB
After interleave = 23316.91309 MB
After matmul = 23316.91504 MB
Before local copies matmul = 23316.91504 MB
After local copies = 23316.91797 MB
fter compute chunk allocated = 23316.42090 MB
Memory after cuda sdpa 23316.4287109375 MB
1
Memory before offload  23316.4072265625 MB
Memory after offload  23316.4072265625 MB
Memory before cuda sdpa 23316.4208984375 MB
On entering CUDA sdpa main function  allocated = 23316.42090 MB
Before first SDPA allocated = 23316.42090 MB
On chunked entry = 23316.42090 MB
On scale calculation = 23316.42871 MB
Before interleave = 23316.42871 MB
After interleave = 23316.92871 MB
After matmul = 23325.05566 MB
Before local copies matmul = 23325.05566 MB
After local copies = 23325.05859 MB
After first SDPA allocated = 23324.54590 MB
After first copy allocated = 23324.54590 MB
On chunked entry = 23324.54590 MB
On scale calculation = 23324.55371 MB
Before interleave = 23324.55371 MB
After interleave = 23325.03809 MB
After matmul = 23325.04004 MB
Before local copies matmul = 23325.04004 MB
After local copies = 23325.04297 MB
fter compute chunk allocated = 23324.54590 MB
Memory after cuda sdpa 23324.5537109375 MB
1
Memory before offload  23324.5322265625 MB
Memory after offload  23324.5322265625 MB
Memory before cuda sdpa 23324.5458984375 MB
On entering CUDA sdpa main function  allocated = 23324.54590 MB
Before first SDPA allocated = 23324.54590 MB
On chunked entry = 23324.54590 MB
On scale calculation = 23324.55371 MB
Before interleave = 23324.55371 MB
After interleave = 23325.05371 MB
After matmul = 23333.18066 MB
Before local copies matmul = 23333.18066 MB
After local copies = 23333.18359 MB
After first SDPA allocated = 23332.67090 MB
After first copy allocated = 23332.67090 MB
On chunked entry = 23332.67090 MB
On scale calculation = 23332.67871 MB
Before interleave = 23332.67871 MB
After interleave = 23333.16309 MB
After matmul = 23333.16504 MB
Before local copies matmul = 23333.16504 MB
After local copies = 23333.16797 MB
fter compute chunk allocated = 23332.67090 MB
Memory after cuda sdpa 23332.6787109375 MB
1
Memory before offload  23332.6572265625 MB
Memory after offload  23332.6572265625 MB
Memory before cuda sdpa 23332.6708984375 MB
On entering CUDA sdpa main function  allocated = 23332.67090 MB
Before first SDPA allocated = 23332.67090 MB
On chunked entry = 23332.67090 MB
On scale calculation = 23332.67871 MB
Before interleave = 23332.67871 MB
After interleave = 23333.17871 MB
After matmul = 23341.30566 MB
Before local copies matmul = 23341.30566 MB
After local copies = 23341.30859 MB
After first SDPA allocated = 23340.79590 MB
After first copy allocated = 23340.79590 MB
On chunked entry = 23340.79590 MB
On scale calculation = 23340.80371 MB
Before interleave = 23340.80371 MB
After interleave = 23341.28809 MB
After matmul = 23341.29004 MB
Before local copies matmul = 23341.29004 MB
After local copies = 23341.29297 MB
fter compute chunk allocated = 23340.79590 MB
Memory after cuda sdpa 23340.8037109375 MB
1
Memory before offload  23340.7822265625 MB
Memory after offload  23340.7822265625 MB
Memory before cuda sdpa 23340.7958984375 MB
On entering CUDA sdpa main function  allocated = 23340.79590 MB
Before first SDPA allocated = 23340.79590 MB
On chunked entry = 23340.79590 MB
On scale calculation = 23340.80371 MB
Before interleave = 23340.80371 MB
After interleave = 23341.30371 MB
After matmul = 23349.43066 MB
Before local copies matmul = 23349.43066 MB
After local copies = 23349.43359 MB
After first SDPA allocated = 23348.92090 MB
After first copy allocated = 23348.92090 MB
On chunked entry = 23348.92090 MB
On scale calculation = 23348.92871 MB
Before interleave = 23348.92871 MB
After interleave = 23349.41309 MB
After matmul = 23349.41504 MB
Before local copies matmul = 23349.41504 MB
After local copies = 23349.41797 MB
fter compute chunk allocated = 23348.92090 MB
Memory after cuda sdpa 23348.9287109375 MB
1
Memory before offload  23348.9072265625 MB
Memory after offload  23348.9072265625 MB
Memory before cuda sdpa 23348.9208984375 MB
On entering CUDA sdpa main function  allocated = 23348.92090 MB
Before first SDPA allocated = 23348.92090 MB
On chunked entry = 23348.92090 MB
On scale calculation = 23348.92871 MB
Before interleave = 23348.92871 MB
After interleave = 23349.42871 MB
After matmul = 23357.55566 MB
Before local copies matmul = 23357.55566 MB
After local copies = 23357.55859 MB
After first SDPA allocated = 23357.04590 MB
After first copy allocated = 23357.04590 MB
On chunked entry = 23357.04590 MB
On scale calculation = 23357.05371 MB
Before interleave = 23357.05371 MB
After interleave = 23357.53809 MB
After matmul = 23357.54004 MB
Before local copies matmul = 23357.54004 MB
After local copies = 23357.54297 MB
fter compute chunk allocated = 23357.04590 MB
Memory after cuda sdpa 23357.0537109375 MB
1
Memory before offload  23357.0322265625 MB
Memory after offload  23357.0322265625 MB
Memory before cuda sdpa 23357.0458984375 MB
On entering CUDA sdpa main function  allocated = 23357.04590 MB
Before first SDPA allocated = 23357.04590 MB
On chunked entry = 23357.04590 MB
On scale calculation = 23357.05371 MB
Before interleave = 23357.05371 MB
After interleave = 23357.55371 MB
After matmul = 23365.68066 MB
Before local copies matmul = 23365.68066 MB
After local copies = 23365.68359 MB
After first SDPA allocated = 23365.17090 MB
After first copy allocated = 23365.17090 MB
On chunked entry = 23365.17090 MB
On scale calculation = 23365.17871 MB
Before interleave = 23365.17871 MB
After interleave = 23365.66309 MB
After matmul = 23365.66504 MB
Before local copies matmul = 23365.66504 MB
After local copies = 23365.66797 MB
fter compute chunk allocated = 23365.17090 MB
Memory after cuda sdpa 23365.1787109375 MB
1
Memory before offload  23365.1572265625 MB
Memory after offload  23365.1572265625 MB
Memory before cuda sdpa 23365.1708984375 MB
On entering CUDA sdpa main function  allocated = 23365.17090 MB
Before first SDPA allocated = 23365.17090 MB
On chunked entry = 23365.17090 MB
On scale calculation = 23365.17871 MB
Before interleave = 23365.17871 MB
After interleave = 23365.67871 MB
After matmul = 23373.80566 MB
Before local copies matmul = 23373.80566 MB
After local copies = 23373.80859 MB
After first SDPA allocated = 23373.29590 MB
After first copy allocated = 23373.29590 MB
On chunked entry = 23373.29590 MB
On scale calculation = 23373.30371 MB
Before interleave = 23373.30371 MB
After interleave = 23373.78809 MB
After matmul = 23373.79004 MB
Before local copies matmul = 23373.79004 MB
After local copies = 23373.79297 MB
fter compute chunk allocated = 23373.29590 MB
Memory after cuda sdpa 23373.3037109375 MB
1
Memory before offload  23373.2822265625 MB
Memory after offload  23373.2822265625 MB
Memory before cuda sdpa 23373.2958984375 MB
On entering CUDA sdpa main function  allocated = 23373.29590 MB
Before first SDPA allocated = 23373.29590 MB
On chunked entry = 23373.29590 MB
On scale calculation = 23373.30371 MB
Before interleave = 23373.30371 MB
After interleave = 23373.80371 MB
After matmul = 23381.93066 MB
Before local copies matmul = 23381.93066 MB
After local copies = 23381.93359 MB
After first SDPA allocated = 23381.42090 MB
After first copy allocated = 23381.42090 MB
On chunked entry = 23381.42090 MB
On scale calculation = 23381.42871 MB
Before interleave = 23381.42871 MB
After interleave = 23381.91309 MB
After matmul = 23381.91504 MB
Before local copies matmul = 23381.91504 MB
After local copies = 23381.91797 MB
fter compute chunk allocated = 23381.42090 MB
Memory after cuda sdpa 23381.4287109375 MB
1
Memory before offload  23381.4072265625 MB
Memory after offload  23381.4072265625 MB
Memory before cuda sdpa 23381.4208984375 MB
On entering CUDA sdpa main function  allocated = 23381.42090 MB
Before first SDPA allocated = 23381.42090 MB
On chunked entry = 23381.42090 MB
On scale calculation = 23381.42871 MB
Before interleave = 23381.42871 MB
After interleave = 23381.92871 MB
After matmul = 23390.05566 MB
Before local copies matmul = 23390.05566 MB
After local copies = 23390.05859 MB
After first SDPA allocated = 23389.54590 MB
After first copy allocated = 23389.54590 MB
On chunked entry = 23389.54590 MB
On scale calculation = 23389.55371 MB
Before interleave = 23389.55371 MB
After interleave = 23390.03809 MB
After matmul = 23390.04004 MB
Before local copies matmul = 23390.04004 MB
After local copies = 23390.04297 MB
fter compute chunk allocated = 23389.54590 MB
Memory after cuda sdpa 23389.5537109375 MB
1
Memory before offload  23389.5322265625 MB
Memory after offload  23389.5322265625 MB
Memory before cuda sdpa 23389.5458984375 MB
On entering CUDA sdpa main function  allocated = 23389.54590 MB
Before first SDPA allocated = 23389.54590 MB
On chunked entry = 23389.54590 MB
On scale calculation = 23389.55371 MB
Before interleave = 23389.55371 MB
After interleave = 23390.05371 MB
After matmul = 23398.18066 MB
Before local copies matmul = 23398.18066 MB
After local copies = 23398.18359 MB
After first SDPA allocated = 23397.67090 MB
After first copy allocated = 23397.67090 MB
On chunked entry = 23397.67090 MB
On scale calculation = 23397.67871 MB
Before interleave = 23397.67871 MB
After interleave = 23398.16309 MB
After matmul = 23398.16504 MB
Before local copies matmul = 23398.16504 MB
After local copies = 23398.16797 MB
fter compute chunk allocated = 23397.67090 MB
Memory after cuda sdpa 23397.6787109375 MB
1
Memory before offload  23397.6572265625 MB
Memory after offload  23397.6572265625 MB
Memory before cuda sdpa 23397.6708984375 MB
On entering CUDA sdpa main function  allocated = 23397.67090 MB
Before first SDPA allocated = 23397.67090 MB
On chunked entry = 23397.67090 MB
On scale calculation = 23397.67871 MB
Before interleave = 23397.67871 MB
After interleave = 23398.17871 MB
After matmul = 23406.30566 MB
Before local copies matmul = 23406.30566 MB
After local copies = 23406.30859 MB
After first SDPA allocated = 23405.79590 MB
After first copy allocated = 23405.79590 MB
On chunked entry = 23405.79590 MB
On scale calculation = 23405.80371 MB
Before interleave = 23405.80371 MB
After interleave = 23406.28809 MB
After matmul = 23406.29004 MB
Before local copies matmul = 23406.29004 MB
After local copies = 23406.29297 MB
fter compute chunk allocated = 23405.79590 MB
Memory after cuda sdpa 23405.8037109375 MB
Decode step 32
1
Memory before offload  23405.78271484375 MB
Memory after offload  23405.78271484375 MB
Memory before cuda sdpa 23405.79638671875 MB
On entering CUDA sdpa main function  allocated = 23405.79639 MB
Before first SDPA allocated = 23405.79639 MB
On chunked entry = 23405.79639 MB
On scale calculation = 23405.80420 MB
Before interleave = 23405.80420 MB
After interleave = 23406.30420 MB
After matmul = 23414.43115 MB
Before local copies matmul = 23414.43115 MB
After local copies = 23414.43408 MB
After first SDPA allocated = 23413.92139 MB
After first copy allocated = 23413.92139 MB
On chunked entry = 23413.92139 MB
On scale calculation = 23413.92920 MB
Before interleave = 23413.92920 MB
After interleave = 23414.42920 MB
After matmul = 23414.43115 MB
Before local copies matmul = 23414.43115 MB
After local copies = 23414.43408 MB
fter compute chunk allocated = 23413.92139 MB
Memory after cuda sdpa 23413.92919921875 MB
1
Memory before offload  23413.90771484375 MB
Memory after offload  23413.90771484375 MB
Memory before cuda sdpa 23413.92138671875 MB
On entering CUDA sdpa main function  allocated = 23413.92139 MB
Before first SDPA allocated = 23413.92139 MB
On chunked entry = 23413.92139 MB
On scale calculation = 23413.92920 MB
Before interleave = 23413.92920 MB
After interleave = 23414.42920 MB
After matmul = 23422.55615 MB
Before local copies matmul = 23422.55615 MB
After local copies = 23422.55908 MB
After first SDPA allocated = 23422.04639 MB
After first copy allocated = 23422.04639 MB
On chunked entry = 23422.04639 MB
On scale calculation = 23422.05420 MB
Before interleave = 23422.05420 MB
After interleave = 23422.55420 MB
After matmul = 23422.55615 MB
Before local copies matmul = 23422.55615 MB
After local copies = 23422.55908 MB
fter compute chunk allocated = 23422.04639 MB
Memory after cuda sdpa 23422.05419921875 MB
1
Memory before offload  23422.03271484375 MB
Memory after offload  23422.03271484375 MB
Memory before cuda sdpa 23422.04638671875 MB
On entering CUDA sdpa main function  allocated = 23422.04639 MB
Before first SDPA allocated = 23422.04639 MB
On chunked entry = 23422.04639 MB
On scale calculation = 23422.05420 MB
Before interleave = 23422.05420 MB
After interleave = 23422.55420 MB
After matmul = 23430.68115 MB
Before local copies matmul = 23430.68115 MB
After local copies = 23430.68408 MB
After first SDPA allocated = 23430.17139 MB
After first copy allocated = 23430.17139 MB
On chunked entry = 23430.17139 MB
On scale calculation = 23430.17920 MB
Before interleave = 23430.17920 MB
After interleave = 23430.67920 MB
After matmul = 23430.68115 MB
Before local copies matmul = 23430.68115 MB
After local copies = 23430.68408 MB
fter compute chunk allocated = 23430.17139 MB
Memory after cuda sdpa 23430.17919921875 MB
1
Memory before offload  23430.15771484375 MB
Memory after offload  23430.15771484375 MB
Memory before cuda sdpa 23430.17138671875 MB
On entering CUDA sdpa main function  allocated = 23430.17139 MB
Before first SDPA allocated = 23430.17139 MB
On chunked entry = 23430.17139 MB
On scale calculation = 23430.17920 MB
Before interleave = 23430.17920 MB
After interleave = 23430.67920 MB
After matmul = 23438.80615 MB
Before local copies matmul = 23438.80615 MB
After local copies = 23438.80908 MB
After first SDPA allocated = 23438.29639 MB
After first copy allocated = 23438.29639 MB
On chunked entry = 23438.29639 MB
On scale calculation = 23438.30420 MB
Before interleave = 23438.30420 MB
After interleave = 23438.80420 MB
After matmul = 23438.80615 MB
Before local copies matmul = 23438.80615 MB
After local copies = 23438.80908 MB
fter compute chunk allocated = 23438.29639 MB
Memory after cuda sdpa 23438.30419921875 MB
1
Memory before offload  23438.28271484375 MB
Memory after offload  23438.28271484375 MB
Memory before cuda sdpa 23438.29638671875 MB
On entering CUDA sdpa main function  allocated = 23438.29639 MB
Before first SDPA allocated = 23438.29639 MB
On chunked entry = 23438.29639 MB
On scale calculation = 23438.30420 MB
Before interleave = 23438.30420 MB
After interleave = 23438.80420 MB
After matmul = 23446.93115 MB
Before local copies matmul = 23446.93115 MB
After local copies = 23446.93408 MB
After first SDPA allocated = 23446.42139 MB
After first copy allocated = 23446.42139 MB
On chunked entry = 23446.42139 MB
On scale calculation = 23446.42920 MB
Before interleave = 23446.42920 MB
After interleave = 23446.92920 MB
After matmul = 23446.93115 MB
Before local copies matmul = 23446.93115 MB
After local copies = 23446.93408 MB
fter compute chunk allocated = 23446.42139 MB
Memory after cuda sdpa 23446.42919921875 MB
1
Memory before offload  23446.40771484375 MB
Memory after offload  23446.40771484375 MB
Memory before cuda sdpa 23446.42138671875 MB
On entering CUDA sdpa main function  allocated = 23446.42139 MB
Before first SDPA allocated = 23446.42139 MB
On chunked entry = 23446.42139 MB
On scale calculation = 23446.42920 MB
Before interleave = 23446.42920 MB
After interleave = 23446.92920 MB
After matmul = 23455.05615 MB
Before local copies matmul = 23455.05615 MB
After local copies = 23455.05908 MB
After first SDPA allocated = 23454.54639 MB
After first copy allocated = 23454.54639 MB
On chunked entry = 23454.54639 MB
On scale calculation = 23454.55420 MB
Before interleave = 23454.55420 MB
After interleave = 23455.05420 MB
After matmul = 23455.05615 MB
Before local copies matmul = 23455.05615 MB
After local copies = 23455.05908 MB
fter compute chunk allocated = 23454.54639 MB
Memory after cuda sdpa 23454.55419921875 MB
1
Memory before offload  23454.53271484375 MB
Memory after offload  23454.53271484375 MB
Memory before cuda sdpa 23454.54638671875 MB
On entering CUDA sdpa main function  allocated = 23454.54639 MB
Before first SDPA allocated = 23454.54639 MB
On chunked entry = 23454.54639 MB
On scale calculation = 23454.55420 MB
Before interleave = 23454.55420 MB
After interleave = 23455.05420 MB
After matmul = 23463.18115 MB
Before local copies matmul = 23463.18115 MB
After local copies = 23463.18408 MB
After first SDPA allocated = 23462.67139 MB
After first copy allocated = 23462.67139 MB
On chunked entry = 23462.67139 MB
On scale calculation = 23462.67920 MB
Before interleave = 23462.67920 MB
After interleave = 23463.17920 MB
After matmul = 23463.18115 MB
Before local copies matmul = 23463.18115 MB
After local copies = 23463.18408 MB
fter compute chunk allocated = 23462.67139 MB
Memory after cuda sdpa 23462.67919921875 MB
1
Memory before offload  23462.65771484375 MB
Memory after offload  23462.65771484375 MB
Memory before cuda sdpa 23462.67138671875 MB
On entering CUDA sdpa main function  allocated = 23462.67139 MB
Before first SDPA allocated = 23462.67139 MB
On chunked entry = 23462.67139 MB
On scale calculation = 23462.67920 MB
Before interleave = 23462.67920 MB
After interleave = 23463.17920 MB
After matmul = 23471.30615 MB
Before local copies matmul = 23471.30615 MB
After local copies = 23471.30908 MB
After first SDPA allocated = 23470.79639 MB
After first copy allocated = 23470.79639 MB
On chunked entry = 23470.79639 MB
On scale calculation = 23470.80420 MB
Before interleave = 23470.80420 MB
After interleave = 23471.30420 MB
After matmul = 23471.30615 MB
Before local copies matmul = 23471.30615 MB
After local copies = 23471.30908 MB
fter compute chunk allocated = 23470.79639 MB
Memory after cuda sdpa 23470.80419921875 MB
1
Memory before offload  23470.78271484375 MB
Memory after offload  23470.78271484375 MB
Memory before cuda sdpa 23470.79638671875 MB
On entering CUDA sdpa main function  allocated = 23470.79639 MB
Before first SDPA allocated = 23470.79639 MB
On chunked entry = 23470.79639 MB
On scale calculation = 23470.80420 MB
Before interleave = 23470.80420 MB
After interleave = 23471.30420 MB
After matmul = 23479.43115 MB
Before local copies matmul = 23479.43115 MB
After local copies = 23479.43408 MB
After first SDPA allocated = 23478.92139 MB
After first copy allocated = 23478.92139 MB
On chunked entry = 23478.92139 MB
On scale calculation = 23478.92920 MB
Before interleave = 23478.92920 MB
After interleave = 23479.42920 MB
After matmul = 23479.43115 MB
Before local copies matmul = 23479.43115 MB
After local copies = 23479.43408 MB
fter compute chunk allocated = 23478.92139 MB
Memory after cuda sdpa 23478.92919921875 MB
1
Memory before offload  23478.90771484375 MB
Memory after offload  23478.90771484375 MB
Memory before cuda sdpa 23478.92138671875 MB
On entering CUDA sdpa main function  allocated = 23478.92139 MB
Before first SDPA allocated = 23478.92139 MB
On chunked entry = 23478.92139 MB
On scale calculation = 23478.92920 MB
Before interleave = 23478.92920 MB
After interleave = 23479.42920 MB
After matmul = 23487.55615 MB
Before local copies matmul = 23487.55615 MB
After local copies = 23487.55908 MB
After first SDPA allocated = 23487.04639 MB
After first copy allocated = 23487.04639 MB
On chunked entry = 23487.04639 MB
On scale calculation = 23487.05420 MB
Before interleave = 23487.05420 MB
After interleave = 23487.55420 MB
After matmul = 23487.55615 MB
Before local copies matmul = 23487.55615 MB
After local copies = 23487.55908 MB
fter compute chunk allocated = 23487.04639 MB
Memory after cuda sdpa 23487.05419921875 MB
1
Memory before offload  23487.03271484375 MB
Memory after offload  23487.03271484375 MB
Memory before cuda sdpa 23487.04638671875 MB
On entering CUDA sdpa main function  allocated = 23487.04639 MB
Before first SDPA allocated = 23487.04639 MB
On chunked entry = 23487.04639 MB
On scale calculation = 23487.05420 MB
Before interleave = 23487.05420 MB
After interleave = 23487.55420 MB
After matmul = 23495.68115 MB
Before local copies matmul = 23495.68115 MB
After local copies = 23495.68408 MB
After first SDPA allocated = 23495.17139 MB
After first copy allocated = 23495.17139 MB
On chunked entry = 23495.17139 MB
On scale calculation = 23495.17920 MB
Before interleave = 23495.17920 MB
After interleave = 23495.67920 MB
After matmul = 23495.68115 MB
Before local copies matmul = 23495.68115 MB
After local copies = 23495.68408 MB
fter compute chunk allocated = 23495.17139 MB
Memory after cuda sdpa 23495.17919921875 MB
1
Memory before offload  23495.15771484375 MB
Memory after offload  23495.15771484375 MB
Memory before cuda sdpa 23495.17138671875 MB
On entering CUDA sdpa main function  allocated = 23495.17139 MB
Before first SDPA allocated = 23495.17139 MB
On chunked entry = 23495.17139 MB
On scale calculation = 23495.17920 MB
Before interleave = 23495.17920 MB
After interleave = 23495.67920 MB
After matmul = 23503.80615 MB
Before local copies matmul = 23503.80615 MB
After local copies = 23503.80908 MB
After first SDPA allocated = 23503.29639 MB
After first copy allocated = 23503.29639 MB
On chunked entry = 23503.29639 MB
On scale calculation = 23503.30420 MB
Before interleave = 23503.30420 MB
After interleave = 23503.80420 MB
After matmul = 23503.80615 MB
Before local copies matmul = 23503.80615 MB
After local copies = 23503.80908 MB
fter compute chunk allocated = 23503.29639 MB
Memory after cuda sdpa 23503.30419921875 MB
1
Memory before offload  23503.28271484375 MB
Memory after offload  23503.28271484375 MB
Memory before cuda sdpa 23503.29638671875 MB
On entering CUDA sdpa main function  allocated = 23503.29639 MB
Before first SDPA allocated = 23503.29639 MB
On chunked entry = 23503.29639 MB
On scale calculation = 23503.30420 MB
Before interleave = 23503.30420 MB
After interleave = 23503.80420 MB
After matmul = 23511.93115 MB
Before local copies matmul = 23511.93115 MB
After local copies = 23511.93408 MB
After first SDPA allocated = 23511.42139 MB
After first copy allocated = 23511.42139 MB
On chunked entry = 23511.42139 MB
On scale calculation = 23511.42920 MB
Before interleave = 23511.42920 MB
After interleave = 23511.92920 MB
After matmul = 23511.93115 MB
Before local copies matmul = 23511.93115 MB
After local copies = 23511.93408 MB
fter compute chunk allocated = 23511.42139 MB
Memory after cuda sdpa 23511.42919921875 MB
1
Memory before offload  23511.40771484375 MB
Memory after offload  23511.40771484375 MB
Memory before cuda sdpa 23511.42138671875 MB
On entering CUDA sdpa main function  allocated = 23511.42139 MB
Before first SDPA allocated = 23511.42139 MB
On chunked entry = 23511.42139 MB
On scale calculation = 23511.42920 MB
Before interleave = 23511.42920 MB
After interleave = 23511.92920 MB
After matmul = 23520.05615 MB
Before local copies matmul = 23520.05615 MB
After local copies = 23520.05908 MB
After first SDPA allocated = 23519.54639 MB
After first copy allocated = 23519.54639 MB
On chunked entry = 23519.54639 MB
On scale calculation = 23519.55420 MB
Before interleave = 23519.55420 MB
After interleave = 23520.05420 MB
After matmul = 23520.05615 MB
Before local copies matmul = 23520.05615 MB
After local copies = 23520.05908 MB
fter compute chunk allocated = 23519.54639 MB
Memory after cuda sdpa 23519.55419921875 MB
1
Memory before offload  23519.53271484375 MB
Memory after offload  23519.53271484375 MB
Memory before cuda sdpa 23519.54638671875 MB
On entering CUDA sdpa main function  allocated = 23519.54639 MB
Before first SDPA allocated = 23519.54639 MB
On chunked entry = 23519.54639 MB
On scale calculation = 23519.55420 MB
Before interleave = 23519.55420 MB
After interleave = 23520.05420 MB
After matmul = 23528.18115 MB
Before local copies matmul = 23528.18115 MB
After local copies = 23528.18408 MB
After first SDPA allocated = 23527.67139 MB
After first copy allocated = 23527.67139 MB
On chunked entry = 23527.67139 MB
On scale calculation = 23527.67920 MB
Before interleave = 23527.67920 MB
After interleave = 23528.17920 MB
After matmul = 23528.18115 MB
Before local copies matmul = 23528.18115 MB
After local copies = 23528.18408 MB
fter compute chunk allocated = 23527.67139 MB
Memory after cuda sdpa 23527.67919921875 MB
1
Memory before offload  23527.65771484375 MB
Memory after offload  23527.65771484375 MB
Memory before cuda sdpa 23527.67138671875 MB
On entering CUDA sdpa main function  allocated = 23527.67139 MB
Before first SDPA allocated = 23527.67139 MB
On chunked entry = 23527.67139 MB
On scale calculation = 23527.67920 MB
Before interleave = 23527.67920 MB
After interleave = 23528.17920 MB
After matmul = 23536.30615 MB
Before local copies matmul = 23536.30615 MB
After local copies = 23536.30908 MB
After first SDPA allocated = 23535.79639 MB
After first copy allocated = 23535.79639 MB
On chunked entry = 23535.79639 MB
On scale calculation = 23535.80420 MB
Before interleave = 23535.80420 MB
After interleave = 23536.30420 MB
After matmul = 23536.30615 MB
Before local copies matmul = 23536.30615 MB
After local copies = 23536.30908 MB
fter compute chunk allocated = 23535.79639 MB
Memory after cuda sdpa 23535.80419921875 MB
1
Memory before offload  23535.78271484375 MB
Memory after offload  23535.78271484375 MB
Memory before cuda sdpa 23535.79638671875 MB
On entering CUDA sdpa main function  allocated = 23535.79639 MB
Before first SDPA allocated = 23535.79639 MB
On chunked entry = 23535.79639 MB
On scale calculation = 23535.80420 MB
Before interleave = 23535.80420 MB
After interleave = 23536.30420 MB
After matmul = 23544.43115 MB
Before local copies matmul = 23544.43115 MB
After local copies = 23544.43408 MB
After first SDPA allocated = 23543.92139 MB
After first copy allocated = 23543.92139 MB
On chunked entry = 23543.92139 MB
On scale calculation = 23543.92920 MB
Before interleave = 23543.92920 MB
After interleave = 23544.42920 MB
After matmul = 23544.43115 MB
Before local copies matmul = 23544.43115 MB
After local copies = 23544.43408 MB
fter compute chunk allocated = 23543.92139 MB
Memory after cuda sdpa 23543.92919921875 MB
1
Memory before offload  23543.90771484375 MB
Memory after offload  23543.90771484375 MB
Memory before cuda sdpa 23543.92138671875 MB
On entering CUDA sdpa main function  allocated = 23543.92139 MB
Before first SDPA allocated = 23543.92139 MB
On chunked entry = 23543.92139 MB
On scale calculation = 23543.92920 MB
Before interleave = 23543.92920 MB
After interleave = 23544.42920 MB
After matmul = 23552.55615 MB
Before local copies matmul = 23552.55615 MB
After local copies = 23552.55908 MB
After first SDPA allocated = 23552.04639 MB
After first copy allocated = 23552.04639 MB
On chunked entry = 23552.04639 MB
On scale calculation = 23552.05420 MB
Before interleave = 23552.05420 MB
After interleave = 23552.55420 MB
After matmul = 23552.55615 MB
Before local copies matmul = 23552.55615 MB
After local copies = 23552.55908 MB
fter compute chunk allocated = 23552.04639 MB
Memory after cuda sdpa 23552.05419921875 MB
1
Memory before offload  23552.03271484375 MB
Memory after offload  23552.03271484375 MB
Memory before cuda sdpa 23552.04638671875 MB
On entering CUDA sdpa main function  allocated = 23552.04639 MB
Before first SDPA allocated = 23552.04639 MB
On chunked entry = 23552.04639 MB
On scale calculation = 23552.05420 MB
Before interleave = 23552.05420 MB
After interleave = 23552.55420 MB
After matmul = 23560.68115 MB
Before local copies matmul = 23560.68115 MB
After local copies = 23560.68408 MB
After first SDPA allocated = 23560.17139 MB
After first copy allocated = 23560.17139 MB
On chunked entry = 23560.17139 MB
On scale calculation = 23560.17920 MB
Before interleave = 23560.17920 MB
After interleave = 23560.67920 MB
After matmul = 23560.68115 MB
Before local copies matmul = 23560.68115 MB
After local copies = 23560.68408 MB
fter compute chunk allocated = 23560.17139 MB
Memory after cuda sdpa 23560.17919921875 MB
1
Memory before offload  23560.15771484375 MB
Memory after offload  23560.15771484375 MB
Memory before cuda sdpa 23560.17138671875 MB
On entering CUDA sdpa main function  allocated = 23560.17139 MB
Before first SDPA allocated = 23560.17139 MB
On chunked entry = 23560.17139 MB
On scale calculation = 23560.17920 MB
Before interleave = 23560.17920 MB
After interleave = 23560.67920 MB
After matmul = 23568.80615 MB
Before local copies matmul = 23568.80615 MB
After local copies = 23568.80908 MB
After first SDPA allocated = 23568.29639 MB
After first copy allocated = 23568.29639 MB
On chunked entry = 23568.29639 MB
On scale calculation = 23568.30420 MB
Before interleave = 23568.30420 MB
After interleave = 23568.80420 MB
After matmul = 23568.80615 MB
Before local copies matmul = 23568.80615 MB
After local copies = 23568.80908 MB
fter compute chunk allocated = 23568.29639 MB
Memory after cuda sdpa 23568.30419921875 MB
1
Memory before offload  23568.28271484375 MB
Memory after offload  23568.28271484375 MB
Memory before cuda sdpa 23568.29638671875 MB
On entering CUDA sdpa main function  allocated = 23568.29639 MB
Before first SDPA allocated = 23568.29639 MB
On chunked entry = 23568.29639 MB
On scale calculation = 23568.30420 MB
Before interleave = 23568.30420 MB
After interleave = 23568.80420 MB
After matmul = 23576.93115 MB
Before local copies matmul = 23576.93115 MB
After local copies = 23576.93408 MB
After first SDPA allocated = 23576.42139 MB
After first copy allocated = 23576.42139 MB
On chunked entry = 23576.42139 MB
On scale calculation = 23576.42920 MB
Before interleave = 23576.42920 MB
After interleave = 23576.92920 MB
After matmul = 23576.93115 MB
Before local copies matmul = 23576.93115 MB
After local copies = 23576.93408 MB
fter compute chunk allocated = 23576.42139 MB
Memory after cuda sdpa 23576.42919921875 MB
1
Memory before offload  23576.40771484375 MB
Memory after offload  23576.40771484375 MB
Memory before cuda sdpa 23576.42138671875 MB
On entering CUDA sdpa main function  allocated = 23576.42139 MB
Before first SDPA allocated = 23576.42139 MB
On chunked entry = 23576.42139 MB
On scale calculation = 23576.42920 MB
Before interleave = 23576.42920 MB
After interleave = 23576.92920 MB
After matmul = 23585.05615 MB
Before local copies matmul = 23585.05615 MB
After local copies = 23585.05908 MB
After first SDPA allocated = 23584.54639 MB
After first copy allocated = 23584.54639 MB
On chunked entry = 23584.54639 MB
On scale calculation = 23584.55420 MB
Before interleave = 23584.55420 MB
After interleave = 23585.05420 MB
After matmul = 23585.05615 MB
Before local copies matmul = 23585.05615 MB
After local copies = 23585.05908 MB
fter compute chunk allocated = 23584.54639 MB
Memory after cuda sdpa 23584.55419921875 MB
1
Memory before offload  23584.53271484375 MB
Memory after offload  23584.53271484375 MB
Memory before cuda sdpa 23584.54638671875 MB
On entering CUDA sdpa main function  allocated = 23584.54639 MB
Before first SDPA allocated = 23584.54639 MB
On chunked entry = 23584.54639 MB
On scale calculation = 23584.55420 MB
Before interleave = 23584.55420 MB
After interleave = 23585.05420 MB
After matmul = 23593.18115 MB
Before local copies matmul = 23593.18115 MB
After local copies = 23593.18408 MB
After first SDPA allocated = 23592.67139 MB
After first copy allocated = 23592.67139 MB
On chunked entry = 23592.67139 MB
On scale calculation = 23592.67920 MB
Before interleave = 23592.67920 MB
After interleave = 23593.17920 MB
After matmul = 23593.18115 MB
Before local copies matmul = 23593.18115 MB
After local copies = 23593.18408 MB
fter compute chunk allocated = 23592.67139 MB
Memory after cuda sdpa 23592.67919921875 MB
1
Memory before offload  23592.65771484375 MB
Memory after offload  23592.65771484375 MB
Memory before cuda sdpa 23592.67138671875 MB
On entering CUDA sdpa main function  allocated = 23592.67139 MB
Before first SDPA allocated = 23592.67139 MB
On chunked entry = 23592.67139 MB
On scale calculation = 23592.67920 MB
Before interleave = 23592.67920 MB
After interleave = 23593.17920 MB
After matmul = 23601.30615 MB
Before local copies matmul = 23601.30615 MB
After local copies = 23601.30908 MB
After first SDPA allocated = 23600.79639 MB
After first copy allocated = 23600.79639 MB
On chunked entry = 23600.79639 MB
On scale calculation = 23600.80420 MB
Before interleave = 23600.80420 MB
After interleave = 23601.30420 MB
After matmul = 23601.30615 MB
Before local copies matmul = 23601.30615 MB
After local copies = 23601.30908 MB
fter compute chunk allocated = 23600.79639 MB
Memory after cuda sdpa 23600.80419921875 MB
1
Memory before offload  23600.78271484375 MB
Memory after offload  23600.78271484375 MB
Memory before cuda sdpa 23600.79638671875 MB
On entering CUDA sdpa main function  allocated = 23600.79639 MB
Before first SDPA allocated = 23600.79639 MB
On chunked entry = 23600.79639 MB
On scale calculation = 23600.80420 MB
Before interleave = 23600.80420 MB
After interleave = 23601.30420 MB
After matmul = 23609.43115 MB
Before local copies matmul = 23609.43115 MB
After local copies = 23609.43408 MB
After first SDPA allocated = 23608.92139 MB
After first copy allocated = 23608.92139 MB
On chunked entry = 23608.92139 MB
On scale calculation = 23608.92920 MB
Before interleave = 23608.92920 MB
After interleave = 23609.42920 MB
After matmul = 23609.43115 MB
Before local copies matmul = 23609.43115 MB
After local copies = 23609.43408 MB
fter compute chunk allocated = 23608.92139 MB
Memory after cuda sdpa 23608.92919921875 MB
1
Memory before offload  23608.90771484375 MB
Memory after offload  23608.90771484375 MB
Memory before cuda sdpa 23608.92138671875 MB
On entering CUDA sdpa main function  allocated = 23608.92139 MB
Before first SDPA allocated = 23608.92139 MB
On chunked entry = 23608.92139 MB
On scale calculation = 23608.92920 MB
Before interleave = 23608.92920 MB
After interleave = 23609.42920 MB
After matmul = 23617.55615 MB
Before local copies matmul = 23617.55615 MB
After local copies = 23617.55908 MB
After first SDPA allocated = 23617.04639 MB
After first copy allocated = 23617.04639 MB
On chunked entry = 23617.04639 MB
On scale calculation = 23617.05420 MB
Before interleave = 23617.05420 MB
After interleave = 23617.55420 MB
After matmul = 23617.55615 MB
Before local copies matmul = 23617.55615 MB
After local copies = 23617.55908 MB
fter compute chunk allocated = 23617.04639 MB
Memory after cuda sdpa 23617.05419921875 MB
1
Memory before offload  23617.03271484375 MB
Memory after offload  23617.03271484375 MB
Memory before cuda sdpa 23617.04638671875 MB
On entering CUDA sdpa main function  allocated = 23617.04639 MB
Before first SDPA allocated = 23617.04639 MB
On chunked entry = 23617.04639 MB
On scale calculation = 23617.05420 MB
Before interleave = 23617.05420 MB
After interleave = 23617.55420 MB
After matmul = 23625.68115 MB
Before local copies matmul = 23625.68115 MB
After local copies = 23625.68408 MB
After first SDPA allocated = 23625.17139 MB
After first copy allocated = 23625.17139 MB
On chunked entry = 23625.17139 MB
On scale calculation = 23625.17920 MB
Before interleave = 23625.17920 MB
After interleave = 23625.67920 MB
After matmul = 23625.68115 MB
Before local copies matmul = 23625.68115 MB
After local copies = 23625.68408 MB
fter compute chunk allocated = 23625.17139 MB
Memory after cuda sdpa 23625.17919921875 MB
1
Memory before offload  23625.15771484375 MB
Memory after offload  23625.15771484375 MB
Memory before cuda sdpa 23625.17138671875 MB
On entering CUDA sdpa main function  allocated = 23625.17139 MB
Before first SDPA allocated = 23625.17139 MB
On chunked entry = 23625.17139 MB
On scale calculation = 23625.17920 MB
Before interleave = 23625.17920 MB
After interleave = 23625.67920 MB
After matmul = 23633.80615 MB
Before local copies matmul = 23633.80615 MB
After local copies = 23633.80908 MB
After first SDPA allocated = 23633.29639 MB
After first copy allocated = 23633.29639 MB
On chunked entry = 23633.29639 MB
On scale calculation = 23633.30420 MB
Before interleave = 23633.30420 MB
After interleave = 23633.80420 MB
After matmul = 23633.80615 MB
Before local copies matmul = 23633.80615 MB
After local copies = 23633.80908 MB
fter compute chunk allocated = 23633.29639 MB
Memory after cuda sdpa 23633.30419921875 MB
1
Memory before offload  23633.28271484375 MB
Memory after offload  23633.28271484375 MB
Memory before cuda sdpa 23633.29638671875 MB
On entering CUDA sdpa main function  allocated = 23633.29639 MB
Before first SDPA allocated = 23633.29639 MB
On chunked entry = 23633.29639 MB
On scale calculation = 23633.30420 MB
Before interleave = 23633.30420 MB
After interleave = 23633.80420 MB
After matmul = 23641.93115 MB
Before local copies matmul = 23641.93115 MB
After local copies = 23641.93408 MB
After first SDPA allocated = 23641.42139 MB
After first copy allocated = 23641.42139 MB
On chunked entry = 23641.42139 MB
On scale calculation = 23641.42920 MB
Before interleave = 23641.42920 MB
After interleave = 23641.92920 MB
After matmul = 23641.93115 MB
Before local copies matmul = 23641.93115 MB
After local copies = 23641.93408 MB
fter compute chunk allocated = 23641.42139 MB
Memory after cuda sdpa 23641.42919921875 MB
1
Memory before offload  23641.40771484375 MB
Memory after offload  23641.40771484375 MB
Memory before cuda sdpa 23641.42138671875 MB
On entering CUDA sdpa main function  allocated = 23641.42139 MB
Before first SDPA allocated = 23641.42139 MB
On chunked entry = 23641.42139 MB
On scale calculation = 23641.42920 MB
Before interleave = 23641.42920 MB
After interleave = 23641.92920 MB
After matmul = 23650.05615 MB
Before local copies matmul = 23650.05615 MB
After local copies = 23650.05908 MB
After first SDPA allocated = 23649.54639 MB
After first copy allocated = 23649.54639 MB
On chunked entry = 23649.54639 MB
On scale calculation = 23649.55420 MB
Before interleave = 23649.55420 MB
After interleave = 23650.05420 MB
After matmul = 23650.05615 MB
Before local copies matmul = 23650.05615 MB
After local copies = 23650.05908 MB
fter compute chunk allocated = 23649.54639 MB
Memory after cuda sdpa 23649.55419921875 MB
1
Memory before offload  23649.53271484375 MB
Memory after offload  23649.53271484375 MB
Memory before cuda sdpa 23649.54638671875 MB
On entering CUDA sdpa main function  allocated = 23649.54639 MB
Before first SDPA allocated = 23649.54639 MB
On chunked entry = 23649.54639 MB
On scale calculation = 23649.55420 MB
Before interleave = 23649.55420 MB
After interleave = 23650.05420 MB
After matmul = 23658.18115 MB
Before local copies matmul = 23658.18115 MB
After local copies = 23658.18408 MB
After first SDPA allocated = 23657.67139 MB
After first copy allocated = 23657.67139 MB
On chunked entry = 23657.67139 MB
On scale calculation = 23657.67920 MB
Before interleave = 23657.67920 MB
After interleave = 23658.17920 MB
After matmul = 23658.18115 MB
Before local copies matmul = 23658.18115 MB
After local copies = 23658.18408 MB
fter compute chunk allocated = 23657.67139 MB
Memory after cuda sdpa 23657.67919921875 MB
1
Memory before offload  23657.65771484375 MB
Memory after offload  23657.65771484375 MB
Memory before cuda sdpa 23657.67138671875 MB
On entering CUDA sdpa main function  allocated = 23657.67139 MB
Before first SDPA allocated = 23657.67139 MB
On chunked entry = 23657.67139 MB
On scale calculation = 23657.67920 MB
Before interleave = 23657.67920 MB
After interleave = 23658.17920 MB
After matmul = 23666.30615 MB
Before local copies matmul = 23666.30615 MB
After local copies = 23666.30908 MB
After first SDPA allocated = 23665.79639 MB
After first copy allocated = 23665.79639 MB
On chunked entry = 23665.79639 MB
On scale calculation = 23665.80420 MB
Before interleave = 23665.80420 MB
After interleave = 23666.30420 MB
After matmul = 23666.30615 MB
Before local copies matmul = 23666.30615 MB
After local copies = 23666.30908 MB
fter compute chunk allocated = 23665.79639 MB
Memory after cuda sdpa 23665.80419921875 MB
Decode step 33
1
Memory before offload  23665.783203125 MB
Memory after offload  23665.783203125 MB
Memory before cuda sdpa 23665.796875 MB
On entering CUDA sdpa main function  allocated = 23665.79688 MB
Before first SDPA allocated = 23665.79688 MB
On chunked entry = 23665.79688 MB
On scale calculation = 23665.80469 MB
Before interleave = 23665.80469 MB
After interleave = 23666.30469 MB
After matmul = 23674.43164 MB
Before local copies matmul = 23674.43164 MB
After local copies = 23674.43457 MB
After first SDPA allocated = 23673.92188 MB
After first copy allocated = 23673.92188 MB
On chunked entry = 23673.92188 MB
On scale calculation = 23673.92969 MB
Before interleave = 23673.92969 MB
After interleave = 23674.44531 MB
After matmul = 23674.44775 MB
Before local copies matmul = 23674.44775 MB
After local copies = 23674.45117 MB
fter compute chunk allocated = 23673.92188 MB
Memory after cuda sdpa 23673.9296875 MB
1
Memory before offload  23673.908203125 MB
Memory after offload  23673.908203125 MB
Memory before cuda sdpa 23673.921875 MB
On entering CUDA sdpa main function  allocated = 23673.92188 MB
Before first SDPA allocated = 23673.92188 MB
On chunked entry = 23673.92188 MB
On scale calculation = 23673.92969 MB
Before interleave = 23673.92969 MB
After interleave = 23674.42969 MB
After matmul = 23682.55664 MB
Before local copies matmul = 23682.55664 MB
After local copies = 23682.55957 MB
After first SDPA allocated = 23682.04688 MB
After first copy allocated = 23682.04688 MB
On chunked entry = 23682.04688 MB
On scale calculation = 23682.05469 MB
Before interleave = 23682.05469 MB
After interleave = 23682.57031 MB
After matmul = 23682.57275 MB
Before local copies matmul = 23682.57275 MB
After local copies = 23682.57617 MB
fter compute chunk allocated = 23682.04688 MB
Memory after cuda sdpa 23682.0546875 MB
1
Memory before offload  23682.033203125 MB
Memory after offload  23682.033203125 MB
Memory before cuda sdpa 23682.046875 MB
On entering CUDA sdpa main function  allocated = 23682.04688 MB
Before first SDPA allocated = 23682.04688 MB
On chunked entry = 23682.04688 MB
On scale calculation = 23682.05469 MB
Before interleave = 23682.05469 MB
After interleave = 23682.55469 MB
After matmul = 23690.68164 MB
Before local copies matmul = 23690.68164 MB
After local copies = 23690.68457 MB
After first SDPA allocated = 23690.17188 MB
After first copy allocated = 23690.17188 MB
On chunked entry = 23690.17188 MB
On scale calculation = 23690.17969 MB
Before interleave = 23690.17969 MB
After interleave = 23690.69531 MB
After matmul = 23690.69775 MB
Before local copies matmul = 23690.69775 MB
After local copies = 23690.70117 MB
fter compute chunk allocated = 23690.17188 MB
Memory after cuda sdpa 23690.1796875 MB
1
Memory before offload  23690.158203125 MB
Memory after offload  23690.158203125 MB
Memory before cuda sdpa 23690.171875 MB
On entering CUDA sdpa main function  allocated = 23690.17188 MB
Before first SDPA allocated = 23690.17188 MB
On chunked entry = 23690.17188 MB
On scale calculation = 23690.17969 MB
Before interleave = 23690.17969 MB
After interleave = 23690.67969 MB
After matmul = 23698.80664 MB
Before local copies matmul = 23698.80664 MB
After local copies = 23698.80957 MB
After first SDPA allocated = 23698.29688 MB
After first copy allocated = 23698.29688 MB
On chunked entry = 23698.29688 MB
On scale calculation = 23698.30469 MB
Before interleave = 23698.30469 MB
After interleave = 23698.82031 MB
After matmul = 23698.82275 MB
Before local copies matmul = 23698.82275 MB
After local copies = 23698.82617 MB
fter compute chunk allocated = 23698.29688 MB
Memory after cuda sdpa 23698.3046875 MB
1
Memory before offload  23698.283203125 MB
Memory after offload  23698.283203125 MB
Memory before cuda sdpa 23698.296875 MB
On entering CUDA sdpa main function  allocated = 23698.29688 MB
Before first SDPA allocated = 23698.29688 MB
On chunked entry = 23698.29688 MB
On scale calculation = 23698.30469 MB
Before interleave = 23698.30469 MB
After interleave = 23698.80469 MB
After matmul = 23706.93164 MB
Before local copies matmul = 23706.93164 MB
After local copies = 23706.93457 MB
After first SDPA allocated = 23706.42188 MB
After first copy allocated = 23706.42188 MB
On chunked entry = 23706.42188 MB
On scale calculation = 23706.42969 MB
Before interleave = 23706.42969 MB
After interleave = 23706.94531 MB
After matmul = 23706.94775 MB
Before local copies matmul = 23706.94775 MB
After local copies = 23706.95117 MB
fter compute chunk allocated = 23706.42188 MB
Memory after cuda sdpa 23706.4296875 MB
1
Memory before offload  23706.408203125 MB
Memory after offload  23706.408203125 MB
Memory before cuda sdpa 23706.421875 MB
On entering CUDA sdpa main function  allocated = 23706.42188 MB
Before first SDPA allocated = 23706.42188 MB
On chunked entry = 23706.42188 MB
On scale calculation = 23706.42969 MB
Before interleave = 23706.42969 MB
After interleave = 23706.92969 MB
After matmul = 23715.05664 MB
Before local copies matmul = 23715.05664 MB
After local copies = 23715.05957 MB
After first SDPA allocated = 23714.54688 MB
After first copy allocated = 23714.54688 MB
On chunked entry = 23714.54688 MB
On scale calculation = 23714.55469 MB
Before interleave = 23714.55469 MB
After interleave = 23715.07031 MB
After matmul = 23715.07275 MB
Before local copies matmul = 23715.07275 MB
After local copies = 23715.07617 MB
fter compute chunk allocated = 23714.54688 MB
Memory after cuda sdpa 23714.5546875 MB
1
Memory before offload  23714.533203125 MB
Memory after offload  23714.533203125 MB
Memory before cuda sdpa 23714.546875 MB
On entering CUDA sdpa main function  allocated = 23714.54688 MB
Before first SDPA allocated = 23714.54688 MB
On chunked entry = 23714.54688 MB
On scale calculation = 23714.55469 MB
Before interleave = 23714.55469 MB
After interleave = 23715.05469 MB
After matmul = 23723.18164 MB
Before local copies matmul = 23723.18164 MB
After local copies = 23723.18457 MB
After first SDPA allocated = 23722.67188 MB
After first copy allocated = 23722.67188 MB
On chunked entry = 23722.67188 MB
On scale calculation = 23722.67969 MB
Before interleave = 23722.67969 MB
After interleave = 23723.19531 MB
After matmul = 23723.19775 MB
Before local copies matmul = 23723.19775 MB
After local copies = 23723.20117 MB
fter compute chunk allocated = 23722.67188 MB
Memory after cuda sdpa 23722.6796875 MB
1
Memory before offload  23722.658203125 MB
Memory after offload  23722.658203125 MB
Memory before cuda sdpa 23722.671875 MB
On entering CUDA sdpa main function  allocated = 23722.67188 MB
Before first SDPA allocated = 23722.67188 MB
On chunked entry = 23722.67188 MB
On scale calculation = 23722.67969 MB
Before interleave = 23722.67969 MB
After interleave = 23723.17969 MB
After matmul = 23731.30664 MB
Before local copies matmul = 23731.30664 MB
After local copies = 23731.30957 MB
After first SDPA allocated = 23730.79688 MB
After first copy allocated = 23730.79688 MB
On chunked entry = 23730.79688 MB
On scale calculation = 23730.80469 MB
Before interleave = 23730.80469 MB
After interleave = 23731.32031 MB
After matmul = 23731.32275 MB
Before local copies matmul = 23731.32275 MB
After local copies = 23731.32617 MB
fter compute chunk allocated = 23730.79688 MB
Memory after cuda sdpa 23730.8046875 MB
1
Memory before offload  23730.783203125 MB
Memory after offload  23730.783203125 MB
Memory before cuda sdpa 23730.796875 MB
On entering CUDA sdpa main function  allocated = 23730.79688 MB
Before first SDPA allocated = 23730.79688 MB
On chunked entry = 23730.79688 MB
On scale calculation = 23730.80469 MB
Before interleave = 23730.80469 MB
After interleave = 23731.30469 MB
After matmul = 23739.43164 MB
Before local copies matmul = 23739.43164 MB
After local copies = 23739.43457 MB
After first SDPA allocated = 23738.92188 MB
After first copy allocated = 23738.92188 MB
On chunked entry = 23738.92188 MB
On scale calculation = 23738.92969 MB
Before interleave = 23738.92969 MB
After interleave = 23739.44531 MB
After matmul = 23739.44775 MB
Before local copies matmul = 23739.44775 MB
After local copies = 23739.45117 MB
fter compute chunk allocated = 23738.92188 MB
Memory after cuda sdpa 23738.9296875 MB
1
Memory before offload  23738.908203125 MB
Memory after offload  23738.908203125 MB
Memory before cuda sdpa 23738.921875 MB
On entering CUDA sdpa main function  allocated = 23738.92188 MB
Before first SDPA allocated = 23738.92188 MB
On chunked entry = 23738.92188 MB
On scale calculation = 23738.92969 MB
Before interleave = 23738.92969 MB
After interleave = 23739.42969 MB
After matmul = 23747.55664 MB
Before local copies matmul = 23747.55664 MB
After local copies = 23747.55957 MB
After first SDPA allocated = 23747.04688 MB
After first copy allocated = 23747.04688 MB
On chunked entry = 23747.04688 MB
On scale calculation = 23747.05469 MB
Before interleave = 23747.05469 MB
After interleave = 23747.57031 MB
After matmul = 23747.57275 MB
Before local copies matmul = 23747.57275 MB
After local copies = 23747.57617 MB
fter compute chunk allocated = 23747.04688 MB
Memory after cuda sdpa 23747.0546875 MB
1
Memory before offload  23747.033203125 MB
Memory after offload  23747.033203125 MB
Memory before cuda sdpa 23747.046875 MB
On entering CUDA sdpa main function  allocated = 23747.04688 MB
Before first SDPA allocated = 23747.04688 MB
On chunked entry = 23747.04688 MB
On scale calculation = 23747.05469 MB
Before interleave = 23747.05469 MB
After interleave = 23747.55469 MB
After matmul = 23755.68164 MB
Before local copies matmul = 23755.68164 MB
After local copies = 23755.68457 MB
After first SDPA allocated = 23755.17188 MB
After first copy allocated = 23755.17188 MB
On chunked entry = 23755.17188 MB
On scale calculation = 23755.17969 MB
Before interleave = 23755.17969 MB
After interleave = 23755.69531 MB
After matmul = 23755.69775 MB
Before local copies matmul = 23755.69775 MB
After local copies = 23755.70117 MB
fter compute chunk allocated = 23755.17188 MB
Memory after cuda sdpa 23755.1796875 MB
1
Memory before offload  23755.158203125 MB
Memory after offload  23755.158203125 MB
Memory before cuda sdpa 23755.171875 MB
On entering CUDA sdpa main function  allocated = 23755.17188 MB
Before first SDPA allocated = 23755.17188 MB
On chunked entry = 23755.17188 MB
On scale calculation = 23755.17969 MB
Before interleave = 23755.17969 MB
After interleave = 23755.67969 MB
After matmul = 23763.80664 MB
Before local copies matmul = 23763.80664 MB
After local copies = 23763.80957 MB
After first SDPA allocated = 23763.29688 MB
After first copy allocated = 23763.29688 MB
On chunked entry = 23763.29688 MB
On scale calculation = 23763.30469 MB
Before interleave = 23763.30469 MB
After interleave = 23763.82031 MB
After matmul = 23763.82275 MB
Before local copies matmul = 23763.82275 MB
After local copies = 23763.82617 MB
fter compute chunk allocated = 23763.29688 MB
Memory after cuda sdpa 23763.3046875 MB
1
Memory before offload  23763.283203125 MB
Memory after offload  23763.283203125 MB
Memory before cuda sdpa 23763.296875 MB
On entering CUDA sdpa main function  allocated = 23763.29688 MB
Before first SDPA allocated = 23763.29688 MB
On chunked entry = 23763.29688 MB
On scale calculation = 23763.30469 MB
Before interleave = 23763.30469 MB
After interleave = 23763.80469 MB
After matmul = 23771.93164 MB
Before local copies matmul = 23771.93164 MB
After local copies = 23771.93457 MB
After first SDPA allocated = 23771.42188 MB
After first copy allocated = 23771.42188 MB
On chunked entry = 23771.42188 MB
On scale calculation = 23771.42969 MB
Before interleave = 23771.42969 MB
After interleave = 23771.94531 MB
After matmul = 23771.94775 MB
Before local copies matmul = 23771.94775 MB
After local copies = 23771.95117 MB
fter compute chunk allocated = 23771.42188 MB
Memory after cuda sdpa 23771.4296875 MB
1
Memory before offload  23771.408203125 MB
Memory after offload  23771.408203125 MB
Memory before cuda sdpa 23771.421875 MB
On entering CUDA sdpa main function  allocated = 23771.42188 MB
Before first SDPA allocated = 23771.42188 MB
On chunked entry = 23771.42188 MB
On scale calculation = 23771.42969 MB
Before interleave = 23771.42969 MB
After interleave = 23771.92969 MB
After matmul = 23780.05664 MB
Before local copies matmul = 23780.05664 MB
After local copies = 23780.05957 MB
After first SDPA allocated = 23779.54688 MB
After first copy allocated = 23779.54688 MB
On chunked entry = 23779.54688 MB
On scale calculation = 23779.55469 MB
Before interleave = 23779.55469 MB
After interleave = 23780.07031 MB
After matmul = 23780.07275 MB
Before local copies matmul = 23780.07275 MB
After local copies = 23780.07617 MB
fter compute chunk allocated = 23779.54688 MB
Memory after cuda sdpa 23779.5546875 MB
1
Memory before offload  23779.533203125 MB
Memory after offload  23779.533203125 MB
Memory before cuda sdpa 23779.546875 MB
On entering CUDA sdpa main function  allocated = 23779.54688 MB
Before first SDPA allocated = 23779.54688 MB
On chunked entry = 23779.54688 MB
On scale calculation = 23779.55469 MB
Before interleave = 23779.55469 MB
After interleave = 23780.05469 MB
After matmul = 23788.18164 MB
Before local copies matmul = 23788.18164 MB
After local copies = 23788.18457 MB
After first SDPA allocated = 23787.67188 MB
After first copy allocated = 23787.67188 MB
On chunked entry = 23787.67188 MB
On scale calculation = 23787.67969 MB
Before interleave = 23787.67969 MB
After interleave = 23788.19531 MB
After matmul = 23788.19775 MB
Before local copies matmul = 23788.19775 MB
After local copies = 23788.20117 MB
fter compute chunk allocated = 23787.67188 MB
Memory after cuda sdpa 23787.6796875 MB
1
Memory before offload  23787.658203125 MB
Memory after offload  23787.658203125 MB
Memory before cuda sdpa 23787.671875 MB
On entering CUDA sdpa main function  allocated = 23787.67188 MB
Before first SDPA allocated = 23787.67188 MB
On chunked entry = 23787.67188 MB
On scale calculation = 23787.67969 MB
Before interleave = 23787.67969 MB
After interleave = 23788.17969 MB
After matmul = 23796.30664 MB
Before local copies matmul = 23796.30664 MB
After local copies = 23796.30957 MB
After first SDPA allocated = 23795.79688 MB
After first copy allocated = 23795.79688 MB
On chunked entry = 23795.79688 MB
On scale calculation = 23795.80469 MB
Before interleave = 23795.80469 MB
After interleave = 23796.32031 MB
After matmul = 23796.32275 MB
Before local copies matmul = 23796.32275 MB
After local copies = 23796.32617 MB
fter compute chunk allocated = 23795.79688 MB
Memory after cuda sdpa 23795.8046875 MB
1
Memory before offload  23795.783203125 MB
Memory after offload  23795.783203125 MB
Memory before cuda sdpa 23795.796875 MB
On entering CUDA sdpa main function  allocated = 23795.79688 MB
Before first SDPA allocated = 23795.79688 MB
On chunked entry = 23795.79688 MB
On scale calculation = 23795.80469 MB
Before interleave = 23795.80469 MB
After interleave = 23796.30469 MB
After matmul = 23804.43164 MB
Before local copies matmul = 23804.43164 MB
After local copies = 23804.43457 MB
After first SDPA allocated = 23803.92188 MB
After first copy allocated = 23803.92188 MB
On chunked entry = 23803.92188 MB
On scale calculation = 23803.92969 MB
Before interleave = 23803.92969 MB
After interleave = 23804.44531 MB
After matmul = 23804.44775 MB
Before local copies matmul = 23804.44775 MB
After local copies = 23804.45117 MB
fter compute chunk allocated = 23803.92188 MB
Memory after cuda sdpa 23803.9296875 MB
1
Memory before offload  23803.908203125 MB
Memory after offload  23803.908203125 MB
Memory before cuda sdpa 23803.921875 MB
On entering CUDA sdpa main function  allocated = 23803.92188 MB
Before first SDPA allocated = 23803.92188 MB
On chunked entry = 23803.92188 MB
On scale calculation = 23803.92969 MB
Before interleave = 23803.92969 MB
After interleave = 23804.42969 MB
After matmul = 23812.55664 MB
Before local copies matmul = 23812.55664 MB
After local copies = 23812.55957 MB
After first SDPA allocated = 23812.04688 MB
After first copy allocated = 23812.04688 MB
On chunked entry = 23812.04688 MB
On scale calculation = 23812.05469 MB
Before interleave = 23812.05469 MB
After interleave = 23812.57031 MB
After matmul = 23812.57275 MB
Before local copies matmul = 23812.57275 MB
After local copies = 23812.57617 MB
fter compute chunk allocated = 23812.04688 MB
Memory after cuda sdpa 23812.0546875 MB
1
Memory before offload  23812.033203125 MB
Memory after offload  23812.033203125 MB
Memory before cuda sdpa 23812.046875 MB
On entering CUDA sdpa main function  allocated = 23812.04688 MB
Before first SDPA allocated = 23812.04688 MB
On chunked entry = 23812.04688 MB
On scale calculation = 23812.05469 MB
Before interleave = 23812.05469 MB
After interleave = 23812.55469 MB
After matmul = 23820.68164 MB
Before local copies matmul = 23820.68164 MB
After local copies = 23820.68457 MB
After first SDPA allocated = 23820.17188 MB
After first copy allocated = 23820.17188 MB
On chunked entry = 23820.17188 MB
On scale calculation = 23820.17969 MB
Before interleave = 23820.17969 MB
After interleave = 23820.69531 MB
After matmul = 23820.69775 MB
Before local copies matmul = 23820.69775 MB
After local copies = 23820.70117 MB
fter compute chunk allocated = 23820.17188 MB
Memory after cuda sdpa 23820.1796875 MB
1
Memory before offload  23820.158203125 MB
Memory after offload  23820.158203125 MB
Memory before cuda sdpa 23820.171875 MB
On entering CUDA sdpa main function  allocated = 23820.17188 MB
Before first SDPA allocated = 23820.17188 MB
On chunked entry = 23820.17188 MB
On scale calculation = 23820.17969 MB
Before interleave = 23820.17969 MB
After interleave = 23820.67969 MB
After matmul = 23828.80664 MB
Before local copies matmul = 23828.80664 MB
After local copies = 23828.80957 MB
After first SDPA allocated = 23828.29688 MB
After first copy allocated = 23828.29688 MB
On chunked entry = 23828.29688 MB
On scale calculation = 23828.30469 MB
Before interleave = 23828.30469 MB
After interleave = 23828.82031 MB
After matmul = 23828.82275 MB
Before local copies matmul = 23828.82275 MB
After local copies = 23828.82617 MB
fter compute chunk allocated = 23828.29688 MB
Memory after cuda sdpa 23828.3046875 MB
1
Memory before offload  23828.283203125 MB
Memory after offload  23828.283203125 MB
Memory before cuda sdpa 23828.296875 MB
On entering CUDA sdpa main function  allocated = 23828.29688 MB
Before first SDPA allocated = 23828.29688 MB
On chunked entry = 23828.29688 MB
On scale calculation = 23828.30469 MB
Before interleave = 23828.30469 MB
After interleave = 23828.80469 MB
After matmul = 23836.93164 MB
Before local copies matmul = 23836.93164 MB
After local copies = 23836.93457 MB
After first SDPA allocated = 23836.42188 MB
After first copy allocated = 23836.42188 MB
On chunked entry = 23836.42188 MB
On scale calculation = 23836.42969 MB
Before interleave = 23836.42969 MB
After interleave = 23836.94531 MB
After matmul = 23836.94775 MB
Before local copies matmul = 23836.94775 MB
After local copies = 23836.95117 MB
fter compute chunk allocated = 23836.42188 MB
Memory after cuda sdpa 23836.4296875 MB
1
Memory before offload  23836.408203125 MB
Memory after offload  23836.408203125 MB
Memory before cuda sdpa 23836.421875 MB
On entering CUDA sdpa main function  allocated = 23836.42188 MB
Before first SDPA allocated = 23836.42188 MB
On chunked entry = 23836.42188 MB
On scale calculation = 23836.42969 MB
Before interleave = 23836.42969 MB
After interleave = 23836.92969 MB
After matmul = 23845.05664 MB
Before local copies matmul = 23845.05664 MB
After local copies = 23845.05957 MB
After first SDPA allocated = 23844.54688 MB
After first copy allocated = 23844.54688 MB
On chunked entry = 23844.54688 MB
On scale calculation = 23844.55469 MB
Before interleave = 23844.55469 MB
After interleave = 23845.07031 MB
After matmul = 23845.07275 MB
Before local copies matmul = 23845.07275 MB
After local copies = 23845.07617 MB
fter compute chunk allocated = 23844.54688 MB
Memory after cuda sdpa 23844.5546875 MB
1
Memory before offload  23844.533203125 MB
Memory after offload  23844.533203125 MB
Memory before cuda sdpa 23844.546875 MB
On entering CUDA sdpa main function  allocated = 23844.54688 MB
Before first SDPA allocated = 23844.54688 MB
On chunked entry = 23844.54688 MB
On scale calculation = 23844.55469 MB
Before interleave = 23844.55469 MB
After interleave = 23845.05469 MB
After matmul = 23853.18164 MB
Before local copies matmul = 23853.18164 MB
After local copies = 23853.18457 MB
After first SDPA allocated = 23852.67188 MB
After first copy allocated = 23852.67188 MB
On chunked entry = 23852.67188 MB
On scale calculation = 23852.67969 MB
Before interleave = 23852.67969 MB
After interleave = 23853.19531 MB
After matmul = 23853.19775 MB
Before local copies matmul = 23853.19775 MB
After local copies = 23853.20117 MB
fter compute chunk allocated = 23852.67188 MB
Memory after cuda sdpa 23852.6796875 MB
1
Memory before offload  23852.658203125 MB
Memory after offload  23852.658203125 MB
Memory before cuda sdpa 23852.671875 MB
On entering CUDA sdpa main function  allocated = 23852.67188 MB
Before first SDPA allocated = 23852.67188 MB
On chunked entry = 23852.67188 MB
On scale calculation = 23852.67969 MB
Before interleave = 23852.67969 MB
After interleave = 23853.17969 MB
After matmul = 23861.30664 MB
Before local copies matmul = 23861.30664 MB
After local copies = 23861.30957 MB
After first SDPA allocated = 23860.79688 MB
After first copy allocated = 23860.79688 MB
On chunked entry = 23860.79688 MB
On scale calculation = 23860.80469 MB
Before interleave = 23860.80469 MB
After interleave = 23861.32031 MB
After matmul = 23861.32275 MB
Before local copies matmul = 23861.32275 MB
After local copies = 23861.32617 MB
fter compute chunk allocated = 23860.79688 MB
Memory after cuda sdpa 23860.8046875 MB
1
Memory before offload  23860.783203125 MB
Memory after offload  23860.783203125 MB
Memory before cuda sdpa 23860.796875 MB
On entering CUDA sdpa main function  allocated = 23860.79688 MB
Before first SDPA allocated = 23860.79688 MB
On chunked entry = 23860.79688 MB
On scale calculation = 23860.80469 MB
Before interleave = 23860.80469 MB
After interleave = 23861.30469 MB
After matmul = 23869.43164 MB
Before local copies matmul = 23869.43164 MB
After local copies = 23869.43457 MB
After first SDPA allocated = 23868.92188 MB
After first copy allocated = 23868.92188 MB
On chunked entry = 23868.92188 MB
On scale calculation = 23868.92969 MB
Before interleave = 23868.92969 MB
After interleave = 23869.44531 MB
After matmul = 23869.44775 MB
Before local copies matmul = 23869.44775 MB
After local copies = 23869.45117 MB
fter compute chunk allocated = 23868.92188 MB
Memory after cuda sdpa 23868.9296875 MB
1
Memory before offload  23868.908203125 MB
Memory after offload  23868.908203125 MB
Memory before cuda sdpa 23868.921875 MB
On entering CUDA sdpa main function  allocated = 23868.92188 MB
Before first SDPA allocated = 23868.92188 MB
On chunked entry = 23868.92188 MB
On scale calculation = 23868.92969 MB
Before interleave = 23868.92969 MB
After interleave = 23869.42969 MB
After matmul = 23877.55664 MB
Before local copies matmul = 23877.55664 MB
After local copies = 23877.55957 MB
After first SDPA allocated = 23877.04688 MB
After first copy allocated = 23877.04688 MB
On chunked entry = 23877.04688 MB
On scale calculation = 23877.05469 MB
Before interleave = 23877.05469 MB
After interleave = 23877.57031 MB
After matmul = 23877.57275 MB
Before local copies matmul = 23877.57275 MB
After local copies = 23877.57617 MB
fter compute chunk allocated = 23877.04688 MB
Memory after cuda sdpa 23877.0546875 MB
1
Memory before offload  23877.033203125 MB
Memory after offload  23877.033203125 MB
Memory before cuda sdpa 23877.046875 MB
On entering CUDA sdpa main function  allocated = 23877.04688 MB
Before first SDPA allocated = 23877.04688 MB
On chunked entry = 23877.04688 MB
On scale calculation = 23877.05469 MB
Before interleave = 23877.05469 MB
After interleave = 23877.55469 MB
After matmul = 23885.68164 MB
Before local copies matmul = 23885.68164 MB
After local copies = 23885.68457 MB
After first SDPA allocated = 23885.17188 MB
After first copy allocated = 23885.17188 MB
On chunked entry = 23885.17188 MB
On scale calculation = 23885.17969 MB
Before interleave = 23885.17969 MB
After interleave = 23885.69531 MB
After matmul = 23885.69775 MB
Before local copies matmul = 23885.69775 MB
After local copies = 23885.70117 MB
fter compute chunk allocated = 23885.17188 MB
Memory after cuda sdpa 23885.1796875 MB
1
Memory before offload  23885.158203125 MB
Memory after offload  23885.158203125 MB
Memory before cuda sdpa 23885.171875 MB
On entering CUDA sdpa main function  allocated = 23885.17188 MB
Before first SDPA allocated = 23885.17188 MB
On chunked entry = 23885.17188 MB
On scale calculation = 23885.17969 MB
Before interleave = 23885.17969 MB
After interleave = 23885.67969 MB
After matmul = 23893.80664 MB
Before local copies matmul = 23893.80664 MB
After local copies = 23893.80957 MB
After first SDPA allocated = 23893.29688 MB
After first copy allocated = 23893.29688 MB
On chunked entry = 23893.29688 MB
On scale calculation = 23893.30469 MB
Before interleave = 23893.30469 MB
After interleave = 23893.82031 MB
After matmul = 23893.82275 MB
Before local copies matmul = 23893.82275 MB
After local copies = 23893.82617 MB
fter compute chunk allocated = 23893.29688 MB
Memory after cuda sdpa 23893.3046875 MB
1
Memory before offload  23893.283203125 MB
Memory after offload  23893.283203125 MB
Memory before cuda sdpa 23893.296875 MB
On entering CUDA sdpa main function  allocated = 23893.29688 MB
Before first SDPA allocated = 23893.29688 MB
On chunked entry = 23893.29688 MB
On scale calculation = 23893.30469 MB
Before interleave = 23893.30469 MB
After interleave = 23893.80469 MB
After matmul = 23901.93164 MB
Before local copies matmul = 23901.93164 MB
After local copies = 23901.93457 MB
After first SDPA allocated = 23901.42188 MB
After first copy allocated = 23901.42188 MB
On chunked entry = 23901.42188 MB
On scale calculation = 23901.42969 MB
Before interleave = 23901.42969 MB
After interleave = 23901.94531 MB
After matmul = 23901.94775 MB
Before local copies matmul = 23901.94775 MB
After local copies = 23901.95117 MB
fter compute chunk allocated = 23901.42188 MB
Memory after cuda sdpa 23901.4296875 MB
1
Memory before offload  23901.408203125 MB
Memory after offload  23901.408203125 MB
Memory before cuda sdpa 23901.421875 MB
On entering CUDA sdpa main function  allocated = 23901.42188 MB
Before first SDPA allocated = 23901.42188 MB
On chunked entry = 23901.42188 MB
On scale calculation = 23901.42969 MB
Before interleave = 23901.42969 MB
After interleave = 23901.92969 MB
After matmul = 23910.05664 MB
Before local copies matmul = 23910.05664 MB
After local copies = 23910.05957 MB
After first SDPA allocated = 23909.54688 MB
After first copy allocated = 23909.54688 MB
On chunked entry = 23909.54688 MB
On scale calculation = 23909.55469 MB
Before interleave = 23909.55469 MB
After interleave = 23910.07031 MB
After matmul = 23910.07275 MB
Before local copies matmul = 23910.07275 MB
After local copies = 23910.07617 MB
fter compute chunk allocated = 23909.54688 MB
Memory after cuda sdpa 23909.5546875 MB
1
Memory before offload  23909.533203125 MB
Memory after offload  23909.533203125 MB
Memory before cuda sdpa 23909.546875 MB
On entering CUDA sdpa main function  allocated = 23909.54688 MB
Before first SDPA allocated = 23909.54688 MB
On chunked entry = 23909.54688 MB
On scale calculation = 23909.55469 MB
Before interleave = 23909.55469 MB
After interleave = 23910.05469 MB
After matmul = 23918.18164 MB
Before local copies matmul = 23918.18164 MB
After local copies = 23918.18457 MB
After first SDPA allocated = 23917.67188 MB
After first copy allocated = 23917.67188 MB
On chunked entry = 23917.67188 MB
On scale calculation = 23917.67969 MB
Before interleave = 23917.67969 MB
After interleave = 23918.19531 MB
After matmul = 23918.19775 MB
Before local copies matmul = 23918.19775 MB
After local copies = 23918.20117 MB
fter compute chunk allocated = 23917.67188 MB
Memory after cuda sdpa 23917.6796875 MB
1
Memory before offload  23917.658203125 MB
Memory after offload  23917.658203125 MB
Memory before cuda sdpa 23917.671875 MB
On entering CUDA sdpa main function  allocated = 23917.67188 MB
Before first SDPA allocated = 23917.67188 MB
On chunked entry = 23917.67188 MB
On scale calculation = 23917.67969 MB
Before interleave = 23917.67969 MB
After interleave = 23918.17969 MB
After matmul = 23926.30664 MB
Before local copies matmul = 23926.30664 MB
After local copies = 23926.30957 MB
After first SDPA allocated = 23925.79688 MB
After first copy allocated = 23925.79688 MB
On chunked entry = 23925.79688 MB
On scale calculation = 23925.80469 MB
Before interleave = 23925.80469 MB
After interleave = 23926.32031 MB
After matmul = 23926.32275 MB
Before local copies matmul = 23926.32275 MB
After local copies = 23926.32617 MB
fter compute chunk allocated = 23925.79688 MB
Memory after cuda sdpa 23925.8046875 MB
Decode step 34
1
Memory before offload  23925.78369140625 MB
Memory after offload  23925.78369140625 MB
Memory before cuda sdpa 23925.79736328125 MB
On entering CUDA sdpa main function  allocated = 23925.79736 MB
Before first SDPA allocated = 23925.79736 MB
On chunked entry = 23925.79736 MB
On scale calculation = 23925.80518 MB
Before interleave = 23925.80518 MB
After interleave = 23926.30518 MB
After matmul = 23934.43213 MB
Before local copies matmul = 23934.43213 MB
After local copies = 23934.43506 MB
After first SDPA allocated = 23933.92236 MB
After first copy allocated = 23933.92236 MB
On chunked entry = 23933.92236 MB
On scale calculation = 23933.93018 MB
Before interleave = 23933.93018 MB
After interleave = 23934.46143 MB
After matmul = 23934.46387 MB
Before local copies matmul = 23934.46387 MB
After local copies = 23934.46729 MB
fter compute chunk allocated = 23933.92236 MB
Memory after cuda sdpa 23933.93017578125 MB
1
Memory before offload  23933.90869140625 MB
Memory after offload  23933.90869140625 MB
Memory before cuda sdpa 23933.92236328125 MB
On entering CUDA sdpa main function  allocated = 23933.92236 MB
Before first SDPA allocated = 23933.92236 MB
On chunked entry = 23933.92236 MB
On scale calculation = 23933.93018 MB
Before interleave = 23933.93018 MB
After interleave = 23934.43018 MB
After matmul = 23942.55713 MB
Before local copies matmul = 23942.55713 MB
After local copies = 23942.56006 MB
After first SDPA allocated = 23942.04736 MB
After first copy allocated = 23942.04736 MB
On chunked entry = 23942.04736 MB
On scale calculation = 23942.05518 MB
Before interleave = 23942.05518 MB
After interleave = 23942.58643 MB
After matmul = 23942.58887 MB
Before local copies matmul = 23942.58887 MB
After local copies = 23942.59229 MB
fter compute chunk allocated = 23942.04736 MB
Memory after cuda sdpa 23942.05517578125 MB
1
Memory before offload  23942.03369140625 MB
Memory after offload  23942.03369140625 MB
Memory before cuda sdpa 23942.04736328125 MB
On entering CUDA sdpa main function  allocated = 23942.04736 MB
Before first SDPA allocated = 23942.04736 MB
On chunked entry = 23942.04736 MB
On scale calculation = 23942.05518 MB
Before interleave = 23942.05518 MB
After interleave = 23942.55518 MB
After matmul = 23950.68213 MB
Before local copies matmul = 23950.68213 MB
After local copies = 23950.68506 MB
After first SDPA allocated = 23950.17236 MB
After first copy allocated = 23950.17236 MB
On chunked entry = 23950.17236 MB
On scale calculation = 23950.18018 MB
Before interleave = 23950.18018 MB
After interleave = 23950.71143 MB
After matmul = 23950.71387 MB
Before local copies matmul = 23950.71387 MB
After local copies = 23950.71729 MB
fter compute chunk allocated = 23950.17236 MB
Memory after cuda sdpa 23950.18017578125 MB
1
Memory before offload  23950.15869140625 MB
Memory after offload  23950.15869140625 MB
Memory before cuda sdpa 23950.17236328125 MB
On entering CUDA sdpa main function  allocated = 23950.17236 MB
Before first SDPA allocated = 23950.17236 MB
On chunked entry = 23950.17236 MB
On scale calculation = 23950.18018 MB
Before interleave = 23950.18018 MB
After interleave = 23950.68018 MB
After matmul = 23958.80713 MB
Before local copies matmul = 23958.80713 MB
After local copies = 23958.81006 MB
After first SDPA allocated = 23958.29736 MB
After first copy allocated = 23958.29736 MB
On chunked entry = 23958.29736 MB
On scale calculation = 23958.30518 MB
Before interleave = 23958.30518 MB
After interleave = 23958.83643 MB
After matmul = 23958.83887 MB
Before local copies matmul = 23958.83887 MB
After local copies = 23958.84229 MB
fter compute chunk allocated = 23958.29736 MB
Memory after cuda sdpa 23958.30517578125 MB
1
Memory before offload  23958.28369140625 MB
Memory after offload  23958.28369140625 MB
Memory before cuda sdpa 23958.29736328125 MB
On entering CUDA sdpa main function  allocated = 23958.29736 MB
Before first SDPA allocated = 23958.29736 MB
On chunked entry = 23958.29736 MB
On scale calculation = 23958.30518 MB
Before interleave = 23958.30518 MB
After interleave = 23958.80518 MB
After matmul = 23966.93213 MB
Before local copies matmul = 23966.93213 MB
After local copies = 23966.93506 MB
After first SDPA allocated = 23966.42236 MB
After first copy allocated = 23966.42236 MB
On chunked entry = 23966.42236 MB
On scale calculation = 23966.43018 MB
Before interleave = 23966.43018 MB
After interleave = 23966.96143 MB
After matmul = 23966.96387 MB
Before local copies matmul = 23966.96387 MB
After local copies = 23966.96729 MB
fter compute chunk allocated = 23966.42236 MB
Memory after cuda sdpa 23966.43017578125 MB
1
Memory before offload  23966.40869140625 MB
Memory after offload  23966.40869140625 MB
Memory before cuda sdpa 23966.42236328125 MB
On entering CUDA sdpa main function  allocated = 23966.42236 MB
Before first SDPA allocated = 23966.42236 MB
On chunked entry = 23966.42236 MB
On scale calculation = 23966.43018 MB
Before interleave = 23966.43018 MB
After interleave = 23966.93018 MB
After matmul = 23975.05713 MB
Before local copies matmul = 23975.05713 MB
After local copies = 23975.06006 MB
After first SDPA allocated = 23974.54736 MB
After first copy allocated = 23974.54736 MB
On chunked entry = 23974.54736 MB
On scale calculation = 23974.55518 MB
Before interleave = 23974.55518 MB
After interleave = 23975.08643 MB
After matmul = 23975.08887 MB
Before local copies matmul = 23975.08887 MB
After local copies = 23975.09229 MB
fter compute chunk allocated = 23974.54736 MB
Memory after cuda sdpa 23974.55517578125 MB
1
Memory before offload  23974.53369140625 MB
Memory after offload  23974.53369140625 MB
Memory before cuda sdpa 23974.54736328125 MB
On entering CUDA sdpa main function  allocated = 23974.54736 MB
Before first SDPA allocated = 23974.54736 MB
On chunked entry = 23974.54736 MB
On scale calculation = 23974.55518 MB
Before interleave = 23974.55518 MB
After interleave = 23975.05518 MB
After matmul = 23983.18213 MB
Before local copies matmul = 23983.18213 MB
After local copies = 23983.18506 MB
After first SDPA allocated = 23982.67236 MB
After first copy allocated = 23982.67236 MB
On chunked entry = 23982.67236 MB
On scale calculation = 23982.68018 MB
Before interleave = 23982.68018 MB
After interleave = 23983.21143 MB
After matmul = 23983.21387 MB
Before local copies matmul = 23983.21387 MB
After local copies = 23983.21729 MB
fter compute chunk allocated = 23982.67236 MB
Memory after cuda sdpa 23982.68017578125 MB
1
Memory before offload  23982.65869140625 MB
Memory after offload  23982.65869140625 MB
Memory before cuda sdpa 23982.67236328125 MB
On entering CUDA sdpa main function  allocated = 23982.67236 MB
Before first SDPA allocated = 23982.67236 MB
On chunked entry = 23982.67236 MB
On scale calculation = 23982.68018 MB
Before interleave = 23982.68018 MB
After interleave = 23983.18018 MB
After matmul = 23991.30713 MB
Before local copies matmul = 23991.30713 MB
After local copies = 23991.31006 MB
After first SDPA allocated = 23990.79736 MB
After first copy allocated = 23990.79736 MB
On chunked entry = 23990.79736 MB
On scale calculation = 23990.80518 MB
Before interleave = 23990.80518 MB
After interleave = 23991.33643 MB
After matmul = 23991.33887 MB
Before local copies matmul = 23991.33887 MB
After local copies = 23991.34229 MB
fter compute chunk allocated = 23990.79736 MB
Memory after cuda sdpa 23990.80517578125 MB
1
Memory before offload  23990.78369140625 MB
Memory after offload  23990.78369140625 MB
Memory before cuda sdpa 23990.79736328125 MB
On entering CUDA sdpa main function  allocated = 23990.79736 MB
Before first SDPA allocated = 23990.79736 MB
On chunked entry = 23990.79736 MB
On scale calculation = 23990.80518 MB
Before interleave = 23990.80518 MB
After interleave = 23991.30518 MB
After matmul = 23999.43213 MB
Before local copies matmul = 23999.43213 MB
After local copies = 23999.43506 MB
After first SDPA allocated = 23998.92236 MB
After first copy allocated = 23998.92236 MB
On chunked entry = 23998.92236 MB
On scale calculation = 23998.93018 MB
Before interleave = 23998.93018 MB
After interleave = 23999.46143 MB
After matmul = 23999.46387 MB
Before local copies matmul = 23999.46387 MB
After local copies = 23999.46729 MB
fter compute chunk allocated = 23998.92236 MB
Memory after cuda sdpa 23998.93017578125 MB
1
Memory before offload  23998.90869140625 MB
Memory after offload  23998.90869140625 MB
Memory before cuda sdpa 23998.92236328125 MB
On entering CUDA sdpa main function  allocated = 23998.92236 MB
Before first SDPA allocated = 23998.92236 MB
On chunked entry = 23998.92236 MB
On scale calculation = 23998.93018 MB
Before interleave = 23998.93018 MB
After interleave = 23999.43018 MB
After matmul = 24007.55713 MB
Before local copies matmul = 24007.55713 MB
After local copies = 24007.56006 MB
After first SDPA allocated = 24007.04736 MB
After first copy allocated = 24007.04736 MB
On chunked entry = 24007.04736 MB
On scale calculation = 24007.05518 MB
Before interleave = 24007.05518 MB
After interleave = 24007.58643 MB
After matmul = 24007.58887 MB
Before local copies matmul = 24007.58887 MB
After local copies = 24007.59229 MB
fter compute chunk allocated = 24007.04736 MB
Memory after cuda sdpa 24007.05517578125 MB
1
Memory before offload  24007.03369140625 MB
Memory after offload  24007.03369140625 MB
Memory before cuda sdpa 24007.04736328125 MB
On entering CUDA sdpa main function  allocated = 24007.04736 MB
Before first SDPA allocated = 24007.04736 MB
On chunked entry = 24007.04736 MB
On scale calculation = 24007.05518 MB
Before interleave = 24007.05518 MB
After interleave = 24007.55518 MB
After matmul = 24015.68213 MB
Before local copies matmul = 24015.68213 MB
After local copies = 24015.68506 MB
After first SDPA allocated = 24015.17236 MB
After first copy allocated = 24015.17236 MB
On chunked entry = 24015.17236 MB
On scale calculation = 24015.18018 MB
Before interleave = 24015.18018 MB
After interleave = 24015.71143 MB
After matmul = 24015.71387 MB
Before local copies matmul = 24015.71387 MB
After local copies = 24015.71729 MB
fter compute chunk allocated = 24015.17236 MB
Memory after cuda sdpa 24015.18017578125 MB
1
Memory before offload  24015.15869140625 MB
Memory after offload  24015.15869140625 MB
Memory before cuda sdpa 24015.17236328125 MB
On entering CUDA sdpa main function  allocated = 24015.17236 MB
Before first SDPA allocated = 24015.17236 MB
On chunked entry = 24015.17236 MB
On scale calculation = 24015.18018 MB
Before interleave = 24015.18018 MB
After interleave = 24015.68018 MB
After matmul = 24023.80713 MB
Before local copies matmul = 24023.80713 MB
After local copies = 24023.81006 MB
After first SDPA allocated = 24023.29736 MB
After first copy allocated = 24023.29736 MB
On chunked entry = 24023.29736 MB
On scale calculation = 24023.30518 MB
Before interleave = 24023.30518 MB
After interleave = 24023.83643 MB
After matmul = 24023.83887 MB
Before local copies matmul = 24023.83887 MB
After local copies = 24023.84229 MB
fter compute chunk allocated = 24023.29736 MB
Memory after cuda sdpa 24023.30517578125 MB
1
Memory before offload  24023.28369140625 MB
Memory after offload  24023.28369140625 MB
Memory before cuda sdpa 24023.29736328125 MB
On entering CUDA sdpa main function  allocated = 24023.29736 MB
Before first SDPA allocated = 24023.29736 MB
On chunked entry = 24023.29736 MB
On scale calculation = 24023.30518 MB
Before interleave = 24023.30518 MB
After interleave = 24023.80518 MB
After matmul = 24031.93213 MB
Before local copies matmul = 24031.93213 MB
After local copies = 24031.93506 MB
After first SDPA allocated = 24031.42236 MB
After first copy allocated = 24031.42236 MB
On chunked entry = 24031.42236 MB
On scale calculation = 24031.43018 MB
Before interleave = 24031.43018 MB
After interleave = 24031.96143 MB
After matmul = 24031.96387 MB
Before local copies matmul = 24031.96387 MB
After local copies = 24031.96729 MB
fter compute chunk allocated = 24031.42236 MB
Memory after cuda sdpa 24031.43017578125 MB
1
Memory before offload  24031.40869140625 MB
Memory after offload  24031.40869140625 MB
Memory before cuda sdpa 24031.42236328125 MB
On entering CUDA sdpa main function  allocated = 24031.42236 MB
Before first SDPA allocated = 24031.42236 MB
On chunked entry = 24031.42236 MB
On scale calculation = 24031.43018 MB
Before interleave = 24031.43018 MB
After interleave = 24031.93018 MB
After matmul = 24040.05713 MB
Before local copies matmul = 24040.05713 MB
After local copies = 24040.06006 MB
After first SDPA allocated = 24039.54736 MB
After first copy allocated = 24039.54736 MB
On chunked entry = 24039.54736 MB
On scale calculation = 24039.55518 MB
Before interleave = 24039.55518 MB
After interleave = 24040.08643 MB
After matmul = 24040.08887 MB
Before local copies matmul = 24040.08887 MB
After local copies = 24040.09229 MB
fter compute chunk allocated = 24039.54736 MB
Memory after cuda sdpa 24039.55517578125 MB
1
Memory before offload  24039.53369140625 MB
Memory after offload  24039.53369140625 MB
Memory before cuda sdpa 24039.54736328125 MB
On entering CUDA sdpa main function  allocated = 24039.54736 MB
Before first SDPA allocated = 24039.54736 MB
On chunked entry = 24039.54736 MB
On scale calculation = 24039.55518 MB
Before interleave = 24039.55518 MB
After interleave = 24040.05518 MB
After matmul = 24048.18213 MB
Before local copies matmul = 24048.18213 MB
After local copies = 24048.18506 MB
After first SDPA allocated = 24047.67236 MB
After first copy allocated = 24047.67236 MB
On chunked entry = 24047.67236 MB
On scale calculation = 24047.68018 MB
Before interleave = 24047.68018 MB
After interleave = 24048.21143 MB
After matmul = 24048.21387 MB
Before local copies matmul = 24048.21387 MB
After local copies = 24048.21729 MB
fter compute chunk allocated = 24047.67236 MB
Memory after cuda sdpa 24047.68017578125 MB
1
Memory before offload  24047.65869140625 MB
Memory after offload  24047.65869140625 MB
Memory before cuda sdpa 24047.67236328125 MB
On entering CUDA sdpa main function  allocated = 24047.67236 MB
Before first SDPA allocated = 24047.67236 MB
On chunked entry = 24047.67236 MB
On scale calculation = 24047.68018 MB
Before interleave = 24047.68018 MB
After interleave = 24048.18018 MB
After matmul = 24056.30713 MB
Before local copies matmul = 24056.30713 MB
After local copies = 24056.31006 MB
After first SDPA allocated = 24055.79736 MB
After first copy allocated = 24055.79736 MB
On chunked entry = 24055.79736 MB
On scale calculation = 24055.80518 MB
Before interleave = 24055.80518 MB
After interleave = 24056.33643 MB
After matmul = 24056.33887 MB
Before local copies matmul = 24056.33887 MB
After local copies = 24056.34229 MB
fter compute chunk allocated = 24055.79736 MB
Memory after cuda sdpa 24055.80517578125 MB
1
Memory before offload  24055.78369140625 MB
Memory after offload  24055.78369140625 MB
Memory before cuda sdpa 24055.79736328125 MB
On entering CUDA sdpa main function  allocated = 24055.79736 MB
Before first SDPA allocated = 24055.79736 MB
On chunked entry = 24055.79736 MB
On scale calculation = 24055.80518 MB
Before interleave = 24055.80518 MB
After interleave = 24056.30518 MB
After matmul = 24064.43213 MB
Before local copies matmul = 24064.43213 MB
After local copies = 24064.43506 MB
After first SDPA allocated = 24063.92236 MB
After first copy allocated = 24063.92236 MB
On chunked entry = 24063.92236 MB
On scale calculation = 24063.93018 MB
Before interleave = 24063.93018 MB
After interleave = 24064.46143 MB
After matmul = 24064.46387 MB
Before local copies matmul = 24064.46387 MB
After local copies = 24064.46729 MB
fter compute chunk allocated = 24063.92236 MB
Memory after cuda sdpa 24063.93017578125 MB
1
Memory before offload  24063.90869140625 MB
Memory after offload  24063.90869140625 MB
Memory before cuda sdpa 24063.92236328125 MB
On entering CUDA sdpa main function  allocated = 24063.92236 MB
Before first SDPA allocated = 24063.92236 MB
On chunked entry = 24063.92236 MB
On scale calculation = 24063.93018 MB
Before interleave = 24063.93018 MB
After interleave = 24064.43018 MB
After matmul = 24072.55713 MB
Before local copies matmul = 24072.55713 MB
After local copies = 24072.56006 MB
After first SDPA allocated = 24072.04736 MB
After first copy allocated = 24072.04736 MB
On chunked entry = 24072.04736 MB
On scale calculation = 24072.05518 MB
Before interleave = 24072.05518 MB
After interleave = 24072.58643 MB
After matmul = 24072.58887 MB
Before local copies matmul = 24072.58887 MB
After local copies = 24072.59229 MB
fter compute chunk allocated = 24072.04736 MB
Memory after cuda sdpa 24072.05517578125 MB
1
Memory before offload  24072.03369140625 MB
Memory after offload  24072.03369140625 MB
Memory before cuda sdpa 24072.04736328125 MB
On entering CUDA sdpa main function  allocated = 24072.04736 MB
Before first SDPA allocated = 24072.04736 MB
On chunked entry = 24072.04736 MB
On scale calculation = 24072.05518 MB
Before interleave = 24072.05518 MB
After interleave = 24072.55518 MB
After matmul = 24080.68213 MB
Before local copies matmul = 24080.68213 MB
After local copies = 24080.68506 MB
After first SDPA allocated = 24080.17236 MB
After first copy allocated = 24080.17236 MB
On chunked entry = 24080.17236 MB
On scale calculation = 24080.18018 MB
Before interleave = 24080.18018 MB
After interleave = 24080.71143 MB
After matmul = 24080.71387 MB
Before local copies matmul = 24080.71387 MB
After local copies = 24080.71729 MB
fter compute chunk allocated = 24080.17236 MB
Memory after cuda sdpa 24080.18017578125 MB
1
Memory before offload  24080.15869140625 MB
Memory after offload  24080.15869140625 MB
Memory before cuda sdpa 24080.17236328125 MB
On entering CUDA sdpa main function  allocated = 24080.17236 MB
Before first SDPA allocated = 24080.17236 MB
On chunked entry = 24080.17236 MB
On scale calculation = 24080.18018 MB
Before interleave = 24080.18018 MB
After interleave = 24080.68018 MB
After matmul = 24088.80713 MB
Before local copies matmul = 24088.80713 MB
After local copies = 24088.81006 MB
After first SDPA allocated = 24088.29736 MB
After first copy allocated = 24088.29736 MB
On chunked entry = 24088.29736 MB
On scale calculation = 24088.30518 MB
Before interleave = 24088.30518 MB
After interleave = 24088.83643 MB
After matmul = 24088.83887 MB
Before local copies matmul = 24088.83887 MB
After local copies = 24088.84229 MB
fter compute chunk allocated = 24088.29736 MB
Memory after cuda sdpa 24088.30517578125 MB
1
Memory before offload  24088.28369140625 MB
Memory after offload  24088.28369140625 MB
Memory before cuda sdpa 24088.29736328125 MB
On entering CUDA sdpa main function  allocated = 24088.29736 MB
Before first SDPA allocated = 24088.29736 MB
On chunked entry = 24088.29736 MB
On scale calculation = 24088.30518 MB
Before interleave = 24088.30518 MB
After interleave = 24088.80518 MB
After matmul = 24096.93213 MB
Before local copies matmul = 24096.93213 MB
After local copies = 24096.93506 MB
After first SDPA allocated = 24096.42236 MB
After first copy allocated = 24096.42236 MB
On chunked entry = 24096.42236 MB
On scale calculation = 24096.43018 MB
Before interleave = 24096.43018 MB
After interleave = 24096.96143 MB
After matmul = 24096.96387 MB
Before local copies matmul = 24096.96387 MB
After local copies = 24096.96729 MB
fter compute chunk allocated = 24096.42236 MB
Memory after cuda sdpa 24096.43017578125 MB
1
Memory before offload  24096.40869140625 MB
Memory after offload  24096.40869140625 MB
Memory before cuda sdpa 24096.42236328125 MB
On entering CUDA sdpa main function  allocated = 24096.42236 MB
Before first SDPA allocated = 24096.42236 MB
On chunked entry = 24096.42236 MB
On scale calculation = 24096.43018 MB
Before interleave = 24096.43018 MB
After interleave = 24096.93018 MB
After matmul = 24105.05713 MB
Before local copies matmul = 24105.05713 MB
After local copies = 24105.06006 MB
After first SDPA allocated = 24104.54736 MB
After first copy allocated = 24104.54736 MB
On chunked entry = 24104.54736 MB
On scale calculation = 24104.55518 MB
Before interleave = 24104.55518 MB
After interleave = 24105.08643 MB
After matmul = 24105.08887 MB
Before local copies matmul = 24105.08887 MB
After local copies = 24105.09229 MB
fter compute chunk allocated = 24104.54736 MB
Memory after cuda sdpa 24104.55517578125 MB
1
Memory before offload  24104.53369140625 MB
Memory after offload  24104.53369140625 MB
Memory before cuda sdpa 24104.54736328125 MB
On entering CUDA sdpa main function  allocated = 24104.54736 MB
Before first SDPA allocated = 24104.54736 MB
On chunked entry = 24104.54736 MB
On scale calculation = 24104.55518 MB
Before interleave = 24104.55518 MB
After interleave = 24105.05518 MB
After matmul = 24113.18213 MB
Before local copies matmul = 24113.18213 MB
After local copies = 24113.18506 MB
After first SDPA allocated = 24112.67236 MB
After first copy allocated = 24112.67236 MB
On chunked entry = 24112.67236 MB
On scale calculation = 24112.68018 MB
Before interleave = 24112.68018 MB
After interleave = 24113.21143 MB
After matmul = 24113.21387 MB
Before local copies matmul = 24113.21387 MB
After local copies = 24113.21729 MB
fter compute chunk allocated = 24112.67236 MB
Memory after cuda sdpa 24112.68017578125 MB
1
Memory before offload  24112.65869140625 MB
Memory after offload  24112.65869140625 MB
Memory before cuda sdpa 24112.67236328125 MB
On entering CUDA sdpa main function  allocated = 24112.67236 MB
Before first SDPA allocated = 24112.67236 MB
On chunked entry = 24112.67236 MB
On scale calculation = 24112.68018 MB
Before interleave = 24112.68018 MB
After interleave = 24113.18018 MB
After matmul = 24121.30713 MB
Before local copies matmul = 24121.30713 MB
After local copies = 24121.31006 MB
After first SDPA allocated = 24120.79736 MB
After first copy allocated = 24120.79736 MB
On chunked entry = 24120.79736 MB
On scale calculation = 24120.80518 MB
Before interleave = 24120.80518 MB
After interleave = 24121.33643 MB
After matmul = 24121.33887 MB
Before local copies matmul = 24121.33887 MB
After local copies = 24121.34229 MB
fter compute chunk allocated = 24120.79736 MB
Memory after cuda sdpa 24120.80517578125 MB
1
Memory before offload  24120.78369140625 MB
Memory after offload  24120.78369140625 MB
Memory before cuda sdpa 24120.79736328125 MB
On entering CUDA sdpa main function  allocated = 24120.79736 MB
Before first SDPA allocated = 24120.79736 MB
On chunked entry = 24120.79736 MB
On scale calculation = 24120.80518 MB
Before interleave = 24120.80518 MB
After interleave = 24121.30518 MB
After matmul = 24129.43213 MB
Before local copies matmul = 24129.43213 MB
After local copies = 24129.43506 MB
After first SDPA allocated = 24128.92236 MB
After first copy allocated = 24128.92236 MB
On chunked entry = 24128.92236 MB
On scale calculation = 24128.93018 MB
Before interleave = 24128.93018 MB
After interleave = 24129.46143 MB
After matmul = 24129.46387 MB
Before local copies matmul = 24129.46387 MB
After local copies = 24129.46729 MB
fter compute chunk allocated = 24128.92236 MB
Memory after cuda sdpa 24128.93017578125 MB
1
Memory before offload  24128.90869140625 MB
Memory after offload  24128.90869140625 MB
Memory before cuda sdpa 24128.92236328125 MB
On entering CUDA sdpa main function  allocated = 24128.92236 MB
Before first SDPA allocated = 24128.92236 MB
On chunked entry = 24128.92236 MB
On scale calculation = 24128.93018 MB
Before interleave = 24128.93018 MB
After interleave = 24129.43018 MB
After matmul = 24137.55713 MB
Before local copies matmul = 24137.55713 MB
After local copies = 24137.56006 MB
After first SDPA allocated = 24137.04736 MB
After first copy allocated = 24137.04736 MB
On chunked entry = 24137.04736 MB
On scale calculation = 24137.05518 MB
Before interleave = 24137.05518 MB
After interleave = 24137.58643 MB
After matmul = 24137.58887 MB
Before local copies matmul = 24137.58887 MB
After local copies = 24137.59229 MB
fter compute chunk allocated = 24137.04736 MB
Memory after cuda sdpa 24137.05517578125 MB
1
Memory before offload  24137.03369140625 MB
Memory after offload  24137.03369140625 MB
Memory before cuda sdpa 24137.04736328125 MB
On entering CUDA sdpa main function  allocated = 24137.04736 MB
Before first SDPA allocated = 24137.04736 MB
On chunked entry = 24137.04736 MB
On scale calculation = 24137.05518 MB
Before interleave = 24137.05518 MB
After interleave = 24137.55518 MB
After matmul = 24145.68213 MB
Before local copies matmul = 24145.68213 MB
After local copies = 24145.68506 MB
After first SDPA allocated = 24145.17236 MB
After first copy allocated = 24145.17236 MB
On chunked entry = 24145.17236 MB
On scale calculation = 24145.18018 MB
Before interleave = 24145.18018 MB
After interleave = 24145.71143 MB
After matmul = 24145.71387 MB
Before local copies matmul = 24145.71387 MB
After local copies = 24145.71729 MB
fter compute chunk allocated = 24145.17236 MB
Memory after cuda sdpa 24145.18017578125 MB
1
Memory before offload  24145.15869140625 MB
Memory after offload  24145.15869140625 MB
Memory before cuda sdpa 24145.17236328125 MB
On entering CUDA sdpa main function  allocated = 24145.17236 MB
Before first SDPA allocated = 24145.17236 MB
On chunked entry = 24145.17236 MB
On scale calculation = 24145.18018 MB
Before interleave = 24145.18018 MB
After interleave = 24145.68018 MB
After matmul = 24153.80713 MB
Before local copies matmul = 24153.80713 MB
After local copies = 24153.81006 MB
After first SDPA allocated = 24153.29736 MB
After first copy allocated = 24153.29736 MB
On chunked entry = 24153.29736 MB
On scale calculation = 24153.30518 MB
Before interleave = 24153.30518 MB
After interleave = 24153.83643 MB
After matmul = 24153.83887 MB
Before local copies matmul = 24153.83887 MB
After local copies = 24153.84229 MB
fter compute chunk allocated = 24153.29736 MB
Memory after cuda sdpa 24153.30517578125 MB
1
Memory before offload  24153.28369140625 MB
Memory after offload  24153.28369140625 MB
Memory before cuda sdpa 24153.29736328125 MB
On entering CUDA sdpa main function  allocated = 24153.29736 MB
Before first SDPA allocated = 24153.29736 MB
On chunked entry = 24153.29736 MB
On scale calculation = 24153.30518 MB
Before interleave = 24153.30518 MB
After interleave = 24153.80518 MB
After matmul = 24161.93213 MB
Before local copies matmul = 24161.93213 MB
After local copies = 24161.93506 MB
After first SDPA allocated = 24161.42236 MB
After first copy allocated = 24161.42236 MB
On chunked entry = 24161.42236 MB
On scale calculation = 24161.43018 MB
Before interleave = 24161.43018 MB
After interleave = 24161.96143 MB
After matmul = 24161.96387 MB
Before local copies matmul = 24161.96387 MB
After local copies = 24161.96729 MB
fter compute chunk allocated = 24161.42236 MB
Memory after cuda sdpa 24161.43017578125 MB
1
Memory before offload  24161.40869140625 MB
Memory after offload  24161.40869140625 MB
Memory before cuda sdpa 24161.42236328125 MB
On entering CUDA sdpa main function  allocated = 24161.42236 MB
Before first SDPA allocated = 24161.42236 MB
On chunked entry = 24161.42236 MB
On scale calculation = 24161.43018 MB
Before interleave = 24161.43018 MB
After interleave = 24161.93018 MB
After matmul = 24170.05713 MB
Before local copies matmul = 24170.05713 MB
After local copies = 24170.06006 MB
After first SDPA allocated = 24169.54736 MB
After first copy allocated = 24169.54736 MB
On chunked entry = 24169.54736 MB
On scale calculation = 24169.55518 MB
Before interleave = 24169.55518 MB
After interleave = 24170.08643 MB
After matmul = 24170.08887 MB
Before local copies matmul = 24170.08887 MB
After local copies = 24170.09229 MB
fter compute chunk allocated = 24169.54736 MB
Memory after cuda sdpa 24169.55517578125 MB
1
Memory before offload  24169.53369140625 MB
Memory after offload  24169.53369140625 MB
Memory before cuda sdpa 24169.54736328125 MB
On entering CUDA sdpa main function  allocated = 24169.54736 MB
Before first SDPA allocated = 24169.54736 MB
On chunked entry = 24169.54736 MB
On scale calculation = 24169.55518 MB
Before interleave = 24169.55518 MB
After interleave = 24170.05518 MB
After matmul = 24178.18213 MB
Before local copies matmul = 24178.18213 MB
After local copies = 24178.18506 MB
After first SDPA allocated = 24177.67236 MB
After first copy allocated = 24177.67236 MB
On chunked entry = 24177.67236 MB
On scale calculation = 24177.68018 MB
Before interleave = 24177.68018 MB
After interleave = 24178.21143 MB
After matmul = 24178.21387 MB
Before local copies matmul = 24178.21387 MB
After local copies = 24178.21729 MB
fter compute chunk allocated = 24177.67236 MB
Memory after cuda sdpa 24177.68017578125 MB
1
Memory before offload  24177.65869140625 MB
Memory after offload  24177.65869140625 MB
Memory before cuda sdpa 24177.67236328125 MB
On entering CUDA sdpa main function  allocated = 24177.67236 MB
Before first SDPA allocated = 24177.67236 MB
On chunked entry = 24177.67236 MB
On scale calculation = 24177.68018 MB
Before interleave = 24177.68018 MB
After interleave = 24178.18018 MB
After matmul = 24186.30713 MB
Before local copies matmul = 24186.30713 MB
After local copies = 24186.31006 MB
After first SDPA allocated = 24185.79736 MB
After first copy allocated = 24185.79736 MB
On chunked entry = 24185.79736 MB
On scale calculation = 24185.80518 MB
Before interleave = 24185.80518 MB
After interleave = 24186.33643 MB
After matmul = 24186.33887 MB
Before local copies matmul = 24186.33887 MB
After local copies = 24186.34229 MB
fter compute chunk allocated = 24185.79736 MB
Memory after cuda sdpa 24185.80517578125 MB
Decode step 35
1
Memory before offload  24185.7841796875 MB
Memory after offload  24185.7841796875 MB
Memory before cuda sdpa 24185.7978515625 MB
On entering CUDA sdpa main function  allocated = 24185.79785 MB
Before first SDPA allocated = 24185.79785 MB
On chunked entry = 24185.79785 MB
On scale calculation = 24185.80566 MB
Before interleave = 24185.80566 MB
After interleave = 24186.30566 MB
After matmul = 24194.43262 MB
Before local copies matmul = 24194.43262 MB
After local copies = 24194.43555 MB
After first SDPA allocated = 24193.92285 MB
After first copy allocated = 24193.92285 MB
On chunked entry = 24193.92285 MB
On scale calculation = 24193.93066 MB
Before interleave = 24193.93066 MB
After interleave = 24194.47754 MB
After matmul = 24194.47998 MB
Before local copies matmul = 24194.47998 MB
After local copies = 24194.48340 MB
fter compute chunk allocated = 24193.92285 MB
Memory after cuda sdpa 24193.9306640625 MB
1
Memory before offload  24193.9091796875 MB
Memory after offload  24193.9091796875 MB
Memory before cuda sdpa 24193.9228515625 MB
On entering CUDA sdpa main function  allocated = 24193.92285 MB
Before first SDPA allocated = 24193.92285 MB
On chunked entry = 24193.92285 MB
On scale calculation = 24193.93066 MB
Before interleave = 24193.93066 MB
After interleave = 24194.43066 MB
After matmul = 24202.55762 MB
Before local copies matmul = 24202.55762 MB
After local copies = 24202.56055 MB
After first SDPA allocated = 24202.04785 MB
After first copy allocated = 24202.04785 MB
On chunked entry = 24202.04785 MB
On scale calculation = 24202.05566 MB
Before interleave = 24202.05566 MB
After interleave = 24202.60254 MB
After matmul = 24202.60498 MB
Before local copies matmul = 24202.60498 MB
After local copies = 24202.60840 MB
fter compute chunk allocated = 24202.04785 MB
Memory after cuda sdpa 24202.0556640625 MB
1
Memory before offload  24202.0341796875 MB
Memory after offload  24202.0341796875 MB
Memory before cuda sdpa 24202.0478515625 MB
On entering CUDA sdpa main function  allocated = 24202.04785 MB
Before first SDPA allocated = 24202.04785 MB
On chunked entry = 24202.04785 MB
On scale calculation = 24202.05566 MB
Before interleave = 24202.05566 MB
After interleave = 24202.55566 MB
After matmul = 24210.68262 MB
Before local copies matmul = 24210.68262 MB
After local copies = 24210.68555 MB
After first SDPA allocated = 24210.17285 MB
After first copy allocated = 24210.17285 MB
On chunked entry = 24210.17285 MB
On scale calculation = 24210.18066 MB
Before interleave = 24210.18066 MB
After interleave = 24210.72754 MB
After matmul = 24210.72998 MB
Before local copies matmul = 24210.72998 MB
After local copies = 24210.73340 MB
fter compute chunk allocated = 24210.17285 MB
Memory after cuda sdpa 24210.1806640625 MB
1
Memory before offload  24210.1591796875 MB
Memory after offload  24210.1591796875 MB
Memory before cuda sdpa 24210.1728515625 MB
On entering CUDA sdpa main function  allocated = 24210.17285 MB
Before first SDPA allocated = 24210.17285 MB
On chunked entry = 24210.17285 MB
On scale calculation = 24210.18066 MB
Before interleave = 24210.18066 MB
After interleave = 24210.68066 MB
After matmul = 24218.80762 MB
Before local copies matmul = 24218.80762 MB
After local copies = 24218.81055 MB
After first SDPA allocated = 24218.29785 MB
After first copy allocated = 24218.29785 MB
On chunked entry = 24218.29785 MB
On scale calculation = 24218.30566 MB
Before interleave = 24218.30566 MB
After interleave = 24218.85254 MB
After matmul = 24218.85498 MB
Before local copies matmul = 24218.85498 MB
After local copies = 24218.85840 MB
fter compute chunk allocated = 24218.29785 MB
Memory after cuda sdpa 24218.3056640625 MB
1
Memory before offload  24218.2841796875 MB
Memory after offload  24218.2841796875 MB
Memory before cuda sdpa 24218.2978515625 MB
On entering CUDA sdpa main function  allocated = 24218.29785 MB
Before first SDPA allocated = 24218.29785 MB
On chunked entry = 24218.29785 MB
On scale calculation = 24218.30566 MB
Before interleave = 24218.30566 MB
After interleave = 24218.80566 MB
After matmul = 24226.93262 MB
Before local copies matmul = 24226.93262 MB
After local copies = 24226.93555 MB
After first SDPA allocated = 24226.42285 MB
After first copy allocated = 24226.42285 MB
On chunked entry = 24226.42285 MB
On scale calculation = 24226.43066 MB
Before interleave = 24226.43066 MB
After interleave = 24226.97754 MB
After matmul = 24226.97998 MB
Before local copies matmul = 24226.97998 MB
After local copies = 24226.98340 MB
fter compute chunk allocated = 24226.42285 MB
Memory after cuda sdpa 24226.4306640625 MB
1
Memory before offload  24226.4091796875 MB
Memory after offload  24226.4091796875 MB
Memory before cuda sdpa 24226.4228515625 MB
On entering CUDA sdpa main function  allocated = 24226.42285 MB
Before first SDPA allocated = 24226.42285 MB
On chunked entry = 24226.42285 MB
On scale calculation = 24226.43066 MB
Before interleave = 24226.43066 MB
After interleave = 24226.93066 MB
After matmul = 24235.05762 MB
Before local copies matmul = 24235.05762 MB
After local copies = 24235.06055 MB
After first SDPA allocated = 24234.54785 MB
After first copy allocated = 24234.54785 MB
On chunked entry = 24234.54785 MB
On scale calculation = 24234.55566 MB
Before interleave = 24234.55566 MB
After interleave = 24235.10254 MB
After matmul = 24235.10498 MB
Before local copies matmul = 24235.10498 MB
After local copies = 24235.10840 MB
fter compute chunk allocated = 24234.54785 MB
Memory after cuda sdpa 24234.5556640625 MB
1
Memory before offload  24234.5341796875 MB
Memory after offload  24234.5341796875 MB
Memory before cuda sdpa 24234.5478515625 MB
On entering CUDA sdpa main function  allocated = 24234.54785 MB
Before first SDPA allocated = 24234.54785 MB
On chunked entry = 24234.54785 MB
On scale calculation = 24234.55566 MB
Before interleave = 24234.55566 MB
After interleave = 24235.05566 MB
After matmul = 24243.18262 MB
Before local copies matmul = 24243.18262 MB
After local copies = 24243.18555 MB
After first SDPA allocated = 24242.67285 MB
After first copy allocated = 24242.67285 MB
On chunked entry = 24242.67285 MB
On scale calculation = 24242.68066 MB
Before interleave = 24242.68066 MB
After interleave = 24243.22754 MB
After matmul = 24243.22998 MB
Before local copies matmul = 24243.22998 MB
After local copies = 24243.23340 MB
fter compute chunk allocated = 24242.67285 MB
Memory after cuda sdpa 24242.6806640625 MB
1
Memory before offload  24242.6591796875 MB
Memory after offload  24242.6591796875 MB
Memory before cuda sdpa 24242.6728515625 MB
On entering CUDA sdpa main function  allocated = 24242.67285 MB
Before first SDPA allocated = 24242.67285 MB
On chunked entry = 24242.67285 MB
On scale calculation = 24242.68066 MB
Before interleave = 24242.68066 MB
After interleave = 24243.18066 MB
After matmul = 24251.30762 MB
Before local copies matmul = 24251.30762 MB
After local copies = 24251.31055 MB
After first SDPA allocated = 24250.79785 MB
After first copy allocated = 24250.79785 MB
On chunked entry = 24250.79785 MB
On scale calculation = 24250.80566 MB
Before interleave = 24250.80566 MB
After interleave = 24251.35254 MB
After matmul = 24251.35498 MB
Before local copies matmul = 24251.35498 MB
After local copies = 24251.35840 MB
fter compute chunk allocated = 24250.79785 MB
Memory after cuda sdpa 24250.8056640625 MB
1
Memory before offload  24250.7841796875 MB
Memory after offload  24250.7841796875 MB
Memory before cuda sdpa 24250.7978515625 MB
On entering CUDA sdpa main function  allocated = 24250.79785 MB
Before first SDPA allocated = 24250.79785 MB
On chunked entry = 24250.79785 MB
On scale calculation = 24250.80566 MB
Before interleave = 24250.80566 MB
After interleave = 24251.30566 MB
After matmul = 24259.43262 MB
Before local copies matmul = 24259.43262 MB
After local copies = 24259.43555 MB
After first SDPA allocated = 24258.92285 MB
After first copy allocated = 24258.92285 MB
On chunked entry = 24258.92285 MB
On scale calculation = 24258.93066 MB
Before interleave = 24258.93066 MB
After interleave = 24259.47754 MB
After matmul = 24259.47998 MB
Before local copies matmul = 24259.47998 MB
After local copies = 24259.48340 MB
fter compute chunk allocated = 24258.92285 MB
Memory after cuda sdpa 24258.9306640625 MB
1
Memory before offload  24258.9091796875 MB
Memory after offload  24258.9091796875 MB
Memory before cuda sdpa 24258.9228515625 MB
On entering CUDA sdpa main function  allocated = 24258.92285 MB
Before first SDPA allocated = 24258.92285 MB
On chunked entry = 24258.92285 MB
On scale calculation = 24258.93066 MB
Before interleave = 24258.93066 MB
After interleave = 24259.43066 MB
After matmul = 24267.55762 MB
Before local copies matmul = 24267.55762 MB
After local copies = 24267.56055 MB
After first SDPA allocated = 24267.04785 MB
After first copy allocated = 24267.04785 MB
On chunked entry = 24267.04785 MB
On scale calculation = 24267.05566 MB
Before interleave = 24267.05566 MB
After interleave = 24267.60254 MB
After matmul = 24267.60498 MB
Before local copies matmul = 24267.60498 MB
After local copies = 24267.60840 MB
fter compute chunk allocated = 24267.04785 MB
Memory after cuda sdpa 24267.0556640625 MB
1
Memory before offload  24267.0341796875 MB
Memory after offload  24267.0341796875 MB
Memory before cuda sdpa 24267.0478515625 MB
On entering CUDA sdpa main function  allocated = 24267.04785 MB
Before first SDPA allocated = 24267.04785 MB
On chunked entry = 24267.04785 MB
On scale calculation = 24267.05566 MB
Before interleave = 24267.05566 MB
After interleave = 24267.55566 MB
After matmul = 24275.68262 MB
Before local copies matmul = 24275.68262 MB
After local copies = 24275.68555 MB
After first SDPA allocated = 24275.17285 MB
After first copy allocated = 24275.17285 MB
On chunked entry = 24275.17285 MB
On scale calculation = 24275.18066 MB
Before interleave = 24275.18066 MB
After interleave = 24275.72754 MB
After matmul = 24275.72998 MB
Before local copies matmul = 24275.72998 MB
After local copies = 24275.73340 MB
fter compute chunk allocated = 24275.17285 MB
Memory after cuda sdpa 24275.1806640625 MB
1
Memory before offload  24275.1591796875 MB
Memory after offload  24275.1591796875 MB
Memory before cuda sdpa 24275.1728515625 MB
On entering CUDA sdpa main function  allocated = 24275.17285 MB
Before first SDPA allocated = 24275.17285 MB
On chunked entry = 24275.17285 MB
On scale calculation = 24275.18066 MB
Before interleave = 24275.18066 MB
After interleave = 24275.68066 MB
After matmul = 24283.80762 MB
Before local copies matmul = 24283.80762 MB
After local copies = 24283.81055 MB
After first SDPA allocated = 24283.29785 MB
After first copy allocated = 24283.29785 MB
On chunked entry = 24283.29785 MB
On scale calculation = 24283.30566 MB
Before interleave = 24283.30566 MB
After interleave = 24283.85254 MB
After matmul = 24283.85498 MB
Before local copies matmul = 24283.85498 MB
After local copies = 24283.85840 MB
fter compute chunk allocated = 24283.29785 MB
Memory after cuda sdpa 24283.3056640625 MB
1
Memory before offload  24283.2841796875 MB
Memory after offload  24283.2841796875 MB
Memory before cuda sdpa 24283.2978515625 MB
On entering CUDA sdpa main function  allocated = 24283.29785 MB
Before first SDPA allocated = 24283.29785 MB
On chunked entry = 24283.29785 MB
On scale calculation = 24283.30566 MB
Before interleave = 24283.30566 MB
After interleave = 24283.80566 MB
After matmul = 24291.93262 MB
Before local copies matmul = 24291.93262 MB
After local copies = 24291.93555 MB
After first SDPA allocated = 24291.42285 MB
After first copy allocated = 24291.42285 MB
On chunked entry = 24291.42285 MB
On scale calculation = 24291.43066 MB
Before interleave = 24291.43066 MB
After interleave = 24291.97754 MB
After matmul = 24291.97998 MB
Before local copies matmul = 24291.97998 MB
After local copies = 24291.98340 MB
fter compute chunk allocated = 24291.42285 MB
Memory after cuda sdpa 24291.4306640625 MB
1
Memory before offload  24291.4091796875 MB
Memory after offload  24291.4091796875 MB
Memory before cuda sdpa 24291.4228515625 MB
On entering CUDA sdpa main function  allocated = 24291.42285 MB
Before first SDPA allocated = 24291.42285 MB
On chunked entry = 24291.42285 MB
On scale calculation = 24291.43066 MB
Before interleave = 24291.43066 MB
After interleave = 24291.93066 MB
After matmul = 24300.05762 MB
Before local copies matmul = 24300.05762 MB
After local copies = 24300.06055 MB
After first SDPA allocated = 24299.54785 MB
After first copy allocated = 24299.54785 MB
On chunked entry = 24299.54785 MB
On scale calculation = 24299.55566 MB
Before interleave = 24299.55566 MB
After interleave = 24300.10254 MB
After matmul = 24300.10498 MB
Before local copies matmul = 24300.10498 MB
After local copies = 24300.10840 MB
fter compute chunk allocated = 24299.54785 MB
Memory after cuda sdpa 24299.5556640625 MB
1
Memory before offload  24299.5341796875 MB
Memory after offload  24299.5341796875 MB
Memory before cuda sdpa 24299.5478515625 MB
On entering CUDA sdpa main function  allocated = 24299.54785 MB
Before first SDPA allocated = 24299.54785 MB
On chunked entry = 24299.54785 MB
On scale calculation = 24299.55566 MB
Before interleave = 24299.55566 MB
After interleave = 24300.05566 MB
After matmul = 24308.18262 MB
Before local copies matmul = 24308.18262 MB
After local copies = 24308.18555 MB
After first SDPA allocated = 24307.67285 MB
After first copy allocated = 24307.67285 MB
On chunked entry = 24307.67285 MB
On scale calculation = 24307.68066 MB
Before interleave = 24307.68066 MB
After interleave = 24308.22754 MB
After matmul = 24308.22998 MB
Before local copies matmul = 24308.22998 MB
After local copies = 24308.23340 MB
fter compute chunk allocated = 24307.67285 MB
Memory after cuda sdpa 24307.6806640625 MB
1
Memory before offload  24307.6591796875 MB
Memory after offload  24307.6591796875 MB
Memory before cuda sdpa 24307.6728515625 MB
On entering CUDA sdpa main function  allocated = 24307.67285 MB
Before first SDPA allocated = 24307.67285 MB
On chunked entry = 24307.67285 MB
On scale calculation = 24307.68066 MB
Before interleave = 24307.68066 MB
After interleave = 24308.18066 MB
After matmul = 24316.30762 MB
Before local copies matmul = 24316.30762 MB
After local copies = 24316.31055 MB
After first SDPA allocated = 24315.79785 MB
After first copy allocated = 24315.79785 MB
On chunked entry = 24315.79785 MB
On scale calculation = 24315.80566 MB
Before interleave = 24315.80566 MB
After interleave = 24316.35254 MB
After matmul = 24316.35498 MB
Before local copies matmul = 24316.35498 MB
After local copies = 24316.35840 MB
fter compute chunk allocated = 24315.79785 MB
Memory after cuda sdpa 24315.8056640625 MB
1
Memory before offload  24315.7841796875 MB
Memory after offload  24315.7841796875 MB
Memory before cuda sdpa 24315.7978515625 MB
On entering CUDA sdpa main function  allocated = 24315.79785 MB
Before first SDPA allocated = 24315.79785 MB
On chunked entry = 24315.79785 MB
On scale calculation = 24315.80566 MB
Before interleave = 24315.80566 MB
After interleave = 24316.30566 MB
After matmul = 24324.43262 MB
Before local copies matmul = 24324.43262 MB
After local copies = 24324.43555 MB
After first SDPA allocated = 24323.92285 MB
After first copy allocated = 24323.92285 MB
On chunked entry = 24323.92285 MB
On scale calculation = 24323.93066 MB
Before interleave = 24323.93066 MB
After interleave = 24324.47754 MB
After matmul = 24324.47998 MB
Before local copies matmul = 24324.47998 MB
After local copies = 24324.48340 MB
fter compute chunk allocated = 24323.92285 MB
Memory after cuda sdpa 24323.9306640625 MB
1
Memory before offload  24323.9091796875 MB
Memory after offload  24323.9091796875 MB
Memory before cuda sdpa 24323.9228515625 MB
On entering CUDA sdpa main function  allocated = 24323.92285 MB
Before first SDPA allocated = 24323.92285 MB
On chunked entry = 24323.92285 MB
On scale calculation = 24323.93066 MB
Before interleave = 24323.93066 MB
After interleave = 24324.43066 MB
After matmul = 24332.55762 MB
Before local copies matmul = 24332.55762 MB
After local copies = 24332.56055 MB
After first SDPA allocated = 24332.04785 MB
After first copy allocated = 24332.04785 MB
On chunked entry = 24332.04785 MB
On scale calculation = 24332.05566 MB
Before interleave = 24332.05566 MB
After interleave = 24332.60254 MB
After matmul = 24332.60498 MB
Before local copies matmul = 24332.60498 MB
After local copies = 24332.60840 MB
fter compute chunk allocated = 24332.04785 MB
Memory after cuda sdpa 24332.0556640625 MB
1
Memory before offload  24332.0341796875 MB
Memory after offload  24332.0341796875 MB
Memory before cuda sdpa 24332.0478515625 MB
On entering CUDA sdpa main function  allocated = 24332.04785 MB
Before first SDPA allocated = 24332.04785 MB
On chunked entry = 24332.04785 MB
On scale calculation = 24332.05566 MB
Before interleave = 24332.05566 MB
After interleave = 24332.55566 MB
After matmul = 24340.68262 MB
Before local copies matmul = 24340.68262 MB
After local copies = 24340.68555 MB
After first SDPA allocated = 24340.17285 MB
After first copy allocated = 24340.17285 MB
On chunked entry = 24340.17285 MB
On scale calculation = 24340.18066 MB
Before interleave = 24340.18066 MB
After interleave = 24340.72754 MB
After matmul = 24340.72998 MB
Before local copies matmul = 24340.72998 MB
After local copies = 24340.73340 MB
fter compute chunk allocated = 24340.17285 MB
Memory after cuda sdpa 24340.1806640625 MB
1
Memory before offload  24340.1591796875 MB
Memory after offload  24340.1591796875 MB
Memory before cuda sdpa 24340.1728515625 MB
On entering CUDA sdpa main function  allocated = 24340.17285 MB
Before first SDPA allocated = 24340.17285 MB
On chunked entry = 24340.17285 MB
On scale calculation = 24340.18066 MB
Before interleave = 24340.18066 MB
After interleave = 24340.68066 MB
After matmul = 24348.80762 MB
Before local copies matmul = 24348.80762 MB
After local copies = 24348.81055 MB
After first SDPA allocated = 24348.29785 MB
After first copy allocated = 24348.29785 MB
On chunked entry = 24348.29785 MB
On scale calculation = 24348.30566 MB
Before interleave = 24348.30566 MB
After interleave = 24348.85254 MB
After matmul = 24348.85498 MB
Before local copies matmul = 24348.85498 MB
After local copies = 24348.85840 MB
fter compute chunk allocated = 24348.29785 MB
Memory after cuda sdpa 24348.3056640625 MB
1
Memory before offload  24348.2841796875 MB
Memory after offload  24348.2841796875 MB
Memory before cuda sdpa 24348.2978515625 MB
On entering CUDA sdpa main function  allocated = 24348.29785 MB
Before first SDPA allocated = 24348.29785 MB
On chunked entry = 24348.29785 MB
On scale calculation = 24348.30566 MB
Before interleave = 24348.30566 MB
After interleave = 24348.80566 MB
After matmul = 24356.93262 MB
Before local copies matmul = 24356.93262 MB
After local copies = 24356.93555 MB
After first SDPA allocated = 24356.42285 MB
After first copy allocated = 24356.42285 MB
On chunked entry = 24356.42285 MB
On scale calculation = 24356.43066 MB
Before interleave = 24356.43066 MB
After interleave = 24356.97754 MB
After matmul = 24356.97998 MB
Before local copies matmul = 24356.97998 MB
After local copies = 24356.98340 MB
fter compute chunk allocated = 24356.42285 MB
Memory after cuda sdpa 24356.4306640625 MB
1
Memory before offload  24356.4091796875 MB
Memory after offload  24356.4091796875 MB
Memory before cuda sdpa 24356.4228515625 MB
On entering CUDA sdpa main function  allocated = 24356.42285 MB
Before first SDPA allocated = 24356.42285 MB
On chunked entry = 24356.42285 MB
On scale calculation = 24356.43066 MB
Before interleave = 24356.43066 MB
After interleave = 24356.93066 MB
After matmul = 24365.05762 MB
Before local copies matmul = 24365.05762 MB
After local copies = 24365.06055 MB
After first SDPA allocated = 24364.54785 MB
After first copy allocated = 24364.54785 MB
On chunked entry = 24364.54785 MB
On scale calculation = 24364.55566 MB
Before interleave = 24364.55566 MB
After interleave = 24365.10254 MB
After matmul = 24365.10498 MB
Before local copies matmul = 24365.10498 MB
After local copies = 24365.10840 MB
fter compute chunk allocated = 24364.54785 MB
Memory after cuda sdpa 24364.5556640625 MB
1
Memory before offload  24364.5341796875 MB
Memory after offload  24364.5341796875 MB
Memory before cuda sdpa 24364.5478515625 MB
On entering CUDA sdpa main function  allocated = 24364.54785 MB
Before first SDPA allocated = 24364.54785 MB
On chunked entry = 24364.54785 MB
On scale calculation = 24364.55566 MB
Before interleave = 24364.55566 MB
After interleave = 24365.05566 MB
After matmul = 24373.18262 MB
Before local copies matmul = 24373.18262 MB
After local copies = 24373.18555 MB
After first SDPA allocated = 24372.67285 MB
After first copy allocated = 24372.67285 MB
On chunked entry = 24372.67285 MB
On scale calculation = 24372.68066 MB
Before interleave = 24372.68066 MB
After interleave = 24373.22754 MB
After matmul = 24373.22998 MB
Before local copies matmul = 24373.22998 MB
After local copies = 24373.23340 MB
fter compute chunk allocated = 24372.67285 MB
Memory after cuda sdpa 24372.6806640625 MB
1
Memory before offload  24372.6591796875 MB
Memory after offload  24372.6591796875 MB
Memory before cuda sdpa 24372.6728515625 MB
On entering CUDA sdpa main function  allocated = 24372.67285 MB
Before first SDPA allocated = 24372.67285 MB
On chunked entry = 24372.67285 MB
On scale calculation = 24372.68066 MB
Before interleave = 24372.68066 MB
After interleave = 24373.18066 MB
After matmul = 24381.30762 MB
Before local copies matmul = 24381.30762 MB
After local copies = 24381.31055 MB
After first SDPA allocated = 24380.79785 MB
After first copy allocated = 24380.79785 MB
On chunked entry = 24380.79785 MB
On scale calculation = 24380.80566 MB
Before interleave = 24380.80566 MB
After interleave = 24381.35254 MB
After matmul = 24381.35498 MB
Before local copies matmul = 24381.35498 MB
After local copies = 24381.35840 MB
fter compute chunk allocated = 24380.79785 MB
Memory after cuda sdpa 24380.8056640625 MB
1
Memory before offload  24380.7841796875 MB
Memory after offload  24380.7841796875 MB
Memory before cuda sdpa 24380.7978515625 MB
On entering CUDA sdpa main function  allocated = 24380.79785 MB
Before first SDPA allocated = 24380.79785 MB
On chunked entry = 24380.79785 MB
On scale calculation = 24380.80566 MB
Before interleave = 24380.80566 MB
After interleave = 24381.30566 MB
After matmul = 24389.43262 MB
Before local copies matmul = 24389.43262 MB
After local copies = 24389.43555 MB
After first SDPA allocated = 24388.92285 MB
After first copy allocated = 24388.92285 MB
On chunked entry = 24388.92285 MB
On scale calculation = 24388.93066 MB
Before interleave = 24388.93066 MB
After interleave = 24389.47754 MB
After matmul = 24389.47998 MB
Before local copies matmul = 24389.47998 MB
After local copies = 24389.48340 MB
fter compute chunk allocated = 24388.92285 MB
Memory after cuda sdpa 24388.9306640625 MB
1
Memory before offload  24388.9091796875 MB
Memory after offload  24388.9091796875 MB
Memory before cuda sdpa 24388.9228515625 MB
On entering CUDA sdpa main function  allocated = 24388.92285 MB
Before first SDPA allocated = 24388.92285 MB
On chunked entry = 24388.92285 MB
On scale calculation = 24388.93066 MB
Before interleave = 24388.93066 MB
After interleave = 24389.43066 MB
After matmul = 24397.55762 MB
Before local copies matmul = 24397.55762 MB
After local copies = 24397.56055 MB
After first SDPA allocated = 24397.04785 MB
After first copy allocated = 24397.04785 MB
On chunked entry = 24397.04785 MB
On scale calculation = 24397.05566 MB
Before interleave = 24397.05566 MB
After interleave = 24397.60254 MB
After matmul = 24397.60498 MB
Before local copies matmul = 24397.60498 MB
After local copies = 24397.60840 MB
fter compute chunk allocated = 24397.04785 MB
Memory after cuda sdpa 24397.0556640625 MB
1
Memory before offload  24397.0341796875 MB
Memory after offload  24397.0341796875 MB
Memory before cuda sdpa 24397.0478515625 MB
On entering CUDA sdpa main function  allocated = 24397.04785 MB
Before first SDPA allocated = 24397.04785 MB
On chunked entry = 24397.04785 MB
On scale calculation = 24397.05566 MB
Before interleave = 24397.05566 MB
After interleave = 24397.55566 MB
After matmul = 24405.68262 MB
Before local copies matmul = 24405.68262 MB
After local copies = 24405.68555 MB
After first SDPA allocated = 24405.17285 MB
After first copy allocated = 24405.17285 MB
On chunked entry = 24405.17285 MB
On scale calculation = 24405.18066 MB
Before interleave = 24405.18066 MB
After interleave = 24405.72754 MB
After matmul = 24405.72998 MB
Before local copies matmul = 24405.72998 MB
After local copies = 24405.73340 MB
fter compute chunk allocated = 24405.17285 MB
Memory after cuda sdpa 24405.1806640625 MB
1
Memory before offload  24405.1591796875 MB
Memory after offload  24405.1591796875 MB
Memory before cuda sdpa 24405.1728515625 MB
On entering CUDA sdpa main function  allocated = 24405.17285 MB
Before first SDPA allocated = 24405.17285 MB
On chunked entry = 24405.17285 MB
On scale calculation = 24405.18066 MB
Before interleave = 24405.18066 MB
After interleave = 24405.68066 MB
After matmul = 24413.80762 MB
Before local copies matmul = 24413.80762 MB
After local copies = 24413.81055 MB
After first SDPA allocated = 24413.29785 MB
After first copy allocated = 24413.29785 MB
On chunked entry = 24413.29785 MB
On scale calculation = 24413.30566 MB
Before interleave = 24413.30566 MB
After interleave = 24413.85254 MB
After matmul = 24413.85498 MB
Before local copies matmul = 24413.85498 MB
After local copies = 24413.85840 MB
fter compute chunk allocated = 24413.29785 MB
Memory after cuda sdpa 24413.3056640625 MB
1
Memory before offload  24413.2841796875 MB
Memory after offload  24413.2841796875 MB
Memory before cuda sdpa 24413.2978515625 MB
On entering CUDA sdpa main function  allocated = 24413.29785 MB
Before first SDPA allocated = 24413.29785 MB
On chunked entry = 24413.29785 MB
On scale calculation = 24413.30566 MB
Before interleave = 24413.30566 MB
After interleave = 24413.80566 MB
After matmul = 24421.93262 MB
Before local copies matmul = 24421.93262 MB
After local copies = 24421.93555 MB
After first SDPA allocated = 24421.42285 MB
After first copy allocated = 24421.42285 MB
On chunked entry = 24421.42285 MB
On scale calculation = 24421.43066 MB
Before interleave = 24421.43066 MB
After interleave = 24421.97754 MB
After matmul = 24421.97998 MB
Before local copies matmul = 24421.97998 MB
After local copies = 24421.98340 MB
fter compute chunk allocated = 24421.42285 MB
Memory after cuda sdpa 24421.4306640625 MB
1
Memory before offload  24421.4091796875 MB
Memory after offload  24421.4091796875 MB
Memory before cuda sdpa 24421.4228515625 MB
On entering CUDA sdpa main function  allocated = 24421.42285 MB
Before first SDPA allocated = 24421.42285 MB
On chunked entry = 24421.42285 MB
On scale calculation = 24421.43066 MB
Before interleave = 24421.43066 MB
After interleave = 24421.93066 MB
After matmul = 24430.05762 MB
Before local copies matmul = 24430.05762 MB
After local copies = 24430.06055 MB
After first SDPA allocated = 24429.54785 MB
After first copy allocated = 24429.54785 MB
On chunked entry = 24429.54785 MB
On scale calculation = 24429.55566 MB
Before interleave = 24429.55566 MB
After interleave = 24430.10254 MB
After matmul = 24430.10498 MB
Before local copies matmul = 24430.10498 MB
After local copies = 24430.10840 MB
fter compute chunk allocated = 24429.54785 MB
Memory after cuda sdpa 24429.5556640625 MB
1
Memory before offload  24429.5341796875 MB
Memory after offload  24429.5341796875 MB
Memory before cuda sdpa 24429.5478515625 MB
On entering CUDA sdpa main function  allocated = 24429.54785 MB
Before first SDPA allocated = 24429.54785 MB
On chunked entry = 24429.54785 MB
On scale calculation = 24429.55566 MB
Before interleave = 24429.55566 MB
After interleave = 24430.05566 MB
After matmul = 24438.18262 MB
Before local copies matmul = 24438.18262 MB
After local copies = 24438.18555 MB
After first SDPA allocated = 24437.67285 MB
After first copy allocated = 24437.67285 MB
On chunked entry = 24437.67285 MB
On scale calculation = 24437.68066 MB
Before interleave = 24437.68066 MB
After interleave = 24438.22754 MB
After matmul = 24438.22998 MB
Before local copies matmul = 24438.22998 MB
After local copies = 24438.23340 MB
fter compute chunk allocated = 24437.67285 MB
Memory after cuda sdpa 24437.6806640625 MB
1
Memory before offload  24437.6591796875 MB
Memory after offload  24437.6591796875 MB
Memory before cuda sdpa 24437.6728515625 MB
On entering CUDA sdpa main function  allocated = 24437.67285 MB
Before first SDPA allocated = 24437.67285 MB
On chunked entry = 24437.67285 MB
On scale calculation = 24437.68066 MB
Before interleave = 24437.68066 MB
After interleave = 24438.18066 MB
After matmul = 24446.30762 MB
Before local copies matmul = 24446.30762 MB
After local copies = 24446.31055 MB
After first SDPA allocated = 24445.79785 MB
After first copy allocated = 24445.79785 MB
On chunked entry = 24445.79785 MB
On scale calculation = 24445.80566 MB
Before interleave = 24445.80566 MB
After interleave = 24446.35254 MB
After matmul = 24446.35498 MB
Before local copies matmul = 24446.35498 MB
After local copies = 24446.35840 MB
fter compute chunk allocated = 24445.79785 MB
Memory after cuda sdpa 24445.8056640625 MB
Decode step 36
1
Memory before offload  24445.78466796875 MB
Memory after offload  24445.78466796875 MB
Memory before cuda sdpa 24445.79833984375 MB
On entering CUDA sdpa main function  allocated = 24445.79834 MB
Before first SDPA allocated = 24445.79834 MB
On chunked entry = 24445.79834 MB
On scale calculation = 24445.80615 MB
Before interleave = 24445.80615 MB
After interleave = 24446.30615 MB
After matmul = 24454.43311 MB
Before local copies matmul = 24454.43311 MB
After local copies = 24454.43604 MB
After first SDPA allocated = 24453.92334 MB
After first copy allocated = 24453.92334 MB
On chunked entry = 24453.92334 MB
On scale calculation = 24453.93115 MB
Before interleave = 24453.93115 MB
After interleave = 24454.49365 MB
After matmul = 24454.49609 MB
Before local copies matmul = 24454.49609 MB
After local copies = 24454.49951 MB
fter compute chunk allocated = 24453.92334 MB
Memory after cuda sdpa 24453.93115234375 MB
1
Memory before offload  24453.90966796875 MB
Memory after offload  24453.90966796875 MB
Memory before cuda sdpa 24453.92333984375 MB
On entering CUDA sdpa main function  allocated = 24453.92334 MB
Before first SDPA allocated = 24453.92334 MB
On chunked entry = 24453.92334 MB
On scale calculation = 24453.93115 MB
Before interleave = 24453.93115 MB
After interleave = 24454.43115 MB
After matmul = 24462.55811 MB
Before local copies matmul = 24462.55811 MB
After local copies = 24462.56104 MB
After first SDPA allocated = 24462.04834 MB
After first copy allocated = 24462.04834 MB
On chunked entry = 24462.04834 MB
On scale calculation = 24462.05615 MB
Before interleave = 24462.05615 MB
After interleave = 24462.61865 MB
After matmul = 24462.62109 MB
Before local copies matmul = 24462.62109 MB
After local copies = 24462.62451 MB
fter compute chunk allocated = 24462.04834 MB
Memory after cuda sdpa 24462.05615234375 MB
1
Memory before offload  24462.03466796875 MB
Memory after offload  24462.03466796875 MB
Memory before cuda sdpa 24462.04833984375 MB
On entering CUDA sdpa main function  allocated = 24462.04834 MB
Before first SDPA allocated = 24462.04834 MB
On chunked entry = 24462.04834 MB
On scale calculation = 24462.05615 MB
Before interleave = 24462.05615 MB
After interleave = 24462.55615 MB
After matmul = 24470.68311 MB
Before local copies matmul = 24470.68311 MB
After local copies = 24470.68604 MB
After first SDPA allocated = 24470.17334 MB
After first copy allocated = 24470.17334 MB
On chunked entry = 24470.17334 MB
On scale calculation = 24470.18115 MB
Before interleave = 24470.18115 MB
After interleave = 24470.74365 MB
After matmul = 24470.74609 MB
Before local copies matmul = 24470.74609 MB
After local copies = 24470.74951 MB
fter compute chunk allocated = 24470.17334 MB
Memory after cuda sdpa 24470.18115234375 MB
1
Memory before offload  24470.15966796875 MB
Memory after offload  24470.15966796875 MB
Memory before cuda sdpa 24470.17333984375 MB
On entering CUDA sdpa main function  allocated = 24470.17334 MB
Before first SDPA allocated = 24470.17334 MB
On chunked entry = 24470.17334 MB
On scale calculation = 24470.18115 MB
Before interleave = 24470.18115 MB
After interleave = 24470.68115 MB
After matmul = 24478.80811 MB
Before local copies matmul = 24478.80811 MB
After local copies = 24478.81104 MB
After first SDPA allocated = 24478.29834 MB
After first copy allocated = 24478.29834 MB
On chunked entry = 24478.29834 MB
On scale calculation = 24478.30615 MB
Before interleave = 24478.30615 MB
After interleave = 24478.86865 MB
After matmul = 24478.87109 MB
Before local copies matmul = 24478.87109 MB
After local copies = 24478.87451 MB
fter compute chunk allocated = 24478.29834 MB
Memory after cuda sdpa 24478.30615234375 MB
1
Memory before offload  24478.28466796875 MB
Memory after offload  24478.28466796875 MB
Memory before cuda sdpa 24478.29833984375 MB
On entering CUDA sdpa main function  allocated = 24478.29834 MB
Before first SDPA allocated = 24478.29834 MB
On chunked entry = 24478.29834 MB
On scale calculation = 24478.30615 MB
Before interleave = 24478.30615 MB
After interleave = 24478.80615 MB
After matmul = 24486.93311 MB
Before local copies matmul = 24486.93311 MB
After local copies = 24486.93604 MB
After first SDPA allocated = 24486.42334 MB
After first copy allocated = 24486.42334 MB
On chunked entry = 24486.42334 MB
On scale calculation = 24486.43115 MB
Before interleave = 24486.43115 MB
After interleave = 24486.99365 MB
After matmul = 24486.99609 MB
Before local copies matmul = 24486.99609 MB
After local copies = 24486.99951 MB
fter compute chunk allocated = 24486.42334 MB
Memory after cuda sdpa 24486.43115234375 MB
1
Memory before offload  24486.40966796875 MB
Memory after offload  24486.40966796875 MB
Memory before cuda sdpa 24486.42333984375 MB
On entering CUDA sdpa main function  allocated = 24486.42334 MB
Before first SDPA allocated = 24486.42334 MB
On chunked entry = 24486.42334 MB
On scale calculation = 24486.43115 MB
Before interleave = 24486.43115 MB
After interleave = 24486.93115 MB
After matmul = 24495.05811 MB
Before local copies matmul = 24495.05811 MB
After local copies = 24495.06104 MB
After first SDPA allocated = 24494.54834 MB
After first copy allocated = 24494.54834 MB
On chunked entry = 24494.54834 MB
On scale calculation = 24494.55615 MB
Before interleave = 24494.55615 MB
After interleave = 24495.11865 MB
After matmul = 24495.12109 MB
Before local copies matmul = 24495.12109 MB
After local copies = 24495.12451 MB
fter compute chunk allocated = 24494.54834 MB
Memory after cuda sdpa 24494.55615234375 MB
1
Memory before offload  24494.53466796875 MB
Memory after offload  24494.53466796875 MB
Memory before cuda sdpa 24494.54833984375 MB
On entering CUDA sdpa main function  allocated = 24494.54834 MB
Before first SDPA allocated = 24494.54834 MB
On chunked entry = 24494.54834 MB
On scale calculation = 24494.55615 MB
Before interleave = 24494.55615 MB
After interleave = 24495.05615 MB
After matmul = 24503.18311 MB
Before local copies matmul = 24503.18311 MB
After local copies = 24503.18604 MB
After first SDPA allocated = 24502.67334 MB
After first copy allocated = 24502.67334 MB
On chunked entry = 24502.67334 MB
On scale calculation = 24502.68115 MB
Before interleave = 24502.68115 MB
After interleave = 24503.24365 MB
After matmul = 24503.24609 MB
Before local copies matmul = 24503.24609 MB
After local copies = 24503.24951 MB
fter compute chunk allocated = 24502.67334 MB
Memory after cuda sdpa 24502.68115234375 MB
1
Memory before offload  24502.65966796875 MB
Memory after offload  24502.65966796875 MB
Memory before cuda sdpa 24502.67333984375 MB
On entering CUDA sdpa main function  allocated = 24502.67334 MB
Before first SDPA allocated = 24502.67334 MB
On chunked entry = 24502.67334 MB
On scale calculation = 24502.68115 MB
Before interleave = 24502.68115 MB
After interleave = 24503.18115 MB
After matmul = 24511.30811 MB
Before local copies matmul = 24511.30811 MB
After local copies = 24511.31104 MB
After first SDPA allocated = 24510.79834 MB
After first copy allocated = 24510.79834 MB
On chunked entry = 24510.79834 MB
On scale calculation = 24510.80615 MB
Before interleave = 24510.80615 MB
After interleave = 24511.36865 MB
After matmul = 24511.37109 MB
Before local copies matmul = 24511.37109 MB
After local copies = 24511.37451 MB
fter compute chunk allocated = 24510.79834 MB
Memory after cuda sdpa 24510.80615234375 MB
1
Memory before offload  24510.78466796875 MB
Memory after offload  24510.78466796875 MB
Memory before cuda sdpa 24510.79833984375 MB
On entering CUDA sdpa main function  allocated = 24510.79834 MB
Before first SDPA allocated = 24510.79834 MB
On chunked entry = 24510.79834 MB
On scale calculation = 24510.80615 MB
Before interleave = 24510.80615 MB
After interleave = 24511.30615 MB
After matmul = 24519.43311 MB
Before local copies matmul = 24519.43311 MB
After local copies = 24519.43604 MB
After first SDPA allocated = 24518.92334 MB
After first copy allocated = 24518.92334 MB
On chunked entry = 24518.92334 MB
On scale calculation = 24518.93115 MB
Before interleave = 24518.93115 MB
After interleave = 24519.49365 MB
After matmul = 24519.49609 MB
Before local copies matmul = 24519.49609 MB
After local copies = 24519.49951 MB
fter compute chunk allocated = 24518.92334 MB
Memory after cuda sdpa 24518.93115234375 MB
1
Memory before offload  24518.90966796875 MB
Memory after offload  24518.90966796875 MB
Memory before cuda sdpa 24518.92333984375 MB
On entering CUDA sdpa main function  allocated = 24518.92334 MB
Before first SDPA allocated = 24518.92334 MB
On chunked entry = 24518.92334 MB
On scale calculation = 24518.93115 MB
Before interleave = 24518.93115 MB
After interleave = 24519.43115 MB
After matmul = 24527.55811 MB
Before local copies matmul = 24527.55811 MB
After local copies = 24527.56104 MB
After first SDPA allocated = 24527.04834 MB
After first copy allocated = 24527.04834 MB
On chunked entry = 24527.04834 MB
On scale calculation = 24527.05615 MB
Before interleave = 24527.05615 MB
After interleave = 24527.61865 MB
After matmul = 24527.62109 MB
Before local copies matmul = 24527.62109 MB
After local copies = 24527.62451 MB
fter compute chunk allocated = 24527.04834 MB
Memory after cuda sdpa 24527.05615234375 MB
1
Memory before offload  24527.03466796875 MB
Memory after offload  24527.03466796875 MB
Memory before cuda sdpa 24527.04833984375 MB
On entering CUDA sdpa main function  allocated = 24527.04834 MB
Before first SDPA allocated = 24527.04834 MB
On chunked entry = 24527.04834 MB
On scale calculation = 24527.05615 MB
Before interleave = 24527.05615 MB
After interleave = 24527.55615 MB
After matmul = 24535.68311 MB
Before local copies matmul = 24535.68311 MB
After local copies = 24535.68604 MB
After first SDPA allocated = 24535.17334 MB
After first copy allocated = 24535.17334 MB
On chunked entry = 24535.17334 MB
On scale calculation = 24535.18115 MB
Before interleave = 24535.18115 MB
After interleave = 24535.74365 MB
After matmul = 24535.74609 MB
Before local copies matmul = 24535.74609 MB
After local copies = 24535.74951 MB
fter compute chunk allocated = 24535.17334 MB
Memory after cuda sdpa 24535.18115234375 MB
1
Memory before offload  24535.15966796875 MB
Memory after offload  24535.15966796875 MB
Memory before cuda sdpa 24535.17333984375 MB
On entering CUDA sdpa main function  allocated = 24535.17334 MB
Before first SDPA allocated = 24535.17334 MB
On chunked entry = 24535.17334 MB
On scale calculation = 24535.18115 MB
Before interleave = 24535.18115 MB
After interleave = 24535.68115 MB
After matmul = 24543.80811 MB
Before local copies matmul = 24543.80811 MB
After local copies = 24543.81104 MB
After first SDPA allocated = 24543.29834 MB
After first copy allocated = 24543.29834 MB
On chunked entry = 24543.29834 MB
On scale calculation = 24543.30615 MB
Before interleave = 24543.30615 MB
After interleave = 24543.86865 MB
After matmul = 24543.87109 MB
Before local copies matmul = 24543.87109 MB
After local copies = 24543.87451 MB
fter compute chunk allocated = 24543.29834 MB
Memory after cuda sdpa 24543.30615234375 MB
1
Memory before offload  24543.28466796875 MB
Memory after offload  24543.28466796875 MB
Memory before cuda sdpa 24543.29833984375 MB
On entering CUDA sdpa main function  allocated = 24543.29834 MB
Before first SDPA allocated = 24543.29834 MB
On chunked entry = 24543.29834 MB
On scale calculation = 24543.30615 MB
Before interleave = 24543.30615 MB
After interleave = 24543.80615 MB
After matmul = 24551.93311 MB
Before local copies matmul = 24551.93311 MB
After local copies = 24551.93604 MB
After first SDPA allocated = 24551.42334 MB
After first copy allocated = 24551.42334 MB
On chunked entry = 24551.42334 MB
On scale calculation = 24551.43115 MB
Before interleave = 24551.43115 MB
After interleave = 24551.99365 MB
After matmul = 24551.99609 MB
Before local copies matmul = 24551.99609 MB
After local copies = 24551.99951 MB
fter compute chunk allocated = 24551.42334 MB
Memory after cuda sdpa 24551.43115234375 MB
1
Memory before offload  24551.40966796875 MB
Memory after offload  24551.40966796875 MB
Memory before cuda sdpa 24551.42333984375 MB
On entering CUDA sdpa main function  allocated = 24551.42334 MB
Before first SDPA allocated = 24551.42334 MB
On chunked entry = 24551.42334 MB
On scale calculation = 24551.43115 MB
Before interleave = 24551.43115 MB
After interleave = 24551.93115 MB
After matmul = 24560.05811 MB
Before local copies matmul = 24560.05811 MB
After local copies = 24560.06104 MB
After first SDPA allocated = 24559.54834 MB
After first copy allocated = 24559.54834 MB
On chunked entry = 24559.54834 MB
On scale calculation = 24559.55615 MB
Before interleave = 24559.55615 MB
After interleave = 24560.11865 MB
After matmul = 24560.12109 MB
Before local copies matmul = 24560.12109 MB
After local copies = 24560.12451 MB
fter compute chunk allocated = 24559.54834 MB
Memory after cuda sdpa 24559.55615234375 MB
1
Memory before offload  24559.53466796875 MB
Memory after offload  24559.53466796875 MB
Memory before cuda sdpa 24559.54833984375 MB
On entering CUDA sdpa main function  allocated = 24559.54834 MB
Before first SDPA allocated = 24559.54834 MB
On chunked entry = 24559.54834 MB
On scale calculation = 24559.55615 MB
Before interleave = 24559.55615 MB
After interleave = 24560.05615 MB
After matmul = 24568.18311 MB
Before local copies matmul = 24568.18311 MB
After local copies = 24568.18604 MB
After first SDPA allocated = 24567.67334 MB
After first copy allocated = 24567.67334 MB
On chunked entry = 24567.67334 MB
On scale calculation = 24567.68115 MB
Before interleave = 24567.68115 MB
After interleave = 24568.24365 MB
After matmul = 24568.24609 MB
Before local copies matmul = 24568.24609 MB
After local copies = 24568.24951 MB
fter compute chunk allocated = 24567.67334 MB
Memory after cuda sdpa 24567.68115234375 MB
1
Memory before offload  24567.65966796875 MB
Memory after offload  24567.65966796875 MB
Memory before cuda sdpa 24567.67333984375 MB
On entering CUDA sdpa main function  allocated = 24567.67334 MB
Before first SDPA allocated = 24567.67334 MB
On chunked entry = 24567.67334 MB
On scale calculation = 24567.68115 MB
Before interleave = 24567.68115 MB
After interleave = 24568.18115 MB
After matmul = 24576.30811 MB
Before local copies matmul = 24576.30811 MB
After local copies = 24576.31104 MB
After first SDPA allocated = 24575.79834 MB
After first copy allocated = 24575.79834 MB
On chunked entry = 24575.79834 MB
On scale calculation = 24575.80615 MB
Before interleave = 24575.80615 MB
After interleave = 24576.36865 MB
After matmul = 24576.37109 MB
Before local copies matmul = 24576.37109 MB
After local copies = 24576.37451 MB
fter compute chunk allocated = 24575.79834 MB
Memory after cuda sdpa 24575.80615234375 MB
1
Memory before offload  24575.78466796875 MB
Memory after offload  24575.78466796875 MB
Memory before cuda sdpa 24575.79833984375 MB
On entering CUDA sdpa main function  allocated = 24575.79834 MB
Before first SDPA allocated = 24575.79834 MB
On chunked entry = 24575.79834 MB
On scale calculation = 24575.80615 MB
Before interleave = 24575.80615 MB
After interleave = 24576.30615 MB
After matmul = 24584.43311 MB
Before local copies matmul = 24584.43311 MB
After local copies = 24584.43604 MB
After first SDPA allocated = 24583.92334 MB
After first copy allocated = 24583.92334 MB
On chunked entry = 24583.92334 MB
On scale calculation = 24583.93115 MB
Before interleave = 24583.93115 MB
After interleave = 24584.49365 MB
After matmul = 24584.49609 MB
Before local copies matmul = 24584.49609 MB
After local copies = 24584.49951 MB
fter compute chunk allocated = 24583.92334 MB
Memory after cuda sdpa 24583.93115234375 MB
1
Memory before offload  24583.90966796875 MB
Memory after offload  24583.90966796875 MB
Memory before cuda sdpa 24583.92333984375 MB
On entering CUDA sdpa main function  allocated = 24583.92334 MB
Before first SDPA allocated = 24583.92334 MB
On chunked entry = 24583.92334 MB
On scale calculation = 24583.93115 MB
Before interleave = 24583.93115 MB
After interleave = 24584.43115 MB
After matmul = 24592.55811 MB
Before local copies matmul = 24592.55811 MB
After local copies = 24592.56104 MB
After first SDPA allocated = 24592.04834 MB
After first copy allocated = 24592.04834 MB
On chunked entry = 24592.04834 MB
On scale calculation = 24592.05615 MB
Before interleave = 24592.05615 MB
After interleave = 24592.61865 MB
After matmul = 24592.62109 MB
Before local copies matmul = 24592.62109 MB
After local copies = 24592.62451 MB
fter compute chunk allocated = 24592.04834 MB
Memory after cuda sdpa 24592.05615234375 MB
1
Memory before offload  24592.03466796875 MB
Memory after offload  24592.03466796875 MB
Memory before cuda sdpa 24592.04833984375 MB
On entering CUDA sdpa main function  allocated = 24592.04834 MB
Before first SDPA allocated = 24592.04834 MB
On chunked entry = 24592.04834 MB
On scale calculation = 24592.05615 MB
Before interleave = 24592.05615 MB
After interleave = 24592.55615 MB
After matmul = 24600.68311 MB
Before local copies matmul = 24600.68311 MB
After local copies = 24600.68604 MB
After first SDPA allocated = 24600.17334 MB
After first copy allocated = 24600.17334 MB
On chunked entry = 24600.17334 MB
On scale calculation = 24600.18115 MB
Before interleave = 24600.18115 MB
After interleave = 24600.74365 MB
After matmul = 24600.74609 MB
Before local copies matmul = 24600.74609 MB
After local copies = 24600.74951 MB
fter compute chunk allocated = 24600.17334 MB
Memory after cuda sdpa 24600.18115234375 MB
1
Memory before offload  24600.15966796875 MB
Memory after offload  24600.15966796875 MB
Memory before cuda sdpa 24600.17333984375 MB
On entering CUDA sdpa main function  allocated = 24600.17334 MB
Before first SDPA allocated = 24600.17334 MB
On chunked entry = 24600.17334 MB
On scale calculation = 24600.18115 MB
Before interleave = 24600.18115 MB
After interleave = 24600.68115 MB
After matmul = 24608.80811 MB
Before local copies matmul = 24608.80811 MB
After local copies = 24608.81104 MB
After first SDPA allocated = 24608.29834 MB
After first copy allocated = 24608.29834 MB
On chunked entry = 24608.29834 MB
On scale calculation = 24608.30615 MB
Before interleave = 24608.30615 MB
After interleave = 24608.86865 MB
After matmul = 24608.87109 MB
Before local copies matmul = 24608.87109 MB
After local copies = 24608.87451 MB
fter compute chunk allocated = 24608.29834 MB
Memory after cuda sdpa 24608.30615234375 MB
1
Memory before offload  24608.28466796875 MB
Memory after offload  24608.28466796875 MB
Memory before cuda sdpa 24608.29833984375 MB
On entering CUDA sdpa main function  allocated = 24608.29834 MB
Before first SDPA allocated = 24608.29834 MB
On chunked entry = 24608.29834 MB
On scale calculation = 24608.30615 MB
Before interleave = 24608.30615 MB
After interleave = 24608.80615 MB
After matmul = 24616.93311 MB
Before local copies matmul = 24616.93311 MB
After local copies = 24616.93604 MB
After first SDPA allocated = 24616.42334 MB
After first copy allocated = 24616.42334 MB
On chunked entry = 24616.42334 MB
On scale calculation = 24616.43115 MB
Before interleave = 24616.43115 MB
After interleave = 24616.99365 MB
After matmul = 24616.99609 MB
Before local copies matmul = 24616.99609 MB
After local copies = 24616.99951 MB
fter compute chunk allocated = 24616.42334 MB
Memory after cuda sdpa 24616.43115234375 MB
1
Memory before offload  24616.40966796875 MB
Memory after offload  24616.40966796875 MB
Memory before cuda sdpa 24616.42333984375 MB
On entering CUDA sdpa main function  allocated = 24616.42334 MB
Before first SDPA allocated = 24616.42334 MB
On chunked entry = 24616.42334 MB
On scale calculation = 24616.43115 MB
Before interleave = 24616.43115 MB
After interleave = 24616.93115 MB
After matmul = 24625.05811 MB
Before local copies matmul = 24625.05811 MB
After local copies = 24625.06104 MB
After first SDPA allocated = 24624.54834 MB
After first copy allocated = 24624.54834 MB
On chunked entry = 24624.54834 MB
On scale calculation = 24624.55615 MB
Before interleave = 24624.55615 MB
After interleave = 24625.11865 MB
After matmul = 24625.12109 MB
Before local copies matmul = 24625.12109 MB
After local copies = 24625.12451 MB
fter compute chunk allocated = 24624.54834 MB
Memory after cuda sdpa 24624.55615234375 MB
1
Memory before offload  24624.53466796875 MB
Memory after offload  24624.53466796875 MB
Memory before cuda sdpa 24624.54833984375 MB
On entering CUDA sdpa main function  allocated = 24624.54834 MB
Before first SDPA allocated = 24624.54834 MB
On chunked entry = 24624.54834 MB
On scale calculation = 24624.55615 MB
Before interleave = 24624.55615 MB
After interleave = 24625.05615 MB
After matmul = 24633.18311 MB
Before local copies matmul = 24633.18311 MB
After local copies = 24633.18604 MB
After first SDPA allocated = 24632.67334 MB
After first copy allocated = 24632.67334 MB
On chunked entry = 24632.67334 MB
On scale calculation = 24632.68115 MB
Before interleave = 24632.68115 MB
After interleave = 24633.24365 MB
After matmul = 24633.24609 MB
Before local copies matmul = 24633.24609 MB
After local copies = 24633.24951 MB
fter compute chunk allocated = 24632.67334 MB
Memory after cuda sdpa 24632.68115234375 MB
1
Memory before offload  24632.65966796875 MB
Memory after offload  24632.65966796875 MB
Memory before cuda sdpa 24632.67333984375 MB
On entering CUDA sdpa main function  allocated = 24632.67334 MB
Before first SDPA allocated = 24632.67334 MB
On chunked entry = 24632.67334 MB
On scale calculation = 24632.68115 MB
Before interleave = 24632.68115 MB
After interleave = 24633.18115 MB
After matmul = 24641.30811 MB
Before local copies matmul = 24641.30811 MB
After local copies = 24641.31104 MB
After first SDPA allocated = 24640.79834 MB
After first copy allocated = 24640.79834 MB
On chunked entry = 24640.79834 MB
On scale calculation = 24640.80615 MB
Before interleave = 24640.80615 MB
After interleave = 24641.36865 MB
After matmul = 24641.37109 MB
Before local copies matmul = 24641.37109 MB
After local copies = 24641.37451 MB
fter compute chunk allocated = 24640.79834 MB
Memory after cuda sdpa 24640.80615234375 MB
1
Memory before offload  24640.78466796875 MB
Memory after offload  24640.78466796875 MB
Memory before cuda sdpa 24640.79833984375 MB
On entering CUDA sdpa main function  allocated = 24640.79834 MB
Before first SDPA allocated = 24640.79834 MB
On chunked entry = 24640.79834 MB
On scale calculation = 24640.80615 MB
Before interleave = 24640.80615 MB
After interleave = 24641.30615 MB
After matmul = 24649.43311 MB
Before local copies matmul = 24649.43311 MB
After local copies = 24649.43604 MB
After first SDPA allocated = 24648.92334 MB
After first copy allocated = 24648.92334 MB
On chunked entry = 24648.92334 MB
On scale calculation = 24648.93115 MB
Before interleave = 24648.93115 MB
After interleave = 24649.49365 MB
After matmul = 24649.49609 MB
Before local copies matmul = 24649.49609 MB
After local copies = 24649.49951 MB
fter compute chunk allocated = 24648.92334 MB
Memory after cuda sdpa 24648.93115234375 MB
1
Memory before offload  24648.90966796875 MB
Memory after offload  24648.90966796875 MB
Memory before cuda sdpa 24648.92333984375 MB
On entering CUDA sdpa main function  allocated = 24648.92334 MB
Before first SDPA allocated = 24648.92334 MB
On chunked entry = 24648.92334 MB
On scale calculation = 24648.93115 MB
Before interleave = 24648.93115 MB
After interleave = 24649.43115 MB
After matmul = 24657.55811 MB
Before local copies matmul = 24657.55811 MB
After local copies = 24657.56104 MB
After first SDPA allocated = 24657.04834 MB
After first copy allocated = 24657.04834 MB
On chunked entry = 24657.04834 MB
On scale calculation = 24657.05615 MB
Before interleave = 24657.05615 MB
After interleave = 24657.61865 MB
After matmul = 24657.62109 MB
Before local copies matmul = 24657.62109 MB
After local copies = 24657.62451 MB
fter compute chunk allocated = 24657.04834 MB
Memory after cuda sdpa 24657.05615234375 MB
1
Memory before offload  24657.03466796875 MB
Memory after offload  24657.03466796875 MB
Memory before cuda sdpa 24657.04833984375 MB
On entering CUDA sdpa main function  allocated = 24657.04834 MB
Before first SDPA allocated = 24657.04834 MB
On chunked entry = 24657.04834 MB
On scale calculation = 24657.05615 MB
Before interleave = 24657.05615 MB
After interleave = 24657.55615 MB
After matmul = 24665.68311 MB
Before local copies matmul = 24665.68311 MB
After local copies = 24665.68604 MB
After first SDPA allocated = 24665.17334 MB
After first copy allocated = 24665.17334 MB
On chunked entry = 24665.17334 MB
On scale calculation = 24665.18115 MB
Before interleave = 24665.18115 MB
After interleave = 24665.74365 MB
After matmul = 24665.74609 MB
Before local copies matmul = 24665.74609 MB
After local copies = 24665.74951 MB
fter compute chunk allocated = 24665.17334 MB
Memory after cuda sdpa 24665.18115234375 MB
1
Memory before offload  24665.15966796875 MB
Memory after offload  24665.15966796875 MB
Memory before cuda sdpa 24665.17333984375 MB
On entering CUDA sdpa main function  allocated = 24665.17334 MB
Before first SDPA allocated = 24665.17334 MB
On chunked entry = 24665.17334 MB
On scale calculation = 24665.18115 MB
Before interleave = 24665.18115 MB
After interleave = 24665.68115 MB
After matmul = 24673.80811 MB
Before local copies matmul = 24673.80811 MB
After local copies = 24673.81104 MB
After first SDPA allocated = 24673.29834 MB
After first copy allocated = 24673.29834 MB
On chunked entry = 24673.29834 MB
On scale calculation = 24673.30615 MB
Before interleave = 24673.30615 MB
After interleave = 24673.86865 MB
After matmul = 24673.87109 MB
Before local copies matmul = 24673.87109 MB
After local copies = 24673.87451 MB
fter compute chunk allocated = 24673.29834 MB
Memory after cuda sdpa 24673.30615234375 MB
1
Memory before offload  24673.28466796875 MB
Memory after offload  24673.28466796875 MB
Memory before cuda sdpa 24673.29833984375 MB
On entering CUDA sdpa main function  allocated = 24673.29834 MB
Before first SDPA allocated = 24673.29834 MB
On chunked entry = 24673.29834 MB
On scale calculation = 24673.30615 MB
Before interleave = 24673.30615 MB
After interleave = 24673.80615 MB
After matmul = 24681.93311 MB
Before local copies matmul = 24681.93311 MB
After local copies = 24681.93604 MB
After first SDPA allocated = 24681.42334 MB
After first copy allocated = 24681.42334 MB
On chunked entry = 24681.42334 MB
On scale calculation = 24681.43115 MB
Before interleave = 24681.43115 MB
After interleave = 24681.99365 MB
After matmul = 24681.99609 MB
Before local copies matmul = 24681.99609 MB
After local copies = 24681.99951 MB
fter compute chunk allocated = 24681.42334 MB
Memory after cuda sdpa 24681.43115234375 MB
1
Memory before offload  24681.40966796875 MB
Memory after offload  24681.40966796875 MB
Memory before cuda sdpa 24681.42333984375 MB
On entering CUDA sdpa main function  allocated = 24681.42334 MB
Before first SDPA allocated = 24681.42334 MB
On chunked entry = 24681.42334 MB
On scale calculation = 24681.43115 MB
Before interleave = 24681.43115 MB
After interleave = 24681.93115 MB
After matmul = 24690.05811 MB
Before local copies matmul = 24690.05811 MB
After local copies = 24690.06104 MB
After first SDPA allocated = 24689.54834 MB
After first copy allocated = 24689.54834 MB
On chunked entry = 24689.54834 MB
On scale calculation = 24689.55615 MB
Before interleave = 24689.55615 MB
After interleave = 24690.11865 MB
After matmul = 24690.12109 MB
Before local copies matmul = 24690.12109 MB
After local copies = 24690.12451 MB
fter compute chunk allocated = 24689.54834 MB
Memory after cuda sdpa 24689.55615234375 MB
1
Memory before offload  24689.53466796875 MB
Memory after offload  24689.53466796875 MB
Memory before cuda sdpa 24689.54833984375 MB
On entering CUDA sdpa main function  allocated = 24689.54834 MB
Before first SDPA allocated = 24689.54834 MB
On chunked entry = 24689.54834 MB
On scale calculation = 24689.55615 MB
Before interleave = 24689.55615 MB
After interleave = 24690.05615 MB
After matmul = 24698.18311 MB
Before local copies matmul = 24698.18311 MB
After local copies = 24698.18604 MB
After first SDPA allocated = 24697.67334 MB
After first copy allocated = 24697.67334 MB
On chunked entry = 24697.67334 MB
On scale calculation = 24697.68115 MB
Before interleave = 24697.68115 MB
After interleave = 24698.24365 MB
After matmul = 24698.24609 MB
Before local copies matmul = 24698.24609 MB
After local copies = 24698.24951 MB
fter compute chunk allocated = 24697.67334 MB
Memory after cuda sdpa 24697.68115234375 MB
1
Memory before offload  24697.65966796875 MB
Memory after offload  24697.65966796875 MB
Memory before cuda sdpa 24697.67333984375 MB
On entering CUDA sdpa main function  allocated = 24697.67334 MB
Before first SDPA allocated = 24697.67334 MB
On chunked entry = 24697.67334 MB
On scale calculation = 24697.68115 MB
Before interleave = 24697.68115 MB
After interleave = 24698.18115 MB
After matmul = 24706.30811 MB
Before local copies matmul = 24706.30811 MB
After local copies = 24706.31104 MB
After first SDPA allocated = 24705.79834 MB
After first copy allocated = 24705.79834 MB
On chunked entry = 24705.79834 MB
On scale calculation = 24705.80615 MB
Before interleave = 24705.80615 MB
After interleave = 24706.36865 MB
After matmul = 24706.37109 MB
Before local copies matmul = 24706.37109 MB
After local copies = 24706.37451 MB
fter compute chunk allocated = 24705.79834 MB
Memory after cuda sdpa 24705.80615234375 MB
Decode step 37
1
Memory before offload  24705.78515625 MB
Memory after offload  24705.78515625 MB
Memory before cuda sdpa 24705.798828125 MB
On entering CUDA sdpa main function  allocated = 24705.79883 MB
Before first SDPA allocated = 24705.79883 MB
On chunked entry = 24705.79883 MB
On scale calculation = 24705.80664 MB
Before interleave = 24705.80664 MB
After interleave = 24706.30664 MB
After matmul = 24714.43359 MB
Before local copies matmul = 24714.43359 MB
After local copies = 24714.43652 MB
After first SDPA allocated = 24713.92383 MB
After first copy allocated = 24713.92383 MB
On chunked entry = 24713.92383 MB
On scale calculation = 24713.93164 MB
Before interleave = 24713.93164 MB
After interleave = 24714.50977 MB
After matmul = 24714.51221 MB
Before local copies matmul = 24714.51221 MB
After local copies = 24714.51562 MB
fter compute chunk allocated = 24713.92383 MB
Memory after cuda sdpa 24713.931640625 MB
1
Memory before offload  24713.91015625 MB
Memory after offload  24713.91015625 MB
Memory before cuda sdpa 24713.923828125 MB
On entering CUDA sdpa main function  allocated = 24713.92383 MB
Before first SDPA allocated = 24713.92383 MB
On chunked entry = 24713.92383 MB
On scale calculation = 24713.93164 MB
Before interleave = 24713.93164 MB
After interleave = 24714.43164 MB
After matmul = 24722.55859 MB
Before local copies matmul = 24722.55859 MB
After local copies = 24722.56152 MB
After first SDPA allocated = 24722.04883 MB
After first copy allocated = 24722.04883 MB
On chunked entry = 24722.04883 MB
On scale calculation = 24722.05664 MB
Before interleave = 24722.05664 MB
After interleave = 24722.63477 MB
After matmul = 24722.63721 MB
Before local copies matmul = 24722.63721 MB
After local copies = 24722.64062 MB
fter compute chunk allocated = 24722.04883 MB
Memory after cuda sdpa 24722.056640625 MB
1
Memory before offload  24722.03515625 MB
Memory after offload  24722.03515625 MB
Memory before cuda sdpa 24722.048828125 MB
On entering CUDA sdpa main function  allocated = 24722.04883 MB
Before first SDPA allocated = 24722.04883 MB
On chunked entry = 24722.04883 MB
On scale calculation = 24722.05664 MB
Before interleave = 24722.05664 MB
After interleave = 24722.55664 MB
After matmul = 24730.68359 MB
Before local copies matmul = 24730.68359 MB
After local copies = 24730.68652 MB
After first SDPA allocated = 24730.17383 MB
After first copy allocated = 24730.17383 MB
On chunked entry = 24730.17383 MB
On scale calculation = 24730.18164 MB
Before interleave = 24730.18164 MB
After interleave = 24730.75977 MB
After matmul = 24730.76221 MB
Before local copies matmul = 24730.76221 MB
After local copies = 24730.76562 MB
fter compute chunk allocated = 24730.17383 MB
Memory after cuda sdpa 24730.181640625 MB
1
Memory before offload  24730.16015625 MB
Memory after offload  24730.16015625 MB
Memory before cuda sdpa 24730.173828125 MB
On entering CUDA sdpa main function  allocated = 24730.17383 MB
Before first SDPA allocated = 24730.17383 MB
On chunked entry = 24730.17383 MB
On scale calculation = 24730.18164 MB
Before interleave = 24730.18164 MB
After interleave = 24730.68164 MB
After matmul = 24738.80859 MB
Before local copies matmul = 24738.80859 MB
After local copies = 24738.81152 MB
After first SDPA allocated = 24738.29883 MB
After first copy allocated = 24738.29883 MB
On chunked entry = 24738.29883 MB
On scale calculation = 24738.30664 MB
Before interleave = 24738.30664 MB
After interleave = 24738.88477 MB
After matmul = 24738.88721 MB
Before local copies matmul = 24738.88721 MB
After local copies = 24738.89062 MB
fter compute chunk allocated = 24738.29883 MB
Memory after cuda sdpa 24738.306640625 MB
1
Memory before offload  24738.28515625 MB
Memory after offload  24738.28515625 MB
Memory before cuda sdpa 24738.298828125 MB
On entering CUDA sdpa main function  allocated = 24738.29883 MB
Before first SDPA allocated = 24738.29883 MB
On chunked entry = 24738.29883 MB
On scale calculation = 24738.30664 MB
Before interleave = 24738.30664 MB
After interleave = 24738.80664 MB
After matmul = 24746.93359 MB
Before local copies matmul = 24746.93359 MB
After local copies = 24746.93652 MB
After first SDPA allocated = 24746.42383 MB
After first copy allocated = 24746.42383 MB
On chunked entry = 24746.42383 MB
On scale calculation = 24746.43164 MB
Before interleave = 24746.43164 MB
After interleave = 24747.00977 MB
After matmul = 24747.01221 MB
Before local copies matmul = 24747.01221 MB
After local copies = 24747.01562 MB
fter compute chunk allocated = 24746.42383 MB
Memory after cuda sdpa 24746.431640625 MB
1
Memory before offload  24746.41015625 MB
Memory after offload  24746.41015625 MB
Memory before cuda sdpa 24746.423828125 MB
On entering CUDA sdpa main function  allocated = 24746.42383 MB
Before first SDPA allocated = 24746.42383 MB
On chunked entry = 24746.42383 MB
On scale calculation = 24746.43164 MB
Before interleave = 24746.43164 MB
After interleave = 24746.93164 MB
After matmul = 24755.05859 MB
Before local copies matmul = 24755.05859 MB
After local copies = 24755.06152 MB
After first SDPA allocated = 24754.54883 MB
After first copy allocated = 24754.54883 MB
On chunked entry = 24754.54883 MB
On scale calculation = 24754.55664 MB
Before interleave = 24754.55664 MB
After interleave = 24755.13477 MB
After matmul = 24755.13721 MB
Before local copies matmul = 24755.13721 MB
After local copies = 24755.14062 MB
fter compute chunk allocated = 24754.54883 MB
Memory after cuda sdpa 24754.556640625 MB
1
Memory before offload  24754.53515625 MB
Memory after offload  24754.53515625 MB
Memory before cuda sdpa 24754.548828125 MB
On entering CUDA sdpa main function  allocated = 24754.54883 MB
Before first SDPA allocated = 24754.54883 MB
On chunked entry = 24754.54883 MB
On scale calculation = 24754.55664 MB
Before interleave = 24754.55664 MB
After interleave = 24755.05664 MB
After matmul = 24763.18359 MB
Before local copies matmul = 24763.18359 MB
After local copies = 24763.18652 MB
After first SDPA allocated = 24762.67383 MB
After first copy allocated = 24762.67383 MB
On chunked entry = 24762.67383 MB
On scale calculation = 24762.68164 MB
Before interleave = 24762.68164 MB
After interleave = 24763.25977 MB
After matmul = 24763.26221 MB
Before local copies matmul = 24763.26221 MB
After local copies = 24763.26562 MB
fter compute chunk allocated = 24762.67383 MB
Memory after cuda sdpa 24762.681640625 MB
1
Memory before offload  24762.66015625 MB
Memory after offload  24762.66015625 MB
Memory before cuda sdpa 24762.673828125 MB
On entering CUDA sdpa main function  allocated = 24762.67383 MB
Before first SDPA allocated = 24762.67383 MB
On chunked entry = 24762.67383 MB
On scale calculation = 24762.68164 MB
Before interleave = 24762.68164 MB
After interleave = 24763.18164 MB
After matmul = 24771.30859 MB
Before local copies matmul = 24771.30859 MB
After local copies = 24771.31152 MB
After first SDPA allocated = 24770.79883 MB
After first copy allocated = 24770.79883 MB
On chunked entry = 24770.79883 MB
On scale calculation = 24770.80664 MB
Before interleave = 24770.80664 MB
After interleave = 24771.38477 MB
After matmul = 24771.38721 MB
Before local copies matmul = 24771.38721 MB
After local copies = 24771.39062 MB
fter compute chunk allocated = 24770.79883 MB
Memory after cuda sdpa 24770.806640625 MB
1
Memory before offload  24770.78515625 MB
Memory after offload  24770.78515625 MB
Memory before cuda sdpa 24770.798828125 MB
On entering CUDA sdpa main function  allocated = 24770.79883 MB
Before first SDPA allocated = 24770.79883 MB
On chunked entry = 24770.79883 MB
On scale calculation = 24770.80664 MB
Before interleave = 24770.80664 MB
After interleave = 24771.30664 MB
After matmul = 24779.43359 MB
Before local copies matmul = 24779.43359 MB
After local copies = 24779.43652 MB
After first SDPA allocated = 24778.92383 MB
After first copy allocated = 24778.92383 MB
On chunked entry = 24778.92383 MB
On scale calculation = 24778.93164 MB
Before interleave = 24778.93164 MB
After interleave = 24779.50977 MB
After matmul = 24779.51221 MB
Before local copies matmul = 24779.51221 MB
After local copies = 24779.51562 MB
fter compute chunk allocated = 24778.92383 MB
Memory after cuda sdpa 24778.931640625 MB
1
Memory before offload  24778.91015625 MB
Memory after offload  24778.91015625 MB
Memory before cuda sdpa 24778.923828125 MB
On entering CUDA sdpa main function  allocated = 24778.92383 MB
Before first SDPA allocated = 24778.92383 MB
On chunked entry = 24778.92383 MB
On scale calculation = 24778.93164 MB
Before interleave = 24778.93164 MB
After interleave = 24779.43164 MB
After matmul = 24787.55859 MB
Before local copies matmul = 24787.55859 MB
After local copies = 24787.56152 MB
After first SDPA allocated = 24787.04883 MB
After first copy allocated = 24787.04883 MB
On chunked entry = 24787.04883 MB
On scale calculation = 24787.05664 MB
Before interleave = 24787.05664 MB
After interleave = 24787.63477 MB
After matmul = 24787.63721 MB
Before local copies matmul = 24787.63721 MB
After local copies = 24787.64062 MB
fter compute chunk allocated = 24787.04883 MB
Memory after cuda sdpa 24787.056640625 MB
1
Memory before offload  24787.03515625 MB
Memory after offload  24787.03515625 MB
Memory before cuda sdpa 24787.048828125 MB
On entering CUDA sdpa main function  allocated = 24787.04883 MB
Before first SDPA allocated = 24787.04883 MB
On chunked entry = 24787.04883 MB
On scale calculation = 24787.05664 MB
Before interleave = 24787.05664 MB
After interleave = 24787.55664 MB
After matmul = 24795.68359 MB
Before local copies matmul = 24795.68359 MB
After local copies = 24795.68652 MB
After first SDPA allocated = 24795.17383 MB
After first copy allocated = 24795.17383 MB
On chunked entry = 24795.17383 MB
On scale calculation = 24795.18164 MB
Before interleave = 24795.18164 MB
After interleave = 24795.75977 MB
After matmul = 24795.76221 MB
Before local copies matmul = 24795.76221 MB
After local copies = 24795.76562 MB
fter compute chunk allocated = 24795.17383 MB
Memory after cuda sdpa 24795.181640625 MB
1
Memory before offload  24795.16015625 MB
Memory after offload  24795.16015625 MB
Memory before cuda sdpa 24795.173828125 MB
On entering CUDA sdpa main function  allocated = 24795.17383 MB
Before first SDPA allocated = 24795.17383 MB
On chunked entry = 24795.17383 MB
On scale calculation = 24795.18164 MB
Before interleave = 24795.18164 MB
After interleave = 24795.68164 MB
After matmul = 24803.80859 MB
Before local copies matmul = 24803.80859 MB
After local copies = 24803.81152 MB
After first SDPA allocated = 24803.29883 MB
After first copy allocated = 24803.29883 MB
On chunked entry = 24803.29883 MB
On scale calculation = 24803.30664 MB
Before interleave = 24803.30664 MB
After interleave = 24803.88477 MB
After matmul = 24803.88721 MB
Before local copies matmul = 24803.88721 MB
After local copies = 24803.89062 MB
fter compute chunk allocated = 24803.29883 MB
Memory after cuda sdpa 24803.306640625 MB
1
Memory before offload  24803.28515625 MB
Memory after offload  24803.28515625 MB
Memory before cuda sdpa 24803.298828125 MB
On entering CUDA sdpa main function  allocated = 24803.29883 MB
Before first SDPA allocated = 24803.29883 MB
On chunked entry = 24803.29883 MB
On scale calculation = 24803.30664 MB
Before interleave = 24803.30664 MB
After interleave = 24803.80664 MB
After matmul = 24811.93359 MB
Before local copies matmul = 24811.93359 MB
After local copies = 24811.93652 MB
After first SDPA allocated = 24811.42383 MB
After first copy allocated = 24811.42383 MB
On chunked entry = 24811.42383 MB
On scale calculation = 24811.43164 MB
Before interleave = 24811.43164 MB
After interleave = 24812.00977 MB
After matmul = 24812.01221 MB
Before local copies matmul = 24812.01221 MB
After local copies = 24812.01562 MB
fter compute chunk allocated = 24811.42383 MB
Memory after cuda sdpa 24811.431640625 MB
1
Memory before offload  24811.41015625 MB
Memory after offload  24811.41015625 MB
Memory before cuda sdpa 24811.423828125 MB
On entering CUDA sdpa main function  allocated = 24811.42383 MB
Before first SDPA allocated = 24811.42383 MB
On chunked entry = 24811.42383 MB
On scale calculation = 24811.43164 MB
Before interleave = 24811.43164 MB
After interleave = 24811.93164 MB
After matmul = 24820.05859 MB
Before local copies matmul = 24820.05859 MB
After local copies = 24820.06152 MB
After first SDPA allocated = 24819.54883 MB
After first copy allocated = 24819.54883 MB
On chunked entry = 24819.54883 MB
On scale calculation = 24819.55664 MB
Before interleave = 24819.55664 MB
After interleave = 24820.13477 MB
After matmul = 24820.13721 MB
Before local copies matmul = 24820.13721 MB
After local copies = 24820.14062 MB
fter compute chunk allocated = 24819.54883 MB
Memory after cuda sdpa 24819.556640625 MB
1
Memory before offload  24819.53515625 MB
Memory after offload  24819.53515625 MB
Memory before cuda sdpa 24819.548828125 MB
On entering CUDA sdpa main function  allocated = 24819.54883 MB
Before first SDPA allocated = 24819.54883 MB
On chunked entry = 24819.54883 MB
On scale calculation = 24819.55664 MB
Before interleave = 24819.55664 MB
After interleave = 24820.05664 MB
After matmul = 24828.18359 MB
Before local copies matmul = 24828.18359 MB
After local copies = 24828.18652 MB
After first SDPA allocated = 24827.67383 MB
After first copy allocated = 24827.67383 MB
On chunked entry = 24827.67383 MB
On scale calculation = 24827.68164 MB
Before interleave = 24827.68164 MB
After interleave = 24828.25977 MB
After matmul = 24828.26221 MB
Before local copies matmul = 24828.26221 MB
After local copies = 24828.26562 MB
fter compute chunk allocated = 24827.67383 MB
Memory after cuda sdpa 24827.681640625 MB
1
Memory before offload  24827.66015625 MB
Memory after offload  24827.66015625 MB
Memory before cuda sdpa 24827.673828125 MB
On entering CUDA sdpa main function  allocated = 24827.67383 MB
Before first SDPA allocated = 24827.67383 MB
On chunked entry = 24827.67383 MB
On scale calculation = 24827.68164 MB
Before interleave = 24827.68164 MB
After interleave = 24828.18164 MB
After matmul = 24836.30859 MB
Before local copies matmul = 24836.30859 MB
After local copies = 24836.31152 MB
After first SDPA allocated = 24835.79883 MB
After first copy allocated = 24835.79883 MB
On chunked entry = 24835.79883 MB
On scale calculation = 24835.80664 MB
Before interleave = 24835.80664 MB
After interleave = 24836.38477 MB
After matmul = 24836.38721 MB
Before local copies matmul = 24836.38721 MB
After local copies = 24836.39062 MB
fter compute chunk allocated = 24835.79883 MB
Memory after cuda sdpa 24835.806640625 MB
1
Memory before offload  24835.78515625 MB
Memory after offload  24835.78515625 MB
Memory before cuda sdpa 24835.798828125 MB
On entering CUDA sdpa main function  allocated = 24835.79883 MB
Before first SDPA allocated = 24835.79883 MB
On chunked entry = 24835.79883 MB
On scale calculation = 24835.80664 MB
Before interleave = 24835.80664 MB
After interleave = 24836.30664 MB
After matmul = 24844.43359 MB
Before local copies matmul = 24844.43359 MB
After local copies = 24844.43652 MB
After first SDPA allocated = 24843.92383 MB
After first copy allocated = 24843.92383 MB
On chunked entry = 24843.92383 MB
On scale calculation = 24843.93164 MB
Before interleave = 24843.93164 MB
After interleave = 24844.50977 MB
After matmul = 24844.51221 MB
Before local copies matmul = 24844.51221 MB
After local copies = 24844.51562 MB
fter compute chunk allocated = 24843.92383 MB
Memory after cuda sdpa 24843.931640625 MB
1
Memory before offload  24843.91015625 MB
Memory after offload  24843.91015625 MB
Memory before cuda sdpa 24843.923828125 MB
On entering CUDA sdpa main function  allocated = 24843.92383 MB
Before first SDPA allocated = 24843.92383 MB
On chunked entry = 24843.92383 MB
On scale calculation = 24843.93164 MB
Before interleave = 24843.93164 MB
After interleave = 24844.43164 MB
After matmul = 24852.55859 MB
Before local copies matmul = 24852.55859 MB
After local copies = 24852.56152 MB
After first SDPA allocated = 24852.04883 MB
After first copy allocated = 24852.04883 MB
On chunked entry = 24852.04883 MB
On scale calculation = 24852.05664 MB
Before interleave = 24852.05664 MB
After interleave = 24852.63477 MB
After matmul = 24852.63721 MB
Before local copies matmul = 24852.63721 MB
After local copies = 24852.64062 MB
fter compute chunk allocated = 24852.04883 MB
Memory after cuda sdpa 24852.056640625 MB
1
Memory before offload  24852.03515625 MB
Memory after offload  24852.03515625 MB
Memory before cuda sdpa 24852.048828125 MB
On entering CUDA sdpa main function  allocated = 24852.04883 MB
Before first SDPA allocated = 24852.04883 MB
On chunked entry = 24852.04883 MB
On scale calculation = 24852.05664 MB
Before interleave = 24852.05664 MB
After interleave = 24852.55664 MB
After matmul = 24860.68359 MB
Before local copies matmul = 24860.68359 MB
After local copies = 24860.68652 MB
After first SDPA allocated = 24860.17383 MB
After first copy allocated = 24860.17383 MB
On chunked entry = 24860.17383 MB
On scale calculation = 24860.18164 MB
Before interleave = 24860.18164 MB
After interleave = 24860.75977 MB
After matmul = 24860.76221 MB
Before local copies matmul = 24860.76221 MB
After local copies = 24860.76562 MB
fter compute chunk allocated = 24860.17383 MB
Memory after cuda sdpa 24860.181640625 MB
1
Memory before offload  24860.16015625 MB
Memory after offload  24860.16015625 MB
Memory before cuda sdpa 24860.173828125 MB
On entering CUDA sdpa main function  allocated = 24860.17383 MB
Before first SDPA allocated = 24860.17383 MB
On chunked entry = 24860.17383 MB
On scale calculation = 24860.18164 MB
Before interleave = 24860.18164 MB
After interleave = 24860.68164 MB
After matmul = 24868.80859 MB
Before local copies matmul = 24868.80859 MB
After local copies = 24868.81152 MB
After first SDPA allocated = 24868.29883 MB
After first copy allocated = 24868.29883 MB
On chunked entry = 24868.29883 MB
On scale calculation = 24868.30664 MB
Before interleave = 24868.30664 MB
After interleave = 24868.88477 MB
After matmul = 24868.88721 MB
Before local copies matmul = 24868.88721 MB
After local copies = 24868.89062 MB
fter compute chunk allocated = 24868.29883 MB
Memory after cuda sdpa 24868.306640625 MB
1
Memory before offload  24868.28515625 MB
Memory after offload  24868.28515625 MB
Memory before cuda sdpa 24868.298828125 MB
On entering CUDA sdpa main function  allocated = 24868.29883 MB
Before first SDPA allocated = 24868.29883 MB
On chunked entry = 24868.29883 MB
On scale calculation = 24868.30664 MB
Before interleave = 24868.30664 MB
After interleave = 24868.80664 MB
After matmul = 24876.93359 MB
Before local copies matmul = 24876.93359 MB
After local copies = 24876.93652 MB
After first SDPA allocated = 24876.42383 MB
After first copy allocated = 24876.42383 MB
On chunked entry = 24876.42383 MB
On scale calculation = 24876.43164 MB
Before interleave = 24876.43164 MB
After interleave = 24877.00977 MB
After matmul = 24877.01221 MB
Before local copies matmul = 24877.01221 MB
After local copies = 24877.01562 MB
fter compute chunk allocated = 24876.42383 MB
Memory after cuda sdpa 24876.431640625 MB
1
Memory before offload  24876.41015625 MB
Memory after offload  24876.41015625 MB
Memory before cuda sdpa 24876.423828125 MB
On entering CUDA sdpa main function  allocated = 24876.42383 MB
Before first SDPA allocated = 24876.42383 MB
On chunked entry = 24876.42383 MB
On scale calculation = 24876.43164 MB
Before interleave = 24876.43164 MB
After interleave = 24876.93164 MB
After matmul = 24885.05859 MB
Before local copies matmul = 24885.05859 MB
After local copies = 24885.06152 MB
After first SDPA allocated = 24884.54883 MB
After first copy allocated = 24884.54883 MB
On chunked entry = 24884.54883 MB
On scale calculation = 24884.55664 MB
Before interleave = 24884.55664 MB
After interleave = 24885.13477 MB
After matmul = 24885.13721 MB
Before local copies matmul = 24885.13721 MB
After local copies = 24885.14062 MB
fter compute chunk allocated = 24884.54883 MB
Memory after cuda sdpa 24884.556640625 MB
1
Memory before offload  24884.53515625 MB
Memory after offload  24884.53515625 MB
Memory before cuda sdpa 24884.548828125 MB
On entering CUDA sdpa main function  allocated = 24884.54883 MB
Before first SDPA allocated = 24884.54883 MB
On chunked entry = 24884.54883 MB
On scale calculation = 24884.55664 MB
Before interleave = 24884.55664 MB
After interleave = 24885.05664 MB
After matmul = 24893.18359 MB
Before local copies matmul = 24893.18359 MB
After local copies = 24893.18652 MB
After first SDPA allocated = 24892.67383 MB
After first copy allocated = 24892.67383 MB
On chunked entry = 24892.67383 MB
On scale calculation = 24892.68164 MB
Before interleave = 24892.68164 MB
After interleave = 24893.25977 MB
After matmul = 24893.26221 MB
Before local copies matmul = 24893.26221 MB
After local copies = 24893.26562 MB
fter compute chunk allocated = 24892.67383 MB
Memory after cuda sdpa 24892.681640625 MB
1
Memory before offload  24892.66015625 MB
Memory after offload  24892.66015625 MB
Memory before cuda sdpa 24892.673828125 MB
On entering CUDA sdpa main function  allocated = 24892.67383 MB
Before first SDPA allocated = 24892.67383 MB
On chunked entry = 24892.67383 MB
On scale calculation = 24892.68164 MB
Before interleave = 24892.68164 MB
After interleave = 24893.18164 MB
After matmul = 24901.30859 MB
Before local copies matmul = 24901.30859 MB
After local copies = 24901.31152 MB
After first SDPA allocated = 24900.79883 MB
After first copy allocated = 24900.79883 MB
On chunked entry = 24900.79883 MB
On scale calculation = 24900.80664 MB
Before interleave = 24900.80664 MB
After interleave = 24901.38477 MB
After matmul = 24901.38721 MB
Before local copies matmul = 24901.38721 MB
After local copies = 24901.39062 MB
fter compute chunk allocated = 24900.79883 MB
Memory after cuda sdpa 24900.806640625 MB
1
Memory before offload  24900.78515625 MB
Memory after offload  24900.78515625 MB
Memory before cuda sdpa 24900.798828125 MB
On entering CUDA sdpa main function  allocated = 24900.79883 MB
Before first SDPA allocated = 24900.79883 MB
On chunked entry = 24900.79883 MB
On scale calculation = 24900.80664 MB
Before interleave = 24900.80664 MB
After interleave = 24901.30664 MB
After matmul = 24909.43359 MB
Before local copies matmul = 24909.43359 MB
After local copies = 24909.43652 MB
After first SDPA allocated = 24908.92383 MB
After first copy allocated = 24908.92383 MB
On chunked entry = 24908.92383 MB
On scale calculation = 24908.93164 MB
Before interleave = 24908.93164 MB
After interleave = 24909.50977 MB
After matmul = 24909.51221 MB
Before local copies matmul = 24909.51221 MB
After local copies = 24909.51562 MB
fter compute chunk allocated = 24908.92383 MB
Memory after cuda sdpa 24908.931640625 MB
1
Memory before offload  24908.91015625 MB
Memory after offload  24908.91015625 MB
Memory before cuda sdpa 24908.923828125 MB
On entering CUDA sdpa main function  allocated = 24908.92383 MB
Before first SDPA allocated = 24908.92383 MB
On chunked entry = 24908.92383 MB
On scale calculation = 24908.93164 MB
Before interleave = 24908.93164 MB
After interleave = 24909.43164 MB
After matmul = 24917.55859 MB
Before local copies matmul = 24917.55859 MB
After local copies = 24917.56152 MB
After first SDPA allocated = 24917.04883 MB
After first copy allocated = 24917.04883 MB
On chunked entry = 24917.04883 MB
On scale calculation = 24917.05664 MB
Before interleave = 24917.05664 MB
After interleave = 24917.63477 MB
After matmul = 24917.63721 MB
Before local copies matmul = 24917.63721 MB
After local copies = 24917.64062 MB
fter compute chunk allocated = 24917.04883 MB
Memory after cuda sdpa 24917.056640625 MB
1
Memory before offload  24917.03515625 MB
Memory after offload  24917.03515625 MB
Memory before cuda sdpa 24917.048828125 MB
On entering CUDA sdpa main function  allocated = 24917.04883 MB
Before first SDPA allocated = 24917.04883 MB
On chunked entry = 24917.04883 MB
On scale calculation = 24917.05664 MB
Before interleave = 24917.05664 MB
After interleave = 24917.55664 MB
After matmul = 24925.68359 MB
Before local copies matmul = 24925.68359 MB
After local copies = 24925.68652 MB
After first SDPA allocated = 24925.17383 MB
After first copy allocated = 24925.17383 MB
On chunked entry = 24925.17383 MB
On scale calculation = 24925.18164 MB
Before interleave = 24925.18164 MB
After interleave = 24925.75977 MB
After matmul = 24925.76221 MB
Before local copies matmul = 24925.76221 MB
After local copies = 24925.76562 MB
fter compute chunk allocated = 24925.17383 MB
Memory after cuda sdpa 24925.181640625 MB
1
Memory before offload  24925.16015625 MB
Memory after offload  24925.16015625 MB
Memory before cuda sdpa 24925.173828125 MB
On entering CUDA sdpa main function  allocated = 24925.17383 MB
Before first SDPA allocated = 24925.17383 MB
On chunked entry = 24925.17383 MB
On scale calculation = 24925.18164 MB
Before interleave = 24925.18164 MB
After interleave = 24925.68164 MB
After matmul = 24933.80859 MB
Before local copies matmul = 24933.80859 MB
After local copies = 24933.81152 MB
After first SDPA allocated = 24933.29883 MB
After first copy allocated = 24933.29883 MB
On chunked entry = 24933.29883 MB
On scale calculation = 24933.30664 MB
Before interleave = 24933.30664 MB
After interleave = 24933.88477 MB
After matmul = 24933.88721 MB
Before local copies matmul = 24933.88721 MB
After local copies = 24933.89062 MB
fter compute chunk allocated = 24933.29883 MB
Memory after cuda sdpa 24933.306640625 MB
1
Memory before offload  24933.28515625 MB
Memory after offload  24933.28515625 MB
Memory before cuda sdpa 24933.298828125 MB
On entering CUDA sdpa main function  allocated = 24933.29883 MB
Before first SDPA allocated = 24933.29883 MB
On chunked entry = 24933.29883 MB
On scale calculation = 24933.30664 MB
Before interleave = 24933.30664 MB
After interleave = 24933.80664 MB
After matmul = 24941.93359 MB
Before local copies matmul = 24941.93359 MB
After local copies = 24941.93652 MB
After first SDPA allocated = 24941.42383 MB
After first copy allocated = 24941.42383 MB
On chunked entry = 24941.42383 MB
On scale calculation = 24941.43164 MB
Before interleave = 24941.43164 MB
After interleave = 24942.00977 MB
After matmul = 24942.01221 MB
Before local copies matmul = 24942.01221 MB
After local copies = 24942.01562 MB
fter compute chunk allocated = 24941.42383 MB
Memory after cuda sdpa 24941.431640625 MB
1
Memory before offload  24941.41015625 MB
Memory after offload  24941.41015625 MB
Memory before cuda sdpa 24941.423828125 MB
On entering CUDA sdpa main function  allocated = 24941.42383 MB
Before first SDPA allocated = 24941.42383 MB
On chunked entry = 24941.42383 MB
On scale calculation = 24941.43164 MB
Before interleave = 24941.43164 MB
After interleave = 24941.93164 MB
After matmul = 24950.05859 MB
Before local copies matmul = 24950.05859 MB
After local copies = 24950.06152 MB
After first SDPA allocated = 24949.54883 MB
After first copy allocated = 24949.54883 MB
On chunked entry = 24949.54883 MB
On scale calculation = 24949.55664 MB
Before interleave = 24949.55664 MB
After interleave = 24950.13477 MB
After matmul = 24950.13721 MB
Before local copies matmul = 24950.13721 MB
After local copies = 24950.14062 MB
fter compute chunk allocated = 24949.54883 MB
Memory after cuda sdpa 24949.556640625 MB
1
Memory before offload  24949.53515625 MB
Memory after offload  24949.53515625 MB
Memory before cuda sdpa 24949.548828125 MB
On entering CUDA sdpa main function  allocated = 24949.54883 MB
Before first SDPA allocated = 24949.54883 MB
On chunked entry = 24949.54883 MB
On scale calculation = 24949.55664 MB
Before interleave = 24949.55664 MB
After interleave = 24950.05664 MB
After matmul = 24958.18359 MB
Before local copies matmul = 24958.18359 MB
After local copies = 24958.18652 MB
After first SDPA allocated = 24957.67383 MB
After first copy allocated = 24957.67383 MB
On chunked entry = 24957.67383 MB
On scale calculation = 24957.68164 MB
Before interleave = 24957.68164 MB
After interleave = 24958.25977 MB
After matmul = 24958.26221 MB
Before local copies matmul = 24958.26221 MB
After local copies = 24958.26562 MB
fter compute chunk allocated = 24957.67383 MB
Memory after cuda sdpa 24957.681640625 MB
1
Memory before offload  24957.66015625 MB
Memory after offload  24957.66015625 MB
Memory before cuda sdpa 24957.673828125 MB
On entering CUDA sdpa main function  allocated = 24957.67383 MB
Before first SDPA allocated = 24957.67383 MB
On chunked entry = 24957.67383 MB
On scale calculation = 24957.68164 MB
Before interleave = 24957.68164 MB
After interleave = 24958.18164 MB
After matmul = 24966.30859 MB
Before local copies matmul = 24966.30859 MB
After local copies = 24966.31152 MB
After first SDPA allocated = 24965.79883 MB
After first copy allocated = 24965.79883 MB
On chunked entry = 24965.79883 MB
On scale calculation = 24965.80664 MB
Before interleave = 24965.80664 MB
After interleave = 24966.38477 MB
After matmul = 24966.38721 MB
Before local copies matmul = 24966.38721 MB
After local copies = 24966.39062 MB
fter compute chunk allocated = 24965.79883 MB
Memory after cuda sdpa 24965.806640625 MB
Decode step 38
1
Memory before offload  24965.78564453125 MB
Memory after offload  24965.78564453125 MB
Memory before cuda sdpa 24965.79931640625 MB
On entering CUDA sdpa main function  allocated = 24965.79932 MB
Before first SDPA allocated = 24965.79932 MB
On chunked entry = 24965.79932 MB
On scale calculation = 24965.80713 MB
Before interleave = 24965.80713 MB
After interleave = 24966.30713 MB
After matmul = 24974.43408 MB
Before local copies matmul = 24974.43408 MB
After local copies = 24974.43701 MB
After first SDPA allocated = 24973.92432 MB
After first copy allocated = 24973.92432 MB
On chunked entry = 24973.92432 MB
On scale calculation = 24973.93213 MB
Before interleave = 24973.93213 MB
After interleave = 24974.52588 MB
After matmul = 24974.52832 MB
Before local copies matmul = 24974.52832 MB
After local copies = 24974.53174 MB
fter compute chunk allocated = 24973.92432 MB
Memory after cuda sdpa 24973.93212890625 MB
1
Memory before offload  24973.91064453125 MB
Memory after offload  24973.91064453125 MB
Memory before cuda sdpa 24973.92431640625 MB
On entering CUDA sdpa main function  allocated = 24973.92432 MB
Before first SDPA allocated = 24973.92432 MB
On chunked entry = 24973.92432 MB
On scale calculation = 24973.93213 MB
Before interleave = 24973.93213 MB
After interleave = 24974.43213 MB
After matmul = 24982.55908 MB
Before local copies matmul = 24982.55908 MB
After local copies = 24982.56201 MB
After first SDPA allocated = 24982.04932 MB
After first copy allocated = 24982.04932 MB
On chunked entry = 24982.04932 MB
On scale calculation = 24982.05713 MB
Before interleave = 24982.05713 MB
After interleave = 24982.65088 MB
After matmul = 24982.65332 MB
Before local copies matmul = 24982.65332 MB
After local copies = 24982.65674 MB
fter compute chunk allocated = 24982.04932 MB
Memory after cuda sdpa 24982.05712890625 MB
1
Memory before offload  24982.03564453125 MB
Memory after offload  24982.03564453125 MB
Memory before cuda sdpa 24982.04931640625 MB
On entering CUDA sdpa main function  allocated = 24982.04932 MB
Before first SDPA allocated = 24982.04932 MB
On chunked entry = 24982.04932 MB
On scale calculation = 24982.05713 MB
Before interleave = 24982.05713 MB
After interleave = 24982.55713 MB
After matmul = 24990.68408 MB
Before local copies matmul = 24990.68408 MB
After local copies = 24990.68701 MB
After first SDPA allocated = 24990.17432 MB
After first copy allocated = 24990.17432 MB
On chunked entry = 24990.17432 MB
On scale calculation = 24990.18213 MB
Before interleave = 24990.18213 MB
After interleave = 24990.77588 MB
After matmul = 24990.77832 MB
Before local copies matmul = 24990.77832 MB
After local copies = 24990.78174 MB
fter compute chunk allocated = 24990.17432 MB
Memory after cuda sdpa 24990.18212890625 MB
1
Memory before offload  24990.16064453125 MB
Memory after offload  24990.16064453125 MB
Memory before cuda sdpa 24990.17431640625 MB
On entering CUDA sdpa main function  allocated = 24990.17432 MB
Before first SDPA allocated = 24990.17432 MB
On chunked entry = 24990.17432 MB
On scale calculation = 24990.18213 MB
Before interleave = 24990.18213 MB
After interleave = 24990.68213 MB
After matmul = 24998.80908 MB
Before local copies matmul = 24998.80908 MB
After local copies = 24998.81201 MB
After first SDPA allocated = 24998.29932 MB
After first copy allocated = 24998.29932 MB
On chunked entry = 24998.29932 MB
On scale calculation = 24998.30713 MB
Before interleave = 24998.30713 MB
After interleave = 24998.90088 MB
After matmul = 24998.90332 MB
Before local copies matmul = 24998.90332 MB
After local copies = 24998.90674 MB
fter compute chunk allocated = 24998.29932 MB
Memory after cuda sdpa 24998.30712890625 MB
1
Memory before offload  24998.28564453125 MB
Memory after offload  24998.28564453125 MB
Memory before cuda sdpa 24998.29931640625 MB
On entering CUDA sdpa main function  allocated = 24998.29932 MB
Before first SDPA allocated = 24998.29932 MB
On chunked entry = 24998.29932 MB
On scale calculation = 24998.30713 MB
Before interleave = 24998.30713 MB
After interleave = 24998.80713 MB
After matmul = 25006.93408 MB
Before local copies matmul = 25006.93408 MB
After local copies = 25006.93701 MB
After first SDPA allocated = 25006.42432 MB
After first copy allocated = 25006.42432 MB
On chunked entry = 25006.42432 MB
On scale calculation = 25006.43213 MB
Before interleave = 25006.43213 MB
After interleave = 25007.02588 MB
After matmul = 25007.02832 MB
Before local copies matmul = 25007.02832 MB
After local copies = 25007.03174 MB
fter compute chunk allocated = 25006.42432 MB
Memory after cuda sdpa 25006.43212890625 MB
1
Memory before offload  25006.41064453125 MB
Memory after offload  25006.41064453125 MB
Memory before cuda sdpa 25006.42431640625 MB
On entering CUDA sdpa main function  allocated = 25006.42432 MB
Before first SDPA allocated = 25006.42432 MB
On chunked entry = 25006.42432 MB
On scale calculation = 25006.43213 MB
Before interleave = 25006.43213 MB
After interleave = 25006.93213 MB
After matmul = 25015.05908 MB
Before local copies matmul = 25015.05908 MB
After local copies = 25015.06201 MB
After first SDPA allocated = 25014.54932 MB
After first copy allocated = 25014.54932 MB
On chunked entry = 25014.54932 MB
On scale calculation = 25014.55713 MB
Before interleave = 25014.55713 MB
After interleave = 25015.15088 MB
After matmul = 25015.15332 MB
Before local copies matmul = 25015.15332 MB
After local copies = 25015.15674 MB
fter compute chunk allocated = 25014.54932 MB
Memory after cuda sdpa 25014.55712890625 MB
1
Memory before offload  25014.53564453125 MB
Memory after offload  25014.53564453125 MB
Memory before cuda sdpa 25014.54931640625 MB
On entering CUDA sdpa main function  allocated = 25014.54932 MB
Before first SDPA allocated = 25014.54932 MB
On chunked entry = 25014.54932 MB
On scale calculation = 25014.55713 MB
Before interleave = 25014.55713 MB
After interleave = 25015.05713 MB
After matmul = 25023.18408 MB
Before local copies matmul = 25023.18408 MB
After local copies = 25023.18701 MB
After first SDPA allocated = 25022.67432 MB
After first copy allocated = 25022.67432 MB
On chunked entry = 25022.67432 MB
On scale calculation = 25022.68213 MB
Before interleave = 25022.68213 MB
After interleave = 25023.27588 MB
After matmul = 25023.27832 MB
Before local copies matmul = 25023.27832 MB
After local copies = 25023.28174 MB
fter compute chunk allocated = 25022.67432 MB
Memory after cuda sdpa 25022.68212890625 MB
1
Memory before offload  25022.66064453125 MB
Memory after offload  25022.66064453125 MB
Memory before cuda sdpa 25022.67431640625 MB
On entering CUDA sdpa main function  allocated = 25022.67432 MB
Before first SDPA allocated = 25022.67432 MB
On chunked entry = 25022.67432 MB
On scale calculation = 25022.68213 MB
Before interleave = 25022.68213 MB
After interleave = 25023.18213 MB
After matmul = 25031.30908 MB
Before local copies matmul = 25031.30908 MB
After local copies = 25031.31201 MB
After first SDPA allocated = 25030.79932 MB
After first copy allocated = 25030.79932 MB
On chunked entry = 25030.79932 MB
On scale calculation = 25030.80713 MB
Before interleave = 25030.80713 MB
After interleave = 25031.40088 MB
After matmul = 25031.40332 MB
Before local copies matmul = 25031.40332 MB
After local copies = 25031.40674 MB
fter compute chunk allocated = 25030.79932 MB
Memory after cuda sdpa 25030.80712890625 MB
1
Memory before offload  25030.78564453125 MB
Memory after offload  25030.78564453125 MB
Memory before cuda sdpa 25030.79931640625 MB
On entering CUDA sdpa main function  allocated = 25030.79932 MB
Before first SDPA allocated = 25030.79932 MB
On chunked entry = 25030.79932 MB
On scale calculation = 25030.80713 MB
Before interleave = 25030.80713 MB
After interleave = 25031.30713 MB
After matmul = 25039.43408 MB
Before local copies matmul = 25039.43408 MB
After local copies = 25039.43701 MB
After first SDPA allocated = 25038.92432 MB
After first copy allocated = 25038.92432 MB
On chunked entry = 25038.92432 MB
On scale calculation = 25038.93213 MB
Before interleave = 25038.93213 MB
After interleave = 25039.52588 MB
After matmul = 25039.52832 MB
Before local copies matmul = 25039.52832 MB
After local copies = 25039.53174 MB
fter compute chunk allocated = 25038.92432 MB
Memory after cuda sdpa 25038.93212890625 MB
1
Memory before offload  25038.91064453125 MB
Memory after offload  25038.91064453125 MB
Memory before cuda sdpa 25038.92431640625 MB
On entering CUDA sdpa main function  allocated = 25038.92432 MB
Before first SDPA allocated = 25038.92432 MB
On chunked entry = 25038.92432 MB
On scale calculation = 25038.93213 MB
Before interleave = 25038.93213 MB
After interleave = 25039.43213 MB
After matmul = 25047.55908 MB
Before local copies matmul = 25047.55908 MB
After local copies = 25047.56201 MB
After first SDPA allocated = 25047.04932 MB
After first copy allocated = 25047.04932 MB
On chunked entry = 25047.04932 MB
On scale calculation = 25047.05713 MB
Before interleave = 25047.05713 MB
After interleave = 25047.65088 MB
After matmul = 25047.65332 MB
Before local copies matmul = 25047.65332 MB
After local copies = 25047.65674 MB
fter compute chunk allocated = 25047.04932 MB
Memory after cuda sdpa 25047.05712890625 MB
1
Memory before offload  25047.03564453125 MB
Memory after offload  25047.03564453125 MB
Memory before cuda sdpa 25047.04931640625 MB
On entering CUDA sdpa main function  allocated = 25047.04932 MB
Before first SDPA allocated = 25047.04932 MB
On chunked entry = 25047.04932 MB
On scale calculation = 25047.05713 MB
Before interleave = 25047.05713 MB
After interleave = 25047.55713 MB
After matmul = 25055.68408 MB
Before local copies matmul = 25055.68408 MB
After local copies = 25055.68701 MB
After first SDPA allocated = 25055.17432 MB
After first copy allocated = 25055.17432 MB
On chunked entry = 25055.17432 MB
On scale calculation = 25055.18213 MB
Before interleave = 25055.18213 MB
After interleave = 25055.77588 MB
After matmul = 25055.77832 MB
Before local copies matmul = 25055.77832 MB
After local copies = 25055.78174 MB
fter compute chunk allocated = 25055.17432 MB
Memory after cuda sdpa 25055.18212890625 MB
1
Memory before offload  25055.16064453125 MB
Memory after offload  25055.16064453125 MB
Memory before cuda sdpa 25055.17431640625 MB
On entering CUDA sdpa main function  allocated = 25055.17432 MB
Before first SDPA allocated = 25055.17432 MB
On chunked entry = 25055.17432 MB
On scale calculation = 25055.18213 MB
Before interleave = 25055.18213 MB
After interleave = 25055.68213 MB
After matmul = 25063.80908 MB
Before local copies matmul = 25063.80908 MB
After local copies = 25063.81201 MB
After first SDPA allocated = 25063.29932 MB
After first copy allocated = 25063.29932 MB
On chunked entry = 25063.29932 MB
On scale calculation = 25063.30713 MB
Before interleave = 25063.30713 MB
After interleave = 25063.90088 MB
After matmul = 25063.90332 MB
Before local copies matmul = 25063.90332 MB
After local copies = 25063.90674 MB
fter compute chunk allocated = 25063.29932 MB
Memory after cuda sdpa 25063.30712890625 MB
1
Memory before offload  25063.28564453125 MB
Memory after offload  25063.28564453125 MB
Memory before cuda sdpa 25063.29931640625 MB
On entering CUDA sdpa main function  allocated = 25063.29932 MB
Before first SDPA allocated = 25063.29932 MB
On chunked entry = 25063.29932 MB
On scale calculation = 25063.30713 MB
Before interleave = 25063.30713 MB
After interleave = 25063.80713 MB
After matmul = 25071.93408 MB
Before local copies matmul = 25071.93408 MB
After local copies = 25071.93701 MB
After first SDPA allocated = 25071.42432 MB
After first copy allocated = 25071.42432 MB
On chunked entry = 25071.42432 MB
On scale calculation = 25071.43213 MB
Before interleave = 25071.43213 MB
After interleave = 25072.02588 MB
After matmul = 25072.02832 MB
Before local copies matmul = 25072.02832 MB
After local copies = 25072.03174 MB
fter compute chunk allocated = 25071.42432 MB
Memory after cuda sdpa 25071.43212890625 MB
1
Memory before offload  25071.41064453125 MB
Memory after offload  25071.41064453125 MB
Memory before cuda sdpa 25071.42431640625 MB
On entering CUDA sdpa main function  allocated = 25071.42432 MB
Before first SDPA allocated = 25071.42432 MB
On chunked entry = 25071.42432 MB
On scale calculation = 25071.43213 MB
Before interleave = 25071.43213 MB
After interleave = 25071.93213 MB
After matmul = 25080.05908 MB
Before local copies matmul = 25080.05908 MB
After local copies = 25080.06201 MB
After first SDPA allocated = 25079.54932 MB
After first copy allocated = 25079.54932 MB
On chunked entry = 25079.54932 MB
On scale calculation = 25079.55713 MB
Before interleave = 25079.55713 MB
After interleave = 25080.15088 MB
After matmul = 25080.15332 MB
Before local copies matmul = 25080.15332 MB
After local copies = 25080.15674 MB
fter compute chunk allocated = 25079.54932 MB
Memory after cuda sdpa 25079.55712890625 MB
1
Memory before offload  25079.53564453125 MB
Memory after offload  25079.53564453125 MB
Memory before cuda sdpa 25079.54931640625 MB
On entering CUDA sdpa main function  allocated = 25079.54932 MB
Before first SDPA allocated = 25079.54932 MB
On chunked entry = 25079.54932 MB
On scale calculation = 25079.55713 MB
Before interleave = 25079.55713 MB
After interleave = 25080.05713 MB
After matmul = 25088.18408 MB
Before local copies matmul = 25088.18408 MB
After local copies = 25088.18701 MB
After first SDPA allocated = 25087.67432 MB
After first copy allocated = 25087.67432 MB
On chunked entry = 25087.67432 MB
On scale calculation = 25087.68213 MB
Before interleave = 25087.68213 MB
After interleave = 25088.27588 MB
After matmul = 25088.27832 MB
Before local copies matmul = 25088.27832 MB
After local copies = 25088.28174 MB
fter compute chunk allocated = 25087.67432 MB
Memory after cuda sdpa 25087.68212890625 MB
1
Memory before offload  25087.66064453125 MB
Memory after offload  25087.66064453125 MB
Memory before cuda sdpa 25087.67431640625 MB
On entering CUDA sdpa main function  allocated = 25087.67432 MB
Before first SDPA allocated = 25087.67432 MB
On chunked entry = 25087.67432 MB
On scale calculation = 25087.68213 MB
Before interleave = 25087.68213 MB
After interleave = 25088.18213 MB
After matmul = 25096.30908 MB
Before local copies matmul = 25096.30908 MB
After local copies = 25096.31201 MB
After first SDPA allocated = 25095.79932 MB
After first copy allocated = 25095.79932 MB
On chunked entry = 25095.79932 MB
On scale calculation = 25095.80713 MB
Before interleave = 25095.80713 MB
After interleave = 25096.40088 MB
After matmul = 25096.40332 MB
Before local copies matmul = 25096.40332 MB
After local copies = 25096.40674 MB
fter compute chunk allocated = 25095.79932 MB
Memory after cuda sdpa 25095.80712890625 MB
1
Memory before offload  25095.78564453125 MB
Memory after offload  25095.78564453125 MB
Memory before cuda sdpa 25095.79931640625 MB
On entering CUDA sdpa main function  allocated = 25095.79932 MB
Before first SDPA allocated = 25095.79932 MB
On chunked entry = 25095.79932 MB
On scale calculation = 25095.80713 MB
Before interleave = 25095.80713 MB
After interleave = 25096.30713 MB
After matmul = 25104.43408 MB
Before local copies matmul = 25104.43408 MB
After local copies = 25104.43701 MB
After first SDPA allocated = 25103.92432 MB
After first copy allocated = 25103.92432 MB
On chunked entry = 25103.92432 MB
On scale calculation = 25103.93213 MB
Before interleave = 25103.93213 MB
After interleave = 25104.52588 MB
After matmul = 25104.52832 MB
Before local copies matmul = 25104.52832 MB
After local copies = 25104.53174 MB
fter compute chunk allocated = 25103.92432 MB
Memory after cuda sdpa 25103.93212890625 MB
1
Memory before offload  25103.91064453125 MB
Memory after offload  25103.91064453125 MB
Memory before cuda sdpa 25103.92431640625 MB
On entering CUDA sdpa main function  allocated = 25103.92432 MB
Before first SDPA allocated = 25103.92432 MB
On chunked entry = 25103.92432 MB
On scale calculation = 25103.93213 MB
Before interleave = 25103.93213 MB
After interleave = 25104.43213 MB
After matmul = 25112.55908 MB
Before local copies matmul = 25112.55908 MB
After local copies = 25112.56201 MB
After first SDPA allocated = 25112.04932 MB
After first copy allocated = 25112.04932 MB
On chunked entry = 25112.04932 MB
On scale calculation = 25112.05713 MB
Before interleave = 25112.05713 MB
After interleave = 25112.65088 MB
After matmul = 25112.65332 MB
Before local copies matmul = 25112.65332 MB
After local copies = 25112.65674 MB
fter compute chunk allocated = 25112.04932 MB
Memory after cuda sdpa 25112.05712890625 MB
1
Memory before offload  25112.03564453125 MB
Memory after offload  25112.03564453125 MB
Memory before cuda sdpa 25112.04931640625 MB
On entering CUDA sdpa main function  allocated = 25112.04932 MB
Before first SDPA allocated = 25112.04932 MB
On chunked entry = 25112.04932 MB
On scale calculation = 25112.05713 MB
Before interleave = 25112.05713 MB
After interleave = 25112.55713 MB
After matmul = 25120.68408 MB
Before local copies matmul = 25120.68408 MB
After local copies = 25120.68701 MB
After first SDPA allocated = 25120.17432 MB
After first copy allocated = 25120.17432 MB
On chunked entry = 25120.17432 MB
On scale calculation = 25120.18213 MB
Before interleave = 25120.18213 MB
After interleave = 25120.77588 MB
After matmul = 25120.77832 MB
Before local copies matmul = 25120.77832 MB
After local copies = 25120.78174 MB
fter compute chunk allocated = 25120.17432 MB
Memory after cuda sdpa 25120.18212890625 MB
1
Memory before offload  25120.16064453125 MB
Memory after offload  25120.16064453125 MB
Memory before cuda sdpa 25120.17431640625 MB
On entering CUDA sdpa main function  allocated = 25120.17432 MB
Before first SDPA allocated = 25120.17432 MB
On chunked entry = 25120.17432 MB
On scale calculation = 25120.18213 MB
Before interleave = 25120.18213 MB
After interleave = 25120.68213 MB
After matmul = 25128.80908 MB
Before local copies matmul = 25128.80908 MB
After local copies = 25128.81201 MB
After first SDPA allocated = 25128.29932 MB
After first copy allocated = 25128.29932 MB
On chunked entry = 25128.29932 MB
On scale calculation = 25128.30713 MB
Before interleave = 25128.30713 MB
After interleave = 25128.90088 MB
After matmul = 25128.90332 MB
Before local copies matmul = 25128.90332 MB
After local copies = 25128.90674 MB
fter compute chunk allocated = 25128.29932 MB
Memory after cuda sdpa 25128.30712890625 MB
1
Memory before offload  25128.28564453125 MB
Memory after offload  25128.28564453125 MB
Memory before cuda sdpa 25128.29931640625 MB
On entering CUDA sdpa main function  allocated = 25128.29932 MB
Before first SDPA allocated = 25128.29932 MB
On chunked entry = 25128.29932 MB
On scale calculation = 25128.30713 MB
Before interleave = 25128.30713 MB
After interleave = 25128.80713 MB
